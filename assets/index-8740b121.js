var Aa=Object.defineProperty;var ka=(i,c,s)=>c in i?Aa(i,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[c]=s;var Fe=(i,c,s)=>(ka(i,typeof c!="symbol"?c+"":c,s),s),Wr=(i,c,s)=>{if(!c.has(i))throw TypeError("Cannot "+s)};var K=(i,c,s)=>(Wr(i,c,"read from private field"),s?s.call(i):c.get(i)),Ie=(i,c,s)=>{if(c.has(i))throw TypeError("Cannot add the same private member more than once");c instanceof WeakSet?c.add(i):c.set(i,s)},ke=(i,c,s,m)=>(Wr(i,c,"write to private field"),m?m.call(i,s):c.set(i,s),s);var br=(i,c,s,m)=>({set _(w){ke(i,c,w,s)},get _(){return K(i,c,m)}}),Ae=(i,c,s)=>(Wr(i,c,"access private method"),s);import{ag as Ra,r as js,H as Ta,o as La,k as Ia,l as xa,v as Vt,a5 as Ba,n as Oa,A as $r,ak as Pa,al as Da}from"./index-f0783a82.js";var As=Object.defineProperty,Ma=Object.getOwnPropertyDescriptor,Ua=Object.getOwnPropertyNames,Fa=Object.prototype.hasOwnProperty,Je=(i,c)=>()=>(i&&(c=i(i=0)),c),we=(i,c)=>()=>(c||i((c={exports:{}}).exports,c),c.exports),Zt=(i,c)=>{for(var s in c)As(i,s,{get:c[s],enumerable:!0})},Na=(i,c,s,m)=>{if(c&&typeof c=="object"||typeof c=="function")for(let w of Ua(c))!Fa.call(i,w)&&w!==s&&As(i,w,{get:()=>c[w],enumerable:!(m=Ma(c,w))||m.enumerable});return i},Pe=i=>Na(As({},"__esModule",{value:!0}),i),pe=Je(()=>{}),Ve={};Zt(Ve,{_debugEnd:()=>Mi,_debugProcess:()=>Di,_events:()=>Xi,_eventsCount:()=>Qi,_exiting:()=>wi,_fatalExceptions:()=>Bi,_getActiveHandles:()=>Mn,_getActiveRequests:()=>Dn,_kill:()=>Ei,_linkedBinding:()=>On,_maxListeners:()=>Ji,_preload_modules:()=>Gi,_rawDebug:()=>mi,_startProfilerIdleNotifier:()=>Ui,_stopProfilerIdleNotifier:()=>Fi,_tickCallback:()=>Pi,abort:()=>Wi,addListener:()=>Zi,allowedNodeEnvironmentFlags:()=>Ii,arch:()=>ni,argv:()=>li,argv0:()=>Ki,assert:()=>Un,binding:()=>fi,chdir:()=>gi,config:()=>Si,cpuUsage:()=>fr,cwd:()=>_i,debugPort:()=>Vi,default:()=>Rs,dlopen:()=>Pn,domain:()=>yi,emit:()=>ss,emitWarning:()=>di,env:()=>ai,execArgv:()=>hi,execPath:()=>qi,exit:()=>Ti,features:()=>xi,hasUncaughtExceptionCaptureCallback:()=>Fn,hrtime:()=>Ar,kill:()=>Ri,listeners:()=>jn,memoryUsage:()=>ki,moduleLoadList:()=>bi,nextTick:()=>xn,off:()=>ts,on:()=>bt,once:()=>es,openStdin:()=>Li,pid:()=>$i,platform:()=>oi,ppid:()=>zi,prependListener:()=>ns,prependOnceListener:()=>os,reallyExit:()=>Ci,release:()=>vi,removeAllListeners:()=>is,removeListener:()=>rs,resourceUsage:()=>Ai,setSourceMapsEnabled:()=>Yi,setUncaughtExceptionCaptureCallback:()=>Oi,stderr:()=>ji,stdin:()=>Hi,stdout:()=>Ni,title:()=>si,umask:()=>pi,uptime:()=>Nn,version:()=>ci,versions:()=>ui});function ks(i){throw new Error("Node.js process "+i+" is not supported by JSPM core outside of Node.js")}function ja(){!Jt||!Gt||(Jt=!1,Gt.length?gt=Gt.concat(gt):gr=-1,gt.length&&In())}function In(){if(!Jt){var i=setTimeout(ja,0);Jt=!0;for(var c=gt.length;c;){for(Gt=gt,gt=[];++gr<c;)Gt&&Gt[gr].run();gr=-1,c=gt.length}Gt=null,Jt=!1,clearTimeout(i)}}function xn(i){var c=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)c[s-1]=arguments[s];gt.push(new Bn(i,c)),gt.length===1&&!Jt&&setTimeout(In,0)}function Bn(i,c){this.fun=i,this.array=c}function Qe(){}function On(i){ks("_linkedBinding")}function Pn(i){ks("dlopen")}function Dn(){return[]}function Mn(){return[]}function Un(i,c){if(!i)throw new Error(c||"assertion error")}function Fn(){return!1}function Nn(){return Ct.now()/1e3}function Ar(i){var c=Math.floor((Date.now()-Ct.now())*.001),s=Ct.now()*.001,m=Math.floor(s)+c,w=Math.floor(s%1*1e9);return i&&(m=m-i[0],w=w-i[1],w<0&&(m--,w+=kr)),[m,w]}function bt(){return Rs}function jn(i){return[]}var gt,Jt,Gt,gr,si,ni,oi,ai,li,hi,ci,ui,di,fi,pi,_i,gi,vi,mi,bi,yi,wi,Si,Ci,Ei,fr,Ai,ki,Ri,Ti,Li,Ii,xi,Bi,Oi,Pi,Di,Mi,Ui,Fi,Ni,ji,Hi,Wi,$i,zi,qi,Vi,Ki,Gi,Yi,Ct,zr,kr,Ji,Xi,Qi,Zi,es,ts,rs,is,ss,ns,os,Rs,Ha=Je(()=>{pe(),ge(),_e(),gt=[],Jt=!1,gr=-1,Bn.prototype.run=function(){this.fun.apply(null,this.array)},si="browser",ni="x64",oi="browser",ai={PATH:"/usr/bin",LANG:navigator.language+".UTF-8",PWD:"/",HOME:"/home",TMP:"/tmp"},li=["/usr/bin/node"],hi=[],ci="v16.8.0",ui={},di=function(i,c){console.warn((c?c+": ":"")+i)},fi=function(i){ks("binding")},pi=function(i){return 0},_i=function(){return"/"},gi=function(i){},vi={name:"node",sourceUrl:"",headersUrl:"",libUrl:""},mi=Qe,bi=[],yi={},wi=!1,Si={},Ci=Qe,Ei=Qe,fr=function(){return{}},Ai=fr,ki=fr,Ri=Qe,Ti=Qe,Li=Qe,Ii={},xi={inspector:!1,debug:!1,uv:!1,ipv6:!1,tls_alpn:!1,tls_sni:!1,tls_ocsp:!1,tls:!1,cached_builtins:!0},Bi=Qe,Oi=Qe,Pi=Qe,Di=Qe,Mi=Qe,Ui=Qe,Fi=Qe,Ni=void 0,ji=void 0,Hi=void 0,Wi=Qe,$i=2,zi=1,qi="/bin/usr/node",Vi=9229,Ki="node",Gi=[],Yi=Qe,Ct={now:typeof performance<"u"?performance.now.bind(performance):void 0,timing:typeof performance<"u"?performance.timing:void 0},Ct.now===void 0&&(zr=Date.now(),Ct.timing&&Ct.timing.navigationStart&&(zr=Ct.timing.navigationStart),Ct.now=()=>Date.now()-zr),kr=1e9,Ar.bigint=function(i){var c=Ar(i);return typeof BigInt>"u"?c[0]*kr+c[1]:BigInt(c[0]*kr)+BigInt(c[1])},Ji=10,Xi={},Qi=0,Zi=bt,es=bt,ts=bt,rs=bt,is=bt,ss=Qe,ns=bt,os=bt,Rs={version:ci,versions:ui,arch:ni,platform:oi,release:vi,_rawDebug:mi,moduleLoadList:bi,binding:fi,_linkedBinding:On,_events:Xi,_eventsCount:Qi,_maxListeners:Ji,on:bt,addListener:Zi,once:es,off:ts,removeListener:rs,removeAllListeners:is,emit:ss,prependListener:ns,prependOnceListener:os,listeners:jn,domain:yi,_exiting:wi,config:Si,dlopen:Pn,uptime:Nn,_getActiveRequests:Dn,_getActiveHandles:Mn,reallyExit:Ci,_kill:Ei,cpuUsage:fr,resourceUsage:Ai,memoryUsage:ki,kill:Ri,exit:Ti,openStdin:Li,allowedNodeEnvironmentFlags:Ii,assert:Un,features:xi,_fatalExceptions:Bi,setUncaughtExceptionCaptureCallback:Oi,hasUncaughtExceptionCaptureCallback:Fn,emitWarning:di,nextTick:xn,_tickCallback:Pi,_debugProcess:Di,_debugEnd:Mi,_startProfilerIdleNotifier:Ui,_stopProfilerIdleNotifier:Fi,stdout:Ni,stdin:Hi,stderr:ji,abort:Wi,umask:pi,chdir:gi,cwd:_i,env:ai,title:si,argv:li,execArgv:hi,pid:$i,ppid:zi,execPath:qi,debugPort:Vi,hrtime:Ar,argv0:Ki,_preload_modules:Gi,setSourceMapsEnabled:Yi}}),_e=Je(()=>{Ha()}),Ze={};Zt(Ze,{Buffer:()=>or,INSPECT_MAX_BYTES:()=>Hn,default:()=>yt,kMaxLength:()=>Wn});function Wa(){if(as)return sr;as=!0,sr.byteLength=e,sr.toByteArray=r,sr.fromByteArray=h;for(var i=[],c=[],s=typeof Uint8Array<"u"?Uint8Array:Array,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=0,d=m.length;w<d;++w)i[w]=m[w],c[m.charCodeAt(w)]=w;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63;function n(_){var v=_.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=_.indexOf("=");g===-1&&(g=v);var l=g===v?0:4-g%4;return[g,l]}function e(_){var v=n(_),g=v[0],l=v[1];return(g+l)*3/4-l}function t(_,v,g){return(v+g)*3/4-g}function r(_){var v,g=n(_),l=g[0],p=g[1],u=new s(t(_,l,p)),f=0,y=p>0?l-4:l,b;for(b=0;b<y;b+=4)v=c[_.charCodeAt(b)]<<18|c[_.charCodeAt(b+1)]<<12|c[_.charCodeAt(b+2)]<<6|c[_.charCodeAt(b+3)],u[f++]=v>>16&255,u[f++]=v>>8&255,u[f++]=v&255;return p===2&&(v=c[_.charCodeAt(b)]<<2|c[_.charCodeAt(b+1)]>>4,u[f++]=v&255),p===1&&(v=c[_.charCodeAt(b)]<<10|c[_.charCodeAt(b+1)]<<4|c[_.charCodeAt(b+2)]>>2,u[f++]=v>>8&255,u[f++]=v&255),u}function a(_){return i[_>>18&63]+i[_>>12&63]+i[_>>6&63]+i[_&63]}function o(_,v,g){for(var l,p=[],u=v;u<g;u+=3)l=(_[u]<<16&16711680)+(_[u+1]<<8&65280)+(_[u+2]&255),p.push(a(l));return p.join("")}function h(_){for(var v,g=_.length,l=g%3,p=[],u=16383,f=0,y=g-l;f<y;f+=u)p.push(o(_,f,f+u>y?y:f+u));return l===1?(v=_[g-1],p.push(i[v>>2]+i[v<<4&63]+"==")):l===2&&(v=(_[g-2]<<8)+_[g-1],p.push(i[v>>10]+i[v>>4&63]+i[v<<2&63]+"=")),p.join("")}return sr}function $a(){return ls?pr:(ls=!0,pr.read=function(i,c,s,m,w){var d,n,e=w*8-m-1,t=(1<<e)-1,r=t>>1,a=-7,o=s?w-1:0,h=s?-1:1,_=i[c+o];for(o+=h,d=_&(1<<-a)-1,_>>=-a,a+=e;a>0;d=d*256+i[c+o],o+=h,a-=8);for(n=d&(1<<-a)-1,d>>=-a,a+=m;a>0;n=n*256+i[c+o],o+=h,a-=8);if(d===0)d=1-r;else{if(d===t)return n?NaN:(_?-1:1)*(1/0);n=n+Math.pow(2,m),d=d-r}return(_?-1:1)*n*Math.pow(2,d-m)},pr.write=function(i,c,s,m,w,d){var n,e,t,r=d*8-w-1,a=(1<<r)-1,o=a>>1,h=w===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=m?0:d-1,v=m?1:-1,g=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(e=isNaN(c)?1:0,n=a):(n=Math.floor(Math.log(c)/Math.LN2),c*(t=Math.pow(2,-n))<1&&(n--,t*=2),n+o>=1?c+=h/t:c+=h*Math.pow(2,1-o),c*t>=2&&(n++,t/=2),n+o>=a?(e=0,n=a):n+o>=1?(e=(c*t-1)*Math.pow(2,w),n=n+o):(e=c*Math.pow(2,o-1)*Math.pow(2,w),n=0));w>=8;i[s+_]=e&255,_+=v,e/=256,w-=8);for(n=n<<w|e,r+=w;r>0;i[s+_]=n&255,_+=v,n/=256,r-=8);i[s+_-v]|=g*128},pr)}function za(){if(hs)return Ot;hs=!0;let i=Wa(),c=$a(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Ot.Buffer=n,Ot.SlowBuffer=p,Ot.INSPECT_MAX_BYTES=50;let m=2147483647;Ot.kMaxLength=m,n.TYPED_ARRAY_SUPPORT=w(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function w(){try{let E=new Uint8Array(1),S={foo:function(){return 42}};return Object.setPrototypeOf(S,Uint8Array.prototype),Object.setPrototypeOf(E,S),E.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}});function d(E){if(E>m)throw new RangeError('The value "'+E+'" is invalid for option "size"');let S=new Uint8Array(E);return Object.setPrototypeOf(S,n.prototype),S}function n(E,S,k){if(typeof E=="number"){if(typeof S=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return a(E)}return e(E,S,k)}n.poolSize=8192;function e(E,S,k){if(typeof E=="string")return o(E,S);if(ArrayBuffer.isView(E))return _(E);if(E==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E);if(oe(E,ArrayBuffer)||E&&oe(E.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(oe(E,SharedArrayBuffer)||E&&oe(E.buffer,SharedArrayBuffer)))return v(E,S,k);if(typeof E=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let j=E.valueOf&&E.valueOf();if(j!=null&&j!==E)return n.from(j,S,k);let $=g(E);if($)return $;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof E[Symbol.toPrimitive]=="function")return n.from(E[Symbol.toPrimitive]("string"),S,k);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E)}n.from=function(E,S,k){return e(E,S,k)},Object.setPrototypeOf(n.prototype,Uint8Array.prototype),Object.setPrototypeOf(n,Uint8Array);function t(E){if(typeof E!="number")throw new TypeError('"size" argument must be of type number');if(E<0)throw new RangeError('The value "'+E+'" is invalid for option "size"')}function r(E,S,k){return t(E),E<=0?d(E):S!==void 0?typeof k=="string"?d(E).fill(S,k):d(E).fill(S):d(E)}n.alloc=function(E,S,k){return r(E,S,k)};function a(E){return t(E),d(E<0?0:l(E)|0)}n.allocUnsafe=function(E){return a(E)},n.allocUnsafeSlow=function(E){return a(E)};function o(E,S){if((typeof S!="string"||S==="")&&(S="utf8"),!n.isEncoding(S))throw new TypeError("Unknown encoding: "+S);let k=u(E,S)|0,j=d(k),$=j.write(E,S);return $!==k&&(j=j.slice(0,$)),j}function h(E){let S=E.length<0?0:l(E.length)|0,k=d(S);for(let j=0;j<S;j+=1)k[j]=E[j]&255;return k}function _(E){if(oe(E,Uint8Array)){let S=new Uint8Array(E);return v(S.buffer,S.byteOffset,S.byteLength)}return h(E)}function v(E,S,k){if(S<0||E.byteLength<S)throw new RangeError('"offset" is outside of buffer bounds');if(E.byteLength<S+(k||0))throw new RangeError('"length" is outside of buffer bounds');let j;return S===void 0&&k===void 0?j=new Uint8Array(E):k===void 0?j=new Uint8Array(E,S):j=new Uint8Array(E,S,k),Object.setPrototypeOf(j,n.prototype),j}function g(E){if(n.isBuffer(E)){let S=l(E.length)|0,k=d(S);return k.length===0||E.copy(k,0,0,S),k}if(E.length!==void 0)return typeof E.length!="number"||be(E.length)?d(0):h(E);if(E.type==="Buffer"&&Array.isArray(E.data))return h(E.data)}function l(E){if(E>=m)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m.toString(16)+" bytes");return E|0}function p(E){return+E!=E&&(E=0),n.alloc(+E)}n.isBuffer=function(E){return E!=null&&E._isBuffer===!0&&E!==n.prototype},n.compare=function(E,S){if(oe(E,Uint8Array)&&(E=n.from(E,E.offset,E.byteLength)),oe(S,Uint8Array)&&(S=n.from(S,S.offset,S.byteLength)),!n.isBuffer(E)||!n.isBuffer(S))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(E===S)return 0;let k=E.length,j=S.length;for(let $=0,M=Math.min(k,j);$<M;++$)if(E[$]!==S[$]){k=E[$],j=S[$];break}return k<j?-1:j<k?1:0},n.isEncoding=function(E){switch(String(E).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(E,S){if(!Array.isArray(E))throw new TypeError('"list" argument must be an Array of Buffers');if(E.length===0)return n.alloc(0);let k;if(S===void 0)for(S=0,k=0;k<E.length;++k)S+=E[k].length;let j=n.allocUnsafe(S),$=0;for(k=0;k<E.length;++k){let M=E[k];if(oe(M,Uint8Array))$+M.length>j.length?(n.isBuffer(M)||(M=n.from(M)),M.copy(j,$)):Uint8Array.prototype.set.call(j,M,$);else if(n.isBuffer(M))M.copy(j,$);else throw new TypeError('"list" argument must be an Array of Buffers');$+=M.length}return j};function u(E,S){if(n.isBuffer(E))return E.length;if(ArrayBuffer.isView(E)||oe(E,ArrayBuffer))return E.byteLength;if(typeof E!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof E);let k=E.length,j=arguments.length>2&&arguments[2]===!0;if(!j&&k===0)return 0;let $=!1;for(;;)switch(S){case"ascii":case"latin1":case"binary":return k;case"utf8":case"utf-8":return ee(E).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k*2;case"hex":return k>>>1;case"base64":return ae(E).length;default:if($)return j?-1:ee(E).length;S=(""+S).toLowerCase(),$=!0}}n.byteLength=u;function f(E,S,k){let j=!1;if((S===void 0||S<0)&&(S=0),S>this.length||((k===void 0||k>this.length)&&(k=this.length),k<=0)||(k>>>=0,S>>>=0,k<=S))return"";for(E||(E="utf8");;)switch(E){case"hex":return x(this,S,k);case"utf8":case"utf-8":return P(this,S,k);case"ascii":return re(this,S,k);case"latin1":case"binary":return J(this,S,k);case"base64":return I(this,S,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,S,k);default:if(j)throw new TypeError("Unknown encoding: "+E);E=(E+"").toLowerCase(),j=!0}}n.prototype._isBuffer=!0;function y(E,S,k){let j=E[S];E[S]=E[k],E[k]=j}n.prototype.swap16=function(){let E=this.length;if(E%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let S=0;S<E;S+=2)y(this,S,S+1);return this},n.prototype.swap32=function(){let E=this.length;if(E%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let S=0;S<E;S+=4)y(this,S,S+3),y(this,S+1,S+2);return this},n.prototype.swap64=function(){let E=this.length;if(E%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let S=0;S<E;S+=8)y(this,S,S+7),y(this,S+1,S+6),y(this,S+2,S+5),y(this,S+3,S+4);return this},n.prototype.toString=function(){let E=this.length;return E===0?"":arguments.length===0?P(this,0,E):f.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(E){if(!n.isBuffer(E))throw new TypeError("Argument must be a Buffer");return this===E?!0:n.compare(this,E)===0},n.prototype.inspect=function(){let E="",S=Ot.INSPECT_MAX_BYTES;return E=this.toString("hex",0,S).replace(/(.{2})/g,"$1 ").trim(),this.length>S&&(E+=" ... "),"<Buffer "+E+">"},s&&(n.prototype[s]=n.prototype.inspect),n.prototype.compare=function(E,S,k,j,$){if(oe(E,Uint8Array)&&(E=n.from(E,E.offset,E.byteLength)),!n.isBuffer(E))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof E);if(S===void 0&&(S=0),k===void 0&&(k=E?E.length:0),j===void 0&&(j=0),$===void 0&&($=this.length),S<0||k>E.length||j<0||$>this.length)throw new RangeError("out of range index");if(j>=$&&S>=k)return 0;if(j>=$)return-1;if(S>=k)return 1;if(S>>>=0,k>>>=0,j>>>=0,$>>>=0,this===E)return 0;let M=$-j,H=k-S,ne=Math.min(M,H),ve=this.slice(j,$),fe=E.slice(S,k);for(let ye=0;ye<ne;++ye)if(ve[ye]!==fe[ye]){M=ve[ye],H=fe[ye];break}return M<H?-1:H<M?1:0};function b(E,S,k,j,$){if(E.length===0)return-1;if(typeof k=="string"?(j=k,k=0):k>2147483647?k=2147483647:k<-2147483648&&(k=-2147483648),k=+k,be(k)&&(k=$?0:E.length-1),k<0&&(k=E.length+k),k>=E.length){if($)return-1;k=E.length-1}else if(k<0)if($)k=0;else return-1;if(typeof S=="string"&&(S=n.from(S,j)),n.isBuffer(S))return S.length===0?-1:A(E,S,k,j,$);if(typeof S=="number")return S=S&255,typeof Uint8Array.prototype.indexOf=="function"?$?Uint8Array.prototype.indexOf.call(E,S,k):Uint8Array.prototype.lastIndexOf.call(E,S,k):A(E,[S],k,j,$);throw new TypeError("val must be string, number or Buffer")}function A(E,S,k,j,$){let M=1,H=E.length,ne=S.length;if(j!==void 0&&(j=String(j).toLowerCase(),j==="ucs2"||j==="ucs-2"||j==="utf16le"||j==="utf-16le")){if(E.length<2||S.length<2)return-1;M=2,H/=2,ne/=2,k/=2}function ve(ye,Ce){return M===1?ye[Ce]:ye.readUInt16BE(Ce*M)}let fe;if($){let ye=-1;for(fe=k;fe<H;fe++)if(ve(E,fe)===ve(S,ye===-1?0:fe-ye)){if(ye===-1&&(ye=fe),fe-ye+1===ne)return ye*M}else ye!==-1&&(fe-=fe-ye),ye=-1}else for(k+ne>H&&(k=H-ne),fe=k;fe>=0;fe--){let ye=!0;for(let Ce=0;Ce<ne;Ce++)if(ve(E,fe+Ce)!==ve(S,Ce)){ye=!1;break}if(ye)return fe}return-1}n.prototype.includes=function(E,S,k){return this.indexOf(E,S,k)!==-1},n.prototype.indexOf=function(E,S,k){return b(this,E,S,k,!0)},n.prototype.lastIndexOf=function(E,S,k){return b(this,E,S,k,!1)};function R(E,S,k,j){k=Number(k)||0;let $=E.length-k;j?(j=Number(j),j>$&&(j=$)):j=$;let M=S.length;j>M/2&&(j=M/2);let H;for(H=0;H<j;++H){let ne=parseInt(S.substr(H*2,2),16);if(be(ne))return H;E[k+H]=ne}return H}function C(E,S,k,j){return Q(ee(S,E.length-k),E,k,j)}function L(E,S,k,j){return Q(Y(S),E,k,j)}function O(E,S,k,j){return Q(ae(S),E,k,j)}function N(E,S,k,j){return Q(de(S,E.length-k),E,k,j)}n.prototype.write=function(E,S,k,j){if(S===void 0)j="utf8",k=this.length,S=0;else if(k===void 0&&typeof S=="string")j=S,k=this.length,S=0;else if(isFinite(S))S=S>>>0,isFinite(k)?(k=k>>>0,j===void 0&&(j="utf8")):(j=k,k=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let $=this.length-S;if((k===void 0||k>$)&&(k=$),E.length>0&&(k<0||S<0)||S>this.length)throw new RangeError("Attempt to write outside buffer bounds");j||(j="utf8");let M=!1;for(;;)switch(j){case"hex":return R(this,E,S,k);case"utf8":case"utf-8":return C(this,E,S,k);case"ascii":case"latin1":case"binary":return L(this,E,S,k);case"base64":return O(this,E,S,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,E,S,k);default:if(M)throw new TypeError("Unknown encoding: "+j);j=(""+j).toLowerCase(),M=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(E,S,k){return S===0&&k===E.length?i.fromByteArray(E):i.fromByteArray(E.slice(S,k))}function P(E,S,k){k=Math.min(E.length,k);let j=[],$=S;for(;$<k;){let M=E[$],H=null,ne=M>239?4:M>223?3:M>191?2:1;if($+ne<=k){let ve,fe,ye,Ce;switch(ne){case 1:M<128&&(H=M);break;case 2:ve=E[$+1],(ve&192)===128&&(Ce=(M&31)<<6|ve&63,Ce>127&&(H=Ce));break;case 3:ve=E[$+1],fe=E[$+2],(ve&192)===128&&(fe&192)===128&&(Ce=(M&15)<<12|(ve&63)<<6|fe&63,Ce>2047&&(Ce<55296||Ce>57343)&&(H=Ce));break;case 4:ve=E[$+1],fe=E[$+2],ye=E[$+3],(ve&192)===128&&(fe&192)===128&&(ye&192)===128&&(Ce=(M&15)<<18|(ve&63)<<12|(fe&63)<<6|ye&63,Ce>65535&&Ce<1114112&&(H=Ce))}}H===null?(H=65533,ne=1):H>65535&&(H-=65536,j.push(H>>>10&1023|55296),H=56320|H&1023),j.push(H),$+=ne}return G(j)}let V=4096;function G(E){let S=E.length;if(S<=V)return String.fromCharCode.apply(String,E);let k="",j=0;for(;j<S;)k+=String.fromCharCode.apply(String,E.slice(j,j+=V));return k}function re(E,S,k){let j="";k=Math.min(E.length,k);for(let $=S;$<k;++$)j+=String.fromCharCode(E[$]&127);return j}function J(E,S,k){let j="";k=Math.min(E.length,k);for(let $=S;$<k;++$)j+=String.fromCharCode(E[$]);return j}function x(E,S,k){let j=E.length;(!S||S<0)&&(S=0),(!k||k<0||k>j)&&(k=j);let $="";for(let M=S;M<k;++M)$+=Se[E[M]];return $}function U(E,S,k){let j=E.slice(S,k),$="";for(let M=0;M<j.length-1;M+=2)$+=String.fromCharCode(j[M]+j[M+1]*256);return $}n.prototype.slice=function(E,S){let k=this.length;E=~~E,S=S===void 0?k:~~S,E<0?(E+=k,E<0&&(E=0)):E>k&&(E=k),S<0?(S+=k,S<0&&(S=0)):S>k&&(S=k),S<E&&(S=E);let j=this.subarray(E,S);return Object.setPrototypeOf(j,n.prototype),j};function F(E,S,k){if(E%1!==0||E<0)throw new RangeError("offset is not uint");if(E+S>k)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUintLE=n.prototype.readUIntLE=function(E,S,k){E=E>>>0,S=S>>>0,k||F(E,S,this.length);let j=this[E],$=1,M=0;for(;++M<S&&($*=256);)j+=this[E+M]*$;return j},n.prototype.readUintBE=n.prototype.readUIntBE=function(E,S,k){E=E>>>0,S=S>>>0,k||F(E,S,this.length);let j=this[E+--S],$=1;for(;S>0&&($*=256);)j+=this[E+--S]*$;return j},n.prototype.readUint8=n.prototype.readUInt8=function(E,S){return E=E>>>0,S||F(E,1,this.length),this[E]},n.prototype.readUint16LE=n.prototype.readUInt16LE=function(E,S){return E=E>>>0,S||F(E,2,this.length),this[E]|this[E+1]<<8},n.prototype.readUint16BE=n.prototype.readUInt16BE=function(E,S){return E=E>>>0,S||F(E,2,this.length),this[E]<<8|this[E+1]},n.prototype.readUint32LE=n.prototype.readUInt32LE=function(E,S){return E=E>>>0,S||F(E,4,this.length),(this[E]|this[E+1]<<8|this[E+2]<<16)+this[E+3]*16777216},n.prototype.readUint32BE=n.prototype.readUInt32BE=function(E,S){return E=E>>>0,S||F(E,4,this.length),this[E]*16777216+(this[E+1]<<16|this[E+2]<<8|this[E+3])},n.prototype.readBigUInt64LE=Ee(function(E){E=E>>>0,te(E,"offset");let S=this[E],k=this[E+7];(S===void 0||k===void 0)&&le(E,this.length-8);let j=S+this[++E]*2**8+this[++E]*2**16+this[++E]*2**24,$=this[++E]+this[++E]*2**8+this[++E]*2**16+k*2**24;return BigInt(j)+(BigInt($)<<BigInt(32))}),n.prototype.readBigUInt64BE=Ee(function(E){E=E>>>0,te(E,"offset");let S=this[E],k=this[E+7];(S===void 0||k===void 0)&&le(E,this.length-8);let j=S*2**24+this[++E]*2**16+this[++E]*2**8+this[++E],$=this[++E]*2**24+this[++E]*2**16+this[++E]*2**8+k;return(BigInt(j)<<BigInt(32))+BigInt($)}),n.prototype.readIntLE=function(E,S,k){E=E>>>0,S=S>>>0,k||F(E,S,this.length);let j=this[E],$=1,M=0;for(;++M<S&&($*=256);)j+=this[E+M]*$;return $*=128,j>=$&&(j-=Math.pow(2,8*S)),j},n.prototype.readIntBE=function(E,S,k){E=E>>>0,S=S>>>0,k||F(E,S,this.length);let j=S,$=1,M=this[E+--j];for(;j>0&&($*=256);)M+=this[E+--j]*$;return $*=128,M>=$&&(M-=Math.pow(2,8*S)),M},n.prototype.readInt8=function(E,S){return E=E>>>0,S||F(E,1,this.length),this[E]&128?(255-this[E]+1)*-1:this[E]},n.prototype.readInt16LE=function(E,S){E=E>>>0,S||F(E,2,this.length);let k=this[E]|this[E+1]<<8;return k&32768?k|4294901760:k},n.prototype.readInt16BE=function(E,S){E=E>>>0,S||F(E,2,this.length);let k=this[E+1]|this[E]<<8;return k&32768?k|4294901760:k},n.prototype.readInt32LE=function(E,S){return E=E>>>0,S||F(E,4,this.length),this[E]|this[E+1]<<8|this[E+2]<<16|this[E+3]<<24},n.prototype.readInt32BE=function(E,S){return E=E>>>0,S||F(E,4,this.length),this[E]<<24|this[E+1]<<16|this[E+2]<<8|this[E+3]},n.prototype.readBigInt64LE=Ee(function(E){E=E>>>0,te(E,"offset");let S=this[E],k=this[E+7];(S===void 0||k===void 0)&&le(E,this.length-8);let j=this[E+4]+this[E+5]*2**8+this[E+6]*2**16+(k<<24);return(BigInt(j)<<BigInt(32))+BigInt(S+this[++E]*2**8+this[++E]*2**16+this[++E]*2**24)}),n.prototype.readBigInt64BE=Ee(function(E){E=E>>>0,te(E,"offset");let S=this[E],k=this[E+7];(S===void 0||k===void 0)&&le(E,this.length-8);let j=(S<<24)+this[++E]*2**16+this[++E]*2**8+this[++E];return(BigInt(j)<<BigInt(32))+BigInt(this[++E]*2**24+this[++E]*2**16+this[++E]*2**8+k)}),n.prototype.readFloatLE=function(E,S){return E=E>>>0,S||F(E,4,this.length),c.read(this,E,!0,23,4)},n.prototype.readFloatBE=function(E,S){return E=E>>>0,S||F(E,4,this.length),c.read(this,E,!1,23,4)},n.prototype.readDoubleLE=function(E,S){return E=E>>>0,S||F(E,8,this.length),c.read(this,E,!0,52,8)},n.prototype.readDoubleBE=function(E,S){return E=E>>>0,S||F(E,8,this.length),c.read(this,E,!1,52,8)};function z(E,S,k,j,$,M){if(!n.isBuffer(E))throw new TypeError('"buffer" argument must be a Buffer instance');if(S>$||S<M)throw new RangeError('"value" argument is out of bounds');if(k+j>E.length)throw new RangeError("Index out of range")}n.prototype.writeUintLE=n.prototype.writeUIntLE=function(E,S,k,j){if(E=+E,S=S>>>0,k=k>>>0,!j){let H=Math.pow(2,8*k)-1;z(this,E,S,k,H,0)}let $=1,M=0;for(this[S]=E&255;++M<k&&($*=256);)this[S+M]=E/$&255;return S+k},n.prototype.writeUintBE=n.prototype.writeUIntBE=function(E,S,k,j){if(E=+E,S=S>>>0,k=k>>>0,!j){let H=Math.pow(2,8*k)-1;z(this,E,S,k,H,0)}let $=k-1,M=1;for(this[S+$]=E&255;--$>=0&&(M*=256);)this[S+$]=E/M&255;return S+k},n.prototype.writeUint8=n.prototype.writeUInt8=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,1,255,0),this[S]=E&255,S+1},n.prototype.writeUint16LE=n.prototype.writeUInt16LE=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,2,65535,0),this[S]=E&255,this[S+1]=E>>>8,S+2},n.prototype.writeUint16BE=n.prototype.writeUInt16BE=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,2,65535,0),this[S]=E>>>8,this[S+1]=E&255,S+2},n.prototype.writeUint32LE=n.prototype.writeUInt32LE=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,4,4294967295,0),this[S+3]=E>>>24,this[S+2]=E>>>16,this[S+1]=E>>>8,this[S]=E&255,S+4},n.prototype.writeUint32BE=n.prototype.writeUInt32BE=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,4,4294967295,0),this[S]=E>>>24,this[S+1]=E>>>16,this[S+2]=E>>>8,this[S+3]=E&255,S+4};function D(E,S,k,j,$){ie(S,j,$,E,k,7);let M=Number(S&BigInt(4294967295));E[k++]=M,M=M>>8,E[k++]=M,M=M>>8,E[k++]=M,M=M>>8,E[k++]=M;let H=Number(S>>BigInt(32)&BigInt(4294967295));return E[k++]=H,H=H>>8,E[k++]=H,H=H>>8,E[k++]=H,H=H>>8,E[k++]=H,k}function Z(E,S,k,j,$){ie(S,j,$,E,k,7);let M=Number(S&BigInt(4294967295));E[k+7]=M,M=M>>8,E[k+6]=M,M=M>>8,E[k+5]=M,M=M>>8,E[k+4]=M;let H=Number(S>>BigInt(32)&BigInt(4294967295));return E[k+3]=H,H=H>>8,E[k+2]=H,H=H>>8,E[k+1]=H,H=H>>8,E[k]=H,k+8}n.prototype.writeBigUInt64LE=Ee(function(E,S=0){return D(this,E,S,BigInt(0),BigInt("0xffffffffffffffff"))}),n.prototype.writeBigUInt64BE=Ee(function(E,S=0){return Z(this,E,S,BigInt(0),BigInt("0xffffffffffffffff"))}),n.prototype.writeIntLE=function(E,S,k,j){if(E=+E,S=S>>>0,!j){let ne=Math.pow(2,8*k-1);z(this,E,S,k,ne-1,-ne)}let $=0,M=1,H=0;for(this[S]=E&255;++$<k&&(M*=256);)E<0&&H===0&&this[S+$-1]!==0&&(H=1),this[S+$]=(E/M>>0)-H&255;return S+k},n.prototype.writeIntBE=function(E,S,k,j){if(E=+E,S=S>>>0,!j){let ne=Math.pow(2,8*k-1);z(this,E,S,k,ne-1,-ne)}let $=k-1,M=1,H=0;for(this[S+$]=E&255;--$>=0&&(M*=256);)E<0&&H===0&&this[S+$+1]!==0&&(H=1),this[S+$]=(E/M>>0)-H&255;return S+k},n.prototype.writeInt8=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,1,127,-128),E<0&&(E=255+E+1),this[S]=E&255,S+1},n.prototype.writeInt16LE=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,2,32767,-32768),this[S]=E&255,this[S+1]=E>>>8,S+2},n.prototype.writeInt16BE=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,2,32767,-32768),this[S]=E>>>8,this[S+1]=E&255,S+2},n.prototype.writeInt32LE=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,4,2147483647,-2147483648),this[S]=E&255,this[S+1]=E>>>8,this[S+2]=E>>>16,this[S+3]=E>>>24,S+4},n.prototype.writeInt32BE=function(E,S,k){return E=+E,S=S>>>0,k||z(this,E,S,4,2147483647,-2147483648),E<0&&(E=4294967295+E+1),this[S]=E>>>24,this[S+1]=E>>>16,this[S+2]=E>>>8,this[S+3]=E&255,S+4},n.prototype.writeBigInt64LE=Ee(function(E,S=0){return D(this,E,S,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),n.prototype.writeBigInt64BE=Ee(function(E,S=0){return Z(this,E,S,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function se(E,S,k,j,$,M){if(k+j>E.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("Index out of range")}function he(E,S,k,j,$){return S=+S,k=k>>>0,$||se(E,S,k,4),c.write(E,S,k,j,23,4),k+4}n.prototype.writeFloatLE=function(E,S,k){return he(this,E,S,!0,k)},n.prototype.writeFloatBE=function(E,S,k){return he(this,E,S,!1,k)};function ce(E,S,k,j,$){return S=+S,k=k>>>0,$||se(E,S,k,8),c.write(E,S,k,j,52,8),k+8}n.prototype.writeDoubleLE=function(E,S,k){return ce(this,E,S,!0,k)},n.prototype.writeDoubleBE=function(E,S,k){return ce(this,E,S,!1,k)},n.prototype.copy=function(E,S,k,j){if(!n.isBuffer(E))throw new TypeError("argument should be a Buffer");if(k||(k=0),!j&&j!==0&&(j=this.length),S>=E.length&&(S=E.length),S||(S=0),j>0&&j<k&&(j=k),j===k||E.length===0||this.length===0)return 0;if(S<0)throw new RangeError("targetStart out of bounds");if(k<0||k>=this.length)throw new RangeError("Index out of range");if(j<0)throw new RangeError("sourceEnd out of bounds");j>this.length&&(j=this.length),E.length-S<j-k&&(j=E.length-S+k);let $=j-k;return this===E&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(S,k,j):Uint8Array.prototype.set.call(E,this.subarray(k,j),S),$},n.prototype.fill=function(E,S,k,j){if(typeof E=="string"){if(typeof S=="string"?(j=S,S=0,k=this.length):typeof k=="string"&&(j=k,k=this.length),j!==void 0&&typeof j!="string")throw new TypeError("encoding must be a string");if(typeof j=="string"&&!n.isEncoding(j))throw new TypeError("Unknown encoding: "+j);if(E.length===1){let M=E.charCodeAt(0);(j==="utf8"&&M<128||j==="latin1")&&(E=M)}}else typeof E=="number"?E=E&255:typeof E=="boolean"&&(E=Number(E));if(S<0||this.length<S||this.length<k)throw new RangeError("Out of range index");if(k<=S)return this;S=S>>>0,k=k===void 0?this.length:k>>>0,E||(E=0);let $;if(typeof E=="number")for($=S;$<k;++$)this[$]=E;else{let M=n.isBuffer(E)?E:n.from(E,j),H=M.length;if(H===0)throw new TypeError('The value "'+E+'" is invalid for argument "value"');for($=0;$<k-S;++$)this[$+S]=M[$%H]}return this};let T={};function B(E,S,k){T[E]=class extends k{constructor(){super(),Object.defineProperty(this,"message",{value:S.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${E}]`,this.stack,delete this.name}get code(){return E}set code(j){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:j,writable:!0})}toString(){return`${this.name} [${E}]: ${this.message}`}}}B("ERR_BUFFER_OUT_OF_BOUNDS",function(E){return E?`${E} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),B("ERR_INVALID_ARG_TYPE",function(E,S){return`The "${E}" argument must be of type number. Received type ${typeof S}`},TypeError),B("ERR_OUT_OF_RANGE",function(E,S,k){let j=`The value of "${E}" is out of range.`,$=k;return Number.isInteger(k)&&Math.abs(k)>2**32?$=q(String(k)):typeof k=="bigint"&&($=String(k),(k>BigInt(2)**BigInt(32)||k<-(BigInt(2)**BigInt(32)))&&($=q($)),$+="n"),j+=` It must be ${S}. Received ${$}`,j},RangeError);function q(E){let S="",k=E.length,j=E[0]==="-"?1:0;for(;k>=j+4;k-=3)S=`_${E.slice(k-3,k)}${S}`;return`${E.slice(0,k)}${S}`}function X(E,S,k){te(S,"offset"),(E[S]===void 0||E[S+k]===void 0)&&le(S,E.length-(k+1))}function ie(E,S,k,j,$,M){if(E>k||E<S){let H=typeof S=="bigint"?"n":"",ne;throw M>3?S===0||S===BigInt(0)?ne=`>= 0${H} and < 2${H} ** ${(M+1)*8}${H}`:ne=`>= -(2${H} ** ${(M+1)*8-1}${H}) and < 2 ** ${(M+1)*8-1}${H}`:ne=`>= ${S}${H} and <= ${k}${H}`,new T.ERR_OUT_OF_RANGE("value",ne,E)}X(j,$,M)}function te(E,S){if(typeof E!="number")throw new T.ERR_INVALID_ARG_TYPE(S,"number",E)}function le(E,S,k){throw Math.floor(E)!==E?(te(E,k),new T.ERR_OUT_OF_RANGE(k||"offset","an integer",E)):S<0?new T.ERR_BUFFER_OUT_OF_BOUNDS:new T.ERR_OUT_OF_RANGE(k||"offset",`>= ${k?1:0} and <= ${S}`,E)}let ue=/[^+/0-9A-Za-z-_]/g;function W(E){if(E=E.split("=")[0],E=E.trim().replace(ue,""),E.length<2)return"";for(;E.length%4!==0;)E=E+"=";return E}function ee(E,S){S=S||1/0;let k,j=E.length,$=null,M=[];for(let H=0;H<j;++H){if(k=E.charCodeAt(H),k>55295&&k<57344){if(!$){if(k>56319){(S-=3)>-1&&M.push(239,191,189);continue}else if(H+1===j){(S-=3)>-1&&M.push(239,191,189);continue}$=k;continue}if(k<56320){(S-=3)>-1&&M.push(239,191,189),$=k;continue}k=($-55296<<10|k-56320)+65536}else $&&(S-=3)>-1&&M.push(239,191,189);if($=null,k<128){if((S-=1)<0)break;M.push(k)}else if(k<2048){if((S-=2)<0)break;M.push(k>>6|192,k&63|128)}else if(k<65536){if((S-=3)<0)break;M.push(k>>12|224,k>>6&63|128,k&63|128)}else if(k<1114112){if((S-=4)<0)break;M.push(k>>18|240,k>>12&63|128,k>>6&63|128,k&63|128)}else throw new Error("Invalid code point")}return M}function Y(E){let S=[];for(let k=0;k<E.length;++k)S.push(E.charCodeAt(k)&255);return S}function de(E,S){let k,j,$,M=[];for(let H=0;H<E.length&&!((S-=2)<0);++H)k=E.charCodeAt(H),j=k>>8,$=k%256,M.push($),M.push(j);return M}function ae(E){return i.toByteArray(W(E))}function Q(E,S,k,j){let $;for($=0;$<j&&!($+k>=S.length||$>=E.length);++$)S[$+k]=E[$];return $}function oe(E,S){return E instanceof S||E!=null&&E.constructor!=null&&E.constructor.name!=null&&E.constructor.name===S.name}function be(E){return E!==E}let Se=function(){let E="0123456789abcdef",S=new Array(256);for(let k=0;k<16;++k){let j=k*16;for(let $=0;$<16;++$)S[j+$]=E[k]+E[$]}return S}();function Ee(E){return typeof BigInt>"u"?Te:E}function Te(){throw new Error("BigInt not supported")}return Ot}var sr,as,pr,ls,Ot,hs,yt,or,Hn,Wn,et=Je(()=>{pe(),ge(),_e(),sr={},as=!1,pr={},ls=!1,Ot={},hs=!1,yt=za(),yt.Buffer,yt.SlowBuffer,yt.INSPECT_MAX_BYTES,yt.kMaxLength,or=yt.Buffer,Hn=yt.INSPECT_MAX_BYTES,Wn=yt.kMaxLength}),ge=Je(()=>{et()}),qa=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=class{constructor(s){this.aliasToTopic={},this.max=s}put(s,m){return m===0||m>this.max?!1:(this.aliasToTopic[m]=s,this.length=Object.keys(this.aliasToTopic).length,!0)}getTopicByAlias(s){return this.aliasToTopic[s]}clear(){this.aliasToTopic={}}};i.default=c}),Ke=we((i,c)=>{pe(),ge(),_e(),c.exports={ArrayIsArray(s){return Array.isArray(s)},ArrayPrototypeIncludes(s,m){return s.includes(m)},ArrayPrototypeIndexOf(s,m){return s.indexOf(m)},ArrayPrototypeJoin(s,m){return s.join(m)},ArrayPrototypeMap(s,m){return s.map(m)},ArrayPrototypePop(s,m){return s.pop(m)},ArrayPrototypePush(s,m){return s.push(m)},ArrayPrototypeSlice(s,m,w){return s.slice(m,w)},Error,FunctionPrototypeCall(s,m,...w){return s.call(m,...w)},FunctionPrototypeSymbolHasInstance(s,m){return Function.prototype[Symbol.hasInstance].call(s,m)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(s,m){return Object.defineProperties(s,m)},ObjectDefineProperty(s,m,w){return Object.defineProperty(s,m,w)},ObjectGetOwnPropertyDescriptor(s,m){return Object.getOwnPropertyDescriptor(s,m)},ObjectKeys(s){return Object.keys(s)},ObjectSetPrototypeOf(s,m){return Object.setPrototypeOf(s,m)},Promise,PromisePrototypeCatch(s,m){return s.catch(m)},PromisePrototypeThen(s,m,w){return s.then(m,w)},PromiseReject(s){return Promise.reject(s)},ReflectApply:Reflect.apply,RegExpPrototypeTest(s,m){return s.test(m)},SafeSet:Set,String,StringPrototypeSlice(s,m,w){return s.slice(m,w)},StringPrototypeToLowerCase(s){return s.toLowerCase()},StringPrototypeToUpperCase(s){return s.toUpperCase()},StringPrototypeTrim(s){return s.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(s,m,w){return s.set(m,w)},Uint8Array}}),kt=we((i,c)=>{pe(),ge(),_e();var s=(et(),Pe(Ze)),m=Object.getPrototypeOf(async function(){}).constructor,w=globalThis.Blob||s.Blob,d=typeof w<"u"?function(e){return e instanceof w}:function(e){return!1},n=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);let t="";for(let r=0;r<e.length;r++)t+=`    ${e[r].stack}
`;super(t),this.name="AggregateError",this.errors=e}};c.exports={AggregateError:n,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...r){t||(t=!0,e.apply(this,r))}},createDeferredPromise:function(){let e,t;return{promise:new Promise((r,a)=>{e=r,t=a}),resolve:e,reject:t}},promisify(e){return new Promise((t,r)=>{e((a,...o)=>a?r(a):t(...o))})},debuglog(){return function(){}},format(e,...t){return e.replace(/%([sdifj])/g,function(...[r,a]){let o=t.shift();return a==="f"?o.toFixed(6):a==="j"?JSON.stringify(o):a==="s"&&typeof o=="object"?`${o.constructor!==Object?o.constructor.name:""} {}`.trim():o.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction(e){return e instanceof m},isArrayBufferView(e){return ArrayBuffer.isView(e)}},isBlob:d},c.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}),Ts=we((i,c)=>{pe(),ge(),_e();var{AbortController:s,AbortSignal:m}=typeof self<"u"?self:typeof window<"u"?window:void 0;c.exports=s,c.exports.AbortSignal=m,c.exports.default=s}),nt=we((i,c)=>{pe(),ge(),_e();var{format:s,inspect:m,AggregateError:w}=kt(),d=globalThis.AggregateError||w,n=Symbol("kIsNodeError"),e=["string","function","number","object","Function","Object","boolean","bigint","symbol"],t=/^([A-Z][a-z0-9]*)+$/,r="__node_internal_",a={};function o(u,f){if(!u)throw new a.ERR_INTERNAL_ASSERTION(f)}function h(u){let f="",y=u.length,b=u[0]==="-"?1:0;for(;y>=b+4;y-=3)f=`_${u.slice(y-3,y)}${f}`;return`${u.slice(0,y)}${f}`}function _(u,f,y){if(typeof f=="function")return o(f.length<=y.length,`Code: ${u}; The provided arguments length (${y.length}) does not match the required ones (${f.length}).`),f(...y);let b=(f.match(/%[dfijoOs]/g)||[]).length;return o(b===y.length,`Code: ${u}; The provided arguments length (${y.length}) does not match the required ones (${b}).`),y.length===0?f:s(f,...y)}function v(u,f,y){y||(y=Error);class b extends y{constructor(...R){super(_(u,f,R))}toString(){return`${this.name} [${u}]: ${this.message}`}}Object.defineProperties(b.prototype,{name:{value:y.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${u}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),b.prototype.code=u,b.prototype[n]=!0,a[u]=b}function g(u){let f=r+u.name;return Object.defineProperty(u,"name",{value:f}),u}function l(u,f){if(u&&f&&u!==f){if(Array.isArray(f.errors))return f.errors.push(u),f;let y=new d([f,u],f.message);return y.code=f.code,y}return u||f}var p=class extends Error{constructor(u="The operation was aborted",f=void 0){if(f!==void 0&&typeof f!="object")throw new a.ERR_INVALID_ARG_TYPE("options","Object",f);super(u,f),this.code="ABORT_ERR",this.name="AbortError"}};v("ERR_ASSERTION","%s",Error),v("ERR_INVALID_ARG_TYPE",(u,f,y)=>{o(typeof u=="string","'name' must be a string"),Array.isArray(f)||(f=[f]);let b="The ";u.endsWith(" argument")?b+=`${u} `:b+=`"${u}" ${u.includes(".")?"property":"argument"} `,b+="must be ";let A=[],R=[],C=[];for(let O of f)o(typeof O=="string","All expected entries have to be of type string"),e.includes(O)?A.push(O.toLowerCase()):t.test(O)?R.push(O):(o(O!=="object",'The value "object" should be written as "Object"'),C.push(O));if(R.length>0){let O=A.indexOf("object");O!==-1&&(A.splice(A,O,1),R.push("Object"))}if(A.length>0){switch(A.length){case 1:b+=`of type ${A[0]}`;break;case 2:b+=`one of type ${A[0]} or ${A[1]}`;break;default:{let O=A.pop();b+=`one of type ${A.join(", ")}, or ${O}`}}(R.length>0||C.length>0)&&(b+=" or ")}if(R.length>0){switch(R.length){case 1:b+=`an instance of ${R[0]}`;break;case 2:b+=`an instance of ${R[0]} or ${R[1]}`;break;default:{let O=R.pop();b+=`an instance of ${R.join(", ")}, or ${O}`}}C.length>0&&(b+=" or ")}switch(C.length){case 0:break;case 1:C[0].toLowerCase()!==C[0]&&(b+="an "),b+=`${C[0]}`;break;case 2:b+=`one of ${C[0]} or ${C[1]}`;break;default:{let O=C.pop();b+=`one of ${C.join(", ")}, or ${O}`}}if(y==null)b+=`. Received ${y}`;else if(typeof y=="function"&&y.name)b+=`. Received function ${y.name}`;else if(typeof y=="object"){var L;if((L=y.constructor)!==null&&L!==void 0&&L.name)b+=`. Received an instance of ${y.constructor.name}`;else{let O=m(y,{depth:-1});b+=`. Received ${O}`}}else{let O=m(y,{colors:!1});O.length>25&&(O=`${O.slice(0,25)}...`),b+=`. Received type ${typeof y} (${O})`}return b},TypeError),v("ERR_INVALID_ARG_VALUE",(u,f,y="is invalid")=>{let b=m(f);return b.length>128&&(b=b.slice(0,128)+"..."),`The ${u.includes(".")?"property":"argument"} '${u}' ${y}. Received ${b}`},TypeError),v("ERR_INVALID_RETURN_VALUE",(u,f,y)=>{var b;let A=y!=null&&(b=y.constructor)!==null&&b!==void 0&&b.name?`instance of ${y.constructor.name}`:`type ${typeof y}`;return`Expected ${u} to be returned from the "${f}" function but got ${A}.`},TypeError),v("ERR_MISSING_ARGS",(...u)=>{o(u.length>0,"At least one arg needs to be specified");let f,y=u.length;switch(u=(Array.isArray(u)?u:[u]).map(b=>`"${b}"`).join(" or "),y){case 1:f+=`The ${u[0]} argument`;break;case 2:f+=`The ${u[0]} and ${u[1]} arguments`;break;default:{let b=u.pop();f+=`The ${u.join(", ")}, and ${b} arguments`}break}return`${f} must be specified`},TypeError),v("ERR_OUT_OF_RANGE",(u,f,y)=>{o(f,'Missing "range" argument');let b;return Number.isInteger(y)&&Math.abs(y)>2**32?b=h(String(y)):typeof y=="bigint"?(b=String(y),(y>2n**32n||y<-(2n**32n))&&(b=h(b)),b+="n"):b=m(y),`The value of "${u}" is out of range. It must be ${f}. Received ${b}`},RangeError),v("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),v("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),v("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),v("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),v("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),v("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),v("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),v("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),v("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),v("ERR_STREAM_WRITE_AFTER_END","write after end",Error),v("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),c.exports={AbortError:p,aggregateTwoErrors:g(l),hideStackFrames:g,codes:a}}),Ur=we((i,c)=>{pe(),ge(),_e();var{ArrayIsArray:s,ArrayPrototypeIncludes:m,ArrayPrototypeJoin:w,ArrayPrototypeMap:d,NumberIsInteger:n,NumberIsNaN:e,NumberMAX_SAFE_INTEGER:t,NumberMIN_SAFE_INTEGER:r,NumberParseInt:a,ObjectPrototypeHasOwnProperty:o,RegExpPrototypeExec:h,String:_,StringPrototypeToUpperCase:v,StringPrototypeTrim:g}=Ke(),{hideStackFrames:l,codes:{ERR_SOCKET_BAD_PORT:p,ERR_INVALID_ARG_TYPE:u,ERR_INVALID_ARG_VALUE:f,ERR_OUT_OF_RANGE:y,ERR_UNKNOWN_SIGNAL:b}}=nt(),{normalizeEncoding:A}=kt(),{isAsyncFunction:R,isArrayBufferView:C}=kt().types,L={};function O(Q){return Q===(Q|0)}function N(Q){return Q===Q>>>0}var I=/^[0-7]+$/,P="must be a 32-bit unsigned integer or an octal string";function V(Q,oe,be){if(typeof Q>"u"&&(Q=be),typeof Q=="string"){if(h(I,Q)===null)throw new f(oe,Q,P);Q=a(Q,8)}return J(Q,oe),Q}var G=l((Q,oe,be=r,Se=t)=>{if(typeof Q!="number")throw new u(oe,"number",Q);if(!n(Q))throw new y(oe,"an integer",Q);if(Q<be||Q>Se)throw new y(oe,`>= ${be} && <= ${Se}`,Q)}),re=l((Q,oe,be=-2147483648,Se=2147483647)=>{if(typeof Q!="number")throw new u(oe,"number",Q);if(!n(Q))throw new y(oe,"an integer",Q);if(Q<be||Q>Se)throw new y(oe,`>= ${be} && <= ${Se}`,Q)}),J=l((Q,oe,be=!1)=>{if(typeof Q!="number")throw new u(oe,"number",Q);if(!n(Q))throw new y(oe,"an integer",Q);let Se=be?1:0,Ee=4294967295;if(Q<Se||Q>Ee)throw new y(oe,`>= ${Se} && <= ${Ee}`,Q)});function x(Q,oe){if(typeof Q!="string")throw new u(oe,"string",Q)}function U(Q,oe,be=void 0,Se){if(typeof Q!="number")throw new u(oe,"number",Q);if(be!=null&&Q<be||Se!=null&&Q>Se||(be!=null||Se!=null)&&e(Q))throw new y(oe,`${be!=null?`>= ${be}`:""}${be!=null&&Se!=null?" && ":""}${Se!=null?`<= ${Se}`:""}`,Q)}var F=l((Q,oe,be)=>{if(!m(be,Q)){let Se="must be one of: "+w(d(be,Ee=>typeof Ee=="string"?`'${Ee}'`:_(Ee)),", ");throw new f(oe,Q,Se)}});function z(Q,oe){if(typeof Q!="boolean")throw new u(oe,"boolean",Q)}function D(Q,oe,be){return Q==null||!o(Q,oe)?be:Q[oe]}var Z=l((Q,oe,be=null)=>{let Se=D(be,"allowArray",!1),Ee=D(be,"allowFunction",!1);if(!D(be,"nullable",!1)&&Q===null||!Se&&s(Q)||typeof Q!="object"&&(!Ee||typeof Q!="function"))throw new u(oe,"Object",Q)}),se=l((Q,oe)=>{if(Q!=null&&typeof Q!="object"&&typeof Q!="function")throw new u(oe,"a dictionary",Q)}),he=l((Q,oe,be=0)=>{if(!s(Q))throw new u(oe,"Array",Q);if(Q.length<be){let Se=`must be longer than ${be}`;throw new f(oe,Q,Se)}});function ce(Q,oe){he(Q,oe);for(let be=0;be<Q.length;be++)x(Q[be],`${oe}[${be}]`)}function T(Q,oe){he(Q,oe);for(let be=0;be<Q.length;be++)z(Q[be],`${oe}[${be}]`)}function B(Q,oe="signal"){if(x(Q,oe),L[Q]===void 0)throw L[v(Q)]!==void 0?new b(Q+" (signals must use all capital letters)"):new b(Q)}var q=l((Q,oe="buffer")=>{if(!C(Q))throw new u(oe,["Buffer","TypedArray","DataView"],Q)});function X(Q,oe){let be=A(oe),Se=Q.length;if(be==="hex"&&Se%2!==0)throw new f("encoding",oe,`is invalid for data of length ${Se}`)}function ie(Q,oe="Port",be=!0){if(typeof Q!="number"&&typeof Q!="string"||typeof Q=="string"&&g(Q).length===0||+Q!==+Q>>>0||Q>65535||Q===0&&!be)throw new p(oe,Q,be);return Q|0}var te=l((Q,oe)=>{if(Q!==void 0&&(Q===null||typeof Q!="object"||!("aborted"in Q)))throw new u(oe,"AbortSignal",Q)}),le=l((Q,oe)=>{if(typeof Q!="function")throw new u(oe,"Function",Q)}),ue=l((Q,oe)=>{if(typeof Q!="function"||R(Q))throw new u(oe,"Function",Q)}),W=l((Q,oe)=>{if(Q!==void 0)throw new u(oe,"undefined",Q)});function ee(Q,oe,be){if(!m(be,Q))throw new u(oe,`('${w(be,"|")}')`,Q)}var Y=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function de(Q,oe){if(typeof Q>"u"||!h(Y,Q))throw new f(oe,Q,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ae(Q){if(typeof Q=="string")return de(Q,"hints"),Q;if(s(Q)){let oe=Q.length,be="";if(oe===0)return be;for(let Se=0;Se<oe;Se++){let Ee=Q[Se];de(Ee,"hints"),be+=Ee,Se!==oe-1&&(be+=", ")}return be}throw new f("hints",Q,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}c.exports={isInt32:O,isUint32:N,parseFileMode:V,validateArray:he,validateStringArray:ce,validateBooleanArray:T,validateBoolean:z,validateBuffer:q,validateDictionary:se,validateEncoding:X,validateFunction:le,validateInt32:re,validateInteger:G,validateNumber:U,validateObject:Z,validateOneOf:F,validatePlainFunction:ue,validatePort:ie,validateSignalName:B,validateString:x,validateUint32:J,validateUndefined:W,validateUnion:ee,validateAbortSignal:te,validateLinkHeaderValue:ae}}),er=we((i,c)=>{pe(),ge(),_e();var s=c.exports={},m,w;function d(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?m=setTimeout:m=d}catch{m=d}try{typeof clearTimeout=="function"?w=clearTimeout:w=n}catch{w=n}})();function e(p){if(m===setTimeout)return setTimeout(p,0);if((m===d||!m)&&setTimeout)return m=setTimeout,setTimeout(p,0);try{return m(p,0)}catch{try{return m.call(null,p,0)}catch{return m.call(this,p,0)}}}function t(p){if(w===clearTimeout)return clearTimeout(p);if((w===n||!w)&&clearTimeout)return w=clearTimeout,clearTimeout(p);try{return w(p)}catch{try{return w.call(null,p)}catch{return w.call(this,p)}}}var r=[],a=!1,o,h=-1;function _(){!a||!o||(a=!1,o.length?r=o.concat(r):h=-1,r.length&&v())}function v(){if(!a){var p=e(_);a=!0;for(var u=r.length;u;){for(o=r,r=[];++h<u;)o&&o[h].run();h=-1,u=r.length}o=null,a=!1,t(p)}}s.nextTick=function(p){var u=new Array(arguments.length-1);if(arguments.length>1)for(var f=1;f<arguments.length;f++)u[f-1]=arguments[f];r.push(new g(p,u)),r.length===1&&!a&&e(v)};function g(p,u){this.fun=p,this.array=u}g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={};function l(){}s.on=l,s.addListener=l,s.once=l,s.off=l,s.removeListener=l,s.removeAllListeners=l,s.emit=l,s.prependListener=l,s.prependOnceListener=l,s.listeners=function(p){return[]},s.binding=function(p){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(p){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}}),Lt=we((i,c)=>{pe(),ge(),_e();var{Symbol:s,SymbolAsyncIterator:m,SymbolIterator:w,SymbolFor:d}=Ke(),n=s("kDestroyed"),e=s("kIsErrored"),t=s("kIsReadable"),r=s("kIsDisturbed"),a=d("nodejs.webstream.isClosedPromise"),o=d("nodejs.webstream.controllerErrorFunction");function h(D,Z=!1){var se;return!!(D&&typeof D.pipe=="function"&&typeof D.on=="function"&&(!Z||typeof D.pause=="function"&&typeof D.resume=="function")&&(!D._writableState||((se=D._readableState)===null||se===void 0?void 0:se.readable)!==!1)&&(!D._writableState||D._readableState))}function _(D){var Z;return!!(D&&typeof D.write=="function"&&typeof D.on=="function"&&(!D._readableState||((Z=D._writableState)===null||Z===void 0?void 0:Z.writable)!==!1))}function v(D){return!!(D&&typeof D.pipe=="function"&&D._readableState&&typeof D.on=="function"&&typeof D.write=="function")}function g(D){return D&&(D._readableState||D._writableState||typeof D.write=="function"&&typeof D.on=="function"||typeof D.pipe=="function"&&typeof D.on=="function")}function l(D){return!!(D&&!g(D)&&typeof D.pipeThrough=="function"&&typeof D.getReader=="function"&&typeof D.cancel=="function")}function p(D){return!!(D&&!g(D)&&typeof D.getWriter=="function"&&typeof D.abort=="function")}function u(D){return!!(D&&!g(D)&&typeof D.readable=="object"&&typeof D.writable=="object")}function f(D){return l(D)||p(D)||u(D)}function y(D,Z){return D==null?!1:Z===!0?typeof D[m]=="function":Z===!1?typeof D[w]=="function":typeof D[m]=="function"||typeof D[w]=="function"}function b(D){if(!g(D))return null;let Z=D._writableState,se=D._readableState,he=Z||se;return!!(D.destroyed||D[n]||he!=null&&he.destroyed)}function A(D){if(!_(D))return null;if(D.writableEnded===!0)return!0;let Z=D._writableState;return Z!=null&&Z.errored?!1:typeof(Z==null?void 0:Z.ended)!="boolean"?null:Z.ended}function R(D,Z){if(!_(D))return null;if(D.writableFinished===!0)return!0;let se=D._writableState;return se!=null&&se.errored?!1:typeof(se==null?void 0:se.finished)!="boolean"?null:!!(se.finished||Z===!1&&se.ended===!0&&se.length===0)}function C(D){if(!h(D))return null;if(D.readableEnded===!0)return!0;let Z=D._readableState;return!Z||Z.errored?!1:typeof(Z==null?void 0:Z.ended)!="boolean"?null:Z.ended}function L(D,Z){if(!h(D))return null;let se=D._readableState;return se!=null&&se.errored?!1:typeof(se==null?void 0:se.endEmitted)!="boolean"?null:!!(se.endEmitted||Z===!1&&se.ended===!0&&se.length===0)}function O(D){return D&&D[t]!=null?D[t]:typeof(D==null?void 0:D.readable)!="boolean"?null:b(D)?!1:h(D)&&D.readable&&!L(D)}function N(D){return typeof(D==null?void 0:D.writable)!="boolean"?null:b(D)?!1:_(D)&&D.writable&&!A(D)}function I(D,Z){return g(D)?b(D)?!0:!((Z==null?void 0:Z.readable)!==!1&&O(D)||(Z==null?void 0:Z.writable)!==!1&&N(D)):null}function P(D){var Z,se;return g(D)?D.writableErrored?D.writableErrored:(Z=(se=D._writableState)===null||se===void 0?void 0:se.errored)!==null&&Z!==void 0?Z:null:null}function V(D){var Z,se;return g(D)?D.readableErrored?D.readableErrored:(Z=(se=D._readableState)===null||se===void 0?void 0:se.errored)!==null&&Z!==void 0?Z:null:null}function G(D){if(!g(D))return null;if(typeof D.closed=="boolean")return D.closed;let Z=D._writableState,se=D._readableState;return typeof(Z==null?void 0:Z.closed)=="boolean"||typeof(se==null?void 0:se.closed)=="boolean"?(Z==null?void 0:Z.closed)||(se==null?void 0:se.closed):typeof D._closed=="boolean"&&re(D)?D._closed:null}function re(D){return typeof D._closed=="boolean"&&typeof D._defaultKeepAlive=="boolean"&&typeof D._removedConnection=="boolean"&&typeof D._removedContLen=="boolean"}function J(D){return typeof D._sent100=="boolean"&&re(D)}function x(D){var Z;return typeof D._consuming=="boolean"&&typeof D._dumped=="boolean"&&((Z=D.req)===null||Z===void 0?void 0:Z.upgradeOrConnect)===void 0}function U(D){if(!g(D))return null;let Z=D._writableState,se=D._readableState,he=Z||se;return!he&&J(D)||!!(he&&he.autoDestroy&&he.emitClose&&he.closed===!1)}function F(D){var Z;return!!(D&&((Z=D[r])!==null&&Z!==void 0?Z:D.readableDidRead||D.readableAborted))}function z(D){var Z,se,he,ce,T,B,q,X,ie,te;return!!(D&&((Z=(se=(he=(ce=(T=(B=D[e])!==null&&B!==void 0?B:D.readableErrored)!==null&&T!==void 0?T:D.writableErrored)!==null&&ce!==void 0?ce:(q=D._readableState)===null||q===void 0?void 0:q.errorEmitted)!==null&&he!==void 0?he:(X=D._writableState)===null||X===void 0?void 0:X.errorEmitted)!==null&&se!==void 0?se:(ie=D._readableState)===null||ie===void 0?void 0:ie.errored)!==null&&Z!==void 0?Z:!((te=D._writableState)===null||te===void 0)&&te.errored))}c.exports={kDestroyed:n,isDisturbed:F,kIsDisturbed:r,isErrored:z,kIsErrored:e,isReadable:O,kIsReadable:t,kIsClosedPromise:a,kControllerErrorFunction:o,isClosed:G,isDestroyed:b,isDuplexNodeStream:v,isFinished:I,isIterable:y,isReadableNodeStream:h,isReadableStream:l,isReadableEnded:C,isReadableFinished:L,isReadableErrored:V,isNodeStream:g,isWebStream:f,isWritable:N,isWritableNodeStream:_,isWritableStream:p,isWritableEnded:A,isWritableFinished:R,isWritableErrored:P,isServerRequest:x,isServerResponse:J,willEmitClose:U,isTransformStream:u}}),Ut=we((i,c)=>{pe(),ge(),_e();var s=er(),{AbortError:m,codes:w}=nt(),{ERR_INVALID_ARG_TYPE:d,ERR_STREAM_PREMATURE_CLOSE:n}=w,{kEmptyObject:e,once:t}=kt(),{validateAbortSignal:r,validateFunction:a,validateObject:o,validateBoolean:h}=Ur(),{Promise:_,PromisePrototypeThen:v}=Ke(),{isClosed:g,isReadable:l,isReadableNodeStream:p,isReadableStream:u,isReadableFinished:f,isReadableErrored:y,isWritable:b,isWritableNodeStream:A,isWritableStream:R,isWritableFinished:C,isWritableErrored:L,isNodeStream:O,willEmitClose:N,kIsClosedPromise:I}=Lt();function P(x){return x.setHeader&&typeof x.abort=="function"}var V=()=>{};function G(x,U,F){var z,D;if(arguments.length===2?(F=U,U=e):U==null?U=e:o(U,"options"),a(F,"callback"),r(U.signal,"options.signal"),F=t(F),u(x)||R(x))return re(x,U,F);if(!O(x))throw new d("stream",["ReadableStream","WritableStream","Stream"],x);let Z=(z=U.readable)!==null&&z!==void 0?z:p(x),se=(D=U.writable)!==null&&D!==void 0?D:A(x),he=x._writableState,ce=x._readableState,T=()=>{x.writable||X()},B=N(x)&&p(x)===Z&&A(x)===se,q=C(x,!1),X=()=>{q=!0,x.destroyed&&(B=!1),!(B&&(!x.readable||Z))&&(!Z||ie)&&F.call(x)},ie=f(x,!1),te=()=>{ie=!0,x.destroyed&&(B=!1),!(B&&(!x.writable||se))&&(!se||q)&&F.call(x)},le=ae=>{F.call(x,ae)},ue=g(x),W=()=>{ue=!0;let ae=L(x)||y(x);if(ae&&typeof ae!="boolean")return F.call(x,ae);if(Z&&!ie&&p(x,!0)&&!f(x,!1))return F.call(x,new n);if(se&&!q&&!C(x,!1))return F.call(x,new n);F.call(x)},ee=()=>{ue=!0;let ae=L(x)||y(x);if(ae&&typeof ae!="boolean")return F.call(x,ae);F.call(x)},Y=()=>{x.req.on("finish",X)};P(x)?(x.on("complete",X),B||x.on("abort",W),x.req?Y():x.on("request",Y)):se&&!he&&(x.on("end",T),x.on("close",T)),!B&&typeof x.aborted=="boolean"&&x.on("aborted",W),x.on("end",te),x.on("finish",X),U.error!==!1&&x.on("error",le),x.on("close",W),ue?s.nextTick(W):he!=null&&he.errorEmitted||ce!=null&&ce.errorEmitted?B||s.nextTick(ee):(!Z&&(!B||l(x))&&(q||b(x)===!1)||!se&&(!B||b(x))&&(ie||l(x)===!1)||ce&&x.req&&x.aborted)&&s.nextTick(ee);let de=()=>{F=V,x.removeListener("aborted",W),x.removeListener("complete",X),x.removeListener("abort",W),x.removeListener("request",Y),x.req&&x.req.removeListener("finish",X),x.removeListener("end",T),x.removeListener("close",T),x.removeListener("finish",X),x.removeListener("end",te),x.removeListener("error",le),x.removeListener("close",W)};if(U.signal&&!ue){let ae=()=>{let Q=F;de(),Q.call(x,new m(void 0,{cause:U.signal.reason}))};if(U.signal.aborted)s.nextTick(ae);else{let Q=F;F=t((...oe)=>{U.signal.removeEventListener("abort",ae),Q.apply(x,oe)}),U.signal.addEventListener("abort",ae)}}return de}function re(x,U,F){let z=!1,D=V;if(U.signal)if(D=()=>{z=!0,F.call(x,new m(void 0,{cause:U.signal.reason}))},U.signal.aborted)s.nextTick(D);else{let se=F;F=t((...he)=>{U.signal.removeEventListener("abort",D),se.apply(x,he)}),U.signal.addEventListener("abort",D)}let Z=(...se)=>{z||s.nextTick(()=>F.apply(x,se))};return v(x[I].promise,Z,Z),V}function J(x,U){var F;let z=!1;return U===null&&(U=e),(F=U)!==null&&F!==void 0&&F.cleanup&&(h(U.cleanup,"cleanup"),z=U.cleanup),new _((D,Z)=>{let se=G(x,U,he=>{z&&se(),he?Z(he):D()})})}c.exports=G,c.exports.finished=J}),ar=we((i,c)=>{pe(),ge(),_e();var s=er(),{aggregateTwoErrors:m,codes:{ERR_MULTIPLE_CALLBACK:w},AbortError:d}=nt(),{Symbol:n}=Ke(),{kDestroyed:e,isDestroyed:t,isFinished:r,isServerRequest:a}=Lt(),o=n("kDestroy"),h=n("kConstruct");function _(I,P,V){I&&(I.stack,P&&!P.errored&&(P.errored=I),V&&!V.errored&&(V.errored=I))}function v(I,P){let V=this._readableState,G=this._writableState,re=G||V;return G!=null&&G.destroyed||V!=null&&V.destroyed?(typeof P=="function"&&P(),this):(_(I,G,V),G&&(G.destroyed=!0),V&&(V.destroyed=!0),re.constructed?g(this,I,P):this.once(o,function(J){g(this,m(J,I),P)}),this)}function g(I,P,V){let G=!1;function re(J){if(G)return;G=!0;let x=I._readableState,U=I._writableState;_(J,U,x),U&&(U.closed=!0),x&&(x.closed=!0),typeof V=="function"&&V(J),J?s.nextTick(l,I,J):s.nextTick(p,I)}try{I._destroy(P||null,re)}catch(J){re(J)}}function l(I,P){u(I,P),p(I)}function p(I){let P=I._readableState,V=I._writableState;V&&(V.closeEmitted=!0),P&&(P.closeEmitted=!0),(V!=null&&V.emitClose||P!=null&&P.emitClose)&&I.emit("close")}function u(I,P){let V=I._readableState,G=I._writableState;G!=null&&G.errorEmitted||V!=null&&V.errorEmitted||(G&&(G.errorEmitted=!0),V&&(V.errorEmitted=!0),I.emit("error",P))}function f(){let I=this._readableState,P=this._writableState;I&&(I.constructed=!0,I.closed=!1,I.closeEmitted=!1,I.destroyed=!1,I.errored=null,I.errorEmitted=!1,I.reading=!1,I.ended=I.readable===!1,I.endEmitted=I.readable===!1),P&&(P.constructed=!0,P.destroyed=!1,P.closed=!1,P.closeEmitted=!1,P.errored=null,P.errorEmitted=!1,P.finalCalled=!1,P.prefinished=!1,P.ended=P.writable===!1,P.ending=P.writable===!1,P.finished=P.writable===!1)}function y(I,P,V){let G=I._readableState,re=I._writableState;if(re!=null&&re.destroyed||G!=null&&G.destroyed)return this;G!=null&&G.autoDestroy||re!=null&&re.autoDestroy?I.destroy(P):P&&(P.stack,re&&!re.errored&&(re.errored=P),G&&!G.errored&&(G.errored=P),V?s.nextTick(u,I,P):u(I,P))}function b(I,P){if(typeof I._construct!="function")return;let V=I._readableState,G=I._writableState;V&&(V.constructed=!1),G&&(G.constructed=!1),I.once(h,P),!(I.listenerCount(h)>1)&&s.nextTick(A,I)}function A(I){let P=!1;function V(G){if(P){y(I,G??new w);return}P=!0;let re=I._readableState,J=I._writableState,x=J||re;re&&(re.constructed=!0),J&&(J.constructed=!0),x.destroyed?I.emit(o,G):G?y(I,G,!0):s.nextTick(R,I)}try{I._construct(G=>{s.nextTick(V,G)})}catch(G){s.nextTick(V,G)}}function R(I){I.emit(h)}function C(I){return(I==null?void 0:I.setHeader)&&typeof I.abort=="function"}function L(I){I.emit("close")}function O(I,P){I.emit("error",P),s.nextTick(L,I)}function N(I,P){!I||t(I)||(!P&&!r(I)&&(P=new d),a(I)?(I.socket=null,I.destroy(P)):C(I)?I.abort():C(I.req)?I.req.abort():typeof I.destroy=="function"?I.destroy(P):typeof I.close=="function"?I.close():P?s.nextTick(O,I,P):s.nextTick(L,I),I.destroyed||(I[e]=!0))}c.exports={construct:b,destroyer:N,destroy:v,undestroy:f,errorOrDestroy:y}});function Be(){Be.init.call(this)}function Rr(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}function $n(i){return i._maxListeners===void 0?Be.defaultMaxListeners:i._maxListeners}function Hs(i,c,s,m){var w,d,n,e;if(Rr(s),(d=i._events)===void 0?(d=i._events=Object.create(null),i._eventsCount=0):(d.newListener!==void 0&&(i.emit("newListener",c,s.listener?s.listener:s),d=i._events),n=d[c]),n===void 0)n=d[c]=s,++i._eventsCount;else if(typeof n=="function"?n=d[c]=m?[s,n]:[n,s]:m?n.unshift(s):n.push(s),(w=$n(i))>0&&n.length>w&&!n.warned){n.warned=!0;var t=new Error("Possible EventEmitter memory leak detected. "+n.length+" "+String(c)+" listeners added. Use emitter.setMaxListeners() to increase limit");t.name="MaxListenersExceededWarning",t.emitter=i,t.type=c,t.count=n.length,e=t,console&&console.warn&&console.warn(e)}return i}function Va(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ws(i,c,s){var m={fired:!1,wrapFn:void 0,target:i,type:c,listener:s},w=Va.bind(m);return w.listener=s,m.wrapFn=w,w}function $s(i,c,s){var m=i._events;if(m===void 0)return[];var w=m[c];return w===void 0?[]:typeof w=="function"?s?[w.listener||w]:[w]:s?function(d){for(var n=new Array(d.length),e=0;e<n.length;++e)n[e]=d[e].listener||d[e];return n}(w):zn(w,w.length)}function zs(i){var c=this._events;if(c!==void 0){var s=c[i];if(typeof s=="function")return 1;if(s!==void 0)return s.length}return 0}function zn(i,c){for(var s=new Array(c),m=0;m<c;++m)s[m]=i[m];return s}var qs,Vs,Nt,qr,Vr,Kr,at,Ks=Je(()=>{pe(),ge(),_e(),Nt=typeof Reflect=="object"?Reflect:null,qr=Nt&&typeof Nt.apply=="function"?Nt.apply:function(i,c,s){return Function.prototype.apply.call(i,c,s)},Vs=Nt&&typeof Nt.ownKeys=="function"?Nt.ownKeys:Object.getOwnPropertySymbols?function(i){return Object.getOwnPropertyNames(i).concat(Object.getOwnPropertySymbols(i))}:function(i){return Object.getOwnPropertyNames(i)},Vr=Number.isNaN||function(i){return i!=i},qs=Be,Be.EventEmitter=Be,Be.prototype._events=void 0,Be.prototype._eventsCount=0,Be.prototype._maxListeners=void 0,Kr=10,Object.defineProperty(Be,"defaultMaxListeners",{enumerable:!0,get:function(){return Kr},set:function(i){if(typeof i!="number"||i<0||Vr(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");Kr=i}}),Be.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Be.prototype.setMaxListeners=function(i){if(typeof i!="number"||i<0||Vr(i))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+i+".");return this._maxListeners=i,this},Be.prototype.getMaxListeners=function(){return $n(this)},Be.prototype.emit=function(i){for(var c=[],s=1;s<arguments.length;s++)c.push(arguments[s]);var m=i==="error",w=this._events;if(w!==void 0)m=m&&w.error===void 0;else if(!m)return!1;if(m){var d;if(c.length>0&&(d=c[0]),d instanceof Error)throw d;var n=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw n.context=d,n}var e=w[i];if(e===void 0)return!1;if(typeof e=="function")qr(e,this,c);else{var t=e.length,r=zn(e,t);for(s=0;s<t;++s)qr(r[s],this,c)}return!0},Be.prototype.addListener=function(i,c){return Hs(this,i,c,!1)},Be.prototype.on=Be.prototype.addListener,Be.prototype.prependListener=function(i,c){return Hs(this,i,c,!0)},Be.prototype.once=function(i,c){return Rr(c),this.on(i,Ws(this,i,c)),this},Be.prototype.prependOnceListener=function(i,c){return Rr(c),this.prependListener(i,Ws(this,i,c)),this},Be.prototype.removeListener=function(i,c){var s,m,w,d,n;if(Rr(c),(m=this._events)===void 0)return this;if((s=m[i])===void 0)return this;if(s===c||s.listener===c)--this._eventsCount==0?this._events=Object.create(null):(delete m[i],m.removeListener&&this.emit("removeListener",i,s.listener||c));else if(typeof s!="function"){for(w=-1,d=s.length-1;d>=0;d--)if(s[d]===c||s[d].listener===c){n=s[d].listener,w=d;break}if(w<0)return this;w===0?s.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(s,w),s.length===1&&(m[i]=s[0]),m.removeListener!==void 0&&this.emit("removeListener",i,n||c)}return this},Be.prototype.off=Be.prototype.removeListener,Be.prototype.removeAllListeners=function(i){var c,s,m;if((s=this._events)===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[i]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete s[i]),this;if(arguments.length===0){var w,d=Object.keys(s);for(m=0;m<d.length;++m)(w=d[m])!=="removeListener"&&this.removeAllListeners(w);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(c=s[i])=="function")this.removeListener(i,c);else if(c!==void 0)for(m=c.length-1;m>=0;m--)this.removeListener(i,c[m]);return this},Be.prototype.listeners=function(i){return $s(this,i,!0)},Be.prototype.rawListeners=function(i){return $s(this,i,!1)},Be.listenerCount=function(i,c){return typeof i.listenerCount=="function"?i.listenerCount(c):zs.call(i,c)},Be.prototype.listenerCount=zs,Be.prototype.eventNames=function(){return this._eventsCount>0?Vs(this._events):[]},at=qs,at.EventEmitter,at.defaultMaxListeners,at.init,at.listenerCount,at.EventEmitter,at.defaultMaxListeners,at.init,at.listenerCount}),tr={};Zt(tr,{EventEmitter:()=>qn,default:()=>at,defaultMaxListeners:()=>Vn,init:()=>Kn,listenerCount:()=>Gn,on:()=>Yn,once:()=>Jn});var qn,Vn,Kn,Gn,Yn,Jn,lr=Je(()=>{pe(),ge(),_e(),Ks(),Ks(),at.once=function(i,c){return new Promise((s,m)=>{function w(...n){d!==void 0&&i.removeListener("error",d),s(n)}let d;c!=="error"&&(d=n=>{i.removeListener(name,w),m(n)},i.once("error",d)),i.once(c,w)})},at.on=function(i,c){let s=[],m=[],w=null,d=!1,n={async next(){let r=s.shift();if(r)return createIterResult(r,!1);if(w){let a=Promise.reject(w);return w=null,a}return d?createIterResult(void 0,!0):new Promise((a,o)=>m.push({resolve:a,reject:o}))},async return(){i.removeListener(c,e),i.removeListener("error",t),d=!0;for(let r of m)r.resolve(createIterResult(void 0,!0));return createIterResult(void 0,!0)},throw(r){w=r,i.removeListener(c,e),i.removeListener("error",t)},[Symbol.asyncIterator](){return this}};return i.on(c,e),i.on("error",t),n;function e(...r){let a=m.shift();a?a.resolve(createIterResult(r,!1)):s.push(r)}function t(r){d=!0;let a=m.shift();a?a.reject(r):w=r,n.return()}},{EventEmitter:qn,defaultMaxListeners:Vn,init:Kn,listenerCount:Gn,on:Yn,once:Jn}=at}),Ls=we((i,c)=>{pe(),ge(),_e();var{ArrayIsArray:s,ObjectSetPrototypeOf:m}=Ke(),{EventEmitter:w}=(lr(),Pe(tr));function d(e){w.call(this,e)}m(d.prototype,w.prototype),m(d,w),d.prototype.pipe=function(e,t){let r=this;function a(p){e.writable&&e.write(p)===!1&&r.pause&&r.pause()}r.on("data",a);function o(){r.readable&&r.resume&&r.resume()}e.on("drain",o),!e._isStdio&&(!t||t.end!==!1)&&(r.on("end",_),r.on("close",v));let h=!1;function _(){h||(h=!0,e.end())}function v(){h||(h=!0,typeof e.destroy=="function"&&e.destroy())}function g(p){l(),w.listenerCount(this,"error")===0&&this.emit("error",p)}n(r,"error",g),n(e,"error",g);function l(){r.removeListener("data",a),e.removeListener("drain",o),r.removeListener("end",_),r.removeListener("close",v),r.removeListener("error",g),e.removeListener("error",g),r.removeListener("end",l),r.removeListener("close",l),e.removeListener("close",l)}return r.on("end",l),r.on("close",l),e.on("close",l),e.emit("pipe",r),e};function n(e,t,r){if(typeof e.prependListener=="function")return e.prependListener(t,r);!e._events||!e._events[t]?e.on(t,r):s(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]}c.exports={Stream:d,prependListener:n}}),Fr=we((i,c)=>{pe(),ge(),_e();var{AbortError:s,codes:m}=nt(),{isNodeStream:w,isWebStream:d,kControllerErrorFunction:n}=Lt(),e=Ut(),{ERR_INVALID_ARG_TYPE:t}=m,r=(a,o)=>{if(typeof a!="object"||!("aborted"in a))throw new t(o,"AbortSignal",a)};c.exports.addAbortSignal=function(a,o){if(r(a,"signal"),!w(o)&&!d(o))throw new t("stream",["ReadableStream","WritableStream","Stream"],o);return c.exports.addAbortSignalNoValidate(a,o)},c.exports.addAbortSignalNoValidate=function(a,o){if(typeof a!="object"||!("aborted"in a))return o;let h=w(o)?()=>{o.destroy(new s(void 0,{cause:a.reason}))}:()=>{o[n](new s(void 0,{cause:a.reason}))};return a.aborted?h():(a.addEventListener("abort",h),e(o,()=>a.removeEventListener("abort",h))),o}}),Ka=we((i,c)=>{pe(),ge(),_e();var{StringPrototypeSlice:s,SymbolIterator:m,TypedArrayPrototypeSet:w,Uint8Array:d}=Ke(),{Buffer:n}=(et(),Pe(Ze)),{inspect:e}=kt();c.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){let r={data:t,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}unshift(t){let r={data:t,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}shift(){if(this.length===0)return;let t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(this.length===0)return"";let r=this.head,a=""+r.data;for(;(r=r.next)!==null;)a+=t+r.data;return a}concat(t){if(this.length===0)return n.alloc(0);let r=n.allocUnsafe(t>>>0),a=this.head,o=0;for(;a;)w(r,a.data,o),o+=a.data.length,a=a.next;return r}consume(t,r){let a=this.head.data;if(t<a.length){let o=a.slice(0,t);return this.head.data=a.slice(t),o}return t===a.length?this.shift():r?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[m](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let r="",a=this.head,o=0;do{let h=a.data;if(t>h.length)r+=h,t-=h.length;else{t===h.length?(r+=h,++o,a.next?this.head=a.next:this.head=this.tail=null):(r+=s(h,0,t),this.head=a,a.data=s(h,t));break}++o}while((a=a.next)!==null);return this.length-=o,r}_getBuffer(t){let r=n.allocUnsafe(t),a=t,o=this.head,h=0;do{let _=o.data;if(t>_.length)w(r,_,a-t),t-=_.length;else{t===_.length?(w(r,_,a-t),++h,o.next?this.head=o.next:this.head=this.tail=null):(w(r,new d(_.buffer,_.byteOffset,t),a-t),this.head=o,o.data=_.slice(t));break}++h}while((o=o.next)!==null);return this.length-=h,r}[Symbol.for("nodejs.util.inspect.custom")](t,r){return e(this,{...r,depth:0,customInspect:!1})}}}),Is=we((i,c)=>{pe(),ge(),_e();var{MathFloor:s,NumberIsInteger:m}=Ke(),{ERR_INVALID_ARG_VALUE:w}=nt().codes;function d(t,r,a){return t.highWaterMark!=null?t.highWaterMark:r?t[a]:null}function n(t){return t?16:16*1024}function e(t,r,a,o){let h=d(r,o,a);if(h!=null){if(!m(h)||h<0){let _=o?`options.${a}`:"options.highWaterMark";throw new w(_,h)}return s(h)}return n(t.objectMode)}c.exports={getHighWaterMark:e,getDefaultHighWaterMark:n}});function Gs(i){var c=i.length;if(c%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=i.indexOf("=");return s===-1&&(s=c),[s,s===c?0:4-s%4]}function Ga(i,c,s){for(var m,w,d=[],n=c;n<s;n+=3)m=(i[n]<<16&16711680)+(i[n+1]<<8&65280)+(255&i[n+2]),d.push(ft[(w=m)>>18&63]+ft[w>>12&63]+ft[w>>6&63]+ft[63&w]);return d.join("")}function Et(i){if(i>2147483647)throw new RangeError('The value "'+i+'" is invalid for option "size"');var c=new Uint8Array(i);return Object.setPrototypeOf(c,me.prototype),c}function me(i,c,s){if(typeof i=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return cs(i)}return Xn(i,c,s)}function Xn(i,c,s){if(typeof i=="string")return function(d,n){if(typeof n=="string"&&n!==""||(n="utf8"),!me.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var e=0|Zn(d,n),t=Et(e),r=t.write(d,n);return r!==e&&(t=t.slice(0,r)),t}(i,c);if(ArrayBuffer.isView(i))return Gr(i);if(i==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i);if(At(i,ArrayBuffer)||i&&At(i.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(At(i,SharedArrayBuffer)||i&&At(i.buffer,SharedArrayBuffer)))return Ya(i,c,s);if(typeof i=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var m=i.valueOf&&i.valueOf();if(m!=null&&m!==i)return me.from(m,c,s);var w=function(d){if(me.isBuffer(d)){var n=0|xs(d.length),e=Et(n);return e.length===0||d.copy(e,0,0,n),e}if(d.length!==void 0)return typeof d.length!="number"||Bs(d.length)?Et(0):Gr(d);if(d.type==="Buffer"&&Array.isArray(d.data))return Gr(d.data)}(i);if(w)return w;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof i[Symbol.toPrimitive]=="function")return me.from(i[Symbol.toPrimitive]("string"),c,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i)}function Qn(i){if(typeof i!="number")throw new TypeError('"size" argument must be of type number');if(i<0)throw new RangeError('The value "'+i+'" is invalid for option "size"')}function cs(i){return Qn(i),Et(i<0?0:0|xs(i))}function Gr(i){for(var c=i.length<0?0:0|xs(i.length),s=Et(c),m=0;m<c;m+=1)s[m]=255&i[m];return s}function Ya(i,c,s){if(c<0||i.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<c+(s||0))throw new RangeError('"length" is outside of buffer bounds');var m;return m=c===void 0&&s===void 0?new Uint8Array(i):s===void 0?new Uint8Array(i,c):new Uint8Array(i,c,s),Object.setPrototypeOf(m,me.prototype),m}function xs(i){if(i>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|i}function Zn(i,c){if(me.isBuffer(i))return i.length;if(ArrayBuffer.isView(i)||At(i,ArrayBuffer))return i.byteLength;if(typeof i!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof i);var s=i.length,m=arguments.length>2&&arguments[2]===!0;if(!m&&s===0)return 0;for(var w=!1;;)switch(c){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return us(i).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*s;case"hex":return s>>>1;case"base64":return io(i).length;default:if(w)return m?-1:us(i).length;c=(""+c).toLowerCase(),w=!0}}function Ja(i,c,s){var m=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((s===void 0||s>this.length)&&(s=this.length),s<=0)||(s>>>=0)<=(c>>>=0))return"";for(i||(i="utf8");;)switch(i){case"hex":return nl(this,c,s);case"utf8":case"utf-8":return to(this,c,s);case"ascii":return il(this,c,s);case"latin1":case"binary":return sl(this,c,s);case"base64":return rl(this,c,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ol(this,c,s);default:if(m)throw new TypeError("Unknown encoding: "+i);i=(i+"").toLowerCase(),m=!0}}function jt(i,c,s){var m=i[c];i[c]=i[s],i[s]=m}function Ys(i,c,s,m,w){if(i.length===0)return-1;if(typeof s=="string"?(m=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),Bs(s=+s)&&(s=w?0:i.length-1),s<0&&(s=i.length+s),s>=i.length){if(w)return-1;s=i.length-1}else if(s<0){if(!w)return-1;s=0}if(typeof c=="string"&&(c=me.from(c,m)),me.isBuffer(c))return c.length===0?-1:Js(i,c,s,m,w);if(typeof c=="number")return c&=255,typeof Uint8Array.prototype.indexOf=="function"?w?Uint8Array.prototype.indexOf.call(i,c,s):Uint8Array.prototype.lastIndexOf.call(i,c,s):Js(i,[c],s,m,w);throw new TypeError("val must be string, number or Buffer")}function Js(i,c,s,m,w){var d,n=1,e=i.length,t=c.length;if(m!==void 0&&((m=String(m).toLowerCase())==="ucs2"||m==="ucs-2"||m==="utf16le"||m==="utf-16le")){if(i.length<2||c.length<2)return-1;n=2,e/=2,t/=2,s/=2}function r(_,v){return n===1?_[v]:_.readUInt16BE(v*n)}if(w){var a=-1;for(d=s;d<e;d++)if(r(i,d)===r(c,a===-1?0:d-a)){if(a===-1&&(a=d),d-a+1===t)return a*n}else a!==-1&&(d-=d-a),a=-1}else for(s+t>e&&(s=e-t),d=s;d>=0;d--){for(var o=!0,h=0;h<t;h++)if(r(i,d+h)!==r(c,h)){o=!1;break}if(o)return d}return-1}function Xa(i,c,s,m){s=Number(s)||0;var w=i.length-s;m?(m=Number(m))>w&&(m=w):m=w;var d=c.length;m>d/2&&(m=d/2);for(var n=0;n<m;++n){var e=parseInt(c.substr(2*n,2),16);if(Bs(e))return n;i[s+n]=e}return n}function Qa(i,c,s,m){return Nr(us(c,i.length-s),i,s,m)}function eo(i,c,s,m){return Nr(function(w){for(var d=[],n=0;n<w.length;++n)d.push(255&w.charCodeAt(n));return d}(c),i,s,m)}function Za(i,c,s,m){return eo(i,c,s,m)}function el(i,c,s,m){return Nr(io(c),i,s,m)}function tl(i,c,s,m){return Nr(function(w,d){for(var n,e,t,r=[],a=0;a<w.length&&!((d-=2)<0);++a)n=w.charCodeAt(a),e=n>>8,t=n%256,r.push(t),r.push(e);return r}(c,i.length-s),i,s,m)}function rl(i,c,s){return c===0&&s===i.length?Or.fromByteArray(i):Or.fromByteArray(i.slice(c,s))}function to(i,c,s){s=Math.min(i.length,s);for(var m=[],w=c;w<s;){var d,n,e,t,r=i[w],a=null,o=r>239?4:r>223?3:r>191?2:1;if(w+o<=s)switch(o){case 1:r<128&&(a=r);break;case 2:(192&(d=i[w+1]))==128&&(t=(31&r)<<6|63&d)>127&&(a=t);break;case 3:d=i[w+1],n=i[w+2],(192&d)==128&&(192&n)==128&&(t=(15&r)<<12|(63&d)<<6|63&n)>2047&&(t<55296||t>57343)&&(a=t);break;case 4:d=i[w+1],n=i[w+2],e=i[w+3],(192&d)==128&&(192&n)==128&&(192&e)==128&&(t=(15&r)<<18|(63&d)<<12|(63&n)<<6|63&e)>65535&&t<1114112&&(a=t)}a===null?(a=65533,o=1):a>65535&&(a-=65536,m.push(a>>>10&1023|55296),a=56320|1023&a),m.push(a),w+=o}return function(h){var _=h.length;if(_<=4096)return String.fromCharCode.apply(String,h);for(var v="",g=0;g<_;)v+=String.fromCharCode.apply(String,h.slice(g,g+=4096));return v}(m)}function il(i,c,s){var m="";s=Math.min(i.length,s);for(var w=c;w<s;++w)m+=String.fromCharCode(127&i[w]);return m}function sl(i,c,s){var m="";s=Math.min(i.length,s);for(var w=c;w<s;++w)m+=String.fromCharCode(i[w]);return m}function nl(i,c,s){var m=i.length;(!c||c<0)&&(c=0),(!s||s<0||s>m)&&(s=m);for(var w="",d=c;d<s;++d)w+=no[i[d]];return w}function ol(i,c,s){for(var m=i.slice(c,s),w="",d=0;d<m.length;d+=2)w+=String.fromCharCode(m[d]+256*m[d+1]);return w}function Ge(i,c,s){if(i%1!=0||i<0)throw new RangeError("offset is not uint");if(i+c>s)throw new RangeError("Trying to access beyond buffer length")}function st(i,c,s,m,w,d){if(!me.isBuffer(i))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>w||c<d)throw new RangeError('"value" argument is out of bounds');if(s+m>i.length)throw new RangeError("Index out of range")}function ro(i,c,s,m,w,d){if(s+m>i.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function Xs(i,c,s,m,w){return c=+c,s>>>=0,w||ro(i,0,s,4),Kt.write(i,c,s,m,23,4),s+4}function Qs(i,c,s,m,w){return c=+c,s>>>=0,w||ro(i,0,s,8),Kt.write(i,c,s,m,52,8),s+8}function us(i,c){var s;c=c||1/0;for(var m=i.length,w=null,d=[],n=0;n<m;++n){if((s=i.charCodeAt(n))>55295&&s<57344){if(!w){if(s>56319){(c-=3)>-1&&d.push(239,191,189);continue}if(n+1===m){(c-=3)>-1&&d.push(239,191,189);continue}w=s;continue}if(s<56320){(c-=3)>-1&&d.push(239,191,189),w=s;continue}s=65536+(w-55296<<10|s-56320)}else w&&(c-=3)>-1&&d.push(239,191,189);if(w=null,s<128){if((c-=1)<0)break;d.push(s)}else if(s<2048){if((c-=2)<0)break;d.push(s>>6|192,63&s|128)}else if(s<65536){if((c-=3)<0)break;d.push(s>>12|224,s>>6&63|128,63&s|128)}else{if(!(s<1114112))throw new Error("Invalid code point");if((c-=4)<0)break;d.push(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}}return d}function io(i){return Or.toByteArray(function(c){if((c=(c=c.split("=")[0]).trim().replace(so,"")).length<2)return"";for(;c.length%4!=0;)c+="=";return c}(i))}function Nr(i,c,s,m){for(var w=0;w<m&&!(w+s>=c.length||w>=i.length);++w)c[w+s]=i[w];return w}function At(i,c){return i instanceof c||i!=null&&i.constructor!=null&&i.constructor.name!=null&&i.constructor.name===c.name}function Bs(i){return i!=i}function Zs(i,c){for(var s in i)c[s]=i[s]}function Ht(i,c,s){return ut(i,c,s)}function hr(i){var c;switch(this.encoding=function(s){var m=function(w){if(!w)return"utf8";for(var d;;)switch(w){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return w;default:if(d)return;w=(""+w).toLowerCase(),d=!0}}(s);if(typeof m!="string"&&(Pr.isEncoding===ds||!ds(s)))throw new Error("Unknown encoding: "+s);return m||s}(i),this.encoding){case"utf16le":this.text=ll,this.end=hl,c=4;break;case"utf8":this.fillLast=al,c=4;break;case"base64":this.text=cl,this.end=ul,c=3;break;default:return this.write=dl,this.end=fl,void 0}this.lastNeed=0,this.lastTotal=0,this.lastChar=Pr.allocUnsafe(c)}function Yr(i){return i<=127?0:i>>5==6?2:i>>4==14?3:i>>3==30?4:i>>6==2?-1:-2}function al(i){var c=this.lastTotal-this.lastNeed,s=function(m,w,d){if((192&w[0])!=128)return m.lastNeed=0,"�";if(m.lastNeed>1&&w.length>1){if((192&w[1])!=128)return m.lastNeed=1,"�";if(m.lastNeed>2&&w.length>2&&(192&w[2])!=128)return m.lastNeed=2,"�"}}(this,i);return s!==void 0?s:this.lastNeed<=i.length?(i.copy(this.lastChar,c,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(i.copy(this.lastChar,c,0,i.length),this.lastNeed-=i.length,void 0)}function ll(i,c){if((i.length-c)%2==0){var s=i.toString("utf16le",c);if(s){var m=s.charCodeAt(s.length-1);if(m>=55296&&m<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=i[i.length-2],this.lastChar[1]=i[i.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=i[i.length-1],i.toString("utf16le",c,i.length-1)}function hl(i){var c=i&&i.length?this.write(i):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return c+this.lastChar.toString("utf16le",0,s)}return c}function cl(i,c){var s=(i.length-c)%3;return s===0?i.toString("base64",c):(this.lastNeed=3-s,this.lastTotal=3,s===1?this.lastChar[0]=i[i.length-1]:(this.lastChar[0]=i[i.length-2],this.lastChar[1]=i[i.length-1]),i.toString("base64",c,i.length-s))}function ul(i){var c=i&&i.length?this.write(i):"";return this.lastNeed?c+this.lastChar.toString("base64",0,3-this.lastNeed):c}function dl(i){return i.toString(this.encoding)}function fl(i){return i&&i.length?this.write(i):""}var en,ft,ot,tn,yr,Wt,rn,sn,pt,Or,Kt,Jr,so,no,cr,ur,ut,nn,nr,Pr,ds,on=Je(()=>{for(pe(),ge(),_e(),en={byteLength:function(i){var c=Gs(i),s=c[0],m=c[1];return 3*(s+m)/4-m},toByteArray:function(i){var c,s,m=Gs(i),w=m[0],d=m[1],n=new tn(function(r,a,o){return 3*(a+o)/4-o}(0,w,d)),e=0,t=d>0?w-4:w;for(s=0;s<t;s+=4)c=ot[i.charCodeAt(s)]<<18|ot[i.charCodeAt(s+1)]<<12|ot[i.charCodeAt(s+2)]<<6|ot[i.charCodeAt(s+3)],n[e++]=c>>16&255,n[e++]=c>>8&255,n[e++]=255&c;return d===2&&(c=ot[i.charCodeAt(s)]<<2|ot[i.charCodeAt(s+1)]>>4,n[e++]=255&c),d===1&&(c=ot[i.charCodeAt(s)]<<10|ot[i.charCodeAt(s+1)]<<4|ot[i.charCodeAt(s+2)]>>2,n[e++]=c>>8&255,n[e++]=255&c),n},fromByteArray:function(i){for(var c,s=i.length,m=s%3,w=[],d=0,n=s-m;d<n;d+=16383)w.push(Ga(i,d,d+16383>n?n:d+16383));return m===1?(c=i[s-1],w.push(ft[c>>2]+ft[c<<4&63]+"==")):m===2&&(c=(i[s-2]<<8)+i[s-1],w.push(ft[c>>10]+ft[c>>4&63]+ft[c<<2&63]+"=")),w.join("")}},ft=[],ot=[],tn=typeof Uint8Array<"u"?Uint8Array:Array,yr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wt=0,rn=yr.length;Wt<rn;++Wt)ft[Wt]=yr[Wt],ot[yr.charCodeAt(Wt)]=Wt;ot["-".charCodeAt(0)]=62,ot["_".charCodeAt(0)]=63,sn={read:function(i,c,s,m,w){var d,n,e=8*w-m-1,t=(1<<e)-1,r=t>>1,a=-7,o=s?w-1:0,h=s?-1:1,_=i[c+o];for(o+=h,d=_&(1<<-a)-1,_>>=-a,a+=e;a>0;d=256*d+i[c+o],o+=h,a-=8);for(n=d&(1<<-a)-1,d>>=-a,a+=m;a>0;n=256*n+i[c+o],o+=h,a-=8);if(d===0)d=1-r;else{if(d===t)return n?NaN:1/0*(_?-1:1);n+=Math.pow(2,m),d-=r}return(_?-1:1)*n*Math.pow(2,d-m)},write:function(i,c,s,m,w,d){var n,e,t,r=8*d-w-1,a=(1<<r)-1,o=a>>1,h=w===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=m?0:d-1,v=m?1:-1,g=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(e=isNaN(c)?1:0,n=a):(n=Math.floor(Math.log(c)/Math.LN2),c*(t=Math.pow(2,-n))<1&&(n--,t*=2),(c+=n+o>=1?h/t:h*Math.pow(2,1-o))*t>=2&&(n++,t/=2),n+o>=a?(e=0,n=a):n+o>=1?(e=(c*t-1)*Math.pow(2,w),n+=o):(e=c*Math.pow(2,o-1)*Math.pow(2,w),n=0));w>=8;i[s+_]=255&e,_+=v,e/=256,w-=8);for(n=n<<w|e,r+=w;r>0;i[s+_]=255&n,_+=v,n/=256,r-=8);i[s+_-v]|=128*g}},pt={},Or=en,Kt=sn,Jr=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null,pt.Buffer=me,pt.SlowBuffer=function(i){return+i!=i&&(i=0),me.alloc(+i)},pt.INSPECT_MAX_BYTES=50,pt.kMaxLength=2147483647,me.TYPED_ARRAY_SUPPORT=function(){try{var i=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(i,c),i.foo()===42}catch{return!1}}(),me.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(me.prototype,"parent",{enumerable:!0,get:function(){if(me.isBuffer(this))return this.buffer}}),Object.defineProperty(me.prototype,"offset",{enumerable:!0,get:function(){if(me.isBuffer(this))return this.byteOffset}}),me.poolSize=8192,me.from=function(i,c,s){return Xn(i,c,s)},Object.setPrototypeOf(me.prototype,Uint8Array.prototype),Object.setPrototypeOf(me,Uint8Array),me.alloc=function(i,c,s){return function(m,w,d){return Qn(m),m<=0?Et(m):w!==void 0?typeof d=="string"?Et(m).fill(w,d):Et(m).fill(w):Et(m)}(i,c,s)},me.allocUnsafe=function(i){return cs(i)},me.allocUnsafeSlow=function(i){return cs(i)},me.isBuffer=function(i){return i!=null&&i._isBuffer===!0&&i!==me.prototype},me.compare=function(i,c){if(At(i,Uint8Array)&&(i=me.from(i,i.offset,i.byteLength)),At(c,Uint8Array)&&(c=me.from(c,c.offset,c.byteLength)),!me.isBuffer(i)||!me.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(i===c)return 0;for(var s=i.length,m=c.length,w=0,d=Math.min(s,m);w<d;++w)if(i[w]!==c[w]){s=i[w],m=c[w];break}return s<m?-1:m<s?1:0},me.isEncoding=function(i){switch(String(i).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},me.concat=function(i,c){if(!Array.isArray(i))throw new TypeError('"list" argument must be an Array of Buffers');if(i.length===0)return me.alloc(0);var s;if(c===void 0)for(c=0,s=0;s<i.length;++s)c+=i[s].length;var m=me.allocUnsafe(c),w=0;for(s=0;s<i.length;++s){var d=i[s];if(At(d,Uint8Array)&&(d=me.from(d)),!me.isBuffer(d))throw new TypeError('"list" argument must be an Array of Buffers');d.copy(m,w),w+=d.length}return m},me.byteLength=Zn,me.prototype._isBuffer=!0,me.prototype.swap16=function(){var i=this.length;if(i%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<i;c+=2)jt(this,c,c+1);return this},me.prototype.swap32=function(){var i=this.length;if(i%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<i;c+=4)jt(this,c,c+3),jt(this,c+1,c+2);return this},me.prototype.swap64=function(){var i=this.length;if(i%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<i;c+=8)jt(this,c,c+7),jt(this,c+1,c+6),jt(this,c+2,c+5),jt(this,c+3,c+4);return this},me.prototype.toString=function(){var i=this.length;return i===0?"":arguments.length===0?to(this,0,i):Ja.apply(this,arguments)},me.prototype.toLocaleString=me.prototype.toString,me.prototype.equals=function(i){if(!me.isBuffer(i))throw new TypeError("Argument must be a Buffer");return this===i||me.compare(this,i)===0},me.prototype.inspect=function(){var i="",c=pt.INSPECT_MAX_BYTES;return i=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(i+=" ... "),"<Buffer "+i+">"},Jr&&(me.prototype[Jr]=me.prototype.inspect),me.prototype.compare=function(i,c,s,m,w){if(At(i,Uint8Array)&&(i=me.from(i,i.offset,i.byteLength)),!me.isBuffer(i))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof i);if(c===void 0&&(c=0),s===void 0&&(s=i?i.length:0),m===void 0&&(m=0),w===void 0&&(w=this.length),c<0||s>i.length||m<0||w>this.length)throw new RangeError("out of range index");if(m>=w&&c>=s)return 0;if(m>=w)return-1;if(c>=s)return 1;if(this===i)return 0;for(var d=(w>>>=0)-(m>>>=0),n=(s>>>=0)-(c>>>=0),e=Math.min(d,n),t=this.slice(m,w),r=i.slice(c,s),a=0;a<e;++a)if(t[a]!==r[a]){d=t[a],n=r[a];break}return d<n?-1:n<d?1:0},me.prototype.includes=function(i,c,s){return this.indexOf(i,c,s)!==-1},me.prototype.indexOf=function(i,c,s){return Ys(this,i,c,s,!0)},me.prototype.lastIndexOf=function(i,c,s){return Ys(this,i,c,s,!1)},me.prototype.write=function(i,c,s,m){if(c===void 0)m="utf8",s=this.length,c=0;else if(s===void 0&&typeof c=="string")m=c,s=this.length,c=0;else{if(!isFinite(c))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");c>>>=0,isFinite(s)?(s>>>=0,m===void 0&&(m="utf8")):(m=s,s=void 0)}var w=this.length-c;if((s===void 0||s>w)&&(s=w),i.length>0&&(s<0||c<0)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");m||(m="utf8");for(var d=!1;;)switch(m){case"hex":return Xa(this,i,c,s);case"utf8":case"utf-8":return Qa(this,i,c,s);case"ascii":return eo(this,i,c,s);case"latin1":case"binary":return Za(this,i,c,s);case"base64":return el(this,i,c,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return tl(this,i,c,s);default:if(d)throw new TypeError("Unknown encoding: "+m);m=(""+m).toLowerCase(),d=!0}},me.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},me.prototype.slice=function(i,c){var s=this.length;(i=~~i)<0?(i+=s)<0&&(i=0):i>s&&(i=s),(c=c===void 0?s:~~c)<0?(c+=s)<0&&(c=0):c>s&&(c=s),c<i&&(c=i);var m=this.subarray(i,c);return Object.setPrototypeOf(m,me.prototype),m},me.prototype.readUIntLE=function(i,c,s){i>>>=0,c>>>=0,s||Ge(i,c,this.length);for(var m=this[i],w=1,d=0;++d<c&&(w*=256);)m+=this[i+d]*w;return m},me.prototype.readUIntBE=function(i,c,s){i>>>=0,c>>>=0,s||Ge(i,c,this.length);for(var m=this[i+--c],w=1;c>0&&(w*=256);)m+=this[i+--c]*w;return m},me.prototype.readUInt8=function(i,c){return i>>>=0,c||Ge(i,1,this.length),this[i]},me.prototype.readUInt16LE=function(i,c){return i>>>=0,c||Ge(i,2,this.length),this[i]|this[i+1]<<8},me.prototype.readUInt16BE=function(i,c){return i>>>=0,c||Ge(i,2,this.length),this[i]<<8|this[i+1]},me.prototype.readUInt32LE=function(i,c){return i>>>=0,c||Ge(i,4,this.length),(this[i]|this[i+1]<<8|this[i+2]<<16)+16777216*this[i+3]},me.prototype.readUInt32BE=function(i,c){return i>>>=0,c||Ge(i,4,this.length),16777216*this[i]+(this[i+1]<<16|this[i+2]<<8|this[i+3])},me.prototype.readIntLE=function(i,c,s){i>>>=0,c>>>=0,s||Ge(i,c,this.length);for(var m=this[i],w=1,d=0;++d<c&&(w*=256);)m+=this[i+d]*w;return m>=(w*=128)&&(m-=Math.pow(2,8*c)),m},me.prototype.readIntBE=function(i,c,s){i>>>=0,c>>>=0,s||Ge(i,c,this.length);for(var m=c,w=1,d=this[i+--m];m>0&&(w*=256);)d+=this[i+--m]*w;return d>=(w*=128)&&(d-=Math.pow(2,8*c)),d},me.prototype.readInt8=function(i,c){return i>>>=0,c||Ge(i,1,this.length),128&this[i]?-1*(255-this[i]+1):this[i]},me.prototype.readInt16LE=function(i,c){i>>>=0,c||Ge(i,2,this.length);var s=this[i]|this[i+1]<<8;return 32768&s?4294901760|s:s},me.prototype.readInt16BE=function(i,c){i>>>=0,c||Ge(i,2,this.length);var s=this[i+1]|this[i]<<8;return 32768&s?4294901760|s:s},me.prototype.readInt32LE=function(i,c){return i>>>=0,c||Ge(i,4,this.length),this[i]|this[i+1]<<8|this[i+2]<<16|this[i+3]<<24},me.prototype.readInt32BE=function(i,c){return i>>>=0,c||Ge(i,4,this.length),this[i]<<24|this[i+1]<<16|this[i+2]<<8|this[i+3]},me.prototype.readFloatLE=function(i,c){return i>>>=0,c||Ge(i,4,this.length),Kt.read(this,i,!0,23,4)},me.prototype.readFloatBE=function(i,c){return i>>>=0,c||Ge(i,4,this.length),Kt.read(this,i,!1,23,4)},me.prototype.readDoubleLE=function(i,c){return i>>>=0,c||Ge(i,8,this.length),Kt.read(this,i,!0,52,8)},me.prototype.readDoubleBE=function(i,c){return i>>>=0,c||Ge(i,8,this.length),Kt.read(this,i,!1,52,8)},me.prototype.writeUIntLE=function(i,c,s,m){i=+i,c>>>=0,s>>>=0,m||st(this,i,c,s,Math.pow(2,8*s)-1,0);var w=1,d=0;for(this[c]=255&i;++d<s&&(w*=256);)this[c+d]=i/w&255;return c+s},me.prototype.writeUIntBE=function(i,c,s,m){i=+i,c>>>=0,s>>>=0,m||st(this,i,c,s,Math.pow(2,8*s)-1,0);var w=s-1,d=1;for(this[c+w]=255&i;--w>=0&&(d*=256);)this[c+w]=i/d&255;return c+s},me.prototype.writeUInt8=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,1,255,0),this[c]=255&i,c+1},me.prototype.writeUInt16LE=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,2,65535,0),this[c]=255&i,this[c+1]=i>>>8,c+2},me.prototype.writeUInt16BE=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,2,65535,0),this[c]=i>>>8,this[c+1]=255&i,c+2},me.prototype.writeUInt32LE=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,4,4294967295,0),this[c+3]=i>>>24,this[c+2]=i>>>16,this[c+1]=i>>>8,this[c]=255&i,c+4},me.prototype.writeUInt32BE=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,4,4294967295,0),this[c]=i>>>24,this[c+1]=i>>>16,this[c+2]=i>>>8,this[c+3]=255&i,c+4},me.prototype.writeIntLE=function(i,c,s,m){if(i=+i,c>>>=0,!m){var w=Math.pow(2,8*s-1);st(this,i,c,s,w-1,-w)}var d=0,n=1,e=0;for(this[c]=255&i;++d<s&&(n*=256);)i<0&&e===0&&this[c+d-1]!==0&&(e=1),this[c+d]=(i/n>>0)-e&255;return c+s},me.prototype.writeIntBE=function(i,c,s,m){if(i=+i,c>>>=0,!m){var w=Math.pow(2,8*s-1);st(this,i,c,s,w-1,-w)}var d=s-1,n=1,e=0;for(this[c+d]=255&i;--d>=0&&(n*=256);)i<0&&e===0&&this[c+d+1]!==0&&(e=1),this[c+d]=(i/n>>0)-e&255;return c+s},me.prototype.writeInt8=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,1,127,-128),i<0&&(i=255+i+1),this[c]=255&i,c+1},me.prototype.writeInt16LE=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,2,32767,-32768),this[c]=255&i,this[c+1]=i>>>8,c+2},me.prototype.writeInt16BE=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,2,32767,-32768),this[c]=i>>>8,this[c+1]=255&i,c+2},me.prototype.writeInt32LE=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,4,2147483647,-2147483648),this[c]=255&i,this[c+1]=i>>>8,this[c+2]=i>>>16,this[c+3]=i>>>24,c+4},me.prototype.writeInt32BE=function(i,c,s){return i=+i,c>>>=0,s||st(this,i,c,4,2147483647,-2147483648),i<0&&(i=4294967295+i+1),this[c]=i>>>24,this[c+1]=i>>>16,this[c+2]=i>>>8,this[c+3]=255&i,c+4},me.prototype.writeFloatLE=function(i,c,s){return Xs(this,i,c,!0,s)},me.prototype.writeFloatBE=function(i,c,s){return Xs(this,i,c,!1,s)},me.prototype.writeDoubleLE=function(i,c,s){return Qs(this,i,c,!0,s)},me.prototype.writeDoubleBE=function(i,c,s){return Qs(this,i,c,!1,s)},me.prototype.copy=function(i,c,s,m){if(!me.isBuffer(i))throw new TypeError("argument should be a Buffer");if(s||(s=0),m||m===0||(m=this.length),c>=i.length&&(c=i.length),c||(c=0),m>0&&m<s&&(m=s),m===s||i.length===0||this.length===0)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("sourceEnd out of bounds");m>this.length&&(m=this.length),i.length-c<m-s&&(m=i.length-c+s);var w=m-s;if(this===i&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(c,s,m);else if(this===i&&s<c&&c<m)for(var d=w-1;d>=0;--d)i[d+c]=this[d+s];else Uint8Array.prototype.set.call(i,this.subarray(s,m),c);return w},me.prototype.fill=function(i,c,s,m){if(typeof i=="string"){if(typeof c=="string"?(m=c,c=0,s=this.length):typeof s=="string"&&(m=s,s=this.length),m!==void 0&&typeof m!="string")throw new TypeError("encoding must be a string");if(typeof m=="string"&&!me.isEncoding(m))throw new TypeError("Unknown encoding: "+m);if(i.length===1){var w=i.charCodeAt(0);(m==="utf8"&&w<128||m==="latin1")&&(i=w)}}else typeof i=="number"?i&=255:typeof i=="boolean"&&(i=Number(i));if(c<0||this.length<c||this.length<s)throw new RangeError("Out of range index");if(s<=c)return this;var d;if(c>>>=0,s=s===void 0?this.length:s>>>0,i||(i=0),typeof i=="number")for(d=c;d<s;++d)this[d]=i;else{var n=me.isBuffer(i)?i:me.from(i,m),e=n.length;if(e===0)throw new TypeError('The value "'+i+'" is invalid for argument "value"');for(d=0;d<s-c;++d)this[d+c]=n[d%e]}return this},so=/[^+/0-9A-Za-z-_]/g,no=function(){for(var i=new Array(256),c=0;c<16;++c)for(var s=16*c,m=0;m<16;++m)i[s+m]="0123456789abcdef"[c]+"0123456789abcdef"[m];return i}(),pt.Buffer,pt.INSPECT_MAX_BYTES,pt.kMaxLength,cr={},ur=pt,ut=ur.Buffer,ut.from&&ut.alloc&&ut.allocUnsafe&&ut.allocUnsafeSlow?cr=ur:(Zs(ur,cr),cr.Buffer=Ht),Ht.prototype=Object.create(ut.prototype),Zs(ut,Ht),Ht.from=function(i,c,s){if(typeof i=="number")throw new TypeError("Argument must not be a number");return ut(i,c,s)},Ht.alloc=function(i,c,s){if(typeof i!="number")throw new TypeError("Argument must be a number");var m=ut(i);return c!==void 0?typeof s=="string"?m.fill(c,s):m.fill(c):m.fill(0),m},Ht.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return ut(i)},Ht.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return ur.SlowBuffer(i)},nn=cr,nr={},Pr=nn.Buffer,ds=Pr.isEncoding||function(i){switch((i=""+i)&&i.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},nr.StringDecoder=hr,hr.prototype.write=function(i){if(i.length===0)return"";var c,s;if(this.lastNeed){if((c=this.fillLast(i))===void 0)return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<i.length?c?c+this.text(i,s):this.text(i,s):c||""},hr.prototype.end=function(i){var c=i&&i.length?this.write(i):"";return this.lastNeed?c+"�":c},hr.prototype.text=function(i,c){var s=function(w,d,n){var e=d.length-1;if(e<n)return 0;var t=Yr(d[e]);return t>=0?(t>0&&(w.lastNeed=t-1),t):--e<n||t===-2?0:(t=Yr(d[e]))>=0?(t>0&&(w.lastNeed=t-2),t):--e<n||t===-2?0:(t=Yr(d[e]))>=0?(t>0&&(t===2?t=0:w.lastNeed=t-3),t):0}(this,i,c);if(!this.lastNeed)return i.toString("utf8",c);this.lastTotal=s;var m=i.length-(s-this.lastNeed);return i.copy(this.lastChar,0,m),i.toString("utf8",c,m)},hr.prototype.fillLast=function(i){if(this.lastNeed<=i.length)return i.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);i.copy(this.lastChar,this.lastTotal-this.lastNeed,0,i.length),this.lastNeed-=i.length},nr.StringDecoder,nr.StringDecoder}),oo={};Zt(oo,{StringDecoder:()=>ao,default:()=>nr});var ao,pl=Je(()=>{pe(),ge(),_e(),on(),on(),ao=nr.StringDecoder}),lo=we((i,c)=>{pe(),ge(),_e();var s=er(),{PromisePrototypeThen:m,SymbolAsyncIterator:w,SymbolIterator:d}=Ke(),{Buffer:n}=(et(),Pe(Ze)),{ERR_INVALID_ARG_TYPE:e,ERR_STREAM_NULL_VALUES:t}=nt().codes;function r(a,o,h){let _;if(typeof o=="string"||o instanceof n)return new a({objectMode:!0,...h,read(){this.push(o),this.push(null)}});let v;if(o&&o[w])v=!0,_=o[w]();else if(o&&o[d])v=!1,_=o[d]();else throw new e("iterable",["Iterable"],o);let g=new a({objectMode:!0,highWaterMark:1,...h}),l=!1;g._read=function(){l||(l=!0,u())},g._destroy=function(f,y){m(p(f),()=>s.nextTick(y,f),b=>s.nextTick(y,b||f))};async function p(f){let y=f!=null,b=typeof _.throw=="function";if(y&&b){let{value:A,done:R}=await _.throw(f);if(await A,R)return}if(typeof _.return=="function"){let{value:A}=await _.return();await A}}async function u(){for(;;){try{let{value:f,done:y}=v?await _.next():_.next();if(y)g.push(null);else{let b=f&&typeof f.then=="function"?await f:f;if(b===null)throw l=!1,new t;if(g.push(b))continue;l=!1}}catch(f){g.destroy(f)}break}}return g}c.exports=r}),jr=we((i,c)=>{pe(),ge(),_e();var s=er(),{ArrayPrototypeIndexOf:m,NumberIsInteger:w,NumberIsNaN:d,NumberParseInt:n,ObjectDefineProperties:e,ObjectKeys:t,ObjectSetPrototypeOf:r,Promise:a,SafeSet:o,SymbolAsyncIterator:h,Symbol:_}=Ke();c.exports=D,D.ReadableState=z;var{EventEmitter:v}=(lr(),Pe(tr)),{Stream:g,prependListener:l}=Ls(),{Buffer:p}=(et(),Pe(Ze)),{addAbortSignal:u}=Fr(),f=Ut(),y=kt().debuglog("stream",S=>{y=S}),b=Ka(),A=ar(),{getHighWaterMark:R,getDefaultHighWaterMark:C}=Is(),{aggregateTwoErrors:L,codes:{ERR_INVALID_ARG_TYPE:O,ERR_METHOD_NOT_IMPLEMENTED:N,ERR_OUT_OF_RANGE:I,ERR_STREAM_PUSH_AFTER_EOF:P,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:V}}=nt(),{validateObject:G}=Ur(),re=_("kPaused"),{StringDecoder:J}=(pl(),Pe(oo)),x=lo();r(D.prototype,g.prototype),r(D,g);var U=()=>{},{errorOrDestroy:F}=A;function z(S,k,j){typeof j!="boolean"&&(j=k instanceof Rt()),this.objectMode=!!(S&&S.objectMode),j&&(this.objectMode=this.objectMode||!!(S&&S.readableObjectMode)),this.highWaterMark=S?R(this,S,"readableHighWaterMark",j):C(!1),this.buffer=new b,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[re]=null,this.errorEmitted=!1,this.emitClose=!S||S.emitClose!==!1,this.autoDestroy=!S||S.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=S&&S.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,S&&S.encoding&&(this.decoder=new J(S.encoding),this.encoding=S.encoding)}function D(S){if(!(this instanceof D))return new D(S);let k=this instanceof Rt();this._readableState=new z(S,this,k),S&&(typeof S.read=="function"&&(this._read=S.read),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.construct=="function"&&(this._construct=S.construct),S.signal&&!k&&u(S.signal,this)),g.call(this,S),A.construct(this,()=>{this._readableState.needReadable&&ie(this,this._readableState)})}D.prototype.destroy=A.destroy,D.prototype._undestroy=A.undestroy,D.prototype._destroy=function(S,k){k(S)},D.prototype[v.captureRejectionSymbol]=function(S){this.destroy(S)},D.prototype.push=function(S,k){return Z(this,S,k,!1)},D.prototype.unshift=function(S,k){return Z(this,S,k,!0)};function Z(S,k,j,$){y("readableAddChunk",k);let M=S._readableState,H;if(M.objectMode||(typeof k=="string"?(j=j||M.defaultEncoding,M.encoding!==j&&($&&M.encoding?k=p.from(k,j).toString(M.encoding):(k=p.from(k,j),j=""))):k instanceof p?j="":g._isUint8Array(k)?(k=g._uint8ArrayToBuffer(k),j=""):k!=null&&(H=new O("chunk",["string","Buffer","Uint8Array"],k))),H)F(S,H);else if(k===null)M.reading=!1,B(S,M);else if(M.objectMode||k&&k.length>0)if($)if(M.endEmitted)F(S,new V);else{if(M.destroyed||M.errored)return!1;se(S,M,k,!0)}else if(M.ended)F(S,new P);else{if(M.destroyed||M.errored)return!1;M.reading=!1,M.decoder&&!j?(k=M.decoder.write(k),M.objectMode||k.length!==0?se(S,M,k,!1):ie(S,M)):se(S,M,k,!1)}else $||(M.reading=!1,ie(S,M));return!M.ended&&(M.length<M.highWaterMark||M.length===0)}function se(S,k,j,$){k.flowing&&k.length===0&&!k.sync&&S.listenerCount("data")>0?(k.multiAwaitDrain?k.awaitDrainWriters.clear():k.awaitDrainWriters=null,k.dataEmitted=!0,S.emit("data",j)):(k.length+=k.objectMode?1:j.length,$?k.buffer.unshift(j):k.buffer.push(j),k.needReadable&&q(S)),ie(S,k)}D.prototype.isPaused=function(){let S=this._readableState;return S[re]===!0||S.flowing===!1},D.prototype.setEncoding=function(S){let k=new J(S);this._readableState.decoder=k,this._readableState.encoding=this._readableState.decoder.encoding;let j=this._readableState.buffer,$="";for(let M of j)$+=k.write(M);return j.clear(),$!==""&&j.push($),this._readableState.length=$.length,this};var he=1073741824;function ce(S){if(S>he)throw new I("size","<= 1GiB",S);return S--,S|=S>>>1,S|=S>>>2,S|=S>>>4,S|=S>>>8,S|=S>>>16,S++,S}function T(S,k){return S<=0||k.length===0&&k.ended?0:k.objectMode?1:d(S)?k.flowing&&k.length?k.buffer.first().length:k.length:S<=k.length?S:k.ended?k.length:0}D.prototype.read=function(S){y("read",S),S===void 0?S=NaN:w(S)||(S=n(S,10));let k=this._readableState,j=S;if(S>k.highWaterMark&&(k.highWaterMark=ce(S)),S!==0&&(k.emittedReadable=!1),S===0&&k.needReadable&&((k.highWaterMark!==0?k.length>=k.highWaterMark:k.length>0)||k.ended))return y("read: emitReadable",k.length,k.ended),k.length===0&&k.ended?be(this):q(this),null;if(S=T(S,k),S===0&&k.ended)return k.length===0&&be(this),null;let $=k.needReadable;if(y("need readable",$),(k.length===0||k.length-S<k.highWaterMark)&&($=!0,y("length less than watermark",$)),k.ended||k.reading||k.destroyed||k.errored||!k.constructed)$=!1,y("reading, ended or constructing",$);else if($){y("do read"),k.reading=!0,k.sync=!0,k.length===0&&(k.needReadable=!0);try{this._read(k.highWaterMark)}catch(H){F(this,H)}k.sync=!1,k.reading||(S=T(j,k))}let M;return S>0?M=oe(S,k):M=null,M===null?(k.needReadable=k.length<=k.highWaterMark,S=0):(k.length-=S,k.multiAwaitDrain?k.awaitDrainWriters.clear():k.awaitDrainWriters=null),k.length===0&&(k.ended||(k.needReadable=!0),j!==S&&k.ended&&be(this)),M!==null&&!k.errorEmitted&&!k.closeEmitted&&(k.dataEmitted=!0,this.emit("data",M)),M};function B(S,k){if(y("onEofChunk"),!k.ended){if(k.decoder){let j=k.decoder.end();j&&j.length&&(k.buffer.push(j),k.length+=k.objectMode?1:j.length)}k.ended=!0,k.sync?q(S):(k.needReadable=!1,k.emittedReadable=!0,X(S))}}function q(S){let k=S._readableState;y("emitReadable",k.needReadable,k.emittedReadable),k.needReadable=!1,k.emittedReadable||(y("emitReadable",k.flowing),k.emittedReadable=!0,s.nextTick(X,S))}function X(S){let k=S._readableState;y("emitReadable_",k.destroyed,k.length,k.ended),!k.destroyed&&!k.errored&&(k.length||k.ended)&&(S.emit("readable"),k.emittedReadable=!1),k.needReadable=!k.flowing&&!k.ended&&k.length<=k.highWaterMark,de(S)}function ie(S,k){!k.readingMore&&k.constructed&&(k.readingMore=!0,s.nextTick(te,S,k))}function te(S,k){for(;!k.reading&&!k.ended&&(k.length<k.highWaterMark||k.flowing&&k.length===0);){let j=k.length;if(y("maybeReadMore read 0"),S.read(0),j===k.length)break}k.readingMore=!1}D.prototype._read=function(S){throw new N("_read()")},D.prototype.pipe=function(S,k){let j=this,$=this._readableState;$.pipes.length===1&&($.multiAwaitDrain||($.multiAwaitDrain=!0,$.awaitDrainWriters=new o($.awaitDrainWriters?[$.awaitDrainWriters]:[]))),$.pipes.push(S),y("pipe count=%d opts=%j",$.pipes.length,k);let M=(!k||k.end!==!1)&&S!==s.stdout&&S!==s.stderr?ne:rt;$.endEmitted?s.nextTick(M):j.once("end",M),S.on("unpipe",H);function H(ze,qe){y("onunpipe"),ze===j&&qe&&qe.hasUnpiped===!1&&(qe.hasUnpiped=!0,ye())}function ne(){y("onend"),S.end()}let ve,fe=!1;function ye(){y("cleanup"),S.removeListener("close",tt),S.removeListener("finish",Oe),ve&&S.removeListener("drain",ve),S.removeListener("error",We),S.removeListener("unpipe",H),j.removeListener("end",ne),j.removeListener("end",rt),j.removeListener("data",Re),fe=!0,ve&&$.awaitDrainWriters&&(!S._writableState||S._writableState.needDrain)&&ve()}function Ce(){fe||($.pipes.length===1&&$.pipes[0]===S?(y("false write response, pause",0),$.awaitDrainWriters=S,$.multiAwaitDrain=!1):$.pipes.length>1&&$.pipes.includes(S)&&(y("false write response, pause",$.awaitDrainWriters.size),$.awaitDrainWriters.add(S)),j.pause()),ve||(ve=le(j,S),S.on("drain",ve))}j.on("data",Re);function Re(ze){y("ondata");let qe=S.write(ze);y("dest.write",qe),qe===!1&&Ce()}function We(ze){if(y("onerror",ze),rt(),S.removeListener("error",We),S.listenerCount("error")===0){let qe=S._writableState||S._readableState;qe&&!qe.errorEmitted?F(S,ze):S.emit("error",ze)}}l(S,"error",We);function tt(){S.removeListener("finish",Oe),rt()}S.once("close",tt);function Oe(){y("onfinish"),S.removeListener("close",tt),rt()}S.once("finish",Oe);function rt(){y("unpipe"),j.unpipe(S)}return S.emit("pipe",j),S.writableNeedDrain===!0?$.flowing&&Ce():$.flowing||(y("pipe resume"),j.resume()),S};function le(S,k){return function(){let j=S._readableState;j.awaitDrainWriters===k?(y("pipeOnDrain",1),j.awaitDrainWriters=null):j.multiAwaitDrain&&(y("pipeOnDrain",j.awaitDrainWriters.size),j.awaitDrainWriters.delete(k)),(!j.awaitDrainWriters||j.awaitDrainWriters.size===0)&&S.listenerCount("data")&&S.resume()}}D.prototype.unpipe=function(S){let k=this._readableState,j={hasUnpiped:!1};if(k.pipes.length===0)return this;if(!S){let M=k.pipes;k.pipes=[],this.pause();for(let H=0;H<M.length;H++)M[H].emit("unpipe",this,{hasUnpiped:!1});return this}let $=m(k.pipes,S);return $===-1?this:(k.pipes.splice($,1),k.pipes.length===0&&this.pause(),S.emit("unpipe",this,j),this)},D.prototype.on=function(S,k){let j=g.prototype.on.call(this,S,k),$=this._readableState;return S==="data"?($.readableListening=this.listenerCount("readable")>0,$.flowing!==!1&&this.resume()):S==="readable"&&!$.endEmitted&&!$.readableListening&&($.readableListening=$.needReadable=!0,$.flowing=!1,$.emittedReadable=!1,y("on readable",$.length,$.reading),$.length?q(this):$.reading||s.nextTick(W,this)),j},D.prototype.addListener=D.prototype.on,D.prototype.removeListener=function(S,k){let j=g.prototype.removeListener.call(this,S,k);return S==="readable"&&s.nextTick(ue,this),j},D.prototype.off=D.prototype.removeListener,D.prototype.removeAllListeners=function(S){let k=g.prototype.removeAllListeners.apply(this,arguments);return(S==="readable"||S===void 0)&&s.nextTick(ue,this),k};function ue(S){let k=S._readableState;k.readableListening=S.listenerCount("readable")>0,k.resumeScheduled&&k[re]===!1?k.flowing=!0:S.listenerCount("data")>0?S.resume():k.readableListening||(k.flowing=null)}function W(S){y("readable nexttick read 0"),S.read(0)}D.prototype.resume=function(){let S=this._readableState;return S.flowing||(y("resume"),S.flowing=!S.readableListening,ee(this,S)),S[re]=!1,this};function ee(S,k){k.resumeScheduled||(k.resumeScheduled=!0,s.nextTick(Y,S,k))}function Y(S,k){y("resume",k.reading),k.reading||S.read(0),k.resumeScheduled=!1,S.emit("resume"),de(S),k.flowing&&!k.reading&&S.read(0)}D.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[re]=!0,this};function de(S){let k=S._readableState;for(y("flow",k.flowing);k.flowing&&S.read()!==null;);}D.prototype.wrap=function(S){let k=!1;S.on("data",$=>{!this.push($)&&S.pause&&(k=!0,S.pause())}),S.on("end",()=>{this.push(null)}),S.on("error",$=>{F(this,$)}),S.on("close",()=>{this.destroy()}),S.on("destroy",()=>{this.destroy()}),this._read=()=>{k&&S.resume&&(k=!1,S.resume())};let j=t(S);for(let $=1;$<j.length;$++){let M=j[$];this[M]===void 0&&typeof S[M]=="function"&&(this[M]=S[M].bind(S))}return this},D.prototype[h]=function(){return ae(this)},D.prototype.iterator=function(S){return S!==void 0&&G(S,"options"),ae(this,S)};function ae(S,k){typeof S.read!="function"&&(S=D.wrap(S,{objectMode:!0}));let j=Q(S,k);return j.stream=S,j}async function*Q(S,k){let j=U;function $(ne){this===S?(j(),j=U):j=ne}S.on("readable",$);let M,H=f(S,{writable:!1},ne=>{M=ne?L(M,ne):null,j(),j=U});try{for(;;){let ne=S.destroyed?null:S.read();if(ne!==null)yield ne;else{if(M)throw M;if(M===null)return;await new a($)}}}catch(ne){throw M=L(M,ne),M}finally{(M||(k==null?void 0:k.destroyOnReturn)!==!1)&&(M===void 0||S._readableState.autoDestroy)?A.destroyer(S,null):(S.off("readable",$),H())}}e(D.prototype,{readable:{__proto__:null,get(){let S=this._readableState;return!!S&&S.readable!==!1&&!S.destroyed&&!S.errorEmitted&&!S.endEmitted},set(S){this._readableState&&(this._readableState.readable=!!S)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(S){this._readableState&&(this._readableState.flowing=S)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(S){this._readableState&&(this._readableState.destroyed=S)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),e(z.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[re]!==!1},set(S){this[re]=!!S}}}),D._fromList=oe;function oe(S,k){if(k.length===0)return null;let j;return k.objectMode?j=k.buffer.shift():!S||S>=k.length?(k.decoder?j=k.buffer.join(""):k.buffer.length===1?j=k.buffer.first():j=k.buffer.concat(k.length),k.buffer.clear()):j=k.buffer.consume(S,k.decoder),j}function be(S){let k=S._readableState;y("endReadable",k.endEmitted),k.endEmitted||(k.ended=!0,s.nextTick(Se,k,S))}function Se(S,k){if(y("endReadableNT",S.endEmitted,S.length),!S.errored&&!S.closeEmitted&&!S.endEmitted&&S.length===0){if(S.endEmitted=!0,k.emit("end"),k.writable&&k.allowHalfOpen===!1)s.nextTick(Ee,k);else if(S.autoDestroy){let j=k._writableState;(!j||j.autoDestroy&&(j.finished||j.writable===!1))&&k.destroy()}}}function Ee(S){S.writable&&!S.writableEnded&&!S.destroyed&&S.end()}D.from=function(S,k){return x(D,S,k)};var Te;function E(){return Te===void 0&&(Te={}),Te}D.fromWeb=function(S,k){return E().newStreamReadableFromReadableStream(S,k)},D.toWeb=function(S,k){return E().newReadableStreamFromStreamReadable(S,k)},D.wrap=function(S,k){var j,$;return new D({objectMode:(j=($=S.readableObjectMode)!==null&&$!==void 0?$:S.objectMode)!==null&&j!==void 0?j:!0,...k,destroy(M,H){A.destroyer(S,M),H(M)}}).wrap(S)}}),ho=we((i,c)=>{pe(),ge(),_e();var s=er(),{ArrayPrototypeSlice:m,Error:w,FunctionPrototypeSymbolHasInstance:d,ObjectDefineProperty:n,ObjectDefineProperties:e,ObjectSetPrototypeOf:t,StringPrototypeToLowerCase:r,Symbol:a,SymbolHasInstance:o}=Ke();c.exports=J,J.WritableState=G;var{EventEmitter:h}=(lr(),Pe(tr)),_=Ls().Stream,{Buffer:v}=(et(),Pe(Ze)),g=ar(),{addAbortSignal:l}=Fr(),{getHighWaterMark:p,getDefaultHighWaterMark:u}=Is(),{ERR_INVALID_ARG_TYPE:f,ERR_METHOD_NOT_IMPLEMENTED:y,ERR_MULTIPLE_CALLBACK:b,ERR_STREAM_CANNOT_PIPE:A,ERR_STREAM_DESTROYED:R,ERR_STREAM_ALREADY_FINISHED:C,ERR_STREAM_NULL_VALUES:L,ERR_STREAM_WRITE_AFTER_END:O,ERR_UNKNOWN_ENCODING:N}=nt().codes,{errorOrDestroy:I}=g;t(J.prototype,_.prototype),t(J,_);function P(){}var V=a("kOnFinished");function G(W,ee,Y){typeof Y!="boolean"&&(Y=ee instanceof Rt()),this.objectMode=!!(W&&W.objectMode),Y&&(this.objectMode=this.objectMode||!!(W&&W.writableObjectMode)),this.highWaterMark=W?p(this,W,"writableHighWaterMark",Y):u(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let de=!!(W&&W.decodeStrings===!1);this.decodeStrings=!de,this.defaultEncoding=W&&W.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=D.bind(void 0,ee),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,re(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!W||W.emitClose!==!1,this.autoDestroy=!W||W.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[V]=[]}function re(W){W.buffered=[],W.bufferedIndex=0,W.allBuffers=!0,W.allNoop=!0}G.prototype.getBuffer=function(){return m(this.buffered,this.bufferedIndex)},n(G.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function J(W){let ee=this instanceof Rt();if(!ee&&!d(J,this))return new J(W);this._writableState=new G(W,this,ee),W&&(typeof W.write=="function"&&(this._write=W.write),typeof W.writev=="function"&&(this._writev=W.writev),typeof W.destroy=="function"&&(this._destroy=W.destroy),typeof W.final=="function"&&(this._final=W.final),typeof W.construct=="function"&&(this._construct=W.construct),W.signal&&l(W.signal,this)),_.call(this,W),g.construct(this,()=>{let Y=this._writableState;Y.writing||ce(this,Y),X(this,Y)})}n(J,o,{__proto__:null,value:function(W){return d(this,W)?!0:this!==J?!1:W&&W._writableState instanceof G}}),J.prototype.pipe=function(){I(this,new A)};function x(W,ee,Y,de){let ae=W._writableState;if(typeof Y=="function")de=Y,Y=ae.defaultEncoding;else{if(!Y)Y=ae.defaultEncoding;else if(Y!=="buffer"&&!v.isEncoding(Y))throw new N(Y);typeof de!="function"&&(de=P)}if(ee===null)throw new L;if(!ae.objectMode)if(typeof ee=="string")ae.decodeStrings!==!1&&(ee=v.from(ee,Y),Y="buffer");else if(ee instanceof v)Y="buffer";else if(_._isUint8Array(ee))ee=_._uint8ArrayToBuffer(ee),Y="buffer";else throw new f("chunk",["string","Buffer","Uint8Array"],ee);let Q;return ae.ending?Q=new O:ae.destroyed&&(Q=new R("write")),Q?(s.nextTick(de,Q),I(W,Q,!0),Q):(ae.pendingcb++,U(W,ae,ee,Y,de))}J.prototype.write=function(W,ee,Y){return x(this,W,ee,Y)===!0},J.prototype.cork=function(){this._writableState.corked++},J.prototype.uncork=function(){let W=this._writableState;W.corked&&(W.corked--,W.writing||ce(this,W))},J.prototype.setDefaultEncoding=function(W){if(typeof W=="string"&&(W=r(W)),!v.isEncoding(W))throw new N(W);return this._writableState.defaultEncoding=W,this};function U(W,ee,Y,de,ae){let Q=ee.objectMode?1:Y.length;ee.length+=Q;let oe=ee.length<ee.highWaterMark;return oe||(ee.needDrain=!0),ee.writing||ee.corked||ee.errored||!ee.constructed?(ee.buffered.push({chunk:Y,encoding:de,callback:ae}),ee.allBuffers&&de!=="buffer"&&(ee.allBuffers=!1),ee.allNoop&&ae!==P&&(ee.allNoop=!1)):(ee.writelen=Q,ee.writecb=ae,ee.writing=!0,ee.sync=!0,W._write(Y,de,ee.onwrite),ee.sync=!1),oe&&!ee.errored&&!ee.destroyed}function F(W,ee,Y,de,ae,Q,oe){ee.writelen=de,ee.writecb=oe,ee.writing=!0,ee.sync=!0,ee.destroyed?ee.onwrite(new R("write")):Y?W._writev(ae,ee.onwrite):W._write(ae,Q,ee.onwrite),ee.sync=!1}function z(W,ee,Y,de){--ee.pendingcb,de(Y),he(ee),I(W,Y)}function D(W,ee){let Y=W._writableState,de=Y.sync,ae=Y.writecb;if(typeof ae!="function"){I(W,new b);return}Y.writing=!1,Y.writecb=null,Y.length-=Y.writelen,Y.writelen=0,ee?(ee.stack,Y.errored||(Y.errored=ee),W._readableState&&!W._readableState.errored&&(W._readableState.errored=ee),de?s.nextTick(z,W,Y,ee,ae):z(W,Y,ee,ae)):(Y.buffered.length>Y.bufferedIndex&&ce(W,Y),de?Y.afterWriteTickInfo!==null&&Y.afterWriteTickInfo.cb===ae?Y.afterWriteTickInfo.count++:(Y.afterWriteTickInfo={count:1,cb:ae,stream:W,state:Y},s.nextTick(Z,Y.afterWriteTickInfo)):se(W,Y,1,ae))}function Z({stream:W,state:ee,count:Y,cb:de}){return ee.afterWriteTickInfo=null,se(W,ee,Y,de)}function se(W,ee,Y,de){for(!ee.ending&&!W.destroyed&&ee.length===0&&ee.needDrain&&(ee.needDrain=!1,W.emit("drain"));Y-- >0;)ee.pendingcb--,de();ee.destroyed&&he(ee),X(W,ee)}function he(W){if(W.writing)return;for(let ae=W.bufferedIndex;ae<W.buffered.length;++ae){var ee;let{chunk:Q,callback:oe}=W.buffered[ae],be=W.objectMode?1:Q.length;W.length-=be,oe((ee=W.errored)!==null&&ee!==void 0?ee:new R("write"))}let Y=W[V].splice(0);for(let ae=0;ae<Y.length;ae++){var de;Y[ae]((de=W.errored)!==null&&de!==void 0?de:new R("end"))}re(W)}function ce(W,ee){if(ee.corked||ee.bufferProcessing||ee.destroyed||!ee.constructed)return;let{buffered:Y,bufferedIndex:de,objectMode:ae}=ee,Q=Y.length-de;if(!Q)return;let oe=de;if(ee.bufferProcessing=!0,Q>1&&W._writev){ee.pendingcb-=Q-1;let be=ee.allNoop?P:Ee=>{for(let Te=oe;Te<Y.length;++Te)Y[Te].callback(Ee)},Se=ee.allNoop&&oe===0?Y:m(Y,oe);Se.allBuffers=ee.allBuffers,F(W,ee,!0,ee.length,Se,"",be),re(ee)}else{do{let{chunk:be,encoding:Se,callback:Ee}=Y[oe];Y[oe++]=null;let Te=ae?1:be.length;F(W,ee,!1,Te,be,Se,Ee)}while(oe<Y.length&&!ee.writing);oe===Y.length?re(ee):oe>256?(Y.splice(0,oe),ee.bufferedIndex=0):ee.bufferedIndex=oe}ee.bufferProcessing=!1}J.prototype._write=function(W,ee,Y){if(this._writev)this._writev([{chunk:W,encoding:ee}],Y);else throw new y("_write()")},J.prototype._writev=null,J.prototype.end=function(W,ee,Y){let de=this._writableState;typeof W=="function"?(Y=W,W=null,ee=null):typeof ee=="function"&&(Y=ee,ee=null);let ae;if(W!=null){let Q=x(this,W,ee);Q instanceof w&&(ae=Q)}return de.corked&&(de.corked=1,this.uncork()),ae||(!de.errored&&!de.ending?(de.ending=!0,X(this,de,!0),de.ended=!0):de.finished?ae=new C("end"):de.destroyed&&(ae=new R("end"))),typeof Y=="function"&&(ae||de.finished?s.nextTick(Y,ae):de[V].push(Y)),this};function T(W){return W.ending&&!W.destroyed&&W.constructed&&W.length===0&&!W.errored&&W.buffered.length===0&&!W.finished&&!W.writing&&!W.errorEmitted&&!W.closeEmitted}function B(W,ee){let Y=!1;function de(ae){if(Y){I(W,ae??b());return}if(Y=!0,ee.pendingcb--,ae){let Q=ee[V].splice(0);for(let oe=0;oe<Q.length;oe++)Q[oe](ae);I(W,ae,ee.sync)}else T(ee)&&(ee.prefinished=!0,W.emit("prefinish"),ee.pendingcb++,s.nextTick(ie,W,ee))}ee.sync=!0,ee.pendingcb++;try{W._final(de)}catch(ae){de(ae)}ee.sync=!1}function q(W,ee){!ee.prefinished&&!ee.finalCalled&&(typeof W._final=="function"&&!ee.destroyed?(ee.finalCalled=!0,B(W,ee)):(ee.prefinished=!0,W.emit("prefinish")))}function X(W,ee,Y){T(ee)&&(q(W,ee),ee.pendingcb===0&&(Y?(ee.pendingcb++,s.nextTick((de,ae)=>{T(ae)?ie(de,ae):ae.pendingcb--},W,ee)):T(ee)&&(ee.pendingcb++,ie(W,ee))))}function ie(W,ee){ee.pendingcb--,ee.finished=!0;let Y=ee[V].splice(0);for(let de=0;de<Y.length;de++)Y[de]();if(W.emit("finish"),ee.autoDestroy){let de=W._readableState;(!de||de.autoDestroy&&(de.endEmitted||de.readable===!1))&&W.destroy()}}e(J.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(W){this._writableState&&(this._writableState.destroyed=W)}},writable:{__proto__:null,get(){let W=this._writableState;return!!W&&W.writable!==!1&&!W.destroyed&&!W.errored&&!W.ending&&!W.ended},set(W){this._writableState&&(this._writableState.writable=!!W)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let W=this._writableState;return W?!W.destroyed&&!W.ending&&W.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var te=g.destroy;J.prototype.destroy=function(W,ee){let Y=this._writableState;return!Y.destroyed&&(Y.bufferedIndex<Y.buffered.length||Y[V].length)&&s.nextTick(he,Y),te.call(this,W,ee),this},J.prototype._undestroy=g.undestroy,J.prototype._destroy=function(W,ee){ee(W)},J.prototype[h.captureRejectionSymbol]=function(W){this.destroy(W)};var le;function ue(){return le===void 0&&(le={}),le}J.fromWeb=function(W,ee){return ue().newStreamWritableFromWritableStream(W,ee)},J.toWeb=function(W){return ue().newWritableStreamFromStreamWritable(W)}}),_l=we((i,c)=>{pe(),ge(),_e();var s=er(),m=(et(),Pe(Ze)),{isReadable:w,isWritable:d,isIterable:n,isNodeStream:e,isReadableNodeStream:t,isWritableNodeStream:r,isDuplexNodeStream:a}=Lt(),o=Ut(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:_,ERR_INVALID_RETURN_VALUE:v}}=nt(),{destroyer:g}=ar(),l=Rt(),p=jr(),{createDeferredPromise:u}=kt(),f=lo(),y=globalThis.Blob||m.Blob,b=typeof y<"u"?function(N){return N instanceof y}:function(N){return!1},A=globalThis.AbortController||Ts().AbortController,{FunctionPrototypeCall:R}=Ke(),C=class extends l{constructor(N){super(N),(N==null?void 0:N.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(N==null?void 0:N.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};c.exports=function N(I,P){if(a(I))return I;if(t(I))return O({readable:I});if(r(I))return O({writable:I});if(e(I))return O({writable:!1,readable:!1});if(typeof I=="function"){let{value:G,write:re,final:J,destroy:x}=L(I);if(n(G))return f(C,G,{objectMode:!0,write:re,final:J,destroy:x});let U=G==null?void 0:G.then;if(typeof U=="function"){let F,z=R(U,G,D=>{if(D!=null)throw new v("nully","body",D)},D=>{g(F,D)});return F=new C({objectMode:!0,readable:!1,write:re,final(D){J(async()=>{try{await z,s.nextTick(D,null)}catch(Z){s.nextTick(D,Z)}})},destroy:x})}throw new v("Iterable, AsyncIterable or AsyncFunction",P,G)}if(b(I))return N(I.arrayBuffer());if(n(I))return f(C,I,{objectMode:!0,writable:!1});if(typeof(I==null?void 0:I.writable)=="object"||typeof(I==null?void 0:I.readable)=="object"){let G=I!=null&&I.readable?t(I==null?void 0:I.readable)?I==null?void 0:I.readable:N(I.readable):void 0,re=I!=null&&I.writable?r(I==null?void 0:I.writable)?I==null?void 0:I.writable:N(I.writable):void 0;return O({readable:G,writable:re})}let V=I==null?void 0:I.then;if(typeof V=="function"){let G;return R(V,I,re=>{re!=null&&G.push(re),G.push(null)},re=>{g(G,re)}),G=new C({objectMode:!0,writable:!1,read(){}})}throw new _(P,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],I)};function L(N){let{promise:I,resolve:P}=u(),V=new A,G=V.signal;return{value:N(async function*(){for(;;){let re=I;I=null;let{chunk:J,done:x,cb:U}=await re;if(s.nextTick(U),x)return;if(G.aborted)throw new h(void 0,{cause:G.reason});({promise:I,resolve:P}=u()),yield J}}(),{signal:G}),write(re,J,x){let U=P;P=null,U({chunk:re,done:!1,cb:x})},final(re){let J=P;P=null,J({done:!0,cb:re})},destroy(re,J){V.abort(),J(re)}}}function O(N){let I=N.readable&&typeof N.readable.read!="function"?p.wrap(N.readable):N.readable,P=N.writable,V=!!w(I),G=!!d(P),re,J,x,U,F;function z(D){let Z=U;U=null,Z?Z(D):D&&F.destroy(D)}return F=new C({readableObjectMode:!!(I!=null&&I.readableObjectMode),writableObjectMode:!!(P!=null&&P.writableObjectMode),readable:V,writable:G}),G&&(o(P,D=>{G=!1,D&&g(I,D),z(D)}),F._write=function(D,Z,se){P.write(D,Z)?se():re=se},F._final=function(D){P.end(),J=D},P.on("drain",function(){if(re){let D=re;re=null,D()}}),P.on("finish",function(){if(J){let D=J;J=null,D()}})),V&&(o(I,D=>{V=!1,D&&g(I,D),z(D)}),I.on("readable",function(){if(x){let D=x;x=null,D()}}),I.on("end",function(){F.push(null)}),F._read=function(){for(;;){let D=I.read();if(D===null){x=F._read;return}if(!F.push(D))return}}),F._destroy=function(D,Z){!D&&U!==null&&(D=new h),x=null,re=null,J=null,U===null?Z(D):(U=Z,g(P,D),g(I,D))},F}}),Rt=we((i,c)=>{pe(),ge(),_e();var{ObjectDefineProperties:s,ObjectGetOwnPropertyDescriptor:m,ObjectKeys:w,ObjectSetPrototypeOf:d}=Ke();c.exports=t;var n=jr(),e=ho();d(t.prototype,n.prototype),d(t,n);{let h=w(e.prototype);for(let _=0;_<h.length;_++){let v=h[_];t.prototype[v]||(t.prototype[v]=e.prototype[v])}}function t(h){if(!(this instanceof t))return new t(h);n.call(this,h),e.call(this,h),h?(this.allowHalfOpen=h.allowHalfOpen!==!1,h.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),h.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}s(t.prototype,{writable:{__proto__:null,...m(e.prototype,"writable")},writableHighWaterMark:{__proto__:null,...m(e.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...m(e.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...m(e.prototype,"writableBuffer")},writableLength:{__proto__:null,...m(e.prototype,"writableLength")},writableFinished:{__proto__:null,...m(e.prototype,"writableFinished")},writableCorked:{__proto__:null,...m(e.prototype,"writableCorked")},writableEnded:{__proto__:null,...m(e.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...m(e.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(h){this._readableState&&this._writableState&&(this._readableState.destroyed=h,this._writableState.destroyed=h)}}});var r;function a(){return r===void 0&&(r={}),r}t.fromWeb=function(h,_){return a().newStreamDuplexFromReadableWritablePair(h,_)},t.toWeb=function(h){return a().newReadableWritablePairFromDuplex(h)};var o;t.from=function(h){return o||(o=_l()),o(h,"body")}}),co=we((i,c)=>{pe(),ge(),_e();var{ObjectSetPrototypeOf:s,Symbol:m}=Ke();c.exports=t;var{ERR_METHOD_NOT_IMPLEMENTED:w}=nt().codes,d=Rt(),{getHighWaterMark:n}=Is();s(t.prototype,d.prototype),s(t,d);var e=m("kCallback");function t(o){if(!(this instanceof t))return new t(o);let h=o?n(this,o,"readableHighWaterMark",!0):null;h===0&&(o={...o,highWaterMark:null,readableHighWaterMark:h,writableHighWaterMark:o.writableHighWaterMark||0}),d.call(this,o),this._readableState.sync=!1,this[e]=null,o&&(typeof o.transform=="function"&&(this._transform=o.transform),typeof o.flush=="function"&&(this._flush=o.flush)),this.on("prefinish",a)}function r(o){typeof this._flush=="function"&&!this.destroyed?this._flush((h,_)=>{if(h){o?o(h):this.destroy(h);return}_!=null&&this.push(_),this.push(null),o&&o()}):(this.push(null),o&&o())}function a(){this._final!==r&&r.call(this)}t.prototype._final=r,t.prototype._transform=function(o,h,_){throw new w("_transform()")},t.prototype._write=function(o,h,_){let v=this._readableState,g=this._writableState,l=v.length;this._transform(o,h,(p,u)=>{if(p){_(p);return}u!=null&&this.push(u),g.ended||l===v.length||v.length<v.highWaterMark?_():this[e]=_})},t.prototype._read=function(){if(this[e]){let o=this[e];this[e]=null,o()}}}),uo=we((i,c)=>{pe(),ge(),_e();var{ObjectSetPrototypeOf:s}=Ke();c.exports=w;var m=co();s(w.prototype,m.prototype),s(w,m);function w(d){if(!(this instanceof w))return new w(d);m.call(this,d)}w.prototype._transform=function(d,n,e){e(null,d)}}),Os=we((i,c)=>{pe(),ge(),_e();var s=er(),{ArrayIsArray:m,Promise:w,SymbolAsyncIterator:d}=Ke(),n=Ut(),{once:e}=kt(),t=ar(),r=Rt(),{aggregateTwoErrors:a,codes:{ERR_INVALID_ARG_TYPE:o,ERR_INVALID_RETURN_VALUE:h,ERR_MISSING_ARGS:_,ERR_STREAM_DESTROYED:v,ERR_STREAM_PREMATURE_CLOSE:g},AbortError:l}=nt(),{validateFunction:p,validateAbortSignal:u}=Ur(),{isIterable:f,isReadable:y,isReadableNodeStream:b,isNodeStream:A,isTransformStream:R,isWebStream:C,isReadableStream:L,isReadableEnded:O}=Lt(),N=globalThis.AbortController||Ts().AbortController,I,P;function V(Z,se,he){let ce=!1;Z.on("close",()=>{ce=!0});let T=n(Z,{readable:se,writable:he},B=>{ce=!B});return{destroy:B=>{ce||(ce=!0,t.destroyer(Z,B||new v("pipe")))},cleanup:T}}function G(Z){return p(Z[Z.length-1],"streams[stream.length - 1]"),Z.pop()}function re(Z){if(f(Z))return Z;if(b(Z))return J(Z);throw new o("val",["Readable","Iterable","AsyncIterable"],Z)}async function*J(Z){P||(P=jr()),yield*P.prototype[d].call(Z)}async function x(Z,se,he,{end:ce}){let T,B=null,q=te=>{if(te&&(T=te),B){let le=B;B=null,le()}},X=()=>new w((te,le)=>{T?le(T):B=()=>{T?le(T):te()}});se.on("drain",q);let ie=n(se,{readable:!1},q);try{se.writableNeedDrain&&await X();for await(let te of Z)se.write(te)||await X();ce&&se.end(),await X(),he()}catch(te){he(T!==te?a(T,te):te)}finally{ie(),se.off("drain",q)}}async function U(Z,se,he,{end:ce}){R(se)&&(se=se.writable);let T=se.getWriter();try{for await(let B of Z)await T.ready,T.write(B).catch(()=>{});await T.ready,ce&&await T.close(),he()}catch(B){try{await T.abort(B),he(B)}catch(q){he(q)}}}function F(...Z){return z(Z,e(G(Z)))}function z(Z,se,he){if(Z.length===1&&m(Z[0])&&(Z=Z[0]),Z.length<2)throw new _("streams");let ce=new N,T=ce.signal,B=he==null?void 0:he.signal,q=[];u(B,"options.signal");function X(){ee(new l)}B==null||B.addEventListener("abort",X);let ie,te,le=[],ue=0;function W(Q){ee(Q,--ue===0)}function ee(Q,oe){if(Q&&(!ie||ie.code==="ERR_STREAM_PREMATURE_CLOSE")&&(ie=Q),!(!ie&&!oe)){for(;le.length;)le.shift()(ie);B==null||B.removeEventListener("abort",X),ce.abort(),oe&&(ie||q.forEach(be=>be()),s.nextTick(se,ie,te))}}let Y;for(let Q=0;Q<Z.length;Q++){let oe=Z[Q],be=Q<Z.length-1,Se=Q>0,Ee=be||(he==null?void 0:he.end)!==!1,Te=Q===Z.length-1;if(A(oe)){let E=function(S){S&&S.name!=="AbortError"&&S.code!=="ERR_STREAM_PREMATURE_CLOSE"&&W(S)};if(Ee){let{destroy:S,cleanup:k}=V(oe,be,Se);le.push(S),y(oe)&&Te&&q.push(k)}oe.on("error",E),y(oe)&&Te&&q.push(()=>{oe.removeListener("error",E)})}if(Q===0)if(typeof oe=="function"){if(Y=oe({signal:T}),!f(Y))throw new h("Iterable, AsyncIterable or Stream","source",Y)}else f(oe)||b(oe)||R(oe)?Y=oe:Y=r.from(oe);else if(typeof oe=="function"){if(R(Y)){var de;Y=re((de=Y)===null||de===void 0?void 0:de.readable)}else Y=re(Y);if(Y=oe(Y,{signal:T}),be){if(!f(Y,!0))throw new h("AsyncIterable",`transform[${Q-1}]`,Y)}else{var ae;I||(I=uo());let E=new I({objectMode:!0}),S=(ae=Y)===null||ae===void 0?void 0:ae.then;if(typeof S=="function")ue++,S.call(Y,$=>{te=$,$!=null&&E.write($),Ee&&E.end(),s.nextTick(W)},$=>{E.destroy($),s.nextTick(W,$)});else if(f(Y,!0))ue++,x(Y,E,W,{end:Ee});else if(L(Y)||R(Y)){let $=Y.readable||Y;ue++,x($,E,W,{end:Ee})}else throw new h("AsyncIterable or Promise","destination",Y);Y=E;let{destroy:k,cleanup:j}=V(Y,!1,!0);le.push(k),Te&&q.push(j)}}else if(A(oe)){if(b(Y)){ue+=2;let E=D(Y,oe,W,{end:Ee});y(oe)&&Te&&q.push(E)}else if(R(Y)||L(Y)){let E=Y.readable||Y;ue++,x(E,oe,W,{end:Ee})}else if(f(Y))ue++,x(Y,oe,W,{end:Ee});else throw new o("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],Y);Y=oe}else if(C(oe)){if(b(Y))ue++,U(re(Y),oe,W,{end:Ee});else if(L(Y)||f(Y))ue++,U(Y,oe,W,{end:Ee});else if(R(Y))ue++,U(Y.readable,oe,W,{end:Ee});else throw new o("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],Y);Y=oe}else Y=r.from(oe)}return(T!=null&&T.aborted||B!=null&&B.aborted)&&s.nextTick(X),Y}function D(Z,se,he,{end:ce}){let T=!1;if(se.on("close",()=>{T||he(new g)}),Z.pipe(se,{end:!1}),ce){let B=function(){T=!0,se.end()};O(Z)?s.nextTick(B):Z.once("end",B)}else he();return n(Z,{readable:!0,writable:!1},B=>{let q=Z._readableState;B&&B.code==="ERR_STREAM_PREMATURE_CLOSE"&&q&&q.ended&&!q.errored&&!q.errorEmitted?Z.once("end",he).once("error",he):he(B)}),n(se,{readable:!1,writable:!0},he)}c.exports={pipelineImpl:z,pipeline:F}}),fo=we((i,c)=>{pe(),ge(),_e();var{pipeline:s}=Os(),m=Rt(),{destroyer:w}=ar(),{isNodeStream:d,isReadable:n,isWritable:e,isWebStream:t,isTransformStream:r,isWritableStream:a,isReadableStream:o}=Lt(),{AbortError:h,codes:{ERR_INVALID_ARG_VALUE:_,ERR_MISSING_ARGS:v}}=nt(),g=Ut();c.exports=function(...l){if(l.length===0)throw new v("streams");if(l.length===1)return m.from(l[0]);let p=[...l];if(typeof l[0]=="function"&&(l[0]=m.from(l[0])),typeof l[l.length-1]=="function"){let I=l.length-1;l[I]=m.from(l[I])}for(let I=0;I<l.length;++I)if(!(!d(l[I])&&!t(l[I]))){if(I<l.length-1&&!(n(l[I])||o(l[I])||r(l[I])))throw new _(`streams[${I}]`,p[I],"must be readable");if(I>0&&!(e(l[I])||a(l[I])||r(l[I])))throw new _(`streams[${I}]`,p[I],"must be writable")}let u,f,y,b,A;function R(I){let P=b;b=null,P?P(I):I?A.destroy(I):!N&&!O&&A.destroy()}let C=l[0],L=s(l,R),O=!!(e(C)||a(C)||r(C)),N=!!(n(L)||o(L)||r(L));if(A=new m({writableObjectMode:!!(C!=null&&C.writableObjectMode),readableObjectMode:!!(L!=null&&L.writableObjectMode),writable:O,readable:N}),O){if(d(C))A._write=function(P,V,G){C.write(P,V)?G():u=G},A._final=function(P){C.end(),f=P},C.on("drain",function(){if(u){let P=u;u=null,P()}});else if(t(C)){let P=(r(C)?C.writable:C).getWriter();A._write=async function(V,G,re){try{await P.ready,P.write(V).catch(()=>{}),re()}catch(J){re(J)}},A._final=async function(V){try{await P.ready,P.close().catch(()=>{}),f=V}catch(G){V(G)}}}let I=r(L)?L.readable:L;g(I,()=>{if(f){let P=f;f=null,P()}})}if(N){if(d(L))L.on("readable",function(){if(y){let I=y;y=null,I()}}),L.on("end",function(){A.push(null)}),A._read=function(){for(;;){let I=L.read();if(I===null){y=A._read;return}if(!A.push(I))return}};else if(t(L)){let I=(r(L)?L.readable:L).getReader();A._read=async function(){for(;;)try{let{value:P,done:V}=await I.read();if(!A.push(P))return;if(V){A.push(null);return}}catch{return}}}}return A._destroy=function(I,P){!I&&b!==null&&(I=new h),y=null,u=null,f=null,b===null?P(I):(b=P,d(L)&&w(L,I))},A}}),gl=we((i,c)=>{pe(),ge(),_e();var s=globalThis.AbortController||Ts().AbortController,{codes:{ERR_INVALID_ARG_VALUE:m,ERR_INVALID_ARG_TYPE:w,ERR_MISSING_ARGS:d,ERR_OUT_OF_RANGE:n},AbortError:e}=nt(),{validateAbortSignal:t,validateInteger:r,validateObject:a}=Ur(),o=Ke().Symbol("kWeak"),{finished:h}=Ut(),_=fo(),{addAbortSignalNoValidate:v}=Fr(),{isWritable:g,isNodeStream:l}=Lt(),{ArrayPrototypePush:p,MathFloor:u,Number:f,NumberIsNaN:y,Promise:b,PromiseReject:A,PromisePrototypeThen:R,Symbol:C}=Ke(),L=C("kEmpty"),O=C("kEof");function N(ce,T){if(T!=null&&a(T,"options"),(T==null?void 0:T.signal)!=null&&t(T.signal,"options.signal"),l(ce)&&!g(ce))throw new m("stream",ce,"must be writable");let B=_(this,ce);return T!=null&&T.signal&&v(T.signal,B),B}function I(ce,T){if(typeof ce!="function")throw new w("fn",["Function","AsyncFunction"],ce);T!=null&&a(T,"options"),(T==null?void 0:T.signal)!=null&&t(T.signal,"options.signal");let B=1;return(T==null?void 0:T.concurrency)!=null&&(B=u(T.concurrency)),r(B,"concurrency",1),(async function*(){var q,X;let ie=new s,te=this,le=[],ue=ie.signal,W={signal:ue},ee=()=>ie.abort();T!=null&&(q=T.signal)!==null&&q!==void 0&&q.aborted&&ee(),T==null||(X=T.signal)===null||X===void 0||X.addEventListener("abort",ee);let Y,de,ae=!1;function Q(){ae=!0}async function oe(){try{for await(let Ee of te){var be;if(ae)return;if(ue.aborted)throw new e;try{Ee=ce(Ee,W)}catch(Te){Ee=A(Te)}Ee!==L&&(typeof((be=Ee)===null||be===void 0?void 0:be.catch)=="function"&&Ee.catch(Q),le.push(Ee),Y&&(Y(),Y=null),!ae&&le.length&&le.length>=B&&await new b(Te=>{de=Te}))}le.push(O)}catch(Ee){let Te=A(Ee);R(Te,void 0,Q),le.push(Te)}finally{var Se;ae=!0,Y&&(Y(),Y=null),T==null||(Se=T.signal)===null||Se===void 0||Se.removeEventListener("abort",ee)}}oe();try{for(;;){for(;le.length>0;){let be=await le[0];if(be===O)return;if(ue.aborted)throw new e;be!==L&&(yield be),le.shift(),de&&(de(),de=null)}await new b(be=>{Y=be})}}finally{ie.abort(),ae=!0,de&&(de(),de=null)}}).call(this)}function P(ce=void 0){return ce!=null&&a(ce,"options"),(ce==null?void 0:ce.signal)!=null&&t(ce.signal,"options.signal"),(async function*(){let T=0;for await(let q of this){var B;if(ce!=null&&(B=ce.signal)!==null&&B!==void 0&&B.aborted)throw new e({cause:ce.signal.reason});yield[T++,q]}}).call(this)}async function V(ce,T=void 0){for await(let B of x.call(this,ce,T))return!0;return!1}async function G(ce,T=void 0){if(typeof ce!="function")throw new w("fn",["Function","AsyncFunction"],ce);return!await V.call(this,async(...B)=>!await ce(...B),T)}async function re(ce,T){for await(let B of x.call(this,ce,T))return B}async function J(ce,T){if(typeof ce!="function")throw new w("fn",["Function","AsyncFunction"],ce);async function B(q,X){return await ce(q,X),L}for await(let q of I.call(this,B,T));}function x(ce,T){if(typeof ce!="function")throw new w("fn",["Function","AsyncFunction"],ce);async function B(q,X){return await ce(q,X)?q:L}return I.call(this,B,T)}var U=class extends d{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function F(ce,T,B){var q;if(typeof ce!="function")throw new w("reducer",["Function","AsyncFunction"],ce);B!=null&&a(B,"options"),(B==null?void 0:B.signal)!=null&&t(B.signal,"options.signal");let X=arguments.length>1;if(B!=null&&(q=B.signal)!==null&&q!==void 0&&q.aborted){let W=new e(void 0,{cause:B.signal.reason});throw this.once("error",()=>{}),await h(this.destroy(W)),W}let ie=new s,te=ie.signal;if(B!=null&&B.signal){let W={once:!0,[o]:this};B.signal.addEventListener("abort",()=>ie.abort(),W)}let le=!1;try{for await(let W of this){var ue;if(le=!0,B!=null&&(ue=B.signal)!==null&&ue!==void 0&&ue.aborted)throw new e;X?T=await ce(T,W,{signal:te}):(T=W,X=!0)}if(!le&&!X)throw new U}finally{ie.abort()}return T}async function z(ce){ce!=null&&a(ce,"options"),(ce==null?void 0:ce.signal)!=null&&t(ce.signal,"options.signal");let T=[];for await(let q of this){var B;if(ce!=null&&(B=ce.signal)!==null&&B!==void 0&&B.aborted)throw new e(void 0,{cause:ce.signal.reason});p(T,q)}return T}function D(ce,T){let B=I.call(this,ce,T);return(async function*(){for await(let q of B)yield*q}).call(this)}function Z(ce){if(ce=f(ce),y(ce))return 0;if(ce<0)throw new n("number",">= 0",ce);return ce}function se(ce,T=void 0){return T!=null&&a(T,"options"),(T==null?void 0:T.signal)!=null&&t(T.signal,"options.signal"),ce=Z(ce),(async function*(){var B;if(T!=null&&(B=T.signal)!==null&&B!==void 0&&B.aborted)throw new e;for await(let X of this){var q;if(T!=null&&(q=T.signal)!==null&&q!==void 0&&q.aborted)throw new e;ce--<=0&&(yield X)}}).call(this)}function he(ce,T=void 0){return T!=null&&a(T,"options"),(T==null?void 0:T.signal)!=null&&t(T.signal,"options.signal"),ce=Z(ce),(async function*(){var B;if(T!=null&&(B=T.signal)!==null&&B!==void 0&&B.aborted)throw new e;for await(let X of this){var q;if(T!=null&&(q=T.signal)!==null&&q!==void 0&&q.aborted)throw new e;if(ce-- >0)yield X;else return}}).call(this)}c.exports.streamReturningOperators={asIndexedPairs:P,drop:se,filter:x,flatMap:D,map:I,take:he,compose:N},c.exports.promiseReturningOperators={every:G,forEach:J,reduce:F,toArray:z,some:V,find:re}}),po=we((i,c)=>{pe(),ge(),_e();var{ArrayPrototypePop:s,Promise:m}=Ke(),{isIterable:w,isNodeStream:d,isWebStream:n}=Lt(),{pipelineImpl:e}=Os(),{finished:t}=Ut();_o();function r(...a){return new m((o,h)=>{let _,v,g=a[a.length-1];if(g&&typeof g=="object"&&!d(g)&&!w(g)&&!n(g)){let l=s(a);_=l.signal,v=l.end}e(a,(l,p)=>{l?h(l):o(p)},{signal:_,end:v})})}c.exports={finished:t,pipeline:r}}),_o=we((i,c)=>{pe(),ge(),_e();var{Buffer:s}=(et(),Pe(Ze)),{ObjectDefineProperty:m,ObjectKeys:w,ReflectApply:d}=Ke(),{promisify:{custom:n}}=kt(),{streamReturningOperators:e,promiseReturningOperators:t}=gl(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:r}}=nt(),a=fo(),{pipeline:o}=Os(),{destroyer:h}=ar(),_=Ut(),v=po(),g=Lt(),l=c.exports=Ls().Stream;l.isDisturbed=g.isDisturbed,l.isErrored=g.isErrored,l.isReadable=g.isReadable,l.Readable=jr();for(let u of w(e)){let f=function(...b){if(new.target)throw r();return l.Readable.from(d(y,this,b))},y=e[u];m(f,"name",{__proto__:null,value:y.name}),m(f,"length",{__proto__:null,value:y.length}),m(l.Readable.prototype,u,{__proto__:null,value:f,enumerable:!1,configurable:!0,writable:!0})}for(let u of w(t)){let f=function(...b){if(new.target)throw r();return d(y,this,b)},y=t[u];m(f,"name",{__proto__:null,value:y.name}),m(f,"length",{__proto__:null,value:y.length}),m(l.Readable.prototype,u,{__proto__:null,value:f,enumerable:!1,configurable:!0,writable:!0})}l.Writable=ho(),l.Duplex=Rt(),l.Transform=co(),l.PassThrough=uo(),l.pipeline=o;var{addAbortSignal:p}=Fr();l.addAbortSignal=p,l.finished=_,l.destroy=h,l.compose=a,m(l,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return v}}),m(o,n,{__proto__:null,enumerable:!0,get(){return v.pipeline}}),m(_,n,{__proto__:null,enumerable:!0,get(){return v.finished}}),l.Stream=l,l._isUint8Array=function(u){return u instanceof Uint8Array},l._uint8ArrayToBuffer=function(u){return s.from(u.buffer,u.byteOffset,u.byteLength)}}),rr=we((i,c)=>{pe(),ge(),_e();var s=_o(),m=po(),w=s.Readable.destroy;c.exports=s.Readable,c.exports._uint8ArrayToBuffer=s._uint8ArrayToBuffer,c.exports._isUint8Array=s._isUint8Array,c.exports.isDisturbed=s.isDisturbed,c.exports.isErrored=s.isErrored,c.exports.isReadable=s.isReadable,c.exports.Readable=s.Readable,c.exports.Writable=s.Writable,c.exports.Duplex=s.Duplex,c.exports.Transform=s.Transform,c.exports.PassThrough=s.PassThrough,c.exports.addAbortSignal=s.addAbortSignal,c.exports.finished=s.finished,c.exports.destroy=s.destroy,c.exports.destroy=w,c.exports.pipeline=s.pipeline,c.exports.compose=s.compose,Object.defineProperty(s,"promises",{configurable:!0,enumerable:!0,get(){return m}}),c.exports.Stream=s.Stream,c.exports.default=c.exports}),vl=we((i,c)=>{pe(),ge(),_e(),typeof Object.create=="function"?c.exports=function(s,m){m&&(s.super_=m,s.prototype=Object.create(m.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}))}:c.exports=function(s,m){if(m){s.super_=m;var w=function(){};w.prototype=m.prototype,s.prototype=new w,s.prototype.constructor=s}}}),ml=we((i,c)=>{pe(),ge(),_e();var{Buffer:s}=(et(),Pe(Ze)),m=Symbol.for("BufferList");function w(d){if(!(this instanceof w))return new w(d);w._init.call(this,d)}w._init=function(d){Object.defineProperty(this,m,{value:!0}),this._bufs=[],this.length=0,d&&this.append(d)},w.prototype._new=function(d){return new w(d)},w.prototype._offset=function(d){if(d===0)return[0,0];let n=0;for(let e=0;e<this._bufs.length;e++){let t=n+this._bufs[e].length;if(d<t||e===this._bufs.length-1)return[e,d-n];n=t}},w.prototype._reverseOffset=function(d){let n=d[0],e=d[1];for(let t=0;t<n;t++)e+=this._bufs[t].length;return e},w.prototype.get=function(d){if(d>this.length||d<0)return;let n=this._offset(d);return this._bufs[n[0]][n[1]]},w.prototype.slice=function(d,n){return typeof d=="number"&&d<0&&(d+=this.length),typeof n=="number"&&n<0&&(n+=this.length),this.copy(null,0,d,n)},w.prototype.copy=function(d,n,e,t){if((typeof e!="number"||e<0)&&(e=0),(typeof t!="number"||t>this.length)&&(t=this.length),e>=this.length||t<=0)return d||s.alloc(0);let r=!!d,a=this._offset(e),o=t-e,h=o,_=r&&n||0,v=a[1];if(e===0&&t===this.length){if(!r)return this._bufs.length===1?this._bufs[0]:s.concat(this._bufs,this.length);for(let g=0;g<this._bufs.length;g++)this._bufs[g].copy(d,_),_+=this._bufs[g].length;return d}if(h<=this._bufs[a[0]].length-v)return r?this._bufs[a[0]].copy(d,n,v,v+h):this._bufs[a[0]].slice(v,v+h);r||(d=s.allocUnsafe(o));for(let g=a[0];g<this._bufs.length;g++){let l=this._bufs[g].length-v;if(h>l)this._bufs[g].copy(d,_,v),_+=l;else{this._bufs[g].copy(d,_,v,v+h),_+=l;break}h-=l,v&&(v=0)}return d.length>_?d.slice(0,_):d},w.prototype.shallowSlice=function(d,n){if(d=d||0,n=typeof n!="number"?this.length:n,d<0&&(d+=this.length),n<0&&(n+=this.length),d===n)return this._new();let e=this._offset(d),t=this._offset(n),r=this._bufs.slice(e[0],t[0]+1);return t[1]===0?r.pop():r[r.length-1]=r[r.length-1].slice(0,t[1]),e[1]!==0&&(r[0]=r[0].slice(e[1])),this._new(r)},w.prototype.toString=function(d,n,e){return this.slice(n,e).toString(d)},w.prototype.consume=function(d){if(d=Math.trunc(d),Number.isNaN(d)||d<=0)return this;for(;this._bufs.length;)if(d>=this._bufs[0].length)d-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(d),this.length-=d;break}return this},w.prototype.duplicate=function(){let d=this._new();for(let n=0;n<this._bufs.length;n++)d.append(this._bufs[n]);return d},w.prototype.append=function(d){if(d==null)return this;if(d.buffer)this._appendBuffer(s.from(d.buffer,d.byteOffset,d.byteLength));else if(Array.isArray(d))for(let n=0;n<d.length;n++)this.append(d[n]);else if(this._isBufferList(d))for(let n=0;n<d._bufs.length;n++)this.append(d._bufs[n]);else typeof d=="number"&&(d=d.toString()),this._appendBuffer(s.from(d));return this},w.prototype._appendBuffer=function(d){this._bufs.push(d),this.length+=d.length},w.prototype.indexOf=function(d,n,e){if(e===void 0&&typeof n=="string"&&(e=n,n=void 0),typeof d=="function"||Array.isArray(d))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof d=="number"?d=s.from([d]):typeof d=="string"?d=s.from(d,e):this._isBufferList(d)?d=d.slice():Array.isArray(d.buffer)?d=s.from(d.buffer,d.byteOffset,d.byteLength):s.isBuffer(d)||(d=s.from(d)),n=Number(n||0),isNaN(n)&&(n=0),n<0&&(n=this.length+n),n<0&&(n=0),d.length===0)return n>this.length?this.length:n;let t=this._offset(n),r=t[0],a=t[1];for(;r<this._bufs.length;r++){let o=this._bufs[r];for(;a<o.length;)if(o.length-a>=d.length){let h=o.indexOf(d,a);if(h!==-1)return this._reverseOffset([r,h]);a=o.length-d.length+1}else{let h=this._reverseOffset([r,a]);if(this._match(h,d))return h;a++}a=0}return-1},w.prototype._match=function(d,n){if(this.length-d<n.length)return!1;for(let e=0;e<n.length;e++)if(this.get(d+e)!==n[e])return!1;return!0},function(){let d={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readBigInt64BE:8,readBigInt64LE:8,readBigUInt64BE:8,readBigUInt64LE:8,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let n in d)(function(e){d[e]===null?w.prototype[e]=function(t,r){return this.slice(t,t+r)[e](0,r)}:w.prototype[e]=function(t=0){return this.slice(t,t+d[e])[e](0)}})(n)}(),w.prototype._isBufferList=function(d){return d instanceof w||w.isBufferList(d)},w.isBufferList=function(d){return d!=null&&d[m]},c.exports=w}),bl=we((i,c)=>{pe(),ge(),_e();var s=rr().Duplex,m=vl(),w=ml();function d(n){if(!(this instanceof d))return new d(n);if(typeof n=="function"){this._callback=n;let e=(function(t){this._callback&&(this._callback(t),this._callback=null)}).bind(this);this.on("pipe",function(t){t.on("error",e)}),this.on("unpipe",function(t){t.removeListener("error",e)}),n=null}w._init.call(this,n),s.call(this)}m(d,s),Object.assign(d.prototype,w.prototype),d.prototype._new=function(n){return new d(n)},d.prototype._write=function(n,e,t){this._appendBuffer(n),typeof t=="function"&&t()},d.prototype._read=function(n){if(!this.length)return this.push(null);n=Math.min(n,this.length),this.push(this.slice(0,n)),this.consume(n)},d.prototype.end=function(n){s.prototype.end.call(this,n),this._callback&&(this._callback(null,this.slice()),this._callback=null)},d.prototype._destroy=function(n,e){this._bufs.length=0,this.length=0,e(n)},d.prototype._isBufferList=function(n){return n instanceof d||n instanceof w||d.isBufferList(n)},d.isBufferList=w.isBufferList,c.exports=d,c.exports.BufferListStream=d,c.exports.BufferList=w}),yl=we((i,c)=>{pe(),ge(),_e();var s=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}};c.exports=s}),go=we((i,c)=>{pe(),ge(),_e();var s=c.exports,{Buffer:m}=(et(),Pe(Ze));s.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},s.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0},s.requiredHeaderFlagsErrors={};for(let d in s.requiredHeaderFlags){let n=s.requiredHeaderFlags[d];s.requiredHeaderFlagsErrors[d]="Invalid header flag bits, must be 0x"+n.toString(16)+" for "+s.types[d]+" packet"}s.codes={};for(let d in s.types){let n=s.types[d];s.codes[n]=d}s.CMD_SHIFT=4,s.CMD_MASK=240,s.DUP_MASK=8,s.QOS_MASK=3,s.QOS_SHIFT=1,s.RETAIN_MASK=1,s.VARBYTEINT_MASK=127,s.VARBYTEINT_FIN_MASK=128,s.VARBYTEINT_MAX=268435455,s.SESSIONPRESENT_MASK=1,s.SESSIONPRESENT_HEADER=m.from([s.SESSIONPRESENT_MASK]),s.CONNACK_HEADER=m.from([s.codes.connack<<s.CMD_SHIFT]),s.USERNAME_MASK=128,s.PASSWORD_MASK=64,s.WILL_RETAIN_MASK=32,s.WILL_QOS_MASK=24,s.WILL_QOS_SHIFT=3,s.WILL_FLAG_MASK=4,s.CLEAN_SESSION_MASK=2,s.CONNECT_HEADER=m.from([s.codes.connect<<s.CMD_SHIFT]),s.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},s.propertiesCodes={};for(let d in s.properties){let n=s.properties[d];s.propertiesCodes[n]=d}s.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"};function w(d){return[0,1,2].map(n=>[0,1].map(e=>[0,1].map(t=>{let r=m.alloc(1);return r.writeUInt8(s.codes[d]<<s.CMD_SHIFT|(e?s.DUP_MASK:0)|n<<s.QOS_SHIFT|t,0,!0),r})))}s.PUBLISH_HEADER=w("publish"),s.SUBSCRIBE_HEADER=w("subscribe"),s.SUBSCRIBE_OPTIONS_QOS_MASK=3,s.SUBSCRIBE_OPTIONS_NL_MASK=1,s.SUBSCRIBE_OPTIONS_NL_SHIFT=2,s.SUBSCRIBE_OPTIONS_RAP_MASK=1,s.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,s.SUBSCRIBE_OPTIONS_RH_MASK=3,s.SUBSCRIBE_OPTIONS_RH_SHIFT=4,s.SUBSCRIBE_OPTIONS_RH=[0,16,32],s.SUBSCRIBE_OPTIONS_NL=4,s.SUBSCRIBE_OPTIONS_RAP=8,s.SUBSCRIBE_OPTIONS_QOS=[0,1,2],s.UNSUBSCRIBE_HEADER=w("unsubscribe"),s.ACKS={unsuback:w("unsuback"),puback:w("puback"),pubcomp:w("pubcomp"),pubrel:w("pubrel"),pubrec:w("pubrec")},s.SUBACK_HEADER=m.from([s.codes.suback<<s.CMD_SHIFT]),s.VERSION3=m.from([3]),s.VERSION4=m.from([4]),s.VERSION5=m.from([5]),s.VERSION131=m.from([131]),s.VERSION132=m.from([132]),s.QOS=[0,1,2].map(d=>m.from([d])),s.EMPTY={pingreq:m.from([s.codes.pingreq<<4,0]),pingresp:m.from([s.codes.pingresp<<4,0]),disconnect:m.from([s.codes.disconnect<<4,0])},s.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"},s.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"},s.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},s.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"},s.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},s.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}}),wl=we((i,c)=>{pe(),ge(),_e();var s=1e3,m=s*60,w=m*60,d=w*24,n=d*7,e=d*365.25;c.exports=function(h,_){_=_||{};var v=typeof h;if(v==="string"&&h.length>0)return t(h);if(v==="number"&&isFinite(h))return _.long?a(h):r(h);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))};function t(h){if(h=String(h),!(h.length>100)){var _=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(h);if(_){var v=parseFloat(_[1]),g=(_[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return v*e;case"weeks":case"week":case"w":return v*n;case"days":case"day":case"d":return v*d;case"hours":case"hour":case"hrs":case"hr":case"h":return v*w;case"minutes":case"minute":case"mins":case"min":case"m":return v*m;case"seconds":case"second":case"secs":case"sec":case"s":return v*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return v;default:return}}}}function r(h){var _=Math.abs(h);return _>=d?Math.round(h/d)+"d":_>=w?Math.round(h/w)+"h":_>=m?Math.round(h/m)+"m":_>=s?Math.round(h/s)+"s":h+"ms"}function a(h){var _=Math.abs(h);return _>=d?o(h,_,d,"day"):_>=w?o(h,_,w,"hour"):_>=m?o(h,_,m,"minute"):_>=s?o(h,_,s,"second"):h+" ms"}function o(h,_,v,g){var l=_>=v*1.5;return Math.round(h/v)+" "+g+(l?"s":"")}}),Sl=we((i,c)=>{pe(),ge(),_e();function s(m){d.debug=d,d.default=d,d.coerce=o,d.disable=t,d.enable=e,d.enabled=r,d.humanize=wl(),d.destroy=h,Object.keys(m).forEach(_=>{d[_]=m[_]}),d.names=[],d.skips=[],d.formatters={};function w(_){let v=0;for(let g=0;g<_.length;g++)v=(v<<5)-v+_.charCodeAt(g),v|=0;return d.colors[Math.abs(v)%d.colors.length]}d.selectColor=w;function d(_){let v,g=null,l,p;function u(...f){if(!u.enabled)return;let y=u,b=Number(new Date),A=b-(v||b);y.diff=A,y.prev=v,y.curr=b,v=b,f[0]=d.coerce(f[0]),typeof f[0]!="string"&&f.unshift("%O");let R=0;f[0]=f[0].replace(/%([a-zA-Z%])/g,(C,L)=>{if(C==="%%")return"%";R++;let O=d.formatters[L];if(typeof O=="function"){let N=f[R];C=O.call(y,N),f.splice(R,1),R--}return C}),d.formatArgs.call(y,f),(y.log||d.log).apply(y,f)}return u.namespace=_,u.useColors=d.useColors(),u.color=d.selectColor(_),u.extend=n,u.destroy=d.destroy,Object.defineProperty(u,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(l!==d.namespaces&&(l=d.namespaces,p=d.enabled(_)),p),set:f=>{g=f}}),typeof d.init=="function"&&d.init(u),u}function n(_,v){let g=d(this.namespace+(typeof v>"u"?":":v)+_);return g.log=this.log,g}function e(_){d.save(_),d.namespaces=_,d.names=[],d.skips=[];let v,g=(typeof _=="string"?_:"").split(/[\s,]+/),l=g.length;for(v=0;v<l;v++)g[v]&&(_=g[v].replace(/\*/g,".*?"),_[0]==="-"?d.skips.push(new RegExp("^"+_.slice(1)+"$")):d.names.push(new RegExp("^"+_+"$")))}function t(){let _=[...d.names.map(a),...d.skips.map(a).map(v=>"-"+v)].join(",");return d.enable(""),_}function r(_){if(_[_.length-1]==="*")return!0;let v,g;for(v=0,g=d.skips.length;v<g;v++)if(d.skips[v].test(_))return!1;for(v=0,g=d.names.length;v<g;v++)if(d.names[v].test(_))return!0;return!1}function a(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}function o(_){return _ instanceof Error?_.stack||_.message:_}function h(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return d.enable(d.load()),d}c.exports=s}),Tt=we((i,c)=>{pe(),ge(),_e(),i.formatArgs=m,i.save=w,i.load=d,i.useColors=s,i.storage=n(),i.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function s(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function m(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+c.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let a=0,o=0;t[0].replace(/%[a-zA-Z%]/g,h=>{h!=="%%"&&(a++,h==="%c"&&(o=a))}),t.splice(o,0,r)}i.log=console.debug||console.log||(()=>{});function w(t){try{t?i.storage.setItem("debug",t):i.storage.removeItem("debug")}catch{}}function d(){let t;try{t=i.storage.getItem("debug")}catch{}return!t&&typeof Ve<"u"&&"env"in Ve&&(t=Ve.env.DEBUG),t}function n(){try{return localStorage}catch{}}c.exports=Sl()(i);var{formatters:e}=c.exports;e.j=function(t){try{return JSON.stringify(t)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}}),Cl=we((i,c)=>{pe(),ge(),_e();var s=bl(),{EventEmitter:m}=(lr(),Pe(tr)),w=yl(),d=go(),n=Tt()("mqtt-packet:parser"),e=class fs extends m{constructor(){super(),this.parser=this.constructor.parser}static parser(r){return this instanceof fs?(this.settings=r||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):new fs().parser(r)}_resetState(){n("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new w,this.error=null,this._list=s(),this._stateCounter=0}parse(r){for(this.error&&this._resetState(),this._list.append(r),n("parse: current state: %s",this._states[this._stateCounter]);(this.packet.length!==-1||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,n("parse: state complete. _stateCounter is now: %d",this._stateCounter),n("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return n("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){let r=this._list.readUInt8(0),a=r>>d.CMD_SHIFT;this.packet.cmd=d.types[a];let o=r&15,h=d.requiredHeaderFlags[a];return h!=null&&o!==h?this._emitError(new Error(d.requiredHeaderFlagsErrors[a])):(this.packet.retain=(r&d.RETAIN_MASK)!==0,this.packet.qos=r>>d.QOS_SHIFT&d.QOS_MASK,this.packet.qos>2?this._emitError(new Error("Packet must not have both QoS bits set to 1")):(this.packet.dup=(r&d.DUP_MASK)!==0,n("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0))}_parseLength(){let r=this._parseVarByteNum(!0);return r&&(this.packet.length=r.value,this._list.consume(r.bytes)),n("_parseLength %d",r.value),!!r}_parsePayload(){n("_parsePayload: payload %O",this._list);let r=!1;if(this.packet.length===0||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}r=!0}return n("_parsePayload complete result: %s",r),r}_parseConnect(){n("_parseConnect");let r,a,o,h,_={},v=this.packet,g=this._parseString();if(g===null)return this._emitError(new Error("Cannot parse protocolId"));if(g!=="MQTT"&&g!=="MQIsdp")return this._emitError(new Error("Invalid protocolId"));if(v.protocolId=g,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(v.protocolVersion=this._list.readUInt8(this._pos),v.protocolVersion>=128&&(v.bridgeMode=!0,v.protocolVersion=v.protocolVersion-128),v.protocolVersion!==3&&v.protocolVersion!==4&&v.protocolVersion!==5)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(this._list.readUInt8(this._pos)&1)return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"));_.username=this._list.readUInt8(this._pos)&d.USERNAME_MASK,_.password=this._list.readUInt8(this._pos)&d.PASSWORD_MASK,_.will=this._list.readUInt8(this._pos)&d.WILL_FLAG_MASK;let l=!!(this._list.readUInt8(this._pos)&d.WILL_RETAIN_MASK),p=(this._list.readUInt8(this._pos)&d.WILL_QOS_MASK)>>d.WILL_QOS_SHIFT;if(_.will)v.will={},v.will.retain=l,v.will.qos=p;else{if(l)return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"));if(p)return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}if(v.clean=(this._list.readUInt8(this._pos)&d.CLEAN_SESSION_MASK)!==0,this._pos++,v.keepalive=this._parseNum(),v.keepalive===-1)return this._emitError(new Error("Packet too short"));if(v.protocolVersion===5){let f=this._parseProperties();Object.getOwnPropertyNames(f).length&&(v.properties=f)}let u=this._parseString();if(u===null)return this._emitError(new Error("Packet too short"));if(v.clientId=u,n("_parseConnect: packet.clientId: %s",v.clientId),_.will){if(v.protocolVersion===5){let f=this._parseProperties();Object.getOwnPropertyNames(f).length&&(v.will.properties=f)}if(r=this._parseString(),r===null)return this._emitError(new Error("Cannot parse will topic"));if(v.will.topic=r,n("_parseConnect: packet.will.topic: %s",v.will.topic),a=this._parseBuffer(),a===null)return this._emitError(new Error("Cannot parse will payload"));v.will.payload=a,n("_parseConnect: packet.will.paylaod: %s",v.will.payload)}if(_.username){if(h=this._parseString(),h===null)return this._emitError(new Error("Cannot parse username"));v.username=h,n("_parseConnect: packet.username: %s",v.username)}if(_.password){if(o=this._parseBuffer(),o===null)return this._emitError(new Error("Cannot parse password"));v.password=o}return this.settings=v,n("_parseConnect: complete"),v}_parseConnack(){n("_parseConnack");let r=this.packet;if(this._list.length<1)return null;let a=this._list.readUInt8(this._pos++);if(a>1)return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"));if(r.sessionPresent=!!(a&d.SESSIONPRESENT_MASK),this.settings.protocolVersion===5)this._list.length>=2?r.reasonCode=this._list.readUInt8(this._pos++):r.reasonCode=0;else{if(this._list.length<2)return null;r.returnCode=this._list.readUInt8(this._pos++)}if(r.returnCode===-1||r.reasonCode===-1)return this._emitError(new Error("Cannot parse return code"));if(this.settings.protocolVersion===5){let o=this._parseProperties();Object.getOwnPropertyNames(o).length&&(r.properties=o)}n("_parseConnack: complete")}_parsePublish(){n("_parsePublish");let r=this.packet;if(r.topic=this._parseString(),r.topic===null)return this._emitError(new Error("Cannot parse topic"));if(!(r.qos>0&&!this._parseMessageId())){if(this.settings.protocolVersion===5){let a=this._parseProperties();Object.getOwnPropertyNames(a).length&&(r.properties=a)}r.payload=this._list.slice(this._pos,r.length),n("_parsePublish: payload from buffer list: %o",r.payload)}}_parseSubscribe(){n("_parseSubscribe");let r=this.packet,a,o,h,_,v,g,l;if(r.subscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let p=this._parseProperties();Object.getOwnPropertyNames(p).length&&(r.properties=p)}if(r.length<=0)return this._emitError(new Error("Malformed subscribe, no payload specified"));for(;this._pos<r.length;){if(a=this._parseString(),a===null)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=r.length)return this._emitError(new Error("Malformed Subscribe Payload"));if(o=this._parseByte(),this.settings.protocolVersion===5){if(o&192)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}else if(o&252)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"));if(h=o&d.SUBSCRIBE_OPTIONS_QOS_MASK,h>2)return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"));if(g=(o>>d.SUBSCRIBE_OPTIONS_NL_SHIFT&d.SUBSCRIBE_OPTIONS_NL_MASK)!==0,v=(o>>d.SUBSCRIBE_OPTIONS_RAP_SHIFT&d.SUBSCRIBE_OPTIONS_RAP_MASK)!==0,_=o>>d.SUBSCRIBE_OPTIONS_RH_SHIFT&d.SUBSCRIBE_OPTIONS_RH_MASK,_>2)return this._emitError(new Error("Invalid retain handling, must be <= 2"));l={topic:a,qos:h},this.settings.protocolVersion===5?(l.nl=g,l.rap=v,l.rh=_):this.settings.bridgeMode&&(l.rh=0,l.rap=!0,l.nl=!0),n("_parseSubscribe: push subscription `%s` to subscription",l),r.subscriptions.push(l)}}}_parseSuback(){n("_parseSuback");let r=this.packet;if(this.packet.granted=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let a=this._parseProperties();Object.getOwnPropertyNames(a).length&&(r.properties=a)}if(r.length<=0)return this._emitError(new Error("Malformed suback, no payload specified"));for(;this._pos<this.packet.length;){let a=this._list.readUInt8(this._pos++);if(this.settings.protocolVersion===5){if(!d.MQTT5_SUBACK_CODES[a])return this._emitError(new Error("Invalid suback code"))}else if(a>2&&a!==128)return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"));this.packet.granted.push(a)}}}_parseUnsubscribe(){n("_parseUnsubscribe");let r=this.packet;if(r.unsubscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let a=this._parseProperties();Object.getOwnPropertyNames(a).length&&(r.properties=a)}if(r.length<=0)return this._emitError(new Error("Malformed unsubscribe, no payload specified"));for(;this._pos<r.length;){let a=this._parseString();if(a===null)return this._emitError(new Error("Cannot parse topic"));n("_parseUnsubscribe: push topic `%s` to unsubscriptions",a),r.unsubscriptions.push(a)}}}_parseUnsuback(){n("_parseUnsuback");let r=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((this.settings.protocolVersion===3||this.settings.protocolVersion===4)&&r.length!==2)return this._emitError(new Error("Malformed unsuback, payload length must be 2"));if(r.length<=0)return this._emitError(new Error("Malformed unsuback, no payload specified"));if(this.settings.protocolVersion===5){let a=this._parseProperties();for(Object.getOwnPropertyNames(a).length&&(r.properties=a),r.granted=[];this._pos<this.packet.length;){let o=this._list.readUInt8(this._pos++);if(!d.MQTT5_UNSUBACK_CODES[o])return this._emitError(new Error("Invalid unsuback code"));this.packet.granted.push(o)}}}_parseConfirmation(){n("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);let r=this.packet;if(this._parseMessageId(),this.settings.protocolVersion===5){if(r.length>2){switch(r.reasonCode=this._parseByte(),this.packet.cmd){case"puback":case"pubrec":if(!d.MQTT5_PUBACK_PUBREC_CODES[r.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break;case"pubrel":case"pubcomp":if(!d.MQTT5_PUBREL_PUBCOMP_CODES[r.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break}n("_parseConfirmation: packet.reasonCode `%d`",r.reasonCode)}else r.reasonCode=0;if(r.length>3){let a=this._parseProperties();Object.getOwnPropertyNames(a).length&&(r.properties=a)}}return!0}_parseDisconnect(){let r=this.packet;if(n("_parseDisconnect"),this.settings.protocolVersion===5){this._list.length>0?(r.reasonCode=this._parseByte(),d.MQTT5_DISCONNECT_CODES[r.reasonCode]||this._emitError(new Error("Invalid disconnect reason code"))):r.reasonCode=0;let a=this._parseProperties();Object.getOwnPropertyNames(a).length&&(r.properties=a)}return n("_parseDisconnect result: true"),!0}_parseAuth(){n("_parseAuth");let r=this.packet;if(this.settings.protocolVersion!==5)return this._emitError(new Error("Not supported auth packet for this version MQTT"));if(r.reasonCode=this._parseByte(),!d.MQTT5_AUTH_CODES[r.reasonCode])return this._emitError(new Error("Invalid auth reason code"));let a=this._parseProperties();return Object.getOwnPropertyNames(a).length&&(r.properties=a),n("_parseAuth: result: true"),!0}_parseMessageId(){let r=this.packet;return r.messageId=this._parseNum(),r.messageId===null?(this._emitError(new Error("Cannot parse messageId")),!1):(n("_parseMessageId: packet.messageId %d",r.messageId),!0)}_parseString(r){let a=this._parseNum(),o=a+this._pos;if(a===-1||o>this._list.length||o>this.packet.length)return null;let h=this._list.toString("utf8",this._pos,o);return this._pos+=a,n("_parseString: result: %s",h),h}_parseStringPair(){return n("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){let r=this._parseNum(),a=r+this._pos;if(r===-1||a>this._list.length||a>this.packet.length)return null;let o=this._list.slice(this._pos,a);return this._pos+=r,n("_parseBuffer: result: %o",o),o}_parseNum(){if(this._list.length-this._pos<2)return-1;let r=this._list.readUInt16BE(this._pos);return this._pos+=2,n("_parseNum: result: %s",r),r}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;let r=this._list.readUInt32BE(this._pos);return this._pos+=4,n("_parse4ByteNum: result: %s",r),r}_parseVarByteNum(r){n("_parseVarByteNum");let a=4,o=0,h=1,_=0,v=!1,g,l=this._pos?this._pos:0;for(;o<a&&l+o<this._list.length;){if(g=this._list.readUInt8(l+o++),_+=h*(g&d.VARBYTEINT_MASK),h*=128,!(g&d.VARBYTEINT_FIN_MASK)){v=!0;break}if(this._list.length<=o)break}return!v&&o===a&&this._list.length>=o&&this._emitError(new Error("Invalid variable byte integer")),l&&(this._pos+=o),v?r?v={bytes:o,value:_}:v=_:v=!1,n("_parseVarByteNum: result: %o",v),v}_parseByte(){let r;return this._pos<this._list.length&&(r=this._list.readUInt8(this._pos),this._pos++),n("_parseByte: result: %o",r),r}_parseByType(r){switch(n("_parseByType: type: %s",r),r){case"byte":return this._parseByte()!==0;case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){n("_parseProperties");let r=this._parseVarByteNum(),a=this._pos+r,o={};for(;this._pos<a;){let h=this._parseByte();if(!h)return this._emitError(new Error("Cannot parse property code type")),!1;let _=d.propertiesCodes[h];if(!_)return this._emitError(new Error("Unknown property")),!1;if(_==="userProperties"){o[_]||(o[_]=Object.create(null));let v=this._parseByType(d.propertiesTypes[_]);if(o[_][v.name])if(Array.isArray(o[_][v.name]))o[_][v.name].push(v.value);else{let g=o[_][v.name];o[_][v.name]=[g],o[_][v.name].push(v.value)}else o[_][v.name]=v.value;continue}o[_]?Array.isArray(o[_])?o[_].push(this._parseByType(d.propertiesTypes[_])):(o[_]=[o[_]],o[_].push(this._parseByType(d.propertiesTypes[_]))):o[_]=this._parseByType(d.propertiesTypes[_])}return o}_newPacket(){return n("_newPacket"),this.packet&&(this._list.consume(this.packet.length),n("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),n("_newPacket: new packet"),this.packet=new w,this._pos=0,!0}_emitError(r){n("_emitError",r),this.error=r,this.emit("error",r)}};c.exports=e}),El=we((i,c)=>{pe(),ge(),_e();var{Buffer:s}=(et(),Pe(Ze)),m=65536,w={},d=s.isBuffer(s.from([1,2]).subarray(0,1));function n(a){let o=s.allocUnsafe(2);return o.writeUInt8(a>>8,0),o.writeUInt8(a&255,0+1),o}function e(){for(let a=0;a<m;a++)w[a]=n(a)}function t(a){let o=0,h=0,_=s.allocUnsafe(4);do o=a%128|0,a=a/128|0,a>0&&(o=o|128),_.writeUInt8(o,h++);while(a>0&&h<4);return a>0&&(h=0),d?_.subarray(0,h):_.slice(0,h)}function r(a){let o=s.allocUnsafe(4);return o.writeUInt32BE(a,0),o}c.exports={cache:w,generateCache:e,generateNumber:n,genBufVariableByteInt:t,generate4ByteBuffer:r}}),Al=we((i,c)=>{pe(),ge(),_e(),typeof Ve>"u"||!Ve.version||Ve.version.indexOf("v0.")===0||Ve.version.indexOf("v1.")===0&&Ve.version.indexOf("v1.8.")!==0?c.exports={nextTick:s}:c.exports=Ve;function s(m,w,d,n){if(typeof m!="function")throw new TypeError('"callback" argument must be a function');var e=arguments.length,t,r;switch(e){case 0:case 1:return Ve.nextTick(m);case 2:return Ve.nextTick(function(){m.call(null,w)});case 3:return Ve.nextTick(function(){m.call(null,w,d)});case 4:return Ve.nextTick(function(){m.call(null,w,d,n)});default:for(t=new Array(e-1),r=0;r<t.length;)t[r++]=arguments[r];return Ve.nextTick(function(){m.apply(null,t)})}}}),vo=we((i,c)=>{pe(),ge(),_e();var s=go(),{Buffer:m}=(et(),Pe(Ze)),w=m.allocUnsafe(0),d=m.from([0]),n=El(),e=Al().nextTick,t=Tt()("mqtt-packet:writeToStream"),r=n.cache,a=n.generateNumber,o=n.generateCache,h=n.genBufVariableByteInt,_=n.generate4ByteBuffer,v=J,g=!0;function l(T,B,q){switch(t("generate called"),B.cork&&(B.cork(),e(p,B)),g&&(g=!1,o()),t("generate: packet.cmd: %s",T.cmd),T.cmd){case"connect":return u(T,B);case"connack":return f(T,B,q);case"publish":return y(T,B,q);case"puback":case"pubrec":case"pubrel":case"pubcomp":return b(T,B,q);case"subscribe":return A(T,B,q);case"suback":return R(T,B,q);case"unsubscribe":return C(T,B,q);case"unsuback":return L(T,B,q);case"pingreq":case"pingresp":return O(T,B);case"disconnect":return N(T,B,q);case"auth":return I(T,B,q);default:return B.destroy(new Error("Unknown command")),!1}}Object.defineProperty(l,"cacheNumbers",{get(){return v===J},set(T){T?((!r||Object.keys(r).length===0)&&(g=!0),v=J):(g=!1,v=x)}});function p(T){T.uncork()}function u(T,B,q){let X=T||{},ie=X.protocolId||"MQTT",te=X.protocolVersion||4,le=X.will,ue=X.clean,W=X.keepalive||0,ee=X.clientId||"",Y=X.username,de=X.password,ae=X.properties;ue===void 0&&(ue=!0);let Q=0;if(!ie||typeof ie!="string"&&!m.isBuffer(ie))return B.destroy(new Error("Invalid protocolId")),!1;if(Q+=ie.length+2,te!==3&&te!==4&&te!==5)return B.destroy(new Error("Invalid protocol version")),!1;if(Q+=1,(typeof ee=="string"||m.isBuffer(ee))&&(ee||te>=4)&&(ee||ue))Q+=m.byteLength(ee)+2;else{if(te<4)return B.destroy(new Error("clientId must be supplied before 3.1.1")),!1;if(ue*1===0)return B.destroy(new Error("clientId must be given if cleanSession set to 0")),!1}if(typeof W!="number"||W<0||W>65535||W%1!==0)return B.destroy(new Error("Invalid keepalive")),!1;Q+=2,Q+=1;let oe,be;if(te===5){if(oe=z(B,ae),!oe)return!1;Q+=oe.length}if(le){if(typeof le!="object")return B.destroy(new Error("Invalid will")),!1;if(!le.topic||typeof le.topic!="string")return B.destroy(new Error("Invalid will topic")),!1;if(Q+=m.byteLength(le.topic)+2,Q+=2,le.payload)if(le.payload.length>=0)typeof le.payload=="string"?Q+=m.byteLength(le.payload):Q+=le.payload.length;else return B.destroy(new Error("Invalid will payload")),!1;if(be={},te===5){if(be=z(B,le.properties),!be)return!1;Q+=be.length}}let Se=!1;if(Y!=null)if(ce(Y))Se=!0,Q+=m.byteLength(Y)+2;else return B.destroy(new Error("Invalid username")),!1;if(de!=null){if(!Se)return B.destroy(new Error("Username is required to use password")),!1;if(ce(de))Q+=he(de)+2;else return B.destroy(new Error("Invalid password")),!1}B.write(s.CONNECT_HEADER),V(B,Q),F(B,ie),X.bridgeMode&&(te+=128),B.write(te===131?s.VERSION131:te===132?s.VERSION132:te===4?s.VERSION4:te===5?s.VERSION5:s.VERSION3);let Ee=0;return Ee|=Y!=null?s.USERNAME_MASK:0,Ee|=de!=null?s.PASSWORD_MASK:0,Ee|=le&&le.retain?s.WILL_RETAIN_MASK:0,Ee|=le&&le.qos?le.qos<<s.WILL_QOS_SHIFT:0,Ee|=le?s.WILL_FLAG_MASK:0,Ee|=ue?s.CLEAN_SESSION_MASK:0,B.write(m.from([Ee])),v(B,W),te===5&&oe.write(),F(B,ee),le&&(te===5&&be.write(),G(B,le.topic),F(B,le.payload)),Y!=null&&F(B,Y),de!=null&&F(B,de),!0}function f(T,B,q){let X=q?q.protocolVersion:4,ie=T||{},te=X===5?ie.reasonCode:ie.returnCode,le=ie.properties,ue=2;if(typeof te!="number")return B.destroy(new Error("Invalid return code")),!1;let W=null;if(X===5){if(W=z(B,le),!W)return!1;ue+=W.length}return B.write(s.CONNACK_HEADER),V(B,ue),B.write(ie.sessionPresent?s.SESSIONPRESENT_HEADER:d),B.write(m.from([te])),W==null||W.write(),!0}function y(T,B,q){t("publish: packet: %o",T);let X=q?q.protocolVersion:4,ie=T||{},te=ie.qos||0,le=ie.retain?s.RETAIN_MASK:0,ue=ie.topic,W=ie.payload||w,ee=ie.messageId,Y=ie.properties,de=0;if(typeof ue=="string")de+=m.byteLength(ue)+2;else if(m.isBuffer(ue))de+=ue.length+2;else return B.destroy(new Error("Invalid topic")),!1;if(m.isBuffer(W)?de+=W.length:de+=m.byteLength(W),te&&typeof ee!="number")return B.destroy(new Error("Invalid messageId")),!1;te&&(de+=2);let ae=null;if(X===5){if(ae=z(B,Y),!ae)return!1;de+=ae.length}return B.write(s.PUBLISH_HEADER[te][ie.dup?1:0][le?1:0]),V(B,de),v(B,he(ue)),B.write(ue),te>0&&v(B,ee),ae==null||ae.write(),t("publish: payload: %o",W),B.write(W)}function b(T,B,q){let X=q?q.protocolVersion:4,ie=T||{},te=ie.cmd||"puback",le=ie.messageId,ue=ie.dup&&te==="pubrel"?s.DUP_MASK:0,W=0,ee=ie.reasonCode,Y=ie.properties,de=X===5?3:2;if(te==="pubrel"&&(W=1),typeof le!="number")return B.destroy(new Error("Invalid messageId")),!1;let ae=null;if(X===5&&typeof Y=="object"){if(ae=D(B,Y,q,de),!ae)return!1;de+=ae.length}return B.write(s.ACKS[te][W][ue][0]),de===3&&(de+=ee!==0?1:-1),V(B,de),v(B,le),X===5&&de!==2&&B.write(m.from([ee])),ae!==null?ae.write():de===4&&B.write(m.from([0])),!0}function A(T,B,q){t("subscribe: packet: ");let X=q?q.protocolVersion:4,ie=T||{},te=ie.dup?s.DUP_MASK:0,le=ie.messageId,ue=ie.subscriptions,W=ie.properties,ee=0;if(typeof le!="number")return B.destroy(new Error("Invalid messageId")),!1;ee+=2;let Y=null;if(X===5){if(Y=z(B,W),!Y)return!1;ee+=Y.length}if(typeof ue=="object"&&ue.length)for(let ae=0;ae<ue.length;ae+=1){let Q=ue[ae].topic,oe=ue[ae].qos;if(typeof Q!="string")return B.destroy(new Error("Invalid subscriptions - invalid topic")),!1;if(typeof oe!="number")return B.destroy(new Error("Invalid subscriptions - invalid qos")),!1;if(X===5){if(typeof(ue[ae].nl||!1)!="boolean")return B.destroy(new Error("Invalid subscriptions - invalid No Local")),!1;if(typeof(ue[ae].rap||!1)!="boolean")return B.destroy(new Error("Invalid subscriptions - invalid Retain as Published")),!1;let be=ue[ae].rh||0;if(typeof be!="number"||be>2)return B.destroy(new Error("Invalid subscriptions - invalid Retain Handling")),!1}ee+=m.byteLength(Q)+2+1}else return B.destroy(new Error("Invalid subscriptions")),!1;t("subscribe: writing to stream: %o",s.SUBSCRIBE_HEADER),B.write(s.SUBSCRIBE_HEADER[1][te?1:0][0]),V(B,ee),v(B,le),Y!==null&&Y.write();let de=!0;for(let ae of ue){let Q=ae.topic,oe=ae.qos,be=+ae.nl,Se=+ae.rap,Ee=ae.rh,Te;G(B,Q),Te=s.SUBSCRIBE_OPTIONS_QOS[oe],X===5&&(Te|=be?s.SUBSCRIBE_OPTIONS_NL:0,Te|=Se?s.SUBSCRIBE_OPTIONS_RAP:0,Te|=Ee?s.SUBSCRIBE_OPTIONS_RH[Ee]:0),de=B.write(m.from([Te]))}return de}function R(T,B,q){let X=q?q.protocolVersion:4,ie=T||{},te=ie.messageId,le=ie.granted,ue=ie.properties,W=0;if(typeof te!="number")return B.destroy(new Error("Invalid messageId")),!1;if(W+=2,typeof le=="object"&&le.length)for(let Y=0;Y<le.length;Y+=1){if(typeof le[Y]!="number")return B.destroy(new Error("Invalid qos vector")),!1;W+=1}else return B.destroy(new Error("Invalid qos vector")),!1;let ee=null;if(X===5){if(ee=D(B,ue,q,W),!ee)return!1;W+=ee.length}return B.write(s.SUBACK_HEADER),V(B,W),v(B,te),ee!==null&&ee.write(),B.write(m.from(le))}function C(T,B,q){let X=q?q.protocolVersion:4,ie=T||{},te=ie.messageId,le=ie.dup?s.DUP_MASK:0,ue=ie.unsubscriptions,W=ie.properties,ee=0;if(typeof te!="number")return B.destroy(new Error("Invalid messageId")),!1;if(ee+=2,typeof ue=="object"&&ue.length)for(let ae=0;ae<ue.length;ae+=1){if(typeof ue[ae]!="string")return B.destroy(new Error("Invalid unsubscriptions")),!1;ee+=m.byteLength(ue[ae])+2}else return B.destroy(new Error("Invalid unsubscriptions")),!1;let Y=null;if(X===5){if(Y=z(B,W),!Y)return!1;ee+=Y.length}B.write(s.UNSUBSCRIBE_HEADER[1][le?1:0][0]),V(B,ee),v(B,te),Y!==null&&Y.write();let de=!0;for(let ae=0;ae<ue.length;ae++)de=G(B,ue[ae]);return de}function L(T,B,q){let X=q?q.protocolVersion:4,ie=T||{},te=ie.messageId,le=ie.dup?s.DUP_MASK:0,ue=ie.granted,W=ie.properties,ee=ie.cmd,Y=0,de=2;if(typeof te!="number")return B.destroy(new Error("Invalid messageId")),!1;if(X===5)if(typeof ue=="object"&&ue.length)for(let Q=0;Q<ue.length;Q+=1){if(typeof ue[Q]!="number")return B.destroy(new Error("Invalid qos vector")),!1;de+=1}else return B.destroy(new Error("Invalid qos vector")),!1;let ae=null;if(X===5){if(ae=D(B,W,q,de),!ae)return!1;de+=ae.length}return B.write(s.ACKS[ee][Y][le][0]),V(B,de),v(B,te),ae!==null&&ae.write(),X===5&&B.write(m.from(ue)),!0}function O(T,B,q){return B.write(s.EMPTY[T.cmd])}function N(T,B,q){let X=q?q.protocolVersion:4,ie=T||{},te=ie.reasonCode,le=ie.properties,ue=X===5?1:0,W=null;if(X===5){if(W=D(B,le,q,ue),!W)return!1;ue+=W.length}return B.write(m.from([s.codes.disconnect<<4])),V(B,ue),X===5&&B.write(m.from([te])),W!==null&&W.write(),!0}function I(T,B,q){let X=q?q.protocolVersion:4,ie=T||{},te=ie.reasonCode,le=ie.properties,ue=X===5?1:0;X!==5&&B.destroy(new Error("Invalid mqtt version for auth packet"));let W=D(B,le,q,ue);return W?(ue+=W.length,B.write(m.from([s.codes.auth<<4])),V(B,ue),B.write(m.from([te])),W!==null&&W.write(),!0):!1}var P={};function V(T,B){if(B>s.VARBYTEINT_MAX)return T.destroy(new Error(`Invalid variable byte integer: ${B}`)),!1;let q=P[B];return q||(q=h(B),B<16384&&(P[B]=q)),t("writeVarByteInt: writing to stream: %o",q),T.write(q)}function G(T,B){let q=m.byteLength(B);return v(T,q),t("writeString: %s",B),T.write(B,"utf8")}function re(T,B,q){G(T,B),G(T,q)}function J(T,B){return t("writeNumberCached: number: %d",B),t("writeNumberCached: %o",r[B]),T.write(r[B])}function x(T,B){let q=a(B);return t("writeNumberGenerated: %o",q),T.write(q)}function U(T,B){let q=_(B);return t("write4ByteNumber: %o",q),T.write(q)}function F(T,B){typeof B=="string"?G(T,B):B?(v(T,B.length),T.write(B)):v(T,0)}function z(T,B){if(typeof B!="object"||B.length!=null)return{length:1,write(){se(T,{},0)}};let q=0;function X(ie,te){let le=s.propertiesTypes[ie],ue=0;switch(le){case"byte":{if(typeof te!="boolean")return T.destroy(new Error(`Invalid ${ie}: ${te}`)),!1;ue+=1+1;break}case"int8":{if(typeof te!="number"||te<0||te>255)return T.destroy(new Error(`Invalid ${ie}: ${te}`)),!1;ue+=1+1;break}case"binary":{if(te&&te===null)return T.destroy(new Error(`Invalid ${ie}: ${te}`)),!1;ue+=1+m.byteLength(te)+2;break}case"int16":{if(typeof te!="number"||te<0||te>65535)return T.destroy(new Error(`Invalid ${ie}: ${te}`)),!1;ue+=1+2;break}case"int32":{if(typeof te!="number"||te<0||te>4294967295)return T.destroy(new Error(`Invalid ${ie}: ${te}`)),!1;ue+=1+4;break}case"var":{if(typeof te!="number"||te<0||te>268435455)return T.destroy(new Error(`Invalid ${ie}: ${te}`)),!1;ue+=1+m.byteLength(h(te));break}case"string":{if(typeof te!="string")return T.destroy(new Error(`Invalid ${ie}: ${te}`)),!1;ue+=1+2+m.byteLength(te.toString());break}case"pair":{if(typeof te!="object")return T.destroy(new Error(`Invalid ${ie}: ${te}`)),!1;ue+=Object.getOwnPropertyNames(te).reduce((W,ee)=>{let Y=te[ee];return Array.isArray(Y)?W+=Y.reduce((de,ae)=>(de+=1+2+m.byteLength(ee.toString())+2+m.byteLength(ae.toString()),de),0):W+=1+2+m.byteLength(ee.toString())+2+m.byteLength(te[ee].toString()),W},0);break}default:return T.destroy(new Error(`Invalid property ${ie}: ${te}`)),!1}return ue}if(B)for(let ie in B){let te=0,le=0,ue=B[ie];if(Array.isArray(ue))for(let W=0;W<ue.length;W++){if(le=X(ie,ue[W]),!le)return!1;te+=le}else{if(le=X(ie,ue),!le)return!1;te=le}if(!te)return!1;q+=te}return{length:m.byteLength(h(q))+q,write(){se(T,B,q)}}}function D(T,B,q,X){let ie=["reasonString","userProperties"],te=q&&q.properties&&q.properties.maximumPacketSize?q.properties.maximumPacketSize:0,le=z(T,B);if(te)for(;X+le.length>te;){let ue=ie.shift();if(ue&&B[ue])delete B[ue],le=z(T,B);else return!1}return le}function Z(T,B,q){switch(s.propertiesTypes[B]){case"byte":{T.write(m.from([s.properties[B]])),T.write(m.from([+q]));break}case"int8":{T.write(m.from([s.properties[B]])),T.write(m.from([q]));break}case"binary":{T.write(m.from([s.properties[B]])),F(T,q);break}case"int16":{T.write(m.from([s.properties[B]])),v(T,q);break}case"int32":{T.write(m.from([s.properties[B]])),U(T,q);break}case"var":{T.write(m.from([s.properties[B]])),V(T,q);break}case"string":{T.write(m.from([s.properties[B]])),G(T,q);break}case"pair":{Object.getOwnPropertyNames(q).forEach(X=>{let ie=q[X];Array.isArray(ie)?ie.forEach(te=>{T.write(m.from([s.properties[B]])),re(T,X.toString(),te.toString())}):(T.write(m.from([s.properties[B]])),re(T,X.toString(),ie.toString()))});break}default:return T.destroy(new Error(`Invalid property ${B} value: ${q}`)),!1}}function se(T,B,q){V(T,q);for(let X in B)if(Object.prototype.hasOwnProperty.call(B,X)&&B[X]!==null){let ie=B[X];if(Array.isArray(ie))for(let te=0;te<ie.length;te++)Z(T,X,ie[te]);else Z(T,X,ie)}}function he(T){return T?T instanceof m?T.length:m.byteLength(T):0}function ce(T){return typeof T=="string"||T instanceof m}c.exports=l}),kl=we((i,c)=>{pe(),ge(),_e();var s=vo(),{EventEmitter:m}=(lr(),Pe(tr)),{Buffer:w}=(et(),Pe(Ze));function d(e,t){let r=new n;return s(e,r,t),r.concat()}var n=class extends m{constructor(){super(),this._array=new Array(20),this._i=0}write(e){return this._array[this._i++]=e,!0}concat(){let e=0,t=new Array(this._array.length),r=this._array,a=0,o;for(o=0;o<r.length&&r[o]!==void 0;o++)typeof r[o]!="string"?t[o]=r[o].length:t[o]=w.byteLength(r[o]),e+=t[o];let h=w.allocUnsafe(e);for(o=0;o<r.length&&r[o]!==void 0;o++)typeof r[o]!="string"?(r[o].copy(h,a),a+=t[o]):(h.write(r[o],a),a+=t[o]);return h}destroy(e){e&&this.emit("error",e)}};c.exports=d}),Rl=we(i=>{pe(),ge(),_e(),i.parser=Cl().parser,i.generate=kl(),i.writeToStream=vo()}),mo=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=class{constructor(){this.nextId=Math.max(1,Math.floor(Math.random()*65535))}allocate(){let s=this.nextId++;return this.nextId===65536&&(this.nextId=1),s}getLastAllocated(){return this.nextId===1?65535:this.nextId-1}register(s){return!0}deallocate(s){}clear(){}};i.default=c}),Tl=we((i,c)=>{pe(),ge(),_e(),c.exports=m;function s(d){return d instanceof or?or.from(d):new d.constructor(d.buffer.slice(),d.byteOffset,d.length)}function m(d){if(d=d||{},d.circles)return w(d);return d.proto?t:e;function n(r,a){for(var o=Object.keys(r),h=new Array(o.length),_=0;_<o.length;_++){var v=o[_],g=r[v];typeof g!="object"||g===null?h[v]=g:g instanceof Date?h[v]=new Date(g):ArrayBuffer.isView(g)?h[v]=s(g):h[v]=a(g)}return h}function e(r){if(typeof r!="object"||r===null)return r;if(r instanceof Date)return new Date(r);if(Array.isArray(r))return n(r,e);if(r instanceof Map)return new Map(n(Array.from(r),e));if(r instanceof Set)return new Set(n(Array.from(r),e));var a={};for(var o in r)if(Object.hasOwnProperty.call(r,o)!==!1){var h=r[o];typeof h!="object"||h===null?a[o]=h:h instanceof Date?a[o]=new Date(h):h instanceof Map?a[o]=new Map(n(Array.from(h),e)):h instanceof Set?a[o]=new Set(n(Array.from(h),e)):ArrayBuffer.isView(h)?a[o]=s(h):a[o]=e(h)}return a}function t(r){if(typeof r!="object"||r===null)return r;if(r instanceof Date)return new Date(r);if(Array.isArray(r))return n(r,t);if(r instanceof Map)return new Map(n(Array.from(r),t));if(r instanceof Set)return new Set(n(Array.from(r),t));var a={};for(var o in r){var h=r[o];typeof h!="object"||h===null?a[o]=h:h instanceof Date?a[o]=new Date(h):h instanceof Map?a[o]=new Map(n(Array.from(h),t)):h instanceof Set?a[o]=new Set(n(Array.from(h),t)):ArrayBuffer.isView(h)?a[o]=s(h):a[o]=t(h)}return a}}function w(d){var n=[],e=[];return d.proto?a:r;function t(o,h){for(var _=Object.keys(o),v=new Array(_.length),g=0;g<_.length;g++){var l=_[g],p=o[l];if(typeof p!="object"||p===null)v[l]=p;else if(p instanceof Date)v[l]=new Date(p);else if(ArrayBuffer.isView(p))v[l]=s(p);else{var u=n.indexOf(p);u!==-1?v[l]=e[u]:v[l]=h(p)}}return v}function r(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return t(o,r);if(o instanceof Map)return new Map(t(Array.from(o),r));if(o instanceof Set)return new Set(t(Array.from(o),r));var h={};n.push(o),e.push(h);for(var _ in o)if(Object.hasOwnProperty.call(o,_)!==!1){var v=o[_];if(typeof v!="object"||v===null)h[_]=v;else if(v instanceof Date)h[_]=new Date(v);else if(v instanceof Map)h[_]=new Map(t(Array.from(v),r));else if(v instanceof Set)h[_]=new Set(t(Array.from(v),r));else if(ArrayBuffer.isView(v))h[_]=s(v);else{var g=n.indexOf(v);g!==-1?h[_]=e[g]:h[_]=r(v)}}return n.pop(),e.pop(),h}function a(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return t(o,a);if(o instanceof Map)return new Map(t(Array.from(o),a));if(o instanceof Set)return new Set(t(Array.from(o),a));var h={};n.push(o),e.push(h);for(var _ in o){var v=o[_];if(typeof v!="object"||v===null)h[_]=v;else if(v instanceof Date)h[_]=new Date(v);else if(v instanceof Map)h[_]=new Map(t(Array.from(v),a));else if(v instanceof Set)h[_]=new Set(t(Array.from(v),a));else if(ArrayBuffer.isView(v))h[_]=s(v);else{var g=n.indexOf(v);g!==-1?h[_]=e[g]:h[_]=a(v)}}return n.pop(),e.pop(),h}}}),Ll=we((i,c)=>{pe(),ge(),_e(),c.exports=Tl()()}),Il=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0}),i.validateTopics=i.validateTopic=void 0;function c(m){let w=m.split("/");for(let d=0;d<w.length;d++)if(w[d]!=="+"){if(w[d]==="#")return d===w.length-1;if(w[d].indexOf("+")!==-1||w[d].indexOf("#")!==-1)return!1}return!0}i.validateTopic=c;function s(m){if(m.length===0)return"empty_topic_list";for(let w=0;w<m.length;w++)if(!c(m[w]))return m[w];return null}i.validateTopics=s}),bo=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=rr(),s={objectMode:!0},m={clean:!0},w=class{constructor(d){this.options=d||{},this.options=Object.assign(Object.assign({},m),d),this._inflights=new Map}put(d,n){return this._inflights.set(d.messageId,d),n&&n(),this}createStream(){let d=new c.Readable(s),n=[],e=!1,t=0;return this._inflights.forEach((r,a)=>{n.push(r)}),d._read=()=>{!e&&t<n.length?d.push(n[t++]):d.push(null)},d.destroy=r=>{if(!e)return e=!0,setTimeout(()=>{d.emit("close")},0),d},d}del(d,n){let e=this._inflights.get(d.messageId);return e?(this._inflights.delete(d.messageId),n(null,e)):n&&n(new Error("missing packet")),this}get(d,n){let e=this._inflights.get(d.messageId);return e?n(null,e):n&&n(new Error("missing packet")),this}close(d){this.options.clean&&(this._inflights=null),d&&d()}};i.default=w}),xl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=[0,16,128,131,135,144,145,151,153],s=(m,w,d)=>{m.log("handlePublish: packet %o",w),d=typeof d<"u"?d:m.noop;let n=w.topic.toString(),e=w.payload,{qos:t}=w,{messageId:r}=w,{options:a}=m;if(m.options.protocolVersion===5){let o;if(w.properties&&(o=w.properties.topicAlias),typeof o<"u")if(n.length===0)if(o>0&&o<=65535){let h=m.topicAliasRecv.getTopicByAlias(o);if(h)n=h,m.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",n,o);else{m.log("handlePublish :: unregistered topic alias. alias: %d",o),m.emit("error",new Error("Received unregistered Topic Alias"));return}}else{m.log("handlePublish :: topic alias out of range. alias: %d",o),m.emit("error",new Error("Received Topic Alias is out of range"));return}else if(m.topicAliasRecv.put(n,o))m.log("handlePublish :: registered topic: %s - alias: %d",n,o);else{m.log("handlePublish :: topic alias out of range. alias: %d",o),m.emit("error",new Error("Received Topic Alias is out of range"));return}}switch(m.log("handlePublish: qos %d",t),t){case 2:{a.customHandleAcks(n,e,w,(o,h)=>{if(typeof o=="number"&&(h=o,o=null),o)return m.emit("error",o);if(c.indexOf(h)===-1)return m.emit("error",new Error("Wrong reason code for pubrec"));h?m._sendPacket({cmd:"pubrec",messageId:r,reasonCode:h},d):m.incomingStore.put(w,()=>{m._sendPacket({cmd:"pubrec",messageId:r},d)})});break}case 1:{a.customHandleAcks(n,e,w,(o,h)=>{if(typeof o=="number"&&(h=o,o=null),o)return m.emit("error",o);if(c.indexOf(h)===-1)return m.emit("error",new Error("Wrong reason code for puback"));h||m.emit("message",n,e,w),m.handleMessage(w,_=>{if(_)return d&&d(_);m._sendPacket({cmd:"puback",messageId:r,reasonCode:h},d)})});break}case 0:m.emit("message",n,e,w),m.handleMessage(w,d);break;default:m.log("handlePublish: unknown QoS. Doing nothing.");break}};i.default=s}),mr=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0}),i.nextTick=i.applyMixin=i.ErrorWithReasonCode=void 0;var c=class yo extends Error{constructor(w,d){super(w),this.code=d,Object.setPrototypeOf(this,yo.prototype),Object.getPrototypeOf(this).name="ErrorWithReasonCode"}};i.ErrorWithReasonCode=c;function s(m,w,d=!1){var n;let e=[w];for(;;){let t=e[0],r=Object.getPrototypeOf(t);if(r!=null&&r.prototype)e.unshift(r);else break}for(let t of e)for(let r of Object.getOwnPropertyNames(t.prototype))(d||r!=="constructor")&&Object.defineProperty(m.prototype,r,(n=Object.getOwnPropertyDescriptor(t.prototype,r))!==null&&n!==void 0?n:Object.create(null))}i.applyMixin=s,i.nextTick=Ve?Ve.nextTick:m=>{setTimeout(m,0)}}),Hr=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0}),i.ReasonCodes=void 0,i.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};var c=(s,m)=>{let{messageId:w}=m,d=m.cmd,n=null,e=s.outgoing[w]?s.outgoing[w].cb:null,t;if(!e){s.log("_handleAck :: Server sent an ack in error. Ignoring.");return}switch(s.log("_handleAck :: packet type",d),d){case"pubcomp":case"puback":{let r=m.reasonCode;r&&r>0&&r!==16?(t=new Error(`Publish error: ${i.ReasonCodes[r]}`),t.code=r,s._removeOutgoingAndStoreMessage(w,()=>{e(t,m)})):s._removeOutgoingAndStoreMessage(w,e);break}case"pubrec":{n={cmd:"pubrel",qos:2,messageId:w};let r=m.reasonCode;r&&r>0&&r!==16?(t=new Error(`Publish error: ${i.ReasonCodes[r]}`),t.code=r,s._removeOutgoingAndStoreMessage(w,()=>{e(t,m)})):s._sendPacket(n);break}case"suback":{delete s.outgoing[w],s.messageIdProvider.deallocate(w);let r=m.granted;for(let a=0;a<r.length;a++)if(r[a]&128){let o=s.messageIdToTopic[w];o&&o.forEach(h=>{delete s._resubscribeTopics[h]})}delete s.messageIdToTopic[w],s._invokeStoreProcessingQueue(),e(null,m);break}case"unsuback":{delete s.outgoing[w],s.messageIdProvider.deallocate(w),s._invokeStoreProcessingQueue(),e(null);break}default:s.emit("error",new Error("unrecognized packet type"))}s.disconnecting&&Object.keys(s.outgoing).length===0&&s.emit("outgoingEmpty")};i.default=c}),Bl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=mr(),s=Hr(),m=(w,d)=>{let{options:n}=w,e=n.protocolVersion,t=e===5?d.reasonCode:d.returnCode;if(e!==5){let r=new c.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${e}`,t);w.emit("error",r);return}w.handleAuth(d,(r,a)=>{if(r){w.emit("error",r);return}if(t===24)w.reconnecting=!1,w._sendPacket(a);else{let o=new c.ErrorWithReasonCode(`Connection refused: ${s.ReasonCodes[t]}`,t);w.emit("error",o)}})};i.default=m}),Ol=we(i=>{var _,v,g,l,p,u,f,y,b,A,R,C,L,O,N,I,P,V,G,re,J,x,U,F,z,D,ps,se,he,ce,T,B,wo,X,ie,te,le,Pt,W,Dt,Y,_s,ae,Tr,oe,Lr,Se,De,Te,gs,S,_r,j;pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0}),i.LRUCache=void 0;var c=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,s=new Set,m=typeof Ve=="object"&&Ve?Ve:{},w=($,M,H,ne)=>{typeof m.emitWarning=="function"?m.emitWarning($,M,H,ne):console.error(`[${H}] ${M}: ${$}`)},d=globalThis.AbortController,n=globalThis.AbortSignal;if(typeof d>"u"){n=class{constructor(){Fe(this,"onabort");Fe(this,"_onabort",[]);Fe(this,"reason");Fe(this,"aborted",!1)}addEventListener(H,ne){this._onabort.push(ne)}},d=class{constructor(){Fe(this,"signal",new n);M()}abort(H){var ne,ve;if(!this.signal.aborted){this.signal.reason=H,this.signal.aborted=!0;for(let fe of this.signal._onabort)fe(H);(ve=(ne=this.signal).onabort)==null||ve.call(ne,H)}}};let $=((_=m.env)==null?void 0:_.LRU_CACHE_IGNORE_AC_WARNING)!=="1",M=()=>{$&&($=!1,w("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",M))}}var e=$=>!s.has($),t=$=>$&&$===Math.floor($)&&$>0&&isFinite($),r=$=>t($)?$<=Math.pow(2,8)?Uint8Array:$<=Math.pow(2,16)?Uint16Array:$<=Math.pow(2,32)?Uint32Array:$<=Number.MAX_SAFE_INTEGER?a:null:null,a=class extends Array{constructor($){super($),this.fill(0)}},o=(v=class{constructor(M,H){Fe(this,"heap");Fe(this,"length");if(!K(v,g))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new H(M),this.length=0}static create(M){let H=r(M);if(!H)return[];ke(v,g,!0);let ne=new v(M,H);return ke(v,g,!1),ne}push(M){this.heap[this.length++]=M}pop(){return this.heap[--this.length]}},g=new WeakMap,Ie(v,g,!1),v),h=(j=class{constructor(M){Ie(this,D);Ie(this,B);Ie(this,le);Ie(this,W);Ie(this,Y);Ie(this,ae);Ie(this,oe);Ie(this,Se);Ie(this,Te);Ie(this,S);Ie(this,l,void 0);Ie(this,p,void 0);Ie(this,u,void 0);Ie(this,f,void 0);Ie(this,y,void 0);Fe(this,"ttl");Fe(this,"ttlResolution");Fe(this,"ttlAutopurge");Fe(this,"updateAgeOnGet");Fe(this,"updateAgeOnHas");Fe(this,"allowStale");Fe(this,"noDisposeOnSet");Fe(this,"noUpdateTTL");Fe(this,"maxEntrySize");Fe(this,"sizeCalculation");Fe(this,"noDeleteOnFetchRejection");Fe(this,"noDeleteOnStaleGet");Fe(this,"allowStaleOnFetchAbort");Fe(this,"allowStaleOnFetchRejection");Fe(this,"ignoreFetchAbort");Ie(this,b,void 0);Ie(this,A,void 0);Ie(this,R,void 0);Ie(this,C,void 0);Ie(this,L,void 0);Ie(this,O,void 0);Ie(this,N,void 0);Ie(this,I,void 0);Ie(this,P,void 0);Ie(this,V,void 0);Ie(this,G,void 0);Ie(this,re,void 0);Ie(this,J,void 0);Ie(this,x,void 0);Ie(this,U,void 0);Ie(this,F,void 0);Ie(this,z,void 0);Ie(this,se,()=>{});Ie(this,he,()=>{});Ie(this,ce,()=>{});Ie(this,T,()=>!1);Ie(this,X,M=>{});Ie(this,ie,(M,H,ne)=>{});Ie(this,te,(M,H,ne,ve)=>{if(ne||ve)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});let{max:H=0,ttl:ne,ttlResolution:ve=1,ttlAutopurge:fe,updateAgeOnGet:ye,updateAgeOnHas:Ce,allowStale:Re,dispose:We,disposeAfter:tt,noDisposeOnSet:Oe,noUpdateTTL:rt,maxSize:ze=0,maxEntrySize:qe=0,sizeCalculation:$e,fetchMethod:Xe,noDeleteOnFetchRejection:Le,noDeleteOnStaleGet:je,allowStaleOnFetchRejection:it,allowStaleOnFetchAbort:Ye,ignoreFetchAbort:ht}=M;if(H!==0&&!t(H))throw new TypeError("max option must be a nonnegative integer");let Ft=H?r(H):Array;if(!Ft)throw new Error("invalid max value: "+H);if(ke(this,l,H),ke(this,p,ze),this.maxEntrySize=qe||K(this,p),this.sizeCalculation=$e,this.sizeCalculation){if(!K(this,p)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(Xe!==void 0&&typeof Xe!="function")throw new TypeError("fetchMethod must be a function if specified");if(ke(this,y,Xe),ke(this,F,!!Xe),ke(this,R,new Map),ke(this,C,new Array(H).fill(void 0)),ke(this,L,new Array(H).fill(void 0)),ke(this,O,new Ft(H)),ke(this,N,new Ft(H)),ke(this,I,0),ke(this,P,0),ke(this,V,o.create(H)),ke(this,b,0),ke(this,A,0),typeof We=="function"&&ke(this,u,We),typeof tt=="function"?(ke(this,f,tt),ke(this,G,[])):(ke(this,f,void 0),ke(this,G,void 0)),ke(this,U,!!K(this,u)),ke(this,z,!!K(this,f)),this.noDisposeOnSet=!!Oe,this.noUpdateTTL=!!rt,this.noDeleteOnFetchRejection=!!Le,this.allowStaleOnFetchRejection=!!it,this.allowStaleOnFetchAbort=!!Ye,this.ignoreFetchAbort=!!ht,this.maxEntrySize!==0){if(K(this,p)!==0&&!t(K(this,p)))throw new TypeError("maxSize must be a positive integer if specified");if(!t(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Ae(this,B,wo).call(this)}if(this.allowStale=!!Re,this.noDeleteOnStaleGet=!!je,this.updateAgeOnGet=!!ye,this.updateAgeOnHas=!!Ce,this.ttlResolution=t(ve)||ve===0?ve:1,this.ttlAutopurge=!!fe,this.ttl=ne||0,this.ttl){if(!t(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Ae(this,D,ps).call(this)}if(K(this,l)===0&&this.ttl===0&&K(this,p)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!K(this,l)&&!K(this,p)){let Bt="LRU_CACHE_UNBOUNDED";e(Bt)&&(s.add(Bt),w("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",Bt,j))}}static unsafeExposeInternals(M){return{starts:K(M,J),ttls:K(M,x),sizes:K(M,re),keyMap:K(M,R),keyList:K(M,C),valList:K(M,L),next:K(M,O),prev:K(M,N),get head(){return K(M,I)},get tail(){return K(M,P)},free:K(M,V),isBackgroundFetch:H=>{var ne;return Ae(ne=M,Se,De).call(ne,H)},backgroundFetch:(H,ne,ve,fe)=>{var ye;return Ae(ye=M,oe,Lr).call(ye,H,ne,ve,fe)},moveToTail:H=>{var ne;return Ae(ne=M,S,_r).call(ne,H)},indexes:H=>{var ne;return Ae(ne=M,le,Pt).call(ne,H)},rindexes:H=>{var ne;return Ae(ne=M,W,Dt).call(ne,H)},isStale:H=>{var ne;return K(ne=M,T).call(ne,H)}}}get max(){return K(this,l)}get maxSize(){return K(this,p)}get calculatedSize(){return K(this,A)}get size(){return K(this,b)}get fetchMethod(){return K(this,y)}get dispose(){return K(this,u)}get disposeAfter(){return K(this,f)}getRemainingTTL(M){return K(this,R).has(M)?1/0:0}*entries(){for(let M of Ae(this,le,Pt).call(this))K(this,L)[M]!==void 0&&K(this,C)[M]!==void 0&&!Ae(this,Se,De).call(this,K(this,L)[M])&&(yield[K(this,C)[M],K(this,L)[M]])}*rentries(){for(let M of Ae(this,W,Dt).call(this))K(this,L)[M]!==void 0&&K(this,C)[M]!==void 0&&!Ae(this,Se,De).call(this,K(this,L)[M])&&(yield[K(this,C)[M],K(this,L)[M]])}*keys(){for(let M of Ae(this,le,Pt).call(this)){let H=K(this,C)[M];H!==void 0&&!Ae(this,Se,De).call(this,K(this,L)[M])&&(yield H)}}*rkeys(){for(let M of Ae(this,W,Dt).call(this)){let H=K(this,C)[M];H!==void 0&&!Ae(this,Se,De).call(this,K(this,L)[M])&&(yield H)}}*values(){for(let M of Ae(this,le,Pt).call(this))K(this,L)[M]!==void 0&&!Ae(this,Se,De).call(this,K(this,L)[M])&&(yield K(this,L)[M])}*rvalues(){for(let M of Ae(this,W,Dt).call(this))K(this,L)[M]!==void 0&&!Ae(this,Se,De).call(this,K(this,L)[M])&&(yield K(this,L)[M])}[Symbol.iterator](){return this.entries()}find(M,H={}){for(let ne of Ae(this,le,Pt).call(this)){let ve=K(this,L)[ne],fe=Ae(this,Se,De).call(this,ve)?ve.__staleWhileFetching:ve;if(fe!==void 0&&M(fe,K(this,C)[ne],this))return this.get(K(this,C)[ne],H)}}forEach(M,H=this){for(let ne of Ae(this,le,Pt).call(this)){let ve=K(this,L)[ne],fe=Ae(this,Se,De).call(this,ve)?ve.__staleWhileFetching:ve;fe!==void 0&&M.call(H,fe,K(this,C)[ne],this)}}rforEach(M,H=this){for(let ne of Ae(this,W,Dt).call(this)){let ve=K(this,L)[ne],fe=Ae(this,Se,De).call(this,ve)?ve.__staleWhileFetching:ve;fe!==void 0&&M.call(H,fe,K(this,C)[ne],this)}}purgeStale(){let M=!1;for(let H of Ae(this,W,Dt).call(this,{allowStale:!0}))K(this,T).call(this,H)&&(this.delete(K(this,C)[H]),M=!0);return M}dump(){let M=[];for(let H of Ae(this,le,Pt).call(this,{allowStale:!0})){let ne=K(this,C)[H],ve=K(this,L)[H],fe=Ae(this,Se,De).call(this,ve)?ve.__staleWhileFetching:ve;if(fe===void 0||ne===void 0)continue;let ye={value:fe};if(K(this,x)&&K(this,J)){ye.ttl=K(this,x)[H];let Ce=c.now()-K(this,J)[H];ye.start=Math.floor(Date.now()-Ce)}K(this,re)&&(ye.size=K(this,re)[H]),M.unshift([ne,ye])}return M}load(M){this.clear();for(let[H,ne]of M){if(ne.start){let ve=Date.now()-ne.start;ne.start=c.now()-ve}this.set(H,ne.value,ne)}}set(M,H,ne={}){var rt,ze,qe,$e,Xe;if(H===void 0)return this.delete(M),this;let{ttl:ve=this.ttl,start:fe,noDisposeOnSet:ye=this.noDisposeOnSet,sizeCalculation:Ce=this.sizeCalculation,status:Re}=ne,{noUpdateTTL:We=this.noUpdateTTL}=ne,tt=K(this,te).call(this,M,H,ne.size||0,Ce);if(this.maxEntrySize&&tt>this.maxEntrySize)return Re&&(Re.set="miss",Re.maxEntrySizeExceeded=!0),this.delete(M),this;let Oe=K(this,b)===0?void 0:K(this,R).get(M);if(Oe===void 0)Oe=K(this,b)===0?K(this,P):K(this,V).length!==0?K(this,V).pop():K(this,b)===K(this,l)?Ae(this,ae,Tr).call(this,!1):K(this,b),K(this,C)[Oe]=M,K(this,L)[Oe]=H,K(this,R).set(M,Oe),K(this,O)[K(this,P)]=Oe,K(this,N)[Oe]=K(this,P),ke(this,P,Oe),br(this,b)._++,K(this,ie).call(this,Oe,tt,Re),Re&&(Re.set="add"),We=!1;else{Ae(this,S,_r).call(this,Oe);let Le=K(this,L)[Oe];if(H!==Le){if(K(this,F)&&Ae(this,Se,De).call(this,Le)){Le.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:je}=Le;je!==void 0&&!ye&&(K(this,U)&&((rt=K(this,u))==null||rt.call(this,je,M,"set")),K(this,z)&&((ze=K(this,G))==null||ze.push([je,M,"set"])))}else ye||(K(this,U)&&((qe=K(this,u))==null||qe.call(this,Le,M,"set")),K(this,z)&&(($e=K(this,G))==null||$e.push([Le,M,"set"])));if(K(this,X).call(this,Oe),K(this,ie).call(this,Oe,tt,Re),K(this,L)[Oe]=H,Re){Re.set="replace";let je=Le&&Ae(this,Se,De).call(this,Le)?Le.__staleWhileFetching:Le;je!==void 0&&(Re.oldValue=je)}}else Re&&(Re.set="update")}if(ve!==0&&!K(this,x)&&Ae(this,D,ps).call(this),K(this,x)&&(We||K(this,ce).call(this,Oe,ve,fe),Re&&K(this,he).call(this,Re,Oe)),!ye&&K(this,z)&&K(this,G)){let Le=K(this,G),je;for(;je=Le==null?void 0:Le.shift();)(Xe=K(this,f))==null||Xe.call(this,...je)}return this}pop(){var M;try{for(;K(this,b);){let H=K(this,L)[K(this,I)];if(Ae(this,ae,Tr).call(this,!0),Ae(this,Se,De).call(this,H)){if(H.__staleWhileFetching)return H.__staleWhileFetching}else if(H!==void 0)return H}}finally{if(K(this,z)&&K(this,G)){let H=K(this,G),ne;for(;ne=H==null?void 0:H.shift();)(M=K(this,f))==null||M.call(this,...ne)}}}has(M,H={}){let{updateAgeOnHas:ne=this.updateAgeOnHas,status:ve}=H,fe=K(this,R).get(M);if(fe!==void 0){let ye=K(this,L)[fe];if(Ae(this,Se,De).call(this,ye)&&ye.__staleWhileFetching===void 0)return!1;if(K(this,T).call(this,fe))ve&&(ve.has="stale",K(this,he).call(this,ve,fe));else return ne&&K(this,se).call(this,fe),ve&&(ve.has="hit",K(this,he).call(this,ve,fe)),!0}else ve&&(ve.has="miss");return!1}peek(M,H={}){let{allowStale:ne=this.allowStale}=H,ve=K(this,R).get(M);if(ve!==void 0&&(ne||!K(this,T).call(this,ve))){let fe=K(this,L)[ve];return Ae(this,Se,De).call(this,fe)?fe.__staleWhileFetching:fe}}async fetch(M,H={}){let{allowStale:ne=this.allowStale,updateAgeOnGet:ve=this.updateAgeOnGet,noDeleteOnStaleGet:fe=this.noDeleteOnStaleGet,ttl:ye=this.ttl,noDisposeOnSet:Ce=this.noDisposeOnSet,size:Re=0,sizeCalculation:We=this.sizeCalculation,noUpdateTTL:tt=this.noUpdateTTL,noDeleteOnFetchRejection:Oe=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:rt=this.allowStaleOnFetchRejection,ignoreFetchAbort:ze=this.ignoreFetchAbort,allowStaleOnFetchAbort:qe=this.allowStaleOnFetchAbort,context:$e,forceRefresh:Xe=!1,status:Le,signal:je}=H;if(!K(this,F))return Le&&(Le.fetch="get"),this.get(M,{allowStale:ne,updateAgeOnGet:ve,noDeleteOnStaleGet:fe,status:Le});let it={allowStale:ne,updateAgeOnGet:ve,noDeleteOnStaleGet:fe,ttl:ye,noDisposeOnSet:Ce,size:Re,sizeCalculation:We,noUpdateTTL:tt,noDeleteOnFetchRejection:Oe,allowStaleOnFetchRejection:rt,allowStaleOnFetchAbort:qe,ignoreFetchAbort:ze,status:Le,signal:je},Ye=K(this,R).get(M);if(Ye===void 0){Le&&(Le.fetch="miss");let ht=Ae(this,oe,Lr).call(this,M,Ye,it,$e);return ht.__returned=ht}else{let ht=K(this,L)[Ye];if(Ae(this,Se,De).call(this,ht)){let Ns=ne&&ht.__staleWhileFetching!==void 0;return Le&&(Le.fetch="inflight",Ns&&(Le.returnedStale=!0)),Ns?ht.__staleWhileFetching:ht.__returned=ht}let Ft=K(this,T).call(this,Ye);if(!Xe&&!Ft)return Le&&(Le.fetch="hit"),Ae(this,S,_r).call(this,Ye),ve&&K(this,se).call(this,Ye),Le&&K(this,he).call(this,Le,Ye),ht;let Bt=Ae(this,oe,Lr).call(this,M,Ye,it,$e),Fs=Bt.__staleWhileFetching!==void 0&&ne;return Le&&(Le.fetch=Ft?"stale":"refresh",Fs&&Ft&&(Le.returnedStale=!0)),Fs?Bt.__staleWhileFetching:Bt.__returned=Bt}}get(M,H={}){let{allowStale:ne=this.allowStale,updateAgeOnGet:ve=this.updateAgeOnGet,noDeleteOnStaleGet:fe=this.noDeleteOnStaleGet,status:ye}=H,Ce=K(this,R).get(M);if(Ce!==void 0){let Re=K(this,L)[Ce],We=Ae(this,Se,De).call(this,Re);return ye&&K(this,he).call(this,ye,Ce),K(this,T).call(this,Ce)?(ye&&(ye.get="stale"),We?(ye&&ne&&Re.__staleWhileFetching!==void 0&&(ye.returnedStale=!0),ne?Re.__staleWhileFetching:void 0):(fe||this.delete(M),ye&&ne&&(ye.returnedStale=!0),ne?Re:void 0)):(ye&&(ye.get="hit"),We?Re.__staleWhileFetching:(Ae(this,S,_r).call(this,Ce),ve&&K(this,se).call(this,Ce),Re))}else ye&&(ye.get="miss")}delete(M){var ne,ve,fe,ye;let H=!1;if(K(this,b)!==0){let Ce=K(this,R).get(M);if(Ce!==void 0)if(H=!0,K(this,b)===1)this.clear();else{K(this,X).call(this,Ce);let Re=K(this,L)[Ce];Ae(this,Se,De).call(this,Re)?Re.__abortController.abort(new Error("deleted")):(K(this,U)||K(this,z))&&(K(this,U)&&((ne=K(this,u))==null||ne.call(this,Re,M,"delete")),K(this,z)&&((ve=K(this,G))==null||ve.push([Re,M,"delete"]))),K(this,R).delete(M),K(this,C)[Ce]=void 0,K(this,L)[Ce]=void 0,Ce===K(this,P)?ke(this,P,K(this,N)[Ce]):Ce===K(this,I)?ke(this,I,K(this,O)[Ce]):(K(this,O)[K(this,N)[Ce]]=K(this,O)[Ce],K(this,N)[K(this,O)[Ce]]=K(this,N)[Ce]),br(this,b)._--,K(this,V).push(Ce)}}if(K(this,z)&&((fe=K(this,G))!=null&&fe.length)){let Ce=K(this,G),Re;for(;Re=Ce==null?void 0:Ce.shift();)(ye=K(this,f))==null||ye.call(this,...Re)}return H}clear(){var M,H,ne;for(let ve of Ae(this,W,Dt).call(this,{allowStale:!0})){let fe=K(this,L)[ve];if(Ae(this,Se,De).call(this,fe))fe.__abortController.abort(new Error("deleted"));else{let ye=K(this,C)[ve];K(this,U)&&((M=K(this,u))==null||M.call(this,fe,ye,"delete")),K(this,z)&&((H=K(this,G))==null||H.push([fe,ye,"delete"]))}}if(K(this,R).clear(),K(this,L).fill(void 0),K(this,C).fill(void 0),K(this,x)&&K(this,J)&&(K(this,x).fill(0),K(this,J).fill(0)),K(this,re)&&K(this,re).fill(0),ke(this,I,0),ke(this,P,0),K(this,V).length=0,ke(this,A,0),ke(this,b,0),K(this,z)&&K(this,G)){let ve=K(this,G),fe;for(;fe=ve==null?void 0:ve.shift();)(ne=K(this,f))==null||ne.call(this,...fe)}}},l=new WeakMap,p=new WeakMap,u=new WeakMap,f=new WeakMap,y=new WeakMap,b=new WeakMap,A=new WeakMap,R=new WeakMap,C=new WeakMap,L=new WeakMap,O=new WeakMap,N=new WeakMap,I=new WeakMap,P=new WeakMap,V=new WeakMap,G=new WeakMap,re=new WeakMap,J=new WeakMap,x=new WeakMap,U=new WeakMap,F=new WeakMap,z=new WeakMap,D=new WeakSet,ps=function(){let M=new a(K(this,l)),H=new a(K(this,l));ke(this,x,M),ke(this,J,H),ke(this,ce,(fe,ye,Ce=c.now())=>{if(H[fe]=ye!==0?Ce:0,M[fe]=ye,ye!==0&&this.ttlAutopurge){let Re=setTimeout(()=>{K(this,T).call(this,fe)&&this.delete(K(this,C)[fe])},ye+1);Re.unref&&Re.unref()}}),ke(this,se,fe=>{H[fe]=M[fe]!==0?c.now():0}),ke(this,he,(fe,ye)=>{if(M[ye]){let Ce=M[ye],Re=H[ye];fe.ttl=Ce,fe.start=Re,fe.now=ne||ve();let We=fe.now-Re;fe.remainingTTL=Ce-We}});let ne=0,ve=()=>{let fe=c.now();if(this.ttlResolution>0){ne=fe;let ye=setTimeout(()=>ne=0,this.ttlResolution);ye.unref&&ye.unref()}return fe};this.getRemainingTTL=fe=>{let ye=K(this,R).get(fe);if(ye===void 0)return 0;let Ce=M[ye],Re=H[ye];if(Ce===0||Re===0)return 1/0;let We=(ne||ve())-Re;return Ce-We},ke(this,T,fe=>M[fe]!==0&&H[fe]!==0&&(ne||ve())-H[fe]>M[fe])},se=new WeakMap,he=new WeakMap,ce=new WeakMap,T=new WeakMap,B=new WeakSet,wo=function(){let M=new a(K(this,l));ke(this,A,0),ke(this,re,M),ke(this,X,H=>{ke(this,A,K(this,A)-M[H]),M[H]=0}),ke(this,te,(H,ne,ve,fe)=>{if(Ae(this,Se,De).call(this,ne))return 0;if(!t(ve))if(fe){if(typeof fe!="function")throw new TypeError("sizeCalculation must be a function");if(ve=fe(ne,H),!t(ve))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return ve}),ke(this,ie,(H,ne,ve)=>{if(M[H]=ne,K(this,p)){let fe=K(this,p)-M[H];for(;K(this,A)>fe;)Ae(this,ae,Tr).call(this,!0)}ke(this,A,K(this,A)+M[H]),ve&&(ve.entrySize=ne,ve.totalCalculatedSize=K(this,A))})},X=new WeakMap,ie=new WeakMap,te=new WeakMap,le=new WeakSet,Pt=function*({allowStale:M=this.allowStale}={}){if(K(this,b))for(let H=K(this,P);!(!Ae(this,Y,_s).call(this,H)||((M||!K(this,T).call(this,H))&&(yield H),H===K(this,I)));)H=K(this,N)[H]},W=new WeakSet,Dt=function*({allowStale:M=this.allowStale}={}){if(K(this,b))for(let H=K(this,I);!(!Ae(this,Y,_s).call(this,H)||((M||!K(this,T).call(this,H))&&(yield H),H===K(this,P)));)H=K(this,O)[H]},Y=new WeakSet,_s=function(M){return M!==void 0&&K(this,R).get(K(this,C)[M])===M},ae=new WeakSet,Tr=function(M){var fe,ye;let H=K(this,I),ne=K(this,C)[H],ve=K(this,L)[H];return K(this,F)&&Ae(this,Se,De).call(this,ve)?ve.__abortController.abort(new Error("evicted")):(K(this,U)||K(this,z))&&(K(this,U)&&((fe=K(this,u))==null||fe.call(this,ve,ne,"evict")),K(this,z)&&((ye=K(this,G))==null||ye.push([ve,ne,"evict"]))),K(this,X).call(this,H),M&&(K(this,C)[H]=void 0,K(this,L)[H]=void 0,K(this,V).push(H)),K(this,b)===1?(ke(this,I,ke(this,P,0)),K(this,V).length=0):ke(this,I,K(this,O)[H]),K(this,R).delete(ne),br(this,b)._--,H},oe=new WeakSet,Lr=function(M,H,ne,ve){let fe=H===void 0?void 0:K(this,L)[H];if(Ae(this,Se,De).call(this,fe))return fe;let ye=new d,{signal:Ce}=ne;Ce==null||Ce.addEventListener("abort",()=>ye.abort(Ce.reason),{signal:ye.signal});let Re={signal:ye.signal,options:ne,context:ve},We=($e,Xe=!1)=>{let{aborted:Le}=ye.signal,je=ne.ignoreFetchAbort&&$e!==void 0;if(ne.status&&(Le&&!Xe?(ne.status.fetchAborted=!0,ne.status.fetchError=ye.signal.reason,je&&(ne.status.fetchAbortIgnored=!0)):ne.status.fetchResolved=!0),Le&&!je&&!Xe)return Oe(ye.signal.reason);let it=ze;return K(this,L)[H]===ze&&($e===void 0?it.__staleWhileFetching?K(this,L)[H]=it.__staleWhileFetching:this.delete(M):(ne.status&&(ne.status.fetchUpdated=!0),this.set(M,$e,Re.options))),$e},tt=$e=>(ne.status&&(ne.status.fetchRejected=!0,ne.status.fetchError=$e),Oe($e)),Oe=$e=>{let{aborted:Xe}=ye.signal,Le=Xe&&ne.allowStaleOnFetchAbort,je=Le||ne.allowStaleOnFetchRejection,it=je||ne.noDeleteOnFetchRejection,Ye=ze;if(K(this,L)[H]===ze&&(!it||Ye.__staleWhileFetching===void 0?this.delete(M):Le||(K(this,L)[H]=Ye.__staleWhileFetching)),je)return ne.status&&Ye.__staleWhileFetching!==void 0&&(ne.status.returnedStale=!0),Ye.__staleWhileFetching;if(Ye.__returned===Ye)throw $e},rt=($e,Xe)=>{var je;let Le=(je=K(this,y))==null?void 0:je.call(this,M,fe,Re);Le&&Le instanceof Promise&&Le.then(it=>$e(it===void 0?void 0:it),Xe),ye.signal.addEventListener("abort",()=>{(!ne.ignoreFetchAbort||ne.allowStaleOnFetchAbort)&&($e(void 0),ne.allowStaleOnFetchAbort&&($e=it=>We(it,!0)))})};ne.status&&(ne.status.fetchDispatched=!0);let ze=new Promise(rt).then(We,tt),qe=Object.assign(ze,{__abortController:ye,__staleWhileFetching:fe,__returned:void 0});return H===void 0?(this.set(M,qe,{...Re.options,status:void 0}),H=K(this,R).get(M)):K(this,L)[H]=qe,qe},Se=new WeakSet,De=function(M){if(!K(this,F))return!1;let H=M;return!!H&&H instanceof Promise&&H.hasOwnProperty("__staleWhileFetching")&&H.__abortController instanceof d},Te=new WeakSet,gs=function(M,H){K(this,N)[H]=M,K(this,O)[M]=H},S=new WeakSet,_r=function(M){M!==K(this,P)&&(M===K(this,I)?ke(this,I,K(this,O)[M]):Ae(this,Te,gs).call(this,K(this,N)[M],K(this,O)[M]),Ae(this,Te,gs).call(this,K(this,P),M),ke(this,P,M))},j);i.LRUCache=h}),It=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.ContainerIterator=i.Container=i.Base=void 0;var c=class{constructor(w=0){this.iteratorType=w}equals(w){return this.o===w.o}};i.ContainerIterator=c;var s=class{constructor(){this.i=0}get length(){return this.i}size(){return this.i}empty(){return this.i===0}};i.Base=s;var m=class extends s{};i.Container=m}),Pl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=It(),s=class extends c.Base{constructor(w=[]){super(),this.S=[];let d=this;w.forEach(function(n){d.push(n)})}clear(){this.i=0,this.S=[]}push(w){return this.S.push(w),this.i+=1,this.i}pop(){if(this.i!==0)return this.i-=1,this.S.pop()}top(){return this.S[this.i-1]}},m=s;i.default=m}),Dl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=It(),s=class extends c.Base{constructor(w=[]){super(),this.j=0,this.q=[];let d=this;w.forEach(function(n){d.push(n)})}clear(){this.q=[],this.i=this.j=0}push(w){let d=this.q.length;if(this.j/d>.5&&this.j+this.i>=d&&d>4096){let n=this.i;for(let e=0;e<n;++e)this.q[e]=this.q[this.j+e];this.j=0,this.q[this.i]=w}else this.q[this.j+this.i]=w;return++this.i}pop(){if(this.i===0)return;let w=this.q[this.j++];return this.i-=1,w}front(){if(this.i!==0)return this.q[this.j]}},m=s;i.default=m}),Ml=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=It(),s=class extends c.Base{constructor(w=[],d=function(e,t){return e>t?-1:e<t?1:0},n=!0){if(super(),this.v=d,Array.isArray(w))this.C=n?[...w]:w;else{this.C=[];let t=this;w.forEach(function(r){t.C.push(r)})}this.i=this.C.length;let e=this.i>>1;for(let t=this.i-1>>1;t>=0;--t)this.k(t,e)}m(w){let d=this.C[w];for(;w>0;){let n=w-1>>1,e=this.C[n];if(this.v(e,d)<=0)break;this.C[w]=e,w=n}this.C[w]=d}k(w,d){let n=this.C[w];for(;w<d;){let e=w<<1|1,t=e+1,r=this.C[e];if(t<this.i&&this.v(r,this.C[t])>0&&(e=t,r=this.C[t]),this.v(r,n)>=0)break;this.C[w]=r,w=e}this.C[w]=n}clear(){this.i=0,this.C.length=0}push(w){this.C.push(w),this.m(this.i),this.i+=1}pop(){if(this.i===0)return;let w=this.C[0],d=this.C.pop();return this.i-=1,this.i&&(this.C[0]=d,this.k(0,this.i>>1)),w}top(){return this.C[0]}find(w){return this.C.indexOf(w)>=0}remove(w){let d=this.C.indexOf(w);return d<0?!1:(d===0?this.pop():d===this.i-1?(this.C.pop(),this.i-=1):(this.C.splice(d,1,this.C.pop()),this.i-=1,this.m(d),this.k(d,this.i>>1)),!0)}updateItem(w){let d=this.C.indexOf(w);return d<0?!1:(this.m(d),this.k(d,this.i>>1),!0)}toArray(){return[...this.C]}},m=s;i.default=m}),Ps=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=It(),s=class extends c.Container{},m=s;i.default=m}),xt=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.throwIteratorAccessError=c;function c(){throw new RangeError("Iterator access denied!")}}),So=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.RandomIterator=void 0;var c=It(),s=xt(),m=class extends c.ContainerIterator{constructor(w,d){super(d),this.o=w,this.iteratorType===0?(this.pre=function(){return this.o===0&&(0,s.throwIteratorAccessError)(),this.o-=1,this},this.next=function(){return this.o===this.container.size()&&(0,s.throwIteratorAccessError)(),this.o+=1,this}):(this.pre=function(){return this.o===this.container.size()-1&&(0,s.throwIteratorAccessError)(),this.o+=1,this},this.next=function(){return this.o===-1&&(0,s.throwIteratorAccessError)(),this.o-=1,this})}get pointer(){return this.container.getElementByPos(this.o)}set pointer(w){this.container.setElementByPos(this.o,w)}};i.RandomIterator=m}),Ul=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=m(Ps()),s=So();function m(e){return e&&e.t?e:{default:e}}var w=class Co extends s.RandomIterator{constructor(t,r,a){super(t,a),this.container=r}copy(){return new Co(this.o,this.container,this.iteratorType)}},d=class extends c.default{constructor(e=[],t=!0){if(super(),Array.isArray(e))this.J=t?[...e]:e,this.i=e.length;else{this.J=[];let r=this;e.forEach(function(a){r.pushBack(a)})}}clear(){this.i=0,this.J.length=0}begin(){return new w(0,this)}end(){return new w(this.i,this)}rBegin(){return new w(this.i-1,this,1)}rEnd(){return new w(-1,this,1)}front(){return this.J[0]}back(){return this.J[this.i-1]}getElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;return this.J[e]}eraseElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;return this.J.splice(e,1),this.i-=1,this.i}eraseElementByValue(e){let t=0;for(let r=0;r<this.i;++r)this.J[r]!==e&&(this.J[t++]=this.J[r]);return this.i=this.J.length=t,this.i}eraseElementByIterator(e){let t=e.o;return e=e.next(),this.eraseElementByPos(t),e}pushBack(e){return this.J.push(e),this.i+=1,this.i}popBack(){if(this.i!==0)return this.i-=1,this.J.pop()}setElementByPos(e,t){if(e<0||e>this.i-1)throw new RangeError;this.J[e]=t}insert(e,t,r=1){if(e<0||e>this.i)throw new RangeError;return this.J.splice(e,0,...new Array(r).fill(t)),this.i+=r,this.i}find(e){for(let t=0;t<this.i;++t)if(this.J[t]===e)return new w(t,this);return this.end()}reverse(){this.J.reverse()}unique(){let e=1;for(let t=1;t<this.i;++t)this.J[t]!==this.J[t-1]&&(this.J[e++]=this.J[t]);return this.i=this.J.length=e,this.i}sort(e){this.J.sort(e)}forEach(e){for(let t=0;t<this.i;++t)e(this.J[t],t,this)}[Symbol.iterator](){return(function*(){yield*this.J}).bind(this)()}},n=d;i.default=n}),Fl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=w(Ps()),s=It(),m=xt();function w(t){return t&&t.t?t:{default:t}}var d=class Eo extends s.ContainerIterator{constructor(r,a,o,h){super(h),this.o=r,this.h=a,this.container=o,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,m.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,m.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,m.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,m.throwIteratorAccessError)(),this.o=this.o.L,this})}get pointer(){return this.o===this.h&&(0,m.throwIteratorAccessError)(),this.o.l}set pointer(r){this.o===this.h&&(0,m.throwIteratorAccessError)(),this.o.l=r}copy(){return new Eo(this.o,this.h,this.container,this.iteratorType)}},n=class extends c.default{constructor(t=[]){super(),this.h={},this.p=this._=this.h.L=this.h.B=this.h;let r=this;t.forEach(function(a){r.pushBack(a)})}V(t){let{L:r,B:a}=t;r.B=a,a.L=r,t===this.p&&(this.p=a),t===this._&&(this._=r),this.i-=1}G(t,r){let a=r.B,o={l:t,L:r,B:a};r.B=o,a.L=o,r===this.h&&(this.p=o),a===this.h&&(this._=o),this.i+=1}clear(){this.i=0,this.p=this._=this.h.L=this.h.B=this.h}begin(){return new d(this.p,this.h,this)}end(){return new d(this.h,this.h,this)}rBegin(){return new d(this._,this.h,this,1)}rEnd(){return new d(this.h,this.h,this,1)}front(){return this.p.l}back(){return this._.l}getElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let r=this.p;for(;t--;)r=r.B;return r.l}eraseElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let r=this.p;for(;t--;)r=r.B;return this.V(r),this.i}eraseElementByValue(t){let r=this.p;for(;r!==this.h;)r.l===t&&this.V(r),r=r.B;return this.i}eraseElementByIterator(t){let r=t.o;return r===this.h&&(0,m.throwIteratorAccessError)(),t=t.next(),this.V(r),t}pushBack(t){return this.G(t,this._),this.i}popBack(){if(this.i===0)return;let t=this._.l;return this.V(this._),t}pushFront(t){return this.G(t,this.h),this.i}popFront(){if(this.i===0)return;let t=this.p.l;return this.V(this.p),t}setElementByPos(t,r){if(t<0||t>this.i-1)throw new RangeError;let a=this.p;for(;t--;)a=a.B;a.l=r}insert(t,r,a=1){if(t<0||t>this.i)throw new RangeError;if(a<=0)return this.i;if(t===0)for(;a--;)this.pushFront(r);else if(t===this.i)for(;a--;)this.pushBack(r);else{let o=this.p;for(let _=1;_<t;++_)o=o.B;let h=o.B;for(this.i+=a;a--;)o.B={l:r,L:o},o.B.L=o,o=o.B;o.B=h,h.L=o}return this.i}find(t){let r=this.p;for(;r!==this.h;){if(r.l===t)return new d(r,this.h,this);r=r.B}return this.end()}reverse(){if(this.i<=1)return;let t=this.p,r=this._,a=0;for(;a<<1<this.i;){let o=t.l;t.l=r.l,r.l=o,t=t.B,r=r.L,a+=1}}unique(){if(this.i<=1)return this.i;let t=this.p;for(;t!==this.h;){let r=t;for(;r.B!==this.h&&r.l===r.B.l;)r=r.B,this.i-=1;t.B=r.B,t.B.L=t,t=t.B}return this.i}sort(t){if(this.i<=1)return;let r=[];this.forEach(function(o){r.push(o)}),r.sort(t);let a=this.p;r.forEach(function(o){a.l=o,a=a.B})}merge(t){let r=this;if(this.i===0)t.forEach(function(a){r.pushBack(a)});else{let a=this.p;t.forEach(function(o){for(;a!==r.h&&a.l<=o;)a=a.B;r.G(o,a.L)})}return this.i}forEach(t){let r=this.p,a=0;for(;r!==this.h;)t(r.l,a++,this),r=r.B}[Symbol.iterator](){return(function*(){if(this.i===0)return;let t=this.p;for(;t!==this.h;)yield t.l,t=t.B}).bind(this)()}},e=n;i.default=e}),Nl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=m(Ps()),s=So();function m(e){return e&&e.t?e:{default:e}}var w=class Ao extends s.RandomIterator{constructor(t,r,a){super(t,a),this.container=r}copy(){return new Ao(this.o,this.container,this.iteratorType)}},d=class extends c.default{constructor(e=[],t=4096){super(),this.j=0,this.D=0,this.R=0,this.N=0,this.P=0,this.A=[];let r=(()=>{if(typeof e.length=="number")return e.length;if(typeof e.size=="number")return e.size;if(typeof e.size=="function")return e.size();throw new TypeError("Cannot get the length or size of the container")})();this.F=t,this.P=Math.max(Math.ceil(r/this.F),1);for(let h=0;h<this.P;++h)this.A.push(new Array(this.F));let a=Math.ceil(r/this.F);this.j=this.R=(this.P>>1)-(a>>1),this.D=this.N=this.F-r%this.F>>1;let o=this;e.forEach(function(h){o.pushBack(h)})}T(){let e=[],t=Math.max(this.P>>1,1);for(let r=0;r<t;++r)e[r]=new Array(this.F);for(let r=this.j;r<this.P;++r)e[e.length]=this.A[r];for(let r=0;r<this.R;++r)e[e.length]=this.A[r];e[e.length]=[...this.A[this.R]],this.j=t,this.R=e.length-1;for(let r=0;r<t;++r)e[e.length]=new Array(this.F);this.A=e,this.P=e.length}O(e){let t=this.D+e+1,r=t%this.F,a=r-1,o=this.j+(t-r)/this.F;return r===0&&(o-=1),o%=this.P,a<0&&(a+=this.F),{curNodeBucketIndex:o,curNodePointerIndex:a}}clear(){this.A=[new Array(this.F)],this.P=1,this.j=this.R=this.i=0,this.D=this.N=this.F>>1}begin(){return new w(0,this)}end(){return new w(this.i,this)}rBegin(){return new w(this.i-1,this,1)}rEnd(){return new w(-1,this,1)}front(){if(this.i!==0)return this.A[this.j][this.D]}back(){if(this.i!==0)return this.A[this.R][this.N]}pushBack(e){return this.i&&(this.N<this.F-1?this.N+=1:this.R<this.P-1?(this.R+=1,this.N=0):(this.R=0,this.N=0),this.R===this.j&&this.N===this.D&&this.T()),this.i+=1,this.A[this.R][this.N]=e,this.i}popBack(){if(this.i===0)return;let e=this.A[this.R][this.N];return this.i!==1&&(this.N>0?this.N-=1:this.R>0?(this.R-=1,this.N=this.F-1):(this.R=this.P-1,this.N=this.F-1)),this.i-=1,e}pushFront(e){return this.i&&(this.D>0?this.D-=1:this.j>0?(this.j-=1,this.D=this.F-1):(this.j=this.P-1,this.D=this.F-1),this.j===this.R&&this.D===this.N&&this.T()),this.i+=1,this.A[this.j][this.D]=e,this.i}popFront(){if(this.i===0)return;let e=this.A[this.j][this.D];return this.i!==1&&(this.D<this.F-1?this.D+=1:this.j<this.P-1?(this.j+=1,this.D=0):(this.j=0,this.D=0)),this.i-=1,e}getElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let{curNodeBucketIndex:t,curNodePointerIndex:r}=this.O(e);return this.A[t][r]}setElementByPos(e,t){if(e<0||e>this.i-1)throw new RangeError;let{curNodeBucketIndex:r,curNodePointerIndex:a}=this.O(e);this.A[r][a]=t}insert(e,t,r=1){if(e<0||e>this.i)throw new RangeError;if(e===0)for(;r--;)this.pushFront(t);else if(e===this.i)for(;r--;)this.pushBack(t);else{let a=[];for(let o=e;o<this.i;++o)a.push(this.getElementByPos(o));this.cut(e-1);for(let o=0;o<r;++o)this.pushBack(t);for(let o=0;o<a.length;++o)this.pushBack(a[o])}return this.i}cut(e){if(e<0)return this.clear(),0;let{curNodeBucketIndex:t,curNodePointerIndex:r}=this.O(e);return this.R=t,this.N=r,this.i=e+1,this.i}eraseElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;if(e===0)this.popFront();else if(e===this.i-1)this.popBack();else{let t=[];for(let a=e+1;a<this.i;++a)t.push(this.getElementByPos(a));this.cut(e),this.popBack();let r=this;t.forEach(function(a){r.pushBack(a)})}return this.i}eraseElementByValue(e){if(this.i===0)return 0;let t=[];for(let a=0;a<this.i;++a){let o=this.getElementByPos(a);o!==e&&t.push(o)}let r=t.length;for(let a=0;a<r;++a)this.setElementByPos(a,t[a]);return this.cut(r-1)}eraseElementByIterator(e){let t=e.o;return this.eraseElementByPos(t),e=e.next(),e}find(e){for(let t=0;t<this.i;++t)if(this.getElementByPos(t)===e)return new w(t,this);return this.end()}reverse(){let e=0,t=this.i-1;for(;e<t;){let r=this.getElementByPos(e);this.setElementByPos(e,this.getElementByPos(t)),this.setElementByPos(t,r),e+=1,t-=1}}unique(){if(this.i<=1)return this.i;let e=1,t=this.getElementByPos(0);for(let r=1;r<this.i;++r){let a=this.getElementByPos(r);a!==t&&(t=a,this.setElementByPos(e++,a))}for(;this.i>e;)this.popBack();return this.i}sort(e){let t=[];for(let r=0;r<this.i;++r)t.push(this.getElementByPos(r));t.sort(e);for(let r=0;r<this.i;++r)this.setElementByPos(r,t[r])}shrinkToFit(){if(this.i===0)return;let e=[];this.forEach(function(t){e.push(t)}),this.P=Math.max(Math.ceil(this.i/this.F),1),this.i=this.j=this.R=this.D=this.N=0,this.A=[];for(let t=0;t<this.P;++t)this.A.push(new Array(this.F));for(let t=0;t<e.length;++t)this.pushBack(e[t])}forEach(e){for(let t=0;t<this.i;++t)e(this.getElementByPos(t),t,this)}[Symbol.iterator](){return(function*(){for(let e=0;e<this.i;++e)yield this.getElementByPos(e)}).bind(this)()}},n=d;i.default=n}),jl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.TreeNodeEnableIndex=i.TreeNode=void 0;var c=class{constructor(m,w){this.ee=1,this.u=void 0,this.l=void 0,this.U=void 0,this.W=void 0,this.tt=void 0,this.u=m,this.l=w}L(){let m=this;if(m.ee===1&&m.tt.tt===m)m=m.W;else if(m.U)for(m=m.U;m.W;)m=m.W;else{let w=m.tt;for(;w.U===m;)m=w,w=m.tt;m=w}return m}B(){let m=this;if(m.W){for(m=m.W;m.U;)m=m.U;return m}else{let w=m.tt;for(;w.W===m;)m=w,w=m.tt;return m.W!==w?w:m}}te(){let m=this.tt,w=this.W,d=w.U;return m.tt===this?m.tt=w:m.U===this?m.U=w:m.W=w,w.tt=m,w.U=this,this.tt=w,this.W=d,d&&(d.tt=this),w}se(){let m=this.tt,w=this.U,d=w.W;return m.tt===this?m.tt=w:m.U===this?m.U=w:m.W=w,w.tt=m,w.W=this,this.tt=w,this.U=d,d&&(d.tt=this),w}};i.TreeNode=c;var s=class extends c{constructor(){super(...arguments),this.rt=1}te(){let m=super.te();return this.ie(),m.ie(),m}se(){let m=super.se();return this.ie(),m.ie(),m}ie(){this.rt=1,this.U&&(this.rt+=this.U.rt),this.W&&(this.rt+=this.W.rt)}};i.TreeNodeEnableIndex=s}),ko=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=jl(),s=It(),m=xt(),w=class extends s.Container{constructor(n=function(t,r){return t<r?-1:t>r?1:0},e=!1){super(),this.Y=void 0,this.v=n,e?(this.re=c.TreeNodeEnableIndex,this.M=function(t,r,a){let o=this.ne(t,r,a);if(o){let h=o.tt;for(;h!==this.h;)h.rt+=1,h=h.tt;let _=this.he(o);if(_){let{parentNode:v,grandParent:g,curNode:l}=_;v.ie(),g.ie(),l.ie()}}return this.i},this.V=function(t){let r=this.fe(t);for(;r!==this.h;)r.rt-=1,r=r.tt}):(this.re=c.TreeNode,this.M=function(t,r,a){let o=this.ne(t,r,a);return o&&this.he(o),this.i},this.V=this.fe),this.h=new this.re}X(n,e){let t=this.h;for(;n;){let r=this.v(n.u,e);if(r<0)n=n.W;else if(r>0)t=n,n=n.U;else return n}return t}Z(n,e){let t=this.h;for(;n;)this.v(n.u,e)<=0?n=n.W:(t=n,n=n.U);return t}$(n,e){let t=this.h;for(;n;){let r=this.v(n.u,e);if(r<0)t=n,n=n.W;else if(r>0)n=n.U;else return n}return t}rr(n,e){let t=this.h;for(;n;)this.v(n.u,e)<0?(t=n,n=n.W):n=n.U;return t}ue(n){for(;;){let e=n.tt;if(e===this.h)return;if(n.ee===1){n.ee=0;return}if(n===e.U){let t=e.W;if(t.ee===1)t.ee=0,e.ee=1,e===this.Y?this.Y=e.te():e.te();else if(t.W&&t.W.ee===1){t.ee=e.ee,e.ee=0,t.W.ee=0,e===this.Y?this.Y=e.te():e.te();return}else t.U&&t.U.ee===1?(t.ee=1,t.U.ee=0,t.se()):(t.ee=1,n=e)}else{let t=e.U;if(t.ee===1)t.ee=0,e.ee=1,e===this.Y?this.Y=e.se():e.se();else if(t.U&&t.U.ee===1){t.ee=e.ee,e.ee=0,t.U.ee=0,e===this.Y?this.Y=e.se():e.se();return}else t.W&&t.W.ee===1?(t.ee=1,t.W.ee=0,t.te()):(t.ee=1,n=e)}}}fe(n){if(this.i===1)return this.clear(),this.h;let e=n;for(;e.U||e.W;){if(e.W)for(e=e.W;e.U;)e=e.U;else e=e.U;[n.u,e.u]=[e.u,n.u],[n.l,e.l]=[e.l,n.l],n=e}this.h.U===e?this.h.U=e.tt:this.h.W===e&&(this.h.W=e.tt),this.ue(e);let t=e.tt;return e===t.U?t.U=void 0:t.W=void 0,this.i-=1,this.Y.ee=0,t}oe(n,e){return n===void 0?!1:this.oe(n.U,e)||e(n)?!0:this.oe(n.W,e)}he(n){for(;;){let e=n.tt;if(e.ee===0)return;let t=e.tt;if(e===t.U){let r=t.W;if(r&&r.ee===1){if(r.ee=e.ee=0,t===this.Y)return;t.ee=1,n=t;continue}else if(n===e.W){if(n.ee=0,n.U&&(n.U.tt=e),n.W&&(n.W.tt=t),e.W=n.U,t.U=n.W,n.U=e,n.W=t,t===this.Y)this.Y=n,this.h.tt=n;else{let a=t.tt;a.U===t?a.U=n:a.W=n}return n.tt=t.tt,e.tt=n,t.tt=n,t.ee=1,{parentNode:e,grandParent:t,curNode:n}}else e.ee=0,t===this.Y?this.Y=t.se():t.se(),t.ee=1}else{let r=t.U;if(r&&r.ee===1){if(r.ee=e.ee=0,t===this.Y)return;t.ee=1,n=t;continue}else if(n===e.U){if(n.ee=0,n.U&&(n.U.tt=t),n.W&&(n.W.tt=e),t.W=n.U,e.U=n.W,n.U=t,n.W=e,t===this.Y)this.Y=n,this.h.tt=n;else{let a=t.tt;a.U===t?a.U=n:a.W=n}return n.tt=t.tt,e.tt=n,t.tt=n,t.ee=1,{parentNode:e,grandParent:t,curNode:n}}else e.ee=0,t===this.Y?this.Y=t.te():t.te(),t.ee=1}return}}ne(n,e,t){if(this.Y===void 0){this.i+=1,this.Y=new this.re(n,e),this.Y.ee=0,this.Y.tt=this.h,this.h.tt=this.Y,this.h.U=this.Y,this.h.W=this.Y;return}let r,a=this.h.U,o=this.v(a.u,n);if(o===0){a.l=e;return}else if(o>0)a.U=new this.re(n,e),a.U.tt=a,r=a.U,this.h.U=r;else{let h=this.h.W,_=this.v(h.u,n);if(_===0){h.l=e;return}else if(_<0)h.W=new this.re(n,e),h.W.tt=h,r=h.W,this.h.W=r;else{if(t!==void 0){let v=t.o;if(v!==this.h){let g=this.v(v.u,n);if(g===0){v.l=e;return}else if(g>0){let l=v.L(),p=this.v(l.u,n);if(p===0){l.l=e;return}else p<0&&(r=new this.re(n,e),l.W===void 0?(l.W=r,r.tt=l):(v.U=r,r.tt=v))}}}if(r===void 0)for(r=this.Y;;){let v=this.v(r.u,n);if(v>0){if(r.U===void 0){r.U=new this.re(n,e),r.U.tt=r,r=r.U;break}r=r.U}else if(v<0){if(r.W===void 0){r.W=new this.re(n,e),r.W.tt=r,r=r.W;break}r=r.W}else{r.l=e;return}}}}return this.i+=1,r}I(n,e){for(;n;){let t=this.v(n.u,e);if(t<0)n=n.W;else if(t>0)n=n.U;else return n}return n||this.h}clear(){this.i=0,this.Y=void 0,this.h.tt=void 0,this.h.U=this.h.W=void 0}updateKeyByIterator(n,e){let t=n.o;if(t===this.h&&(0,m.throwIteratorAccessError)(),this.i===1)return t.u=e,!0;if(t===this.h.U)return this.v(t.B().u,e)>0?(t.u=e,!0):!1;if(t===this.h.W)return this.v(t.L().u,e)<0?(t.u=e,!0):!1;let r=t.L().u;if(this.v(r,e)>=0)return!1;let a=t.B().u;return this.v(a,e)<=0?!1:(t.u=e,!0)}eraseElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;let e=0,t=this;return this.oe(this.Y,function(r){return n===e?(t.V(r),!0):(e+=1,!1)}),this.i}eraseElementByKey(n){if(this.i===0)return!1;let e=this.I(this.Y,n);return e===this.h?!1:(this.V(e),!0)}eraseElementByIterator(n){let e=n.o;e===this.h&&(0,m.throwIteratorAccessError)();let t=e.W===void 0;return n.iteratorType===0?t&&n.next():(!t||e.U===void 0)&&n.next(),this.V(e),n}forEach(n){let e=0;for(let t of this)n(t,e++,this)}getElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;let e,t=0;for(let r of this){if(t===n){e=r;break}t+=1}return e}getHeight(){if(this.i===0)return 0;let n=function(e){return e?Math.max(n(e.U),n(e.W))+1:0};return n(this.Y)}},d=w;i.default=d}),Ro=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=It(),s=xt(),m=class extends c.ContainerIterator{constructor(d,n,e){super(e),this.o=d,this.h=n,this.iteratorType===0?(this.pre=function(){return this.o===this.h.U&&(0,s.throwIteratorAccessError)(),this.o=this.o.L(),this},this.next=function(){return this.o===this.h&&(0,s.throwIteratorAccessError)(),this.o=this.o.B(),this}):(this.pre=function(){return this.o===this.h.W&&(0,s.throwIteratorAccessError)(),this.o=this.o.B(),this},this.next=function(){return this.o===this.h&&(0,s.throwIteratorAccessError)(),this.o=this.o.L(),this})}get index(){let d=this.o,n=this.h.tt;if(d===this.h)return n?n.rt-1:0;let e=0;for(d.U&&(e+=d.U.rt);d!==n;){let t=d.tt;d===t.W&&(e+=1,t.U&&(e+=t.U.rt)),d=t}return e}},w=m;i.default=w}),Hl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=w(ko()),s=w(Ro()),m=xt();function w(t){return t&&t.t?t:{default:t}}var d=class To extends s.default{constructor(r,a,o,h){super(r,a,h),this.container=o}get pointer(){return this.o===this.h&&(0,m.throwIteratorAccessError)(),this.o.u}copy(){return new To(this.o,this.h,this.container,this.iteratorType)}},n=class extends c.default{constructor(t=[],r,a){super(r,a);let o=this;t.forEach(function(h){o.insert(h)})}*K(t){t!==void 0&&(yield*this.K(t.U),yield t.u,yield*this.K(t.W))}begin(){return new d(this.h.U||this.h,this.h,this)}end(){return new d(this.h,this.h,this)}rBegin(){return new d(this.h.W||this.h,this.h,this,1)}rEnd(){return new d(this.h,this.h,this,1)}front(){return this.h.U?this.h.U.u:void 0}back(){return this.h.W?this.h.W.u:void 0}insert(t,r){return this.M(t,void 0,r)}find(t){let r=this.I(this.Y,t);return new d(r,this.h,this)}lowerBound(t){let r=this.X(this.Y,t);return new d(r,this.h,this)}upperBound(t){let r=this.Z(this.Y,t);return new d(r,this.h,this)}reverseLowerBound(t){let r=this.$(this.Y,t);return new d(r,this.h,this)}reverseUpperBound(t){let r=this.rr(this.Y,t);return new d(r,this.h,this)}union(t){let r=this;return t.forEach(function(a){r.insert(a)}),this.i}[Symbol.iterator](){return this.K(this.Y)}},e=n;i.default=e}),Wl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=w(ko()),s=w(Ro()),m=xt();function w(t){return t&&t.t?t:{default:t}}var d=class Lo extends s.default{constructor(r,a,o,h){super(r,a,h),this.container=o}get pointer(){this.o===this.h&&(0,m.throwIteratorAccessError)();let r=this;return new Proxy([],{get(a,o){if(o==="0")return r.o.u;if(o==="1")return r.o.l},set(a,o,h){if(o!=="1")throw new TypeError("props must be 1");return r.o.l=h,!0}})}copy(){return new Lo(this.o,this.h,this.container,this.iteratorType)}},n=class extends c.default{constructor(t=[],r,a){super(r,a);let o=this;t.forEach(function(h){o.setElement(h[0],h[1])})}*K(t){t!==void 0&&(yield*this.K(t.U),yield[t.u,t.l],yield*this.K(t.W))}begin(){return new d(this.h.U||this.h,this.h,this)}end(){return new d(this.h,this.h,this)}rBegin(){return new d(this.h.W||this.h,this.h,this,1)}rEnd(){return new d(this.h,this.h,this,1)}front(){if(this.i===0)return;let t=this.h.U;return[t.u,t.l]}back(){if(this.i===0)return;let t=this.h.W;return[t.u,t.l]}lowerBound(t){let r=this.X(this.Y,t);return new d(r,this.h,this)}upperBound(t){let r=this.Z(this.Y,t);return new d(r,this.h,this)}reverseLowerBound(t){let r=this.$(this.Y,t);return new d(r,this.h,this)}reverseUpperBound(t){let r=this.rr(this.Y,t);return new d(r,this.h,this)}setElement(t,r,a){return this.M(t,r,a)}find(t){let r=this.I(this.Y,t);return new d(r,this.h,this)}getElementByKey(t){return this.I(this.Y,t).l}union(t){let r=this;return t.forEach(function(a){r.setElement(a[0],a[1])}),this.i}[Symbol.iterator](){return this.K(this.Y)}},e=n;i.default=e}),Io=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=c;function c(s){let m=typeof s;return m==="object"&&s!==null||m==="function"}}),xo=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.HashContainerIterator=i.HashContainer=void 0;var c=It(),s=w(Io()),m=xt();function w(e){return e&&e.t?e:{default:e}}var d=class extends c.ContainerIterator{constructor(e,t,r){super(r),this.o=e,this.h=t,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,m.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,m.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,m.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,m.throwIteratorAccessError)(),this.o=this.o.L,this})}};i.HashContainerIterator=d;var n=class extends c.Container{constructor(){super(),this.H=[],this.g={},this.HASH_TAG=Symbol("@@HASH_TAG"),Object.setPrototypeOf(this.g,null),this.h={},this.h.L=this.h.B=this.p=this._=this.h}V(e){let{L:t,B:r}=e;t.B=r,r.L=t,e===this.p&&(this.p=r),e===this._&&(this._=t),this.i-=1}M(e,t,r){r===void 0&&(r=(0,s.default)(e));let a;if(r){let o=e[this.HASH_TAG];if(o!==void 0)return this.H[o].l=t,this.i;Object.defineProperty(e,this.HASH_TAG,{value:this.H.length,configurable:!0}),a={u:e,l:t,L:this._,B:this.h},this.H.push(a)}else{let o=this.g[e];if(o)return o.l=t,this.i;a={u:e,l:t,L:this._,B:this.h},this.g[e]=a}return this.i===0?(this.p=a,this.h.B=a):this._.B=a,this._=a,this.h.L=a,++this.i}I(e,t){if(t===void 0&&(t=(0,s.default)(e)),t){let r=e[this.HASH_TAG];return r===void 0?this.h:this.H[r]}else return this.g[e]||this.h}clear(){let e=this.HASH_TAG;this.H.forEach(function(t){delete t.u[e]}),this.H=[],this.g={},Object.setPrototypeOf(this.g,null),this.i=0,this.p=this._=this.h.L=this.h.B=this.h}eraseElementByKey(e,t){let r;if(t===void 0&&(t=(0,s.default)(e)),t){let a=e[this.HASH_TAG];if(a===void 0)return!1;delete e[this.HASH_TAG],r=this.H[a],delete this.H[a]}else{if(r=this.g[e],r===void 0)return!1;delete this.g[e]}return this.V(r),!0}eraseElementByIterator(e){let t=e.o;return t===this.h&&(0,m.throwIteratorAccessError)(),this.V(t),e.next()}eraseElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let t=this.p;for(;e--;)t=t.B;return this.V(t),this.i}};i.HashContainer=n}),$l=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=xo(),s=xt(),m=class Bo extends c.HashContainerIterator{constructor(e,t,r,a){super(e,t,a),this.container=r}get pointer(){return this.o===this.h&&(0,s.throwIteratorAccessError)(),this.o.u}copy(){return new Bo(this.o,this.h,this.container,this.iteratorType)}},w=class extends c.HashContainer{constructor(n=[]){super();let e=this;n.forEach(function(t){e.insert(t)})}begin(){return new m(this.p,this.h,this)}end(){return new m(this.h,this.h,this)}rBegin(){return new m(this._,this.h,this,1)}rEnd(){return new m(this.h,this.h,this,1)}front(){return this.p.u}back(){return this._.u}insert(n,e){return this.M(n,void 0,e)}getElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;let e=this.p;for(;n--;)e=e.B;return e.u}find(n,e){let t=this.I(n,e);return new m(t,this.h,this)}forEach(n){let e=0,t=this.p;for(;t!==this.h;)n(t.u,e++,this),t=t.B}[Symbol.iterator](){return(function*(){let n=this.p;for(;n!==this.h;)yield n.u,n=n.B}).bind(this)()}},d=w;i.default=d}),zl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),i.default=void 0;var c=xo(),s=w(Io()),m=xt();function w(t){return t&&t.t?t:{default:t}}var d=class Oo extends c.HashContainerIterator{constructor(r,a,o,h){super(r,a,h),this.container=o}get pointer(){this.o===this.h&&(0,m.throwIteratorAccessError)();let r=this;return new Proxy([],{get(a,o){if(o==="0")return r.o.u;if(o==="1")return r.o.l},set(a,o,h){if(o!=="1")throw new TypeError("props must be 1");return r.o.l=h,!0}})}copy(){return new Oo(this.o,this.h,this.container,this.iteratorType)}},n=class extends c.HashContainer{constructor(t=[]){super();let r=this;t.forEach(function(a){r.setElement(a[0],a[1])})}begin(){return new d(this.p,this.h,this)}end(){return new d(this.h,this.h,this)}rBegin(){return new d(this._,this.h,this,1)}rEnd(){return new d(this.h,this.h,this,1)}front(){if(this.i!==0)return[this.p.u,this.p.l]}back(){if(this.i!==0)return[this._.u,this._.l]}setElement(t,r,a){return this.M(t,r,a)}getElementByKey(t,r){if(r===void 0&&(r=(0,s.default)(t)),r){let o=t[this.HASH_TAG];return o!==void 0?this.H[o].l:void 0}let a=this.g[t];return a?a.l:void 0}getElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let r=this.p;for(;t--;)r=r.B;return[r.u,r.l]}find(t,r){let a=this.I(t,r);return new d(a,this.h,this)}forEach(t){let r=0,a=this.p;for(;a!==this.h;)t([a.u,a.l],r++,this),a=a.B}[Symbol.iterator](){return(function*(){let t=this.p;for(;t!==this.h;)yield[t.u,t.l],t=t.B}).bind(this)()}},e=n;i.default=e}),ql=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"t",{value:!0}),Object.defineProperty(i,"Deque",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"HashMap",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"HashSet",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"LinkList",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"OrderedMap",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(i,"OrderedSet",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(i,"PriorityQueue",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(i,"Queue",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"Stack",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"Vector",{enumerable:!0,get:function(){return w.default}});var c=o(Pl()),s=o(Dl()),m=o(Ml()),w=o(Ul()),d=o(Fl()),n=o(Nl()),e=o(Hl()),t=o(Wl()),r=o($l()),a=o(zl());function o(h){return h&&h.t?h:{default:h}}}),Vl=we((i,c)=>{pe(),ge(),_e();var s=ql().OrderedSet,m=Tt()("number-allocator:trace"),w=Tt()("number-allocator:error");function d(e,t){this.low=e,this.high=t}d.prototype.equals=function(e){return this.low===e.low&&this.high===e.high},d.prototype.compare=function(e){return this.low<e.low&&this.high<e.low?-1:e.low<this.low&&e.high<this.low?1:0};function n(e,t){if(!(this instanceof n))return new n(e,t);this.min=e,this.max=t,this.ss=new s([],(r,a)=>r.compare(a)),m("Create"),this.clear()}n.prototype.firstVacant=function(){return this.ss.size()===0?null:this.ss.front().low},n.prototype.alloc=function(){if(this.ss.size()===0)return m("alloc():empty"),null;let e=this.ss.begin(),t=e.pointer.low,r=e.pointer.high,a=t;return a+1<=r?this.ss.updateKeyByIterator(e,new d(t+1,r)):this.ss.eraseElementByPos(0),m("alloc():"+a),a},n.prototype.use=function(e){let t=new d(e,e),r=this.ss.lowerBound(t);if(!r.equals(this.ss.end())){let a=r.pointer.low,o=r.pointer.high;return r.pointer.equals(t)?(this.ss.eraseElementByIterator(r),m("use():"+e),!0):a>e?!1:a===e?(this.ss.updateKeyByIterator(r,new d(a+1,o)),m("use():"+e),!0):o===e?(this.ss.updateKeyByIterator(r,new d(a,o-1)),m("use():"+e),!0):(this.ss.updateKeyByIterator(r,new d(e+1,o)),this.ss.insert(new d(a,e-1)),m("use():"+e),!0)}return m("use():failed"),!1},n.prototype.free=function(e){if(e<this.min||e>this.max){w("free():"+e+" is out of range");return}let t=new d(e,e),r=this.ss.upperBound(t);if(r.equals(this.ss.end())){if(r.equals(this.ss.begin())){this.ss.insert(t);return}r.pre();let a=r.pointer.high;r.pointer.high+1===e?this.ss.updateKeyByIterator(r,new d(a,e)):this.ss.insert(t)}else if(r.equals(this.ss.begin()))if(e+1===r.pointer.low){let a=r.pointer.high;this.ss.updateKeyByIterator(r,new d(e,a))}else this.ss.insert(t);else{let a=r.pointer.low,o=r.pointer.high;r.pre();let h=r.pointer.low;r.pointer.high+1===e?e+1===a?(this.ss.eraseElementByIterator(r),this.ss.updateKeyByIterator(r,new d(h,o))):this.ss.updateKeyByIterator(r,new d(h,e)):e+1===a?(this.ss.eraseElementByIterator(r.next()),this.ss.insert(new d(e,o))):this.ss.insert(t)}m("free():"+e)},n.prototype.clear=function(){m("clear()"),this.ss.clear(),this.ss.insert(new d(this.min,this.max))},n.prototype.intervalCount=function(){return this.ss.size()},n.prototype.dump=function(){console.log("length:"+this.ss.size());for(let e of this.ss)console.log(e)},c.exports=n}),Po=we((i,c)=>{pe(),ge(),_e();var s=Vl();c.exports.NumberAllocator=s}),Kl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=Ol(),s=Po(),m=class{constructor(w){w>0&&(this.aliasToTopic=new c.LRUCache({max:w}),this.topicToAlias={},this.numberAllocator=new s.NumberAllocator(1,w),this.max=w,this.length=0)}put(w,d){if(d===0||d>this.max)return!1;let n=this.aliasToTopic.get(d);return n&&delete this.topicToAlias[n],this.aliasToTopic.set(d,w),this.topicToAlias[w]=d,this.numberAllocator.use(d),this.length=this.aliasToTopic.size,!0}getTopicByAlias(w){return this.aliasToTopic.get(w)}getAliasByTopic(w){let d=this.topicToAlias[w];return typeof d<"u"&&this.aliasToTopic.get(d),d}clear(){this.aliasToTopic.clear(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0}getLruAlias(){return this.numberAllocator.firstVacant()||[...this.aliasToTopic.keys()][this.aliasToTopic.size-1]}};i.default=m}),Gl=we(i=>{pe(),ge(),_e();var c=i&&i.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(i,"__esModule",{value:!0});var s=Hr(),m=c(Kl()),w=mr(),d=(n,e)=>{n.log("_handleConnack");let{options:t}=n,r=t.protocolVersion===5?e.reasonCode:e.returnCode;if(clearTimeout(n.connackTimer),delete n.topicAliasSend,e.properties){if(e.properties.topicAliasMaximum){if(e.properties.topicAliasMaximum>65535){n.emit("error",new Error("topicAliasMaximum from broker is out of range"));return}e.properties.topicAliasMaximum>0&&(n.topicAliasSend=new m.default(e.properties.topicAliasMaximum))}e.properties.serverKeepAlive&&t.keepalive&&(t.keepalive=e.properties.serverKeepAlive,n._shiftPingInterval()),e.properties.maximumPacketSize&&(t.properties||(t.properties={}),t.properties.maximumPacketSize=e.properties.maximumPacketSize)}if(r===0)n.reconnecting=!1,n._onConnect(e);else if(r>0){let a=new w.ErrorWithReasonCode(`Connection refused: ${s.ReasonCodes[r]}`,r);n.emit("error",a)}};i.default=d}),Yl=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=(s,m,w)=>{s.log("handling pubrel packet");let d=typeof w<"u"?w:s.noop,{messageId:n}=m,e={cmd:"pubcomp",messageId:n};s.incomingStore.get(m,(t,r)=>{t?s._sendPacket(e,d):(s.emit("message",r.topic,r.payload,r),s.handleMessage(r,a=>{if(a)return d(a);s.incomingStore.del(r,s.noop),s._sendPacket(e,d)}))})};i.default=c}),Jl=we(i=>{pe(),ge(),_e();var c=i&&i.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(i,"__esModule",{value:!0});var s=c(xl()),m=c(Bl()),w=c(Gl()),d=c(Hr()),n=c(Yl()),e=(t,r,a)=>{let{options:o}=t;if(o.protocolVersion===5&&o.properties&&o.properties.maximumPacketSize&&o.properties.maximumPacketSize<r.length)return t.emit("error",new Error(`exceeding packets size ${r.cmd}`)),t.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),t;switch(t.log("_handlePacket :: emitting packetreceive"),t.emit("packetreceive",r),r.cmd){case"publish":(0,s.default)(t,r,a);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":(0,d.default)(t,r),a();break;case"pubrel":(0,n.default)(t,r,a);break;case"connack":(0,w.default)(t,r),a();break;case"auth":(0,m.default)(t,r),a();break;case"pingresp":t.pingResp=!0,a();break;case"disconnect":t.emit("disconnect",r),a();break;default:t.log("_handlePacket :: unknown command"),a();break}};i.default=e}),Xl=we(i=>{pe(),ge(),_e();var c=i&&i.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(i,"__esModule",{value:!0}),i.TypedEventEmitter=void 0;var s=c((lr(),Pe(tr))),m=mr(),w=class{};i.TypedEventEmitter=w,(0,m.applyMixin)(w,s.default)}),Ql=we((i,c)=>{pe(),ge(),_e(),function(s,m){typeof i=="object"&&typeof c<"u"?m(i):typeof define=="function"&&define.amd?define(["exports"],m):(s=typeof globalThis<"u"?globalThis:s||self,m(s.fastUniqueNumbers={}))}(i,function(s){var m=function(_){return function(v){var g=_(v);return v.add(g),g}},w=function(_){return function(v,g){return _.set(v,g),g}},d=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,n=536870912,e=n*2,t=function(_,v){return function(g){var l=v.get(g),p=l===void 0?g.size:l<e?l+1:0;if(!g.has(p))return _(g,p);if(g.size<n){for(;g.has(p);)p=Math.floor(Math.random()*e);return _(g,p)}if(g.size>d)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;g.has(p);)p=Math.floor(Math.random()*d);return _(g,p)}},r=new WeakMap,a=w(r),o=t(a,r),h=m(o);s.addUniqueNumber=h,s.generateUniqueNumber=o})}),Zl=we((i,c)=>{pe(),ge(),_e(),function(s,m){typeof i=="object"&&typeof c<"u"?m(i,Ql()):typeof define=="function"&&define.amd?define(["exports","fast-unique-numbers"],m):(s=typeof globalThis<"u"?globalThis:s||self,m(s.workerTimersBroker={},s.fastUniqueNumbers))}(i,function(s,m){var w=function(e){return e.method!==void 0&&e.method==="call"},d=function(e){return e.error===null&&typeof e.id=="number"},n=function(e){var t=new Map([[0,function(){}]]),r=new Map([[0,function(){}]]),a=new Map,o=new Worker(e);o.addEventListener("message",function(l){var p=l.data;if(w(p)){var u=p.params,f=u.timerId,y=u.timerType;if(y==="interval"){var b=t.get(f);if(typeof b=="number"){var A=a.get(b);if(A===void 0||A.timerId!==f||A.timerType!==y)throw new Error("The timer is in an undefined state.")}else if(typeof b<"u")b();else throw new Error("The timer is in an undefined state.")}else if(y==="timeout"){var R=r.get(f);if(typeof R=="number"){var C=a.get(R);if(C===void 0||C.timerId!==f||C.timerType!==y)throw new Error("The timer is in an undefined state.")}else if(typeof R<"u")R(),r.delete(f);else throw new Error("The timer is in an undefined state.")}}else if(d(p)){var L=p.id,O=a.get(L);if(O===void 0)throw new Error("The timer is in an undefined state.");var N=O.timerId,I=O.timerType;a.delete(L),I==="interval"?t.delete(N):r.delete(N)}else{var P=p.error.message;throw new Error(P)}});var h=function(l){var p=m.generateUniqueNumber(a);a.set(p,{timerId:l,timerType:"interval"}),t.set(l,p),o.postMessage({id:p,method:"clear",params:{timerId:l,timerType:"interval"}})},_=function(l){var p=m.generateUniqueNumber(a);a.set(p,{timerId:l,timerType:"timeout"}),r.set(l,p),o.postMessage({id:p,method:"clear",params:{timerId:l,timerType:"timeout"}})},v=function(l,p){var u=m.generateUniqueNumber(t);return t.set(u,function(){l(),typeof t.get(u)=="function"&&o.postMessage({id:null,method:"set",params:{delay:p,now:performance.now(),timerId:u,timerType:"interval"}})}),o.postMessage({id:null,method:"set",params:{delay:p,now:performance.now(),timerId:u,timerType:"interval"}}),u},g=function(l,p){var u=m.generateUniqueNumber(r);return r.set(u,l),o.postMessage({id:null,method:"set",params:{delay:p,now:performance.now(),timerId:u,timerType:"timeout"}}),u};return{clearInterval:h,clearTimeout:_,setInterval:v,setTimeout:g}};s.load=n})}),eh=we((i,c)=>{pe(),ge(),_e(),function(s,m){typeof i=="object"&&typeof c<"u"?m(i,Zl()):typeof define=="function"&&define.amd?define(["exports","worker-timers-broker"],m):(s=typeof globalThis<"u"?globalThis:s||self,m(s.workerTimers={},s.workerTimersBroker))}(i,function(s,m){var w=function(o,h){var _=null;return function(){if(_!==null)return _;var v=new Blob([h],{type:"application/javascript; charset=utf-8"}),g=URL.createObjectURL(v);return _=o(g),setTimeout(function(){return URL.revokeObjectURL(g)}),_}},d=`(()=>{var e={67:(e,t,r)=>{var o,i;void 0===(i="function"==typeof(o=function(){"use strict";var e=new Map,t=new Map,r=function(t){var r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)},o=function(e){var r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)},i=function(e,t){var r,o=performance.now();return{expected:o+(r=e-Math.max(0,o-t)),remainingDelay:r}},n=function e(t,r,o,i){var n=performance.now();n>o?postMessage({id:null,method:"call",params:{timerId:r,timerType:i}}):t.set(r,setTimeout(e,o-n,t,r,o,i))},a=function(t,r,o){var a=i(t,o),s=a.expected,d=a.remainingDelay;e.set(r,setTimeout(n,d,e,r,s,"interval"))},s=function(e,r,o){var a=i(e,o),s=a.expected,d=a.remainingDelay;t.set(r,setTimeout(n,d,t,r,s,"timeout"))};addEventListener("message",(function(e){var t=e.data;try{if("clear"===t.method){var i=t.id,n=t.params,d=n.timerId,c=n.timerType;if("interval"===c)r(d),postMessage({error:null,id:i});else{if("timeout"!==c)throw new Error('The given type "'.concat(c,'" is not supported'));o(d),postMessage({error:null,id:i})}}else{if("set"!==t.method)throw new Error('The given method "'.concat(t.method,'" is not supported'));var u=t.params,l=u.delay,p=u.now,m=u.timerId,v=u.timerType;if("interval"===v)a(l,m,p);else{if("timeout"!==v)throw new Error('The given type "'.concat(v,'" is not supported'));s(l,m,p)}}}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}}))})?o.call(t,r,t,e):o)||(e.exports=i)}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";r(67)})()})();`,n=w(m.load,d),e=function(o){return n().clearInterval(o)},t=function(o){return n().clearTimeout(o)},r=function(o,h){return n().setInterval(o,h)},a=function(o,h){return n().setTimeout(o,h)};s.clearInterval=e,s.clearTimeout=t,s.setInterval=r,s.setTimeout=a})}),Ds=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0}),i.isWebWorker=void 0;var c=()=>typeof window<"u"&&typeof window.document<"u",s=()=>{var d,n;return!!(typeof self=="object"&&!((n=(d=self==null?void 0:self.constructor)===null||d===void 0?void 0:d.name)===null||n===void 0)&&n.includes("WorkerGlobalScope"))},m=()=>typeof navigator<"u"&&navigator.product==="ReactNative",w=c()||s()||m();i.isWebWorker=s(),i.default=w}),th=we(i=>{pe(),ge(),_e();var c=i&&i.__createBinding||(Object.create?function(e,t,r,a){a===void 0&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){a===void 0&&(a=r),e[a]=t[r]}),s=i&&i.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),m=i&&i.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&c(t,e,r);return s(t,e),t};Object.defineProperty(i,"__esModule",{value:!0});var w=eh(),d=m(Ds()),n=class{constructor(e,t){this._setTimeout=d.default&&!d.isWebWorker?w.setTimeout:(r,a)=>setTimeout(r,a),this._clearTimeout=d.default&&!d.isWebWorker?w.clearTimeout:r=>clearTimeout(r),this.keepalive=e*1e3,this.checkPing=t,this.setup()}setup(){this.timer=this._setTimeout(()=>{this.checkPing(),this.reschedule()},this.keepalive)}clear(){this.timer&&(this._clearTimeout(this.timer),this.timer=null)}reschedule(){this.clear(),this.setup()}};i.default=n}),vs=we(i=>{pe(),ge(),_e();var c=i&&i.__createBinding||(Object.create?function(y,b,A,R){R===void 0&&(R=A);var C=Object.getOwnPropertyDescriptor(b,A);(!C||("get"in C?!b.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return b[A]}}),Object.defineProperty(y,R,C)}:function(y,b,A,R){R===void 0&&(R=A),y[R]=b[A]}),s=i&&i.__setModuleDefault||(Object.create?function(y,b){Object.defineProperty(y,"default",{enumerable:!0,value:b})}:function(y,b){y.default=b}),m=i&&i.__importStar||function(y){if(y&&y.__esModule)return y;var b={};if(y!=null)for(var A in y)A!=="default"&&Object.prototype.hasOwnProperty.call(y,A)&&c(b,y,A);return s(b,y),b},w=i&&i.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(i,"__esModule",{value:!0});var d=w(qa()),n=w(Rl()),e=w(mo()),t=rr(),r=w(Ll()),a=m(Il()),o=w(Tt()),h=w(bo()),_=w(Jl()),v=mr(),g=Xl(),l=w(th()),p=globalThis.setImmediate||((...y)=>{let b=y.shift();(0,v.nextTick)(()=>{b(...y)})}),u={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:30*1e3,clean:!0,resubscribe:!0,writeCache:!0},f=class Do extends g.TypedEventEmitter{static defaultId(){return`mqttjs_${Math.random().toString(16).substr(2,8)}`}constructor(b,A){super(),this.options=A||{};for(let R in u)typeof this.options[R]>"u"?this.options[R]=u[R]:this.options[R]=A[R];this.log=this.options.log||(0,o.default)("mqttjs:client"),this.noop=this._noop.bind(this),this.log("MqttClient :: options.protocol",A.protocol),this.log("MqttClient :: options.protocolVersion",A.protocolVersion),this.log("MqttClient :: options.username",A.username),this.log("MqttClient :: options.keepalive",A.keepalive),this.log("MqttClient :: options.reconnectPeriod",A.reconnectPeriod),this.log("MqttClient :: options.rejectUnauthorized",A.rejectUnauthorized),this.log("MqttClient :: options.properties.topicAliasMaximum",A.properties?A.properties.topicAliasMaximum:void 0),this.options.clientId=typeof A.clientId=="string"?A.clientId:Do.defaultId(),this.log("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=A.protocolVersion===5&&A.customHandleAcks?A.customHandleAcks:(...R)=>{R[3](null,0)},this.options.writeCache||(n.default.writeToStream.cacheNumbers=!1),this.streamBuilder=b,this.messageIdProvider=typeof this.options.messageIdProvider>"u"?new e.default:this.options.messageIdProvider,this.outgoingStore=A.outgoingStore||new h.default,this.incomingStore=A.incomingStore||new h.default,this.queueQoSZero=A.queueQoSZero===void 0?!0:A.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.reconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,A.properties&&A.properties.topicAliasMaximum>0&&(A.properties.topicAliasMaximum>65535?this.log("MqttClient :: options.properties.topicAliasMaximum is out of range"):this.topicAliasRecv=new d.default(A.properties.topicAliasMaximum)),this.on("connect",()=>{let{queue:R}=this,C=()=>{let L=R.shift();this.log("deliver :: entry %o",L);let O=null;if(!L){this._resubscribe();return}O=L.packet,this.log("deliver :: call _sendPacket for %o",O);let N=!0;O.messageId&&O.messageId!==0&&(this.messageIdProvider.register(O.messageId)||(N=!1)),N?this._sendPacket(O,I=>{L.cb&&L.cb(I),C()}):(this.log("messageId: %d has already used. The message is skipped and removed.",O.messageId),C())};this.log("connect :: sending queued packets"),C()}),this.on("close",()=>{this.log("close :: connected set to `false`"),this.connected=!1,this.log("close :: clearing connackTimer"),clearTimeout(this.connackTimer),this.log("close :: clearing ping timer"),this.pingTimer!==null&&(this.pingTimer.clear(),this.pingTimer=null),this.topicAliasRecv&&this.topicAliasRecv.clear(),this.log("close :: calling _setupReconnect"),this._setupReconnect()}),this.options.manualConnect||(this.log("MqttClient :: setting up stream"),this.connect())}handleAuth(b,A){A()}handleMessage(b,A){A()}_nextId(){return this.messageIdProvider.allocate()}getLastMessageId(){return this.messageIdProvider.getLastAllocated()}connect(){var b;let A=new t.Writable,R=n.default.parser(this.options),C=null,L=[];this.log("connect :: calling method to clear reconnect"),this._clearReconnect(),this.log("connect :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),R.on("packet",V=>{this.log("parser :: on packet push to packets array."),L.push(V)});let O=()=>{this.log("work :: getting next packet in queue");let V=L.shift();if(V)this.log("work :: packet pulled from queue"),(0,_.default)(this,V,N);else{this.log("work :: no packets in queue");let G=C;C=null,this.log("work :: done flag is %s",!!G),G&&G()}},N=()=>{if(L.length)(0,v.nextTick)(O);else{let V=C;C=null,V()}};A._write=(V,G,re)=>{C=re,this.log("writable stream :: parsing buffer"),R.parse(V),O()};let I=V=>{this.log("streamErrorHandler :: error",V.message),V.code?(this.log("streamErrorHandler :: emitting error"),this.emit("error",V)):this.noop(V)};this.log("connect :: pipe stream to writable stream"),this.stream.pipe(A),this.stream.on("error",I),this.stream.on("close",()=>{this.log("(%s)stream :: on close",this.options.clientId),this._flushVolatile(),this.log("stream: emit close to MqttClient"),this.emit("close")}),this.log("connect: sending packet `connect`");let P={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};if(this.options.will&&(P.will=Object.assign(Object.assign({},this.options.will),{payload:(b=this.options.will)===null||b===void 0?void 0:b.payload})),this.topicAliasRecv&&(P.properties||(P.properties={}),this.topicAliasRecv&&(P.properties.topicAliasMaximum=this.topicAliasRecv.max)),this._writePacket(P),R.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return this.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&typeof this.options.authPacket=="object"){let V=Object.assign({cmd:"auth",reasonCode:0},this.options.authPacket);this._writePacket(V)}}return this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(()=>{this.log("!!connectTimeout hit!! Calling _cleanUp with force `true`"),this._cleanUp(!0)},this.options.connectTimeout),this}publish(b,A,R,C){this.log("publish :: message `%s` to topic `%s`",A,b);let{options:L}=this;typeof R=="function"&&(C=R,R=null),R=R||{},R=Object.assign(Object.assign({},{qos:0,retain:!1,dup:!1}),R);let{qos:O,retain:N,dup:I,properties:P,cbStorePut:V}=R;if(this._checkDisconnecting(C))return this;let G=()=>{let re=0;if((O===1||O===2)&&(re=this._nextId(),re===null))return this.log("No messageId left"),!1;let J={cmd:"publish",topic:b,payload:A,qos:O,retain:N,messageId:re,dup:I};switch(L.protocolVersion===5&&(J.properties=P),this.log("publish :: qos",O),O){case 1:case 2:this.outgoing[J.messageId]={volatile:!1,cb:C||this.noop},this.log("MqttClient:publish: packet cmd: %s",J.cmd),this._sendPacket(J,void 0,V);break;default:this.log("MqttClient:publish: packet cmd: %s",J.cmd),this._sendPacket(J,C,V);break}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!G())&&this._storeProcessingQueue.push({invoke:G,cbStorePut:R.cbStorePut,callback:C}),this}publishAsync(b,A,R){return new Promise((C,L)=>{this.publish(b,A,R,(O,N)=>{O?L(O):C(N)})})}subscribe(b,A,R){let C=this.options.protocolVersion;typeof A=="function"&&(R=A),R=R||this.noop;let L=!1,O=[];typeof b=="string"?(b=[b],O=b):Array.isArray(b)?O=b:typeof b=="object"&&(L=b.resubscribe,delete b.resubscribe,O=Object.keys(b));let N=a.validateTopics(O);if(N!==null)return p(R,new Error(`Invalid topic ${N}`)),this;if(this._checkDisconnecting(R))return this.log("subscribe: discconecting true"),this;let I={qos:0};C===5&&(I.nl=!1,I.rap=!1,I.rh=0),A=Object.assign(Object.assign({},I),A);let P=A.properties,V=[],G=(J,x)=>{if(x=x||A,!Object.prototype.hasOwnProperty.call(this._resubscribeTopics,J)||this._resubscribeTopics[J].qos<x.qos||L){let U={topic:J,qos:x.qos};C===5&&(U.nl=x.nl,U.rap=x.rap,U.rh=x.rh,U.properties=P),this.log("subscribe: pushing topic `%s` and qos `%s` to subs list",U.topic,U.qos),V.push(U)}};if(Array.isArray(b)?b.forEach(J=>{this.log("subscribe: array topic %s",J),G(J)}):Object.keys(b).forEach(J=>{this.log("subscribe: object topic %s, %o",J,b[J]),G(J,b[J])}),!V.length)return R(null,[]),this;let re=()=>{let J=this._nextId();if(J===null)return this.log("No messageId left"),!1;let x={cmd:"subscribe",subscriptions:V,messageId:J};if(P&&(x.properties=P),this.options.resubscribe){this.log("subscribe :: resubscribe true");let U=[];V.forEach(F=>{if(this.options.reconnectPeriod>0){let z={qos:F.qos};C===5&&(z.nl=F.nl||!1,z.rap=F.rap||!1,z.rh=F.rh||0,z.properties=F.properties),this._resubscribeTopics[F.topic]=z,U.push(F.topic)}}),this.messageIdToTopic[x.messageId]=U}return this.outgoing[x.messageId]={volatile:!0,cb(U,F){if(!U){let{granted:z}=F;for(let D=0;D<z.length;D+=1)V[D].qos=z[D]}R(U,V)}},this.log("subscribe :: call _sendPacket"),this._sendPacket(x),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!re())&&this._storeProcessingQueue.push({invoke:re,callback:R}),this}subscribeAsync(b,A){return new Promise((R,C)=>{this.subscribe(b,A,(L,O)=>{L?C(L):R(O)})})}unsubscribe(b,A,R){typeof b=="string"&&(b=[b]),typeof A=="function"&&(R=A),R=R||this.noop;let C=a.validateTopics(b);if(C!==null)return p(R,new Error(`Invalid topic ${C}`)),this;if(this._checkDisconnecting(R))return this;let L=()=>{let O=this._nextId();if(O===null)return this.log("No messageId left"),!1;let N={cmd:"unsubscribe",messageId:O,unsubscriptions:[]};return typeof b=="string"?N.unsubscriptions=[b]:Array.isArray(b)&&(N.unsubscriptions=b),this.options.resubscribe&&N.unsubscriptions.forEach(I=>{delete this._resubscribeTopics[I]}),typeof A=="object"&&A.properties&&(N.properties=A.properties),this.outgoing[N.messageId]={volatile:!0,cb:R},this.log("unsubscribe: call _sendPacket"),this._sendPacket(N),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!L())&&this._storeProcessingQueue.push({invoke:L,callback:R}),this}unsubscribeAsync(b,A){return new Promise((R,C)=>{this.unsubscribe(b,A,(L,O)=>{L?C(L):R(O)})})}end(b,A,R){this.log("end :: (%s)",this.options.clientId),(b==null||typeof b!="boolean")&&(R=R||A,A=b,b=!1),typeof A!="object"&&(R=R||A,A=null),this.log("end :: cb? %s",!!R),(!R||typeof R!="function")&&(R=this.noop);let C=()=>{this.log("end :: closeStores: closing incoming and outgoing stores"),this.disconnected=!0,this.incomingStore.close(O=>{this.outgoingStore.close(N=>{if(this.log("end :: closeStores: emitting end"),this.emit("end"),R){let I=O||N;this.log("end :: closeStores: invoking callback with args"),R(I)}})}),this._deferredReconnect&&this._deferredReconnect()},L=()=>{this.log("end :: (%s) :: finish :: calling _cleanUp with force %s",this.options.clientId,b),this._cleanUp(b,()=>{this.log("end :: finish :: calling process.nextTick on closeStores"),(0,v.nextTick)(C)},A)};return this.disconnecting?(R(),this):(this._clearReconnect(),this.disconnecting=!0,!b&&Object.keys(this.outgoing).length>0?(this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,L,10))):(this.log("end :: (%s) :: immediately calling finish",this.options.clientId),L()),this)}endAsync(b,A){return new Promise((R,C)=>{this.end(b,A,L=>{L?C(L):R()})})}removeOutgoingMessage(b){if(this.outgoing[b]){let{cb:A}=this.outgoing[b];this._removeOutgoingAndStoreMessage(b,()=>{A(new Error("Message removed"))})}return this}reconnect(b){this.log("client reconnect");let A=()=>{b?(this.options.incomingStore=b.incomingStore,this.options.outgoingStore=b.outgoingStore):(this.options.incomingStore=null,this.options.outgoingStore=null),this.incomingStore=this.options.incomingStore||new h.default,this.outgoingStore=this.options.outgoingStore||new h.default,this.disconnecting=!1,this.disconnected=!1,this._deferredReconnect=null,this._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=A:A(),this}_flushVolatile(){this.outgoing&&(this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(this.outgoing).forEach(b=>{this.outgoing[b].volatile&&typeof this.outgoing[b].cb=="function"&&(this.outgoing[b].cb(new Error("Connection closed")),delete this.outgoing[b])}))}_flush(){this.outgoing&&(this.log("_flush: queue exists? %b",!!this.outgoing),Object.keys(this.outgoing).forEach(b=>{typeof this.outgoing[b].cb=="function"&&(this.outgoing[b].cb(new Error("Connection closed")),delete this.outgoing[b])}))}_removeTopicAliasAndRecoverTopicName(b){let A;b.properties&&(A=b.properties.topicAlias);let R=b.topic.toString();if(this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",A,R),R.length===0){if(typeof A>"u")return new Error("Unregistered Topic Alias");if(R=this.topicAliasSend.getTopicByAlias(A),typeof R>"u")return new Error("Unregistered Topic Alias");b.topic=R}A&&delete b.properties.topicAlias}_checkDisconnecting(b){return this.disconnecting&&(b&&b!==this.noop?b(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting}_reconnect(){this.log("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this.connect()}),this.log("client already connected. disconnecting first.")):(this.log("_reconnect: calling connect"),this.connect())}_setupReconnect(){!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0?(this.reconnecting||(this.log("_setupReconnect :: emit `offline` state"),this.emit("offline"),this.log("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod),this.reconnectTimer=setInterval(()=>{this.log("reconnectTimer :: reconnect triggered!"),this._reconnect()},this.options.reconnectPeriod)):this.log("_setupReconnect :: doing nothing...")}_clearReconnect(){this.log("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)}_cleanUp(b,A,R={}){if(A&&(this.log("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",A)),this.log("_cleanUp :: forced? %s",b),b)this.options.reconnectPeriod===0&&this.options.clean&&this._flush(),this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{let C=Object.assign({cmd:"disconnect"},R);this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(C,()=>{this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),p(()=>{this.stream.end(()=>{this.log("_cleanUp :: (%s) :: stream destroyed",this.options.clientId)})})})}this.disconnecting||(this.log("_cleanUp :: client not disconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),this.pingTimer!==null&&(this.log("_cleanUp :: clearing pingTimer"),this.pingTimer.clear(),this.pingTimer=null),A&&!this.connected&&(this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",A),A())}_storeAndSend(b,A,R){this.log("storeAndSend :: store packet with cmd %s to outgoingStore",b.cmd);let C=b,L;if(C.cmd==="publish"&&(C=(0,r.default)(b),L=this._removeTopicAliasAndRecoverTopicName(C),L))return A&&A(L);this.outgoingStore.put(C,O=>{if(O)return A&&A(O);R(),this._writePacket(b,A)})}_applyTopicAlias(b){if(this.options.protocolVersion===5&&b.cmd==="publish"){let A;b.properties&&(A=b.properties.topicAlias);let R=b.topic.toString();if(this.topicAliasSend)if(A){if(R.length!==0&&(this.log("applyTopicAlias :: register topic: %s - alias: %d",R,A),!this.topicAliasSend.put(R,A)))return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",R,A),new Error("Sending Topic Alias out of range")}else R.length!==0&&(this.options.autoAssignTopicAlias?(A=this.topicAliasSend.getAliasByTopic(R),A?(b.topic="",b.properties=Object.assign(Object.assign({},b.properties),{topicAlias:A}),this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",R,A)):(A=this.topicAliasSend.getLruAlias(),this.topicAliasSend.put(R,A),b.properties=Object.assign(Object.assign({},b.properties),{topicAlias:A}),this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",R,A))):this.options.autoUseTopicAlias&&(A=this.topicAliasSend.getAliasByTopic(R),A&&(b.topic="",b.properties=Object.assign(Object.assign({},b.properties),{topicAlias:A}),this.log("applyTopicAlias :: auto use topic: %s - alias: %d",R,A))));else if(A)return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",R,A),new Error("Sending Topic Alias out of range")}}_noop(b){this.log("noop ::",b)}_writePacket(b,A){this.log("_writePacket :: packet: %O",b),this.log("_writePacket :: emitting `packetsend`"),this.emit("packetsend",b),this._shiftPingInterval(),this.log("_writePacket :: writing to stream");let R=n.default.writeToStream(b,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",R),!R&&A&&A!==this.noop?(this.log("_writePacket :: handle events on `drain` once through callback."),this.stream.once("drain",A)):A&&(this.log("_writePacket :: invoking cb"),A())}_sendPacket(b,A,R,C){this.log("_sendPacket :: (%s) ::  start",this.options.clientId),R=R||this.noop,A=A||this.noop;let L=this._applyTopicAlias(b);if(L){A(L);return}if(!this.connected){if(b.cmd==="auth"){this._writePacket(b,A);return}this.log("_sendPacket :: client not connected. Storing packet offline."),this._storePacket(b,A,R);return}if(C){this._writePacket(b,A);return}switch(b.cmd){case"publish":break;case"pubrel":this._storeAndSend(b,A,R);return;default:this._writePacket(b,A);return}switch(b.qos){case 2:case 1:this._storeAndSend(b,A,R);break;case 0:default:this._writePacket(b,A);break}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}_storePacket(b,A,R){this.log("_storePacket :: packet: %o",b),this.log("_storePacket :: cb? %s",!!A),R=R||this.noop;let C=b;if(C.cmd==="publish"){C=(0,r.default)(b);let O=this._removeTopicAliasAndRecoverTopicName(C);if(O)return A&&A(O)}let L=C.qos||0;L===0&&this.queueQoSZero||C.cmd!=="publish"?this.queue.push({packet:C,cb:A}):L>0?(A=this.outgoing[C.messageId]?this.outgoing[C.messageId].cb:null,this.outgoingStore.put(C,O=>{if(O)return A&&A(O);R()})):A&&A(new Error("No connection to broker"))}_setupPingTimer(){this.log("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive),!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=new l.default(this.options.keepalive,()=>{this._checkPing()}))}_shiftPingInterval(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule()}_checkPing(){this.log("_checkPing :: checking ping..."),this.pingResp?(this.log("_checkPing :: ping response received. Clearing flag and sending `pingreq`"),this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):(this.log("_checkPing :: calling _cleanUp with force true"),this._cleanUp(!0))}_resubscribe(){this.log("_resubscribe");let b=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&b.length>0)if(this.options.resubscribe)if(this.options.protocolVersion===5){this.log("_resubscribe: protocolVersion 5");for(let A=0;A<b.length;A++){let R={};R[b[A]]=this._resubscribeTopics[b[A]],R.resubscribe=!0,this.subscribe(R,{properties:R[b[A]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1}_onConnect(b){if(this.disconnected){this.emit("connect",b);return}this.connackPacket=b,this.messageIdProvider.clear(),this._setupPingTimer(),this.connected=!0;let A=()=>{let R=this.outgoingStore.createStream(),C=()=>{R.destroy(),R=null,this._flushStoreProcessingQueue(),L()},L=()=>{this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={}};this.once("close",C),R.on("error",N=>{L(),this._flushStoreProcessingQueue(),this.removeListener("close",C),this.emit("error",N)});let O=()=>{if(!R)return;let N=R.read(1),I;if(!N){R.once("readable",O);return}if(this._storeProcessing=!0,this._packetIdsDuringStoreProcessing[N.messageId]){O();return}!this.disconnecting&&!this.reconnectTimer?(I=this.outgoing[N.messageId]?this.outgoing[N.messageId].cb:null,this.outgoing[N.messageId]={volatile:!1,cb(P,V){I&&I(P,V),O()}},this._packetIdsDuringStoreProcessing[N.messageId]=!0,this.messageIdProvider.register(N.messageId)?this._sendPacket(N,void 0,void 0,!0):this.log("messageId: %d has already used.",N.messageId)):R.destroy&&R.destroy()};R.on("end",()=>{let N=!0;for(let I in this._packetIdsDuringStoreProcessing)if(!this._packetIdsDuringStoreProcessing[I]){N=!1;break}this.removeListener("close",C),N?(L(),this._invokeAllStoreProcessingQueue(),this.emit("connect",b)):A()}),O()};A()}_invokeStoreProcessingQueue(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){let b=this._storeProcessingQueue[0];if(b&&b.invoke())return this._storeProcessingQueue.shift(),!0}return!1}_invokeAllStoreProcessingQueue(){for(;this._invokeStoreProcessingQueue(););}_flushStoreProcessingQueue(){for(let b of this._storeProcessingQueue)b.cbStorePut&&b.cbStorePut(new Error("Connection closed")),b.callback&&b.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)}_removeOutgoingAndStoreMessage(b,A){delete this.outgoing[b],this.outgoingStore.del({messageId:b},(R,C)=>{A(R,C),this.messageIdProvider.deallocate(b),this._invokeStoreProcessingQueue()})}};i.default=f}),rh=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=Po(),s=class{constructor(){this.numberAllocator=new c.NumberAllocator(1,65535)}allocate(){return this.lastId=this.numberAllocator.alloc(),this.lastId}getLastAllocated(){return this.lastId}register(m){return this.numberAllocator.use(m)}deallocate(m){this.numberAllocator.free(m)}clear(){this.numberAllocator.clear()}};i.default=s});function $t(i){throw new RangeError(Uo[i])}function an(i,c){let s=i.split("@"),m="";s.length>1&&(m=s[0]+"@",i=s[1]);let w=function(d,n){let e=[],t=d.length;for(;t--;)e[t]=n(d[t]);return e}((i=i.replace(Mo,".")).split("."),c).join(".");return m+w}function ln(i){let c=[],s=0,m=i.length;for(;s<m;){let w=i.charCodeAt(s++);if(w>=55296&&w<=56319&&s<m){let d=i.charCodeAt(s++);(64512&d)==56320?c.push(((1023&w)<<10)+(1023&d)+65536):(c.push(w),s--)}else c.push(w)}return c}var hn,cn,Mo,Uo,ct,wr,Xr,Qr,Zr,ei,Mt,ih=Je(()=>{pe(),ge(),_e(),hn=/^xn--/,cn=/[^\0-\x7E]/,Mo=/[\x2E\u3002\uFF0E\uFF61]/g,Uo={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ct=Math.floor,wr=String.fromCharCode,Xr=function(i,c){return i+22+75*(i<26)-((c!=0)<<5)},Qr=function(i,c,s){let m=0;for(i=s?ct(i/700):i>>1,i+=ct(i/c);i>455;m+=36)i=ct(i/35);return ct(m+36*i/(i+38))},Zr=function(i){let c=[],s=i.length,m=0,w=128,d=72,n=i.lastIndexOf("-");n<0&&(n=0);for(let t=0;t<n;++t)i.charCodeAt(t)>=128&&$t("not-basic"),c.push(i.charCodeAt(t));for(let t=n>0?n+1:0;t<s;){let r=m;for(let o=1,h=36;;h+=36){t>=s&&$t("invalid-input");let _=(e=i.charCodeAt(t++))-48<10?e-22:e-65<26?e-65:e-97<26?e-97:36;(_>=36||_>ct((2147483647-m)/o))&&$t("overflow"),m+=_*o;let v=h<=d?1:h>=d+26?26:h-d;if(_<v)break;let g=36-v;o>ct(2147483647/g)&&$t("overflow"),o*=g}let a=c.length+1;d=Qr(m-r,a,r==0),ct(m/a)>2147483647-w&&$t("overflow"),w+=ct(m/a),m%=a,c.splice(m++,0,w)}var e;return String.fromCodePoint(...c)},ei=function(i){let c=[],s=(i=ln(i)).length,m=128,w=0,d=72;for(let t of i)t<128&&c.push(wr(t));let n=c.length,e=n;for(n&&c.push("-");e<s;){let t=2147483647;for(let a of i)a>=m&&a<t&&(t=a);let r=e+1;t-m>ct((2147483647-w)/r)&&$t("overflow"),w+=(t-m)*r,m=t;for(let a of i)if(a<m&&++w>2147483647&&$t("overflow"),a==m){let o=w;for(let h=36;;h+=36){let _=h<=d?1:h>=d+26?26:h-d;if(o<_)break;let v=o-_,g=36-_;c.push(wr(Xr(_+v%g,0))),o=ct(v/g)}c.push(wr(Xr(o,0))),d=Qr(w,r,e==n),w=0,++e}++w,++m}return c.join("")},Mt={version:"2.1.0",ucs2:{decode:ln,encode:i=>String.fromCodePoint(...i)},decode:Zr,encode:ei,toASCII:function(i){return an(i,function(c){return cn.test(c)?"xn--"+ei(c):c})},toUnicode:function(i){return an(i,function(c){return hn.test(c)?Zr(c.slice(4).toLowerCase()):c})}},Mt.decode,Mt.encode,Mt.toASCII,Mt.toUnicode,Mt.ucs2,Mt.version});function sh(i,c){return Object.prototype.hasOwnProperty.call(i,c)}var un,ir,dn,_t,nh=Je(()=>{pe(),ge(),_e(),un=function(i,c,s,m){c=c||"&",s=s||"=";var w={};if(typeof i!="string"||i.length===0)return w;var d=/\+/g;i=i.split(c);var n=1e3;m&&typeof m.maxKeys=="number"&&(n=m.maxKeys);var e=i.length;n>0&&e>n&&(e=n);for(var t=0;t<e;++t){var r,a,o,h,_=i[t].replace(d,"%20"),v=_.indexOf(s);v>=0?(r=_.substr(0,v),a=_.substr(v+1)):(r=_,a=""),o=decodeURIComponent(r),h=decodeURIComponent(a),sh(w,o)?Array.isArray(w[o])?w[o].push(h):w[o]=[w[o],h]:w[o]=h}return w},ir=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}},dn=function(i,c,s,m){return c=c||"&",s=s||"=",i===null&&(i=void 0),typeof i=="object"?Object.keys(i).map(function(w){var d=encodeURIComponent(ir(w))+s;return Array.isArray(i[w])?i[w].map(function(n){return d+encodeURIComponent(ir(n))}).join(c):d+encodeURIComponent(ir(i[w]))}).join(c):m?encodeURIComponent(ir(m))+s+encodeURIComponent(ir(i)):""},_t={},_t.decode=_t.parse=un,_t.encode=_t.stringify=dn,_t.decode,_t.encode,_t.parse,_t.stringify});function ms(){throw new Error("setTimeout has not been defined")}function bs(){throw new Error("clearTimeout has not been defined")}function Fo(i){if(wt===setTimeout)return setTimeout(i,0);if((wt===ms||!wt)&&setTimeout)return wt=setTimeout,setTimeout(i,0);try{return wt(i,0)}catch{try{return wt.call(null,i,0)}catch{return wt.call(this||Xt,i,0)}}}function oh(){Qt&&Yt&&(Qt=!1,Yt.length?vt=Yt.concat(vt):vr=-1,vt.length&&No())}function No(){if(!Qt){var i=Fo(oh);Qt=!0;for(var c=vt.length;c;){for(Yt=vt,vt=[];++vr<c;)Yt&&Yt[vr].run();vr=-1,c=vt.length}Yt=null,Qt=!1,function(s){if(St===clearTimeout)return clearTimeout(s);if((St===bs||!St)&&clearTimeout)return St=clearTimeout,clearTimeout(s);try{St(s)}catch{try{return St.call(null,s)}catch{return St.call(this||Xt,s)}}}(i)}}function fn(i,c){(this||Xt).fun=i,(this||Xt).array=c}function mt(){}var pn,wt,St,Xt,He,Yt,vt,Qt,vr,Ne,ah=Je(()=>{pe(),ge(),_e(),Xt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:global,He=pn={},function(){try{wt=typeof setTimeout=="function"?setTimeout:ms}catch{wt=ms}try{St=typeof clearTimeout=="function"?clearTimeout:bs}catch{St=bs}}(),vt=[],Qt=!1,vr=-1,He.nextTick=function(i){var c=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)c[s-1]=arguments[s];vt.push(new fn(i,c)),vt.length!==1||Qt||Fo(No)},fn.prototype.run=function(){(this||Xt).fun.apply(null,(this||Xt).array)},He.title="browser",He.browser=!0,He.env={},He.argv=[],He.version="",He.versions={},He.on=mt,He.addListener=mt,He.once=mt,He.off=mt,He.removeListener=mt,He.removeAllListeners=mt,He.emit=mt,He.prependListener=mt,He.prependOnceListener=mt,He.listeners=function(i){return[]},He.binding=function(i){throw new Error("process.binding is not supported")},He.cwd=function(){return"/"},He.chdir=function(i){throw new Error("process.chdir is not supported")},He.umask=function(){return 0},Ne=pn,Ne.addListener,Ne.argv,Ne.binding,Ne.browser,Ne.chdir,Ne.cwd,Ne.emit,Ne.env,Ne.listeners,Ne.nextTick,Ne.off,Ne.on,Ne.once,Ne.prependListener,Ne.prependOnceListener,Ne.removeAllListeners,Ne.removeListener,Ne.title,Ne.umask,Ne.version,Ne.versions});function lh(){if(ys)return Ir;ys=!0;var i=Ir={},c,s;function m(){throw new Error("setTimeout has not been defined")}function w(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?c=setTimeout:c=m}catch{c=m}try{typeof clearTimeout=="function"?s=clearTimeout:s=w}catch{s=w}})();function d(g){if(c===setTimeout)return setTimeout(g,0);if((c===m||!c)&&setTimeout)return c=setTimeout,setTimeout(g,0);try{return c(g,0)}catch{try{return c.call(null,g,0)}catch{return c.call(this||qt,g,0)}}}function n(g){if(s===clearTimeout)return clearTimeout(g);if((s===w||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(g);try{return s(g)}catch{try{return s.call(null,g)}catch{return s.call(this||qt,g)}}}var e=[],t=!1,r,a=-1;function o(){!t||!r||(t=!1,r.length?e=r.concat(e):a=-1,e.length&&h())}function h(){if(!t){var g=d(o);t=!0;for(var l=e.length;l;){for(r=e,e=[];++a<l;)r&&r[a].run();a=-1,l=e.length}r=null,t=!1,n(g)}}i.nextTick=function(g){var l=new Array(arguments.length-1);if(arguments.length>1)for(var p=1;p<arguments.length;p++)l[p-1]=arguments[p];e.push(new _(g,l)),e.length===1&&!t&&d(h)};function _(g,l){(this||qt).fun=g,(this||qt).array=l}_.prototype.run=function(){(this||qt).fun.apply(null,(this||qt).array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={};function v(){}return i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(g){return[]},i.binding=function(g){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(g){throw new Error("process.chdir is not supported")},i.umask=function(){return 0},Ir}var Ir,ys,qt,Me,jo=Je(()=>{pe(),ge(),_e(),Ir={},ys=!1,qt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:global,Me=lh(),Me.platform="browser",Me.addListener,Me.argv,Me.binding,Me.browser,Me.chdir,Me.cwd,Me.emit,Me.env,Me.listeners,Me.nextTick,Me.off,Me.on,Me.once,Me.prependListener,Me.prependOnceListener,Me.removeAllListeners,Me.removeListener,Me.title,Me.umask,Me.version,Me.versions});function hh(){if(ws)return xr;ws=!0;var i=Me;function c(d){if(typeof d!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(d))}function s(d,n){for(var e="",t=0,r=-1,a=0,o,h=0;h<=d.length;++h){if(h<d.length)o=d.charCodeAt(h);else{if(o===47)break;o=47}if(o===47){if(!(r===h-1||a===1))if(r!==h-1&&a===2){if(e.length<2||t!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){var _=e.lastIndexOf("/");if(_!==e.length-1){_===-1?(e="",t=0):(e=e.slice(0,_),t=e.length-1-e.lastIndexOf("/")),r=h,a=0;continue}}else if(e.length===2||e.length===1){e="",t=0,r=h,a=0;continue}}n&&(e.length>0?e+="/..":e="..",t=2)}else e.length>0?e+="/"+d.slice(r+1,h):e=d.slice(r+1,h),t=h-r-1;r=h,a=0}else o===46&&a!==-1?++a:a=-1}return e}function m(d,n){var e=n.dir||n.root,t=n.base||(n.name||"")+(n.ext||"");return e?e===n.root?e+t:e+d+t:t}var w={resolve:function(){for(var d="",n=!1,e,t=arguments.length-1;t>=-1&&!n;t--){var r;t>=0?r=arguments[t]:(e===void 0&&(e=i.cwd()),r=e),c(r),r.length!==0&&(d=r+"/"+d,n=r.charCodeAt(0)===47)}return d=s(d,!n),n?d.length>0?"/"+d:"/":d.length>0?d:"."},normalize:function(d){if(c(d),d.length===0)return".";var n=d.charCodeAt(0)===47,e=d.charCodeAt(d.length-1)===47;return d=s(d,!n),d.length===0&&!n&&(d="."),d.length>0&&e&&(d+="/"),n?"/"+d:d},isAbsolute:function(d){return c(d),d.length>0&&d.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var d,n=0;n<arguments.length;++n){var e=arguments[n];c(e),e.length>0&&(d===void 0?d=e:d+="/"+e)}return d===void 0?".":w.normalize(d)},relative:function(d,n){if(c(d),c(n),d===n||(d=w.resolve(d),n=w.resolve(n),d===n))return"";for(var e=1;e<d.length&&d.charCodeAt(e)===47;++e);for(var t=d.length,r=t-e,a=1;a<n.length&&n.charCodeAt(a)===47;++a);for(var o=n.length,h=o-a,_=r<h?r:h,v=-1,g=0;g<=_;++g){if(g===_){if(h>_){if(n.charCodeAt(a+g)===47)return n.slice(a+g+1);if(g===0)return n.slice(a+g)}else r>_&&(d.charCodeAt(e+g)===47?v=g:g===0&&(v=0));break}var l=d.charCodeAt(e+g),p=n.charCodeAt(a+g);if(l!==p)break;l===47&&(v=g)}var u="";for(g=e+v+1;g<=t;++g)(g===t||d.charCodeAt(g)===47)&&(u.length===0?u+="..":u+="/..");return u.length>0?u+n.slice(a+v):(a+=v,n.charCodeAt(a)===47&&++a,n.slice(a))},_makeLong:function(d){return d},dirname:function(d){if(c(d),d.length===0)return".";for(var n=d.charCodeAt(0),e=n===47,t=-1,r=!0,a=d.length-1;a>=1;--a)if(n=d.charCodeAt(a),n===47){if(!r){t=a;break}}else r=!1;return t===-1?e?"/":".":e&&t===1?"//":d.slice(0,t)},basename:function(d,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');c(d);var e=0,t=-1,r=!0,a;if(n!==void 0&&n.length>0&&n.length<=d.length){if(n.length===d.length&&n===d)return"";var o=n.length-1,h=-1;for(a=d.length-1;a>=0;--a){var _=d.charCodeAt(a);if(_===47){if(!r){e=a+1;break}}else h===-1&&(r=!1,h=a+1),o>=0&&(_===n.charCodeAt(o)?--o===-1&&(t=a):(o=-1,t=h))}return e===t?t=h:t===-1&&(t=d.length),d.slice(e,t)}else{for(a=d.length-1;a>=0;--a)if(d.charCodeAt(a)===47){if(!r){e=a+1;break}}else t===-1&&(r=!1,t=a+1);return t===-1?"":d.slice(e,t)}},extname:function(d){c(d);for(var n=-1,e=0,t=-1,r=!0,a=0,o=d.length-1;o>=0;--o){var h=d.charCodeAt(o);if(h===47){if(!r){e=o+1;break}continue}t===-1&&(r=!1,t=o+1),h===46?n===-1?n=o:a!==1&&(a=1):n!==-1&&(a=-1)}return n===-1||t===-1||a===0||a===1&&n===t-1&&n===e+1?"":d.slice(n,t)},format:function(d){if(d===null||typeof d!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof d);return m("/",d)},parse:function(d){c(d);var n={root:"",dir:"",base:"",ext:"",name:""};if(d.length===0)return n;var e=d.charCodeAt(0),t=e===47,r;t?(n.root="/",r=1):r=0;for(var a=-1,o=0,h=-1,_=!0,v=d.length-1,g=0;v>=r;--v){if(e=d.charCodeAt(v),e===47){if(!_){o=v+1;break}continue}h===-1&&(_=!1,h=v+1),e===46?a===-1?a=v:g!==1&&(g=1):a!==-1&&(g=-1)}return a===-1||h===-1||g===0||g===1&&a===h-1&&a===o+1?h!==-1&&(o===0&&t?n.base=n.name=d.slice(1,h):n.base=n.name=d.slice(o,h)):(o===0&&t?(n.name=d.slice(1,a),n.base=d.slice(1,h)):(n.name=d.slice(o,a),n.base=d.slice(o,h)),n.ext=d.slice(a,h)),o>0?n.dir=d.slice(0,o-1):t&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};return w.posix=w,xr=w,xr}var xr,ws,Ss,ch=Je(()=>{pe(),ge(),_e(),jo(),xr={},ws=!1,Ss=hh()}),Ho={};Zt(Ho,{URL:()=>na,Url:()=>ea,default:()=>xe,fileURLToPath:()=>Wo,format:()=>ta,parse:()=>sa,pathToFileURL:()=>$o,resolve:()=>ra,resolveObject:()=>ia});function lt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function dr(i,c,s){if(i&&dt.isObject(i)&&i instanceof lt)return i;var m=new lt;return m.parse(i,c,s),m}function uh(){if(Cs)return Br;Cs=!0;var i=Ne;function c(d){if(typeof d!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(d))}function s(d,n){for(var e="",t=0,r=-1,a=0,o,h=0;h<=d.length;++h){if(h<d.length)o=d.charCodeAt(h);else{if(o===47)break;o=47}if(o===47){if(!(r===h-1||a===1))if(r!==h-1&&a===2){if(e.length<2||t!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){var _=e.lastIndexOf("/");if(_!==e.length-1){_===-1?(e="",t=0):(e=e.slice(0,_),t=e.length-1-e.lastIndexOf("/")),r=h,a=0;continue}}else if(e.length===2||e.length===1){e="",t=0,r=h,a=0;continue}}n&&(e.length>0?e+="/..":e="..",t=2)}else e.length>0?e+="/"+d.slice(r+1,h):e=d.slice(r+1,h),t=h-r-1;r=h,a=0}else o===46&&a!==-1?++a:a=-1}return e}function m(d,n){var e=n.dir||n.root,t=n.base||(n.name||"")+(n.ext||"");return e?e===n.root?e+t:e+d+t:t}var w={resolve:function(){for(var d="",n=!1,e,t=arguments.length-1;t>=-1&&!n;t--){var r;t>=0?r=arguments[t]:(e===void 0&&(e=i.cwd()),r=e),c(r),r.length!==0&&(d=r+"/"+d,n=r.charCodeAt(0)===47)}return d=s(d,!n),n?d.length>0?"/"+d:"/":d.length>0?d:"."},normalize:function(d){if(c(d),d.length===0)return".";var n=d.charCodeAt(0)===47,e=d.charCodeAt(d.length-1)===47;return d=s(d,!n),d.length===0&&!n&&(d="."),d.length>0&&e&&(d+="/"),n?"/"+d:d},isAbsolute:function(d){return c(d),d.length>0&&d.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var d,n=0;n<arguments.length;++n){var e=arguments[n];c(e),e.length>0&&(d===void 0?d=e:d+="/"+e)}return d===void 0?".":w.normalize(d)},relative:function(d,n){if(c(d),c(n),d===n||(d=w.resolve(d),n=w.resolve(n),d===n))return"";for(var e=1;e<d.length&&d.charCodeAt(e)===47;++e);for(var t=d.length,r=t-e,a=1;a<n.length&&n.charCodeAt(a)===47;++a);for(var o=n.length,h=o-a,_=r<h?r:h,v=-1,g=0;g<=_;++g){if(g===_){if(h>_){if(n.charCodeAt(a+g)===47)return n.slice(a+g+1);if(g===0)return n.slice(a+g)}else r>_&&(d.charCodeAt(e+g)===47?v=g:g===0&&(v=0));break}var l=d.charCodeAt(e+g),p=n.charCodeAt(a+g);if(l!==p)break;l===47&&(v=g)}var u="";for(g=e+v+1;g<=t;++g)(g===t||d.charCodeAt(g)===47)&&(u.length===0?u+="..":u+="/..");return u.length>0?u+n.slice(a+v):(a+=v,n.charCodeAt(a)===47&&++a,n.slice(a))},_makeLong:function(d){return d},dirname:function(d){if(c(d),d.length===0)return".";for(var n=d.charCodeAt(0),e=n===47,t=-1,r=!0,a=d.length-1;a>=1;--a)if(n=d.charCodeAt(a),n===47){if(!r){t=a;break}}else r=!1;return t===-1?e?"/":".":e&&t===1?"//":d.slice(0,t)},basename:function(d,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');c(d);var e=0,t=-1,r=!0,a;if(n!==void 0&&n.length>0&&n.length<=d.length){if(n.length===d.length&&n===d)return"";var o=n.length-1,h=-1;for(a=d.length-1;a>=0;--a){var _=d.charCodeAt(a);if(_===47){if(!r){e=a+1;break}}else h===-1&&(r=!1,h=a+1),o>=0&&(_===n.charCodeAt(o)?--o===-1&&(t=a):(o=-1,t=h))}return e===t?t=h:t===-1&&(t=d.length),d.slice(e,t)}else{for(a=d.length-1;a>=0;--a)if(d.charCodeAt(a)===47){if(!r){e=a+1;break}}else t===-1&&(r=!1,t=a+1);return t===-1?"":d.slice(e,t)}},extname:function(d){c(d);for(var n=-1,e=0,t=-1,r=!0,a=0,o=d.length-1;o>=0;--o){var h=d.charCodeAt(o);if(h===47){if(!r){e=o+1;break}continue}t===-1&&(r=!1,t=o+1),h===46?n===-1?n=o:a!==1&&(a=1):n!==-1&&(a=-1)}return n===-1||t===-1||a===0||a===1&&n===t-1&&n===e+1?"":d.slice(n,t)},format:function(d){if(d===null||typeof d!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof d);return m("/",d)},parse:function(d){c(d);var n={root:"",dir:"",base:"",ext:"",name:""};if(d.length===0)return n;var e=d.charCodeAt(0),t=e===47,r;t?(n.root="/",r=1):r=0;for(var a=-1,o=0,h=-1,_=!0,v=d.length-1,g=0;v>=r;--v){if(e=d.charCodeAt(v),e===47){if(!_){o=v+1;break}continue}h===-1&&(_=!1,h=v+1),e===46?a===-1?a=v:g!==1&&(g=1):a!==-1&&(g=-1)}return a===-1||h===-1||g===0||g===1&&a===h-1&&a===o+1?h!==-1&&(o===0&&t?n.base=n.name=d.slice(1,h):n.base=n.name=d.slice(o,h)):(o===0&&t?(n.name=d.slice(1,a),n.base=d.slice(1,h)):(n.name=d.slice(o,a),n.base=d.slice(o,h)),n.ext=d.slice(a,h)),o>0?n.dir=d.slice(0,o-1):t&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};return w.posix=w,Br=w,Br}function dh(i){if(typeof i=="string")i=new URL(i);else if(!(i instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(i.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return Dr?fh(i):ph(i)}function fh(i){let c=i.hostname,s=i.pathname;for(let m=0;m<s.length;m++)if(s[m]==="%"){let w=s.codePointAt(m+2)||32;if(s[m+1]==="2"&&w===102||s[m+1]==="5"&&w===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(s=s.replace(Go,"\\"),s=decodeURIComponent(s),c!=="")return`\\\\${c}${s}`;{let m=s.codePointAt(1)|32,w=s[2];if(m<Vo||m>Ko||w!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return s.slice(1)}}function ph(i){if(i.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let c=i.pathname;for(let s=0;s<c.length;s++)if(c[s]==="%"){let m=c.codePointAt(s+2)||32;if(c[s+1]==="2"&&m===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(c)}function _h(i){let c=Es.resolve(i),s=i.charCodeAt(i.length-1);(s===qo||Dr&&s===zo)&&c[c.length-1]!==Es.sep&&(c+="/");let m=new URL("file://");return c.includes("%")&&(c=c.replace(Yo,"%25")),!Dr&&c.includes("\\")&&(c=c.replace(Jo,"%5C")),c.includes(`
`)&&(c=c.replace(Xo,"%0A")),c.includes("\r")&&(c=c.replace(Qo,"%0D")),c.includes("	")&&(c=c.replace(Zo,"%09")),m.pathname=c,m}function Wo(i){if(typeof i=="string")i=new URL(i);else if(!(i instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(i.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return Mr?gh(i):vh(i)}function gh(i){let c=i.hostname,s=i.pathname;for(let m=0;m<s.length;m++)if(s[m]==="%"){let w=s.codePointAt(m+2)||32;if(s[m+1]==="2"&&w===102||s[m+1]==="5"&&w===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(s=s.replace(ca,"\\"),s=decodeURIComponent(s),c!=="")return`\\\\${c}${s}`;{let m=s.codePointAt(1)|32,w=s[2];if(m<la||m>ha||w!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return s.slice(1)}}function vh(i){if(i.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let c=i.pathname;for(let s=0;s<c.length;s++)if(c[s]==="%"){let m=c.codePointAt(s+2)||32;if(c[s+1]==="2"&&m===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(c)}function $o(i){let c=Ss.resolve(i),s=i.charCodeAt(i.length-1);(s===aa||Mr&&s===oa)&&c[c.length-1]!==Ss.sep&&(c+="/");let m=new URL("file://");return c.includes("%")&&(c=c.replace(ua,"%25")),!Mr&&c.includes("\\")&&(c=c.replace(da,"%5C")),c.includes(`
`)&&(c=c.replace(fa,"%0A")),c.includes("\r")&&(c=c.replace(pa,"%0D")),c.includes("	")&&(c=c.replace(_a,"%09")),m.pathname=c,m}var xe,_n,dt,gn,vn,mn,bn,Sr,ti,ri,ii,yn,wn,Cr,zt,Er,Br,Cs,Es,Sn,zo,qo,Vo,Ko,Dr,Go,Yo,Jo,Xo,Qo,Zo,Cn,ea,ta,ra,ia,sa,na,oa,aa,la,ha,Mr,ca,ua,da,fa,pa,_a,mh=Je(()=>{pe(),ge(),_e(),ih(),nh(),ah(),ch(),jo(),xe={},_n=Mt,dt={isString:function(i){return typeof i=="string"},isObject:function(i){return typeof i=="object"&&i!==null},isNull:function(i){return i===null},isNullOrUndefined:function(i){return i==null}},xe.parse=dr,xe.resolve=function(i,c){return dr(i,!1,!0).resolve(c)},xe.resolveObject=function(i,c){return i?dr(i,!1,!0).resolveObject(c):c},xe.format=function(i){return dt.isString(i)&&(i=dr(i)),i instanceof lt?i.format():lt.prototype.format.call(i)},xe.Url=lt,gn=/^([a-z0-9.+-]+:)/i,vn=/:[0-9]*$/,mn=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,bn=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),Sr=["'"].concat(bn),ti=["%","/","?",";","#"].concat(Sr),ri=["/","?","#"],ii=/^[+a-z0-9A-Z_-]{0,63}$/,yn=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,wn={javascript:!0,"javascript:":!0},Cr={javascript:!0,"javascript:":!0},zt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Er=_t,lt.prototype.parse=function(i,c,s){if(!dt.isString(i))throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var m=i.indexOf("?"),w=m!==-1&&m<i.indexOf("#")?"?":"#",d=i.split(w);d[0]=d[0].replace(/\\/g,"/");var n=i=d.join(w);if(n=n.trim(),!s&&i.split("#").length===1){var e=mn.exec(n);if(e)return this.path=n,this.href=n,this.pathname=e[1],e[2]?(this.search=e[2],this.query=c?Er.parse(this.search.substr(1)):this.search.substr(1)):c&&(this.search="",this.query={}),this}var t=gn.exec(n);if(t){var r=(t=t[0]).toLowerCase();this.protocol=r,n=n.substr(t.length)}if(s||t||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var a=n.substr(0,2)==="//";!a||t&&Cr[t]||(n=n.substr(2),this.slashes=!0)}if(!Cr[t]&&(a||t&&!zt[t])){for(var o,h,_=-1,v=0;v<ri.length;v++)(g=n.indexOf(ri[v]))!==-1&&(_===-1||g<_)&&(_=g);for((h=_===-1?n.lastIndexOf("@"):n.lastIndexOf("@",_))!==-1&&(o=n.slice(0,h),n=n.slice(h+1),this.auth=decodeURIComponent(o)),_=-1,v=0;v<ti.length;v++){var g;(g=n.indexOf(ti[v]))!==-1&&(_===-1||g<_)&&(_=g)}_===-1&&(_=n.length),this.host=n.slice(0,_),n=n.slice(_),this.parseHost(),this.hostname=this.hostname||"";var l=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!l)for(var p=this.hostname.split(/\./),u=(v=0,p.length);v<u;v++){var f=p[v];if(f&&!f.match(ii)){for(var y="",b=0,A=f.length;b<A;b++)f.charCodeAt(b)>127?y+="x":y+=f[b];if(!y.match(ii)){var R=p.slice(0,v),C=p.slice(v+1),L=f.match(yn);L&&(R.push(L[1]),C.unshift(L[2])),C.length&&(n="/"+C.join(".")+n),this.hostname=R.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),l||(this.hostname=_n.toASCII(this.hostname));var O=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+O,this.href+=this.host,l&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),n[0]!=="/"&&(n="/"+n))}if(!wn[r])for(v=0,u=Sr.length;v<u;v++){var I=Sr[v];if(n.indexOf(I)!==-1){var P=encodeURIComponent(I);P===I&&(P=escape(I)),n=n.split(I).join(P)}}var V=n.indexOf("#");V!==-1&&(this.hash=n.substr(V),n=n.slice(0,V));var G=n.indexOf("?");if(G!==-1?(this.search=n.substr(G),this.query=n.substr(G+1),c&&(this.query=Er.parse(this.query)),n=n.slice(0,G)):c&&(this.search="",this.query={}),n&&(this.pathname=n),zt[r]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){O=this.pathname||"";var re=this.search||"";this.path=O+re}return this.href=this.format(),this},lt.prototype.format=function(){var i=this.auth||"";i&&(i=(i=encodeURIComponent(i)).replace(/%3A/i,":"),i+="@");var c=this.protocol||"",s=this.pathname||"",m=this.hash||"",w=!1,d="";this.host?w=i+this.host:this.hostname&&(w=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(w+=":"+this.port)),this.query&&dt.isObject(this.query)&&Object.keys(this.query).length&&(d=Er.stringify(this.query));var n=this.search||d&&"?"+d||"";return c&&c.substr(-1)!==":"&&(c+=":"),this.slashes||(!c||zt[c])&&w!==!1?(w="//"+(w||""),s&&s.charAt(0)!=="/"&&(s="/"+s)):w||(w=""),m&&m.charAt(0)!=="#"&&(m="#"+m),n&&n.charAt(0)!=="?"&&(n="?"+n),c+w+(s=s.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(n=n.replace("#","%23"))+m},lt.prototype.resolve=function(i){return this.resolveObject(dr(i,!1,!0)).format()},lt.prototype.resolveObject=function(i){if(dt.isString(i)){var c=new lt;c.parse(i,!1,!0),i=c}for(var s=new lt,m=Object.keys(this),w=0;w<m.length;w++){var d=m[w];s[d]=this[d]}if(s.hash=i.hash,i.href==="")return s.href=s.format(),s;if(i.slashes&&!i.protocol){for(var n=Object.keys(i),e=0;e<n.length;e++){var t=n[e];t!=="protocol"&&(s[t]=i[t])}return zt[s.protocol]&&s.hostname&&!s.pathname&&(s.path=s.pathname="/"),s.href=s.format(),s}if(i.protocol&&i.protocol!==s.protocol){if(!zt[i.protocol]){for(var r=Object.keys(i),a=0;a<r.length;a++){var o=r[a];s[o]=i[o]}return s.href=s.format(),s}if(s.protocol=i.protocol,i.host||Cr[i.protocol])s.pathname=i.pathname;else{for(var h=(i.pathname||"").split("/");h.length&&!(i.host=h.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),h[0]!==""&&h.unshift(""),h.length<2&&h.unshift(""),s.pathname=h.join("/")}if(s.search=i.search,s.query=i.query,s.host=i.host||"",s.auth=i.auth,s.hostname=i.hostname||i.host,s.port=i.port,s.pathname||s.search){var _=s.pathname||"",v=s.search||"";s.path=_+v}return s.slashes=s.slashes||i.slashes,s.href=s.format(),s}var g=s.pathname&&s.pathname.charAt(0)==="/",l=i.host||i.pathname&&i.pathname.charAt(0)==="/",p=l||g||s.host&&i.pathname,u=p,f=s.pathname&&s.pathname.split("/")||[],y=(h=i.pathname&&i.pathname.split("/")||[],s.protocol&&!zt[s.protocol]);if(y&&(s.hostname="",s.port=null,s.host&&(f[0]===""?f[0]=s.host:f.unshift(s.host)),s.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(h[0]===""?h[0]=i.host:h.unshift(i.host)),i.host=null),p=p&&(h[0]===""||f[0]==="")),l)s.host=i.host||i.host===""?i.host:s.host,s.hostname=i.hostname||i.hostname===""?i.hostname:s.hostname,s.search=i.search,s.query=i.query,f=h;else if(h.length)f||(f=[]),f.pop(),f=f.concat(h),s.search=i.search,s.query=i.query;else if(!dt.isNullOrUndefined(i.search))return y&&(s.hostname=s.host=f.shift(),(L=!!(s.host&&s.host.indexOf("@")>0)&&s.host.split("@"))&&(s.auth=L.shift(),s.host=s.hostname=L.shift())),s.search=i.search,s.query=i.query,dt.isNull(s.pathname)&&dt.isNull(s.search)||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.href=s.format(),s;if(!f.length)return s.pathname=null,s.search?s.path="/"+s.search:s.path=null,s.href=s.format(),s;for(var b=f.slice(-1)[0],A=(s.host||i.host||f.length>1)&&(b==="."||b==="..")||b==="",R=0,C=f.length;C>=0;C--)(b=f[C])==="."?f.splice(C,1):b===".."?(f.splice(C,1),R++):R&&(f.splice(C,1),R--);if(!p&&!u)for(;R--;R)f.unshift("..");!p||f[0]===""||f[0]&&f[0].charAt(0)==="/"||f.unshift(""),A&&f.join("/").substr(-1)!=="/"&&f.push("");var L,O=f[0]===""||f[0]&&f[0].charAt(0)==="/";return y&&(s.hostname=s.host=O?"":f.length?f.shift():"",(L=!!(s.host&&s.host.indexOf("@")>0)&&s.host.split("@"))&&(s.auth=L.shift(),s.host=s.hostname=L.shift())),(p=p||s.host&&f.length)&&!O&&f.unshift(""),f.length?s.pathname=f.join("/"):(s.pathname=null,s.path=null),dt.isNull(s.pathname)&&dt.isNull(s.search)||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.auth=i.auth||s.auth,s.slashes=s.slashes||i.slashes,s.href=s.format(),s},lt.prototype.parseHost=function(){var i=this.host,c=vn.exec(i);c&&((c=c[0])!==":"&&(this.port=c.substr(1)),i=i.substr(0,i.length-c.length)),i&&(this.hostname=i)},xe.Url,xe.format,xe.resolve,xe.resolveObject,Br={},Cs=!1,Es=uh(),Sn=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,xe.URL=typeof URL<"u"?URL:null,xe.pathToFileURL=_h,xe.fileURLToPath=dh,xe.Url,xe.format,xe.resolve,xe.resolveObject,xe.URL,zo=92,qo=47,Vo=97,Ko=122,Dr=Sn==="win32",Go=/\//g,Yo=/%/g,Jo=/\\/g,Xo=/\n/g,Qo=/\r/g,Zo=/\t/g,Cn=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,xe.URL=typeof URL<"u"?URL:null,xe.pathToFileURL=$o,xe.fileURLToPath=Wo,ea=xe.Url,ta=xe.format,ra=xe.resolve,ia=xe.resolveObject,sa=xe.parse,na=xe.URL,oa=92,aa=47,la=97,ha=122,Mr=Cn==="win32",ca=/\//g,ua=/%/g,da=/\\/g,fa=/\n/g,pa=/\r/g,_a=/\t/g}),Ms={};Zt(Ms,{Server:()=>Ue,Socket:()=>Ue,Stream:()=>Ue,_createServerHandle:()=>Ue,_normalizeArgs:()=>Ue,_setSimultaneousAccepts:()=>Ue,connect:()=>Ue,createConnection:()=>Ue,createServer:()=>Ue,default:()=>ga,isIP:()=>Ue,isIPv4:()=>Ue,isIPv6:()=>Ue});function Ue(){throw new Error("Node.js net module is not supported by JSPM core outside of Node.js")}var ga,va=Je(()=>{pe(),ge(),_e(),ga={_createServerHandle:Ue,_normalizeArgs:Ue,_setSimultaneousAccepts:Ue,connect:Ue,createConnection:Ue,createServer:Ue,isIP:Ue,isIPv4:Ue,isIPv6:Ue,Server:Ue,Socket:Ue,Stream:Ue}}),En=we(i=>{pe(),ge(),_e();var c=i&&i.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(i,"__esModule",{value:!0});var s=c((va(),Pe(Ms))),m=c(Tt()),w=(0,m.default)("mqttjs:tcp"),d=(n,e)=>{e.port=e.port||1883,e.hostname=e.hostname||e.host||"localhost";let{port:t}=e,r=e.hostname;return w("port %d and host %s",t,r),s.default.createConnection(t,r)};i.default=d}),ma={};Zt(ma,{default:()=>ba});var ba,bh=Je(()=>{pe(),ge(),_e(),ba={}}),An=we(i=>{pe(),ge(),_e();var c=i&&i.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0});var s=c((bh(),Pe(ma))),m=c((va(),Pe(Ms))),w=c(Tt()),d=(0,w.default)("mqttjs:tls"),n=(e,t)=>{t.port=t.port||8883,t.host=t.hostname||t.host||"localhost",m.default.isIP(t.host)===0&&(t.servername=t.host),t.rejectUnauthorized=t.rejectUnauthorized!==!1,delete t.path,d("port %d host %s rejectUnauthorized %b",t.port,t.host,t.rejectUnauthorized);let r=s.default.connect(t);r.on("secureConnect",()=>{t.rejectUnauthorized&&!r.authorized?r.emit("error",new Error("TLS not authorized")):r.removeListener("error",a)});function a(o){t.rejectUnauthorized&&e.emit("error",o),r.end()}return r.on("error",a),r};i.default=n}),Us=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0}),i.BufferedDuplex=i.writev=void 0;var c=rr();function s(w,d){let n=new Array(w.length);for(let e=0;e<w.length;e++)typeof w[e].chunk=="string"?n[e]=or.from(w[e].chunk,"utf8"):n[e]=w[e].chunk;this._write(or.concat(n),"binary",d)}i.writev=s;var m=class extends c.Duplex{constructor(w,d,n){super({objectMode:!0}),this.proxy=d,this.socket=n,this.writeQueue=[],w.objectMode||(this._writev=s.bind(this)),this.isSocketOpen=!1,this.proxy.on("data",e=>{this.push(e)})}_read(w){this.proxy.read(w)}_write(w,d,n){this.isSocketOpen?this.writeToProxy(w,d,n):this.writeQueue.push({chunk:w,encoding:d,cb:n})}_final(w){this.writeQueue=[],this.proxy.end(w)}socketReady(){this.emit("connect"),this.isSocketOpen=!0,this.processWriteQueue()}writeToProxy(w,d,n){this.proxy.write(w,d)===!1?this.proxy.once("drain",n):n()}processWriteQueue(){for(;this.writeQueue.length>0;){let{chunk:w,encoding:d,cb:n}=this.writeQueue.shift();this.writeToProxy(w,d,n)}}};i.BufferedDuplex=m}),kn=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=(et(),Pe(Ze)),s=rr(),m=Us(),w,d,n;function e(){let h=new s.Transform;return h._write=(_,v,g)=>{w.send({data:_.buffer,success(){g()},fail(l){g(new Error(l))}})},h._flush=_=>{w.close({success(){_()}})},h}function t(h){h.hostname||(h.hostname="localhost"),h.path||(h.path="/"),h.wsOptions||(h.wsOptions={})}function r(h,_){let v=h.protocol==="wxs"?"wss":"ws",g=`${v}://${h.hostname}${h.path}`;return h.port&&h.port!==80&&h.port!==443&&(g=`${v}://${h.hostname}:${h.port}${h.path}`),typeof h.transformWsUrl=="function"&&(g=h.transformWsUrl(g,h,_)),g}function a(){w.onOpen(()=>{n.socketReady()}),w.onMessage(h=>{let{data:_}=h;_ instanceof ArrayBuffer?_=c.Buffer.from(_):_=c.Buffer.from(_,"utf8"),d.push(_)}),w.onClose(()=>{n.emit("close"),n.end(),n.destroy()}),w.onError(h=>{let _=new Error(h.errMsg);n.destroy(_)})}var o=(h,_)=>{if(_.hostname=_.hostname||_.host,!_.hostname)throw new Error("Could not determine host. Specify host manually.");let v=_.protocolId==="MQIsdp"&&_.protocolVersion===3?"mqttv3.1":"mqtt";t(_);let g=r(_,h);w=wx.connectSocket({url:g,protocols:[v]}),d=e(),n=new m.BufferedDuplex(_,d,w),n._destroy=(p,u)=>{w.close({success(){u&&u(p)}})};let l=n.destroy;return n.destroy=(p,u)=>(n.destroy=l,setTimeout(()=>{w.close({fail(){n._destroy(p,u)}})},0),n),a(),n};i.default=o}),Rn=we(i=>{pe(),ge(),_e(),Object.defineProperty(i,"__esModule",{value:!0});var c=(et(),Pe(Ze)),s=rr(),m=Us(),w,d,n,e=!1;function t(){let _=new s.Transform;return _._write=(v,g,l)=>{w.sendSocketMessage({data:v.buffer,success(){l()},fail(){l(new Error)}})},_._flush=v=>{w.closeSocket({success(){v()}})},_}function r(_){_.hostname||(_.hostname="localhost"),_.path||(_.path="/"),_.wsOptions||(_.wsOptions={})}function a(_,v){let g=_.protocol==="alis"?"wss":"ws",l=`${g}://${_.hostname}${_.path}`;return _.port&&_.port!==80&&_.port!==443&&(l=`${g}://${_.hostname}:${_.port}${_.path}`),typeof _.transformWsUrl=="function"&&(l=_.transformWsUrl(l,_,v)),l}function o(){e||(e=!0,w.onSocketOpen(()=>{n.socketReady()}),w.onSocketMessage(_=>{if(typeof _.data=="string"){let v=c.Buffer.from(_.data,"base64");d.push(v)}else{let v=new FileReader;v.addEventListener("load",()=>{let g=v.result;g instanceof ArrayBuffer?g=c.Buffer.from(g):g=c.Buffer.from(g,"utf8"),d.push(g)}),v.readAsArrayBuffer(_.data)}}),w.onSocketClose(()=>{n.end(),n.destroy()}),w.onSocketError(_=>{n.destroy(_)}))}var h=(_,v)=>{if(v.hostname=v.hostname||v.host,!v.hostname)throw new Error("Could not determine host. Specify host manually.");let g=v.protocolId==="MQIsdp"&&v.protocolVersion===3?"mqttv3.1":"mqtt";r(v);let l=a(v,_);return w=v.my,w.connectSocket({url:l,protocols:g}),d=t(),n=new m.BufferedDuplex(v,d,w),o(),n};i.default=h}),yh=we((i,c)=>{pe(),ge(),_e(),c.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}),Tn=we(i=>{pe(),ge(),_e();var c=i&&i.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(i,"__esModule",{value:!0});var s=(et(),Pe(Ze)),m=c(yh()),w=c(Tt()),d=rr(),n=c(Ds()),e=Us(),t=(0,w.default)("mqttjs:ws"),r=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function a(p,u){let f=`${p.protocol}://${p.hostname}:${p.port}${p.path}`;return typeof p.transformWsUrl=="function"&&(f=p.transformWsUrl(f,p,u)),f}function o(p){let u=p;return p.hostname||(u.hostname="localhost"),p.port||(p.protocol==="wss"?u.port=443:u.port=80),p.path||(u.path="/"),p.wsOptions||(u.wsOptions={}),!n.default&&p.protocol==="wss"&&r.forEach(f=>{Object.prototype.hasOwnProperty.call(p,f)&&!Object.prototype.hasOwnProperty.call(p.wsOptions,f)&&(u.wsOptions[f]=p[f])}),u}function h(p){let u=o(p);if(u.hostname||(u.hostname=u.host),!u.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");let f=new URL(document.URL);u.hostname=f.hostname,u.port||(u.port=Number(f.port))}return u.objectMode===void 0&&(u.objectMode=!(u.binary===!0||u.binary===void 0)),u}function _(p,u,f){t("createWebSocket"),t(`protocol: ${f.protocolId} ${f.protocolVersion}`);let y=f.protocolId==="MQIsdp"&&f.protocolVersion===3?"mqttv3.1":"mqtt";t(`creating new Websocket for url: ${u} and protocol: ${y}`);let b;return f.createWebsocket?b=f.createWebsocket(u,[y],f):b=new m.default(u,[y],f.wsOptions),b}function v(p,u){let f=u.protocolId==="MQIsdp"&&u.protocolVersion===3?"mqttv3.1":"mqtt",y=a(u,p),b;return u.createWebsocket?b=u.createWebsocket(y,[f],u):b=new WebSocket(y,[f]),b.binaryType="arraybuffer",b}var g=(p,u)=>{t("streamBuilder");let f=o(u),y=a(f,p),b=_(p,y,f),A=m.default.createWebSocketStream(b,f.wsOptions);return A.url=y,b.on("close",()=>{A.destroy()}),A},l=(p,u)=>{t("browserStreamBuilder");let f,y=h(u).browserBufferSize||1024*512,b=u.browserBufferTimeout||1e3,A=!u.objectMode,R=v(p,u),C=O(u,G,re);u.objectMode||(C._writev=e.writev.bind(C)),C.on("close",()=>{R.close()});let L=typeof R.addEventListener<"u";R.readyState===R.OPEN?(f=C,f.socket=R):(f=new e.BufferedDuplex(u,C,R),L?R.addEventListener("open",N):R.onopen=N),L?(R.addEventListener("close",I),R.addEventListener("error",P),R.addEventListener("message",V)):(R.onclose=I,R.onerror=P,R.onmessage=V);function O(J,x,U){let F=new d.Transform({objectMode:J.objectMode});return F._write=x,F._flush=U,F}function N(){t("WebSocket onOpen"),f instanceof e.BufferedDuplex&&f.socketReady()}function I(J){t("WebSocket onClose",J),f.end(),f.destroy()}function P(J){t("WebSocket onError",J);let x=new Error("WebSocket error");x.event=J,f.destroy(x)}function V(J){let{data:x}=J;x instanceof ArrayBuffer?x=s.Buffer.from(x):x=s.Buffer.from(x,"utf8"),C.push(x)}function G(J,x,U){if(R.bufferedAmount>y){setTimeout(G,b,J,x,U);return}A&&typeof J=="string"&&(J=s.Buffer.from(J,"utf8"));try{R.send(J)}catch(F){return U(F)}U()}function re(J){R.close(),J()}return f};i.default=n.default?l:g}),wh=we(i=>{pe(),ge(),_e();var c=i&&i.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(i,"__esModule",{value:!0}),i.connectAsync=void 0;var s=c(Tt()),m=c((mh(),Pe(Ho))),w=c(vs()),d=c(Ds()),n=(0,s.default)("mqttjs"),e={};d.default?(e.wx=kn().default,e.wxs=kn().default,e.ali=Rn().default,e.alis=Rn().default):(e.mqtt=En().default,e.tcp=En().default,e.ssl=An().default,e.tls=e.ssl,e.mqtts=An().default),e.ws=Tn().default,e.wss=Tn().default;function t(o){let h;o.auth&&(h=o.auth.match(/^(.+):(.+)$/),h?(o.username=h[1],o.password=h[2]):o.username=o.auth)}function r(o,h){if(n("connecting to an MQTT broker..."),typeof o=="object"&&!h&&(h=o,o=""),h=h||{},o&&typeof o=="string"){let g=m.default.parse(o,!0);if(g.port!=null&&(g.port=Number(g.port)),h=Object.assign(Object.assign({},g),h),h.protocol===null)throw new Error("Missing protocol");h.protocol=h.protocol.replace(/:$/,"")}if(t(h),h.query&&typeof h.query.clientId=="string"&&(h.clientId=h.query.clientId),h.cert&&h.key)if(h.protocol){if(["mqtts","wss","wxs","alis"].indexOf(h.protocol)===-1)switch(h.protocol){case"mqtt":h.protocol="mqtts";break;case"ws":h.protocol="wss";break;case"wx":h.protocol="wxs";break;case"ali":h.protocol="alis";break;default:throw new Error(`Unknown protocol for secure connection: "${h.protocol}"!`)}}else throw new Error("Missing secure protocol key");if(!e[h.protocol]){let g=["mqtts","wss"].indexOf(h.protocol)!==-1;h.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((l,p)=>g&&p%2===0?!1:typeof e[l]=="function")[0]}if(h.clean===!1&&!h.clientId)throw new Error("Missing clientId for unclean clients");h.protocol&&(h.defaultProtocol=h.protocol);function _(g){return h.servers&&((!g._reconnectCount||g._reconnectCount===h.servers.length)&&(g._reconnectCount=0),h.host=h.servers[g._reconnectCount].host,h.port=h.servers[g._reconnectCount].port,h.protocol=h.servers[g._reconnectCount].protocol?h.servers[g._reconnectCount].protocol:h.defaultProtocol,h.hostname=h.host,g._reconnectCount++),n("calling streambuilder for",h.protocol),e[h.protocol](g,h)}let v=new w.default(_,h);return v.on("error",()=>{}),v}function a(o,h,_=!0){return new Promise((v,g)=>{let l=r(o,h),p={connect:f=>{u(),v(l)},end:()=>{u(),v(l)},error:f=>{u(),l.end(),g(f)}};_===!1&&(p.close=()=>{p.error(new Error("Couldn't connect to server"))});function u(){Object.keys(p).forEach(f=>{l.off(f,p[f])})}Object.keys(p).forEach(f=>{l.on(f,p[f])})})}i.connectAsync=a,i.default=r}),Ln=we(i=>{pe(),ge(),_e();var c=i&&i.__createBinding||(Object.create?function(h,_,v,g){g===void 0&&(g=v);var l=Object.getOwnPropertyDescriptor(_,v);(!l||("get"in l?!_.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return _[v]}}),Object.defineProperty(h,g,l)}:function(h,_,v,g){g===void 0&&(g=v),h[g]=_[v]}),s=i&&i.__setModuleDefault||(Object.create?function(h,_){Object.defineProperty(h,"default",{enumerable:!0,value:_})}:function(h,_){h.default=_}),m=i&&i.__importStar||function(h){if(h&&h.__esModule)return h;var _={};if(h!=null)for(var v in h)v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)&&c(_,h,v);return s(_,h),_},w=i&&i.__exportStar||function(h,_){for(var v in h)v!=="default"&&!Object.prototype.hasOwnProperty.call(_,v)&&c(_,h,v)},d=i&&i.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(i,"__esModule",{value:!0}),i.ReasonCodes=i.UniqueMessageIdProvider=i.DefaultMessageIdProvider=i.Store=i.MqttClient=i.connectAsync=i.connect=i.Client=void 0;var n=d(vs());i.MqttClient=n.default;var e=d(mo());i.DefaultMessageIdProvider=e.default;var t=d(rh());i.UniqueMessageIdProvider=t.default;var r=d(bo());i.Store=r.default;var a=m(wh());i.connect=a.default,Object.defineProperty(i,"connectAsync",{enumerable:!0,get:function(){return a.connectAsync}}),i.Client=n.default,w(vs(),i),w(mr(),i);var o=Hr();Object.defineProperty(i,"ReasonCodes",{enumerable:!0,get:function(){return o.ReasonCodes}})}),Sh=we(i=>{pe(),ge(),_e();var c=i&&i.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,a)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),s=i&&i.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),m=i&&i.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&c(e,n,t);return s(e,n),e},w=i&&i.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&c(e,n,t)};Object.defineProperty(i,"__esModule",{value:!0});var d=m(Ln());i.default=d,w(Ln(),i)});const Ch=Sh();/*! Bundled license information:

@jspm/core/nodelibs/browser/buffer.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/var ya={exports:{}};(function(i,c){(function(s,m){i.exports=m()})(self,()=>(()=>{var s={4567:function(n,e,t){var r=this&&this.__decorate||function(f,y,b,A){var R,C=arguments.length,L=C<3?y:A===null?A=Object.getOwnPropertyDescriptor(y,b):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(f,y,b,A);else for(var O=f.length-1;O>=0;O--)(R=f[O])&&(L=(C<3?R(L):C>3?R(y,b,L):R(y,b))||L);return C>3&&L&&Object.defineProperty(y,b,L),L},a=this&&this.__param||function(f,y){return function(b,A){y(b,A,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.AccessibilityManager=void 0;const o=t(9042),h=t(6114),_=t(9924),v=t(844),g=t(5596),l=t(4725),p=t(3656);let u=e.AccessibilityManager=class extends v.Disposable{constructor(f,y){super(),this._terminal=f,this._renderService=y,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let b=0;b<this._terminal.rows;b++)this._rowElements[b]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[b]);if(this._topBoundaryFocusListener=b=>this._handleBoundaryFocus(b,0),this._bottomBoundaryFocusListener=b=>this._handleBoundaryFocus(b,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new _.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(b=>this._handleResize(b.rows))),this.register(this._terminal.onRender(b=>this._refreshRows(b.start,b.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(b=>this._handleChar(b))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(b=>this._handleTab(b))),this.register(this._terminal.onKey(b=>this._handleKey(b.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new g.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,p.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,v.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(f){for(let y=0;y<f;y++)this._handleChar(" ")}_handleChar(f){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==f&&(this._charsToAnnounce+=f):this._charsToAnnounce+=f,f===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=o.tooMuchOutput)),h.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,h.isMac&&this._liveRegion.remove()}_handleKey(f){this._clearLiveRegion(),/\p{Control}/u.test(f)||this._charsToConsume.push(f)}_refreshRows(f,y){this._liveRegionDebouncer.refresh(f,y,this._terminal.rows)}_renderRows(f,y){const b=this._terminal.buffer,A=b.lines.length.toString();for(let R=f;R<=y;R++){const C=b.translateBufferLineToString(b.ydisp+R,!0),L=(b.ydisp+R+1).toString(),O=this._rowElements[R];O&&(C.length===0?O.innerText=" ":O.textContent=C,O.setAttribute("aria-posinset",L),O.setAttribute("aria-setsize",A))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(f,y){const b=f.target,A=this._rowElements[y===0?1:this._rowElements.length-2];if(b.getAttribute("aria-posinset")===(y===0?"1":`${this._terminal.buffer.lines.length}`)||f.relatedTarget!==A)return;let R,C;if(y===0?(R=b,C=this._rowElements.pop(),this._rowContainer.removeChild(C)):(R=this._rowElements.shift(),C=b,this._rowContainer.removeChild(R)),R.removeEventListener("focus",this._topBoundaryFocusListener),C.removeEventListener("focus",this._bottomBoundaryFocusListener),y===0){const L=this._createAccessibilityTreeNode();this._rowElements.unshift(L),this._rowContainer.insertAdjacentElement("afterbegin",L)}else{const L=this._createAccessibilityTreeNode();this._rowElements.push(L),this._rowContainer.appendChild(L)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(y===0?-1:1),this._rowElements[y===0?1:this._rowElements.length-2].focus(),f.preventDefault(),f.stopImmediatePropagation()}_handleResize(f){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let y=this._rowContainer.children.length;y<this._terminal.rows;y++)this._rowElements[y]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[y]);for(;this._rowElements.length>f;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const f=document.createElement("div");return f.setAttribute("role","listitem"),f.tabIndex=-1,this._refreshRowDimensions(f),f}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let f=0;f<this._terminal.rows;f++)this._refreshRowDimensions(this._rowElements[f])}}_refreshRowDimensions(f){f.style.height=`${this._renderService.dimensions.css.cell.height}px`}};e.AccessibilityManager=u=r([a(1,l.IRenderService)],u)},3614:(n,e)=>{function t(h){return h.replace(/\r?\n/g,"\r")}function r(h,_){return _?"\x1B[200~"+h+"\x1B[201~":h}function a(h,_,v,g){h=r(h=t(h),v.decPrivateModes.bracketedPasteMode&&g.rawOptions.ignoreBracketedPasteMode!==!0),v.triggerDataEvent(h,!0),_.value=""}function o(h,_,v){const g=v.getBoundingClientRect(),l=h.clientX-g.left-10,p=h.clientY-g.top-10;_.style.width="20px",_.style.height="20px",_.style.left=`${l}px`,_.style.top=`${p}px`,_.style.zIndex="1000",_.focus()}Object.defineProperty(e,"__esModule",{value:!0}),e.rightClickHandler=e.moveTextAreaUnderMouseCursor=e.paste=e.handlePasteEvent=e.copyHandler=e.bracketTextForPaste=e.prepareTextForTerminal=void 0,e.prepareTextForTerminal=t,e.bracketTextForPaste=r,e.copyHandler=function(h,_){h.clipboardData&&h.clipboardData.setData("text/plain",_.selectionText),h.preventDefault()},e.handlePasteEvent=function(h,_,v,g){h.stopPropagation(),h.clipboardData&&a(h.clipboardData.getData("text/plain"),_,v,g)},e.paste=a,e.moveTextAreaUnderMouseCursor=o,e.rightClickHandler=function(h,_,v,g,l){o(h,_,v),l&&g.rightClickSelect(h),_.value=g.selectionText,_.select()}},7239:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorContrastCache=void 0;const r=t(1505);e.ColorContrastCache=class{constructor(){this._color=new r.TwoKeyMap,this._css=new r.TwoKeyMap}setCss(a,o,h){this._css.set(a,o,h)}getCss(a,o){return this._css.get(a,o)}setColor(a,o,h){this._color.set(a,o,h)}getColor(a,o){return this._color.get(a,o)}clear(){this._color.clear(),this._css.clear()}}},3656:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.addDisposableDomListener=void 0,e.addDisposableDomListener=function(t,r,a,o){t.addEventListener(r,a,o);let h=!1;return{dispose:()=>{h||(h=!0,t.removeEventListener(r,a,o))}}}},6465:function(n,e,t){var r=this&&this.__decorate||function(l,p,u,f){var y,b=arguments.length,A=b<3?p:f===null?f=Object.getOwnPropertyDescriptor(p,u):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(l,p,u,f);else for(var R=l.length-1;R>=0;R--)(y=l[R])&&(A=(b<3?y(A):b>3?y(p,u,A):y(p,u))||A);return b>3&&A&&Object.defineProperty(p,u,A),A},a=this&&this.__param||function(l,p){return function(u,f){p(u,f,l)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Linkifier2=void 0;const o=t(3656),h=t(8460),_=t(844),v=t(2585);let g=e.Linkifier2=class extends _.Disposable{get currentLink(){return this._currentLink}constructor(l){super(),this._bufferService=l,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new h.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new h.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,_.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,_.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(l){return this._linkProviders.push(l),{dispose:()=>{const p=this._linkProviders.indexOf(l);p!==-1&&this._linkProviders.splice(p,1)}}}attachToDom(l,p,u){this._element=l,this._mouseService=p,this._renderService=u,this.register((0,o.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,o.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,o.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,o.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(l){if(this._lastMouseEvent=l,!this._element||!this._mouseService)return;const p=this._positionFromMouseEvent(l,this._element,this._mouseService);if(!p)return;this._isMouseOut=!1;const u=l.composedPath();for(let f=0;f<u.length;f++){const y=u[f];if(y.classList.contains("xterm"))break;if(y.classList.contains("xterm-hover"))return}this._lastBufferCell&&p.x===this._lastBufferCell.x&&p.y===this._lastBufferCell.y||(this._handleHover(p),this._lastBufferCell=p)}_handleHover(l){if(this._activeLine!==l.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(l,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,l)||(this._clearCurrentLink(),this._askForLink(l,!0))}_askForLink(l,p){var u,f;this._activeProviderReplies&&p||((u=this._activeProviderReplies)===null||u===void 0||u.forEach(b=>{b==null||b.forEach(A=>{A.link.dispose&&A.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=l.y);let y=!1;for(const[b,A]of this._linkProviders.entries())p?!((f=this._activeProviderReplies)===null||f===void 0)&&f.get(b)&&(y=this._checkLinkProviderResult(b,l,y)):A.provideLinks(l.y,R=>{var C,L;if(this._isMouseOut)return;const O=R==null?void 0:R.map(N=>({link:N}));(C=this._activeProviderReplies)===null||C===void 0||C.set(b,O),y=this._checkLinkProviderResult(b,l,y),((L=this._activeProviderReplies)===null||L===void 0?void 0:L.size)===this._linkProviders.length&&this._removeIntersectingLinks(l.y,this._activeProviderReplies)})}_removeIntersectingLinks(l,p){const u=new Set;for(let f=0;f<p.size;f++){const y=p.get(f);if(y)for(let b=0;b<y.length;b++){const A=y[b],R=A.link.range.start.y<l?0:A.link.range.start.x,C=A.link.range.end.y>l?this._bufferService.cols:A.link.range.end.x;for(let L=R;L<=C;L++){if(u.has(L)){y.splice(b--,1);break}u.add(L)}}}}_checkLinkProviderResult(l,p,u){var f;if(!this._activeProviderReplies)return u;const y=this._activeProviderReplies.get(l);let b=!1;for(let A=0;A<l;A++)this._activeProviderReplies.has(A)&&!this._activeProviderReplies.get(A)||(b=!0);if(!b&&y){const A=y.find(R=>this._linkAtPosition(R.link,p));A&&(u=!0,this._handleNewLink(A))}if(this._activeProviderReplies.size===this._linkProviders.length&&!u)for(let A=0;A<this._activeProviderReplies.size;A++){const R=(f=this._activeProviderReplies.get(A))===null||f===void 0?void 0:f.find(C=>this._linkAtPosition(C.link,p));if(R){u=!0,this._handleNewLink(R);break}}return u}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(l){if(!this._element||!this._mouseService||!this._currentLink)return;const p=this._positionFromMouseEvent(l,this._element,this._mouseService);p&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,p)&&this._currentLink.link.activate(l,this._currentLink.link.text)}_clearCurrentLink(l,p){this._element&&this._currentLink&&this._lastMouseEvent&&(!l||!p||this._currentLink.link.range.start.y>=l&&this._currentLink.link.range.end.y<=p)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,_.disposeArray)(this._linkCacheDisposables))}_handleNewLink(l){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const p=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);p&&this._linkAtPosition(l.link,p)&&(this._currentLink=l,this._currentLink.state={decorations:{underline:l.link.decorations===void 0||l.link.decorations.underline,pointerCursor:l.link.decorations===void 0||l.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,l.link,this._lastMouseEvent),l.link.decorations={},Object.defineProperties(l.link.decorations,{pointerCursor:{get:()=>{var u,f;return(f=(u=this._currentLink)===null||u===void 0?void 0:u.state)===null||f===void 0?void 0:f.decorations.pointerCursor},set:u=>{var f,y;!((f=this._currentLink)===null||f===void 0)&&f.state&&this._currentLink.state.decorations.pointerCursor!==u&&(this._currentLink.state.decorations.pointerCursor=u,this._currentLink.state.isHovered&&((y=this._element)===null||y===void 0||y.classList.toggle("xterm-cursor-pointer",u)))}},underline:{get:()=>{var u,f;return(f=(u=this._currentLink)===null||u===void 0?void 0:u.state)===null||f===void 0?void 0:f.decorations.underline},set:u=>{var f,y,b;!((f=this._currentLink)===null||f===void 0)&&f.state&&((b=(y=this._currentLink)===null||y===void 0?void 0:y.state)===null||b===void 0?void 0:b.decorations.underline)!==u&&(this._currentLink.state.decorations.underline=u,this._currentLink.state.isHovered&&this._fireUnderlineEvent(l.link,u))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(u=>{if(!this._currentLink)return;const f=u.start===0?0:u.start+1+this._bufferService.buffer.ydisp,y=this._bufferService.buffer.ydisp+1+u.end;if(this._currentLink.link.range.start.y>=f&&this._currentLink.link.range.end.y<=y&&(this._clearCurrentLink(f,y),this._lastMouseEvent&&this._element)){const b=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);b&&this._askForLink(b,!1)}})))}_linkHover(l,p,u){var f;!((f=this._currentLink)===null||f===void 0)&&f.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(p,!0),this._currentLink.state.decorations.pointerCursor&&l.classList.add("xterm-cursor-pointer")),p.hover&&p.hover(u,p.text)}_fireUnderlineEvent(l,p){const u=l.range,f=this._bufferService.buffer.ydisp,y=this._createLinkUnderlineEvent(u.start.x-1,u.start.y-f-1,u.end.x,u.end.y-f-1,void 0);(p?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(y)}_linkLeave(l,p,u){var f;!((f=this._currentLink)===null||f===void 0)&&f.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(p,!1),this._currentLink.state.decorations.pointerCursor&&l.classList.remove("xterm-cursor-pointer")),p.leave&&p.leave(u,p.text)}_linkAtPosition(l,p){const u=l.range.start.y*this._bufferService.cols+l.range.start.x,f=l.range.end.y*this._bufferService.cols+l.range.end.x,y=p.y*this._bufferService.cols+p.x;return u<=y&&y<=f}_positionFromMouseEvent(l,p,u){const f=u.getCoords(l,p,this._bufferService.cols,this._bufferService.rows);if(f)return{x:f[0],y:f[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(l,p,u,f,y){return{x1:l,y1:p,x2:u,y2:f,cols:this._bufferService.cols,fg:y}}};e.Linkifier2=g=r([a(0,v.IBufferService)],g)},9042:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tooMuchOutput=e.promptLabel=void 0,e.promptLabel="Terminal input",e.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(n,e,t){var r=this&&this.__decorate||function(g,l,p,u){var f,y=arguments.length,b=y<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,p):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(g,l,p,u);else for(var A=g.length-1;A>=0;A--)(f=g[A])&&(b=(y<3?f(b):y>3?f(l,p,b):f(l,p))||b);return y>3&&b&&Object.defineProperty(l,p,b),b},a=this&&this.__param||function(g,l){return function(p,u){l(p,u,g)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkProvider=void 0;const o=t(511),h=t(2585);let _=e.OscLinkProvider=class{constructor(g,l,p){this._bufferService=g,this._optionsService=l,this._oscLinkService=p}provideLinks(g,l){var p;const u=this._bufferService.buffer.lines.get(g-1);if(!u)return void l(void 0);const f=[],y=this._optionsService.rawOptions.linkHandler,b=new o.CellData,A=u.getTrimmedLength();let R=-1,C=-1,L=!1;for(let O=0;O<A;O++)if(C!==-1||u.hasContent(O)){if(u.loadCell(O,b),b.hasExtendedAttrs()&&b.extended.urlId){if(C===-1){C=O,R=b.extended.urlId;continue}L=b.extended.urlId!==R}else C!==-1&&(L=!0);if(L||C!==-1&&O===A-1){const N=(p=this._oscLinkService.getLinkData(R))===null||p===void 0?void 0:p.uri;if(N){const I={start:{x:C+1,y:g},end:{x:O+(L||O!==A-1?0:1),y:g}};let P=!1;if(!(y!=null&&y.allowNonHttpProtocols))try{const V=new URL(N);["http:","https:"].includes(V.protocol)||(P=!0)}catch{P=!0}P||f.push({text:N,range:I,activate:(V,G)=>y?y.activate(V,G,I):v(0,G),hover:(V,G)=>{var re;return(re=y==null?void 0:y.hover)===null||re===void 0?void 0:re.call(y,V,G,I)},leave:(V,G)=>{var re;return(re=y==null?void 0:y.leave)===null||re===void 0?void 0:re.call(y,V,G,I)}})}L=!1,b.hasExtendedAttrs()&&b.extended.urlId?(C=O,R=b.extended.urlId):(C=-1,R=-1)}}l(f)}};function v(g,l){if(confirm(`Do you want to navigate to ${l}?

WARNING: This link could potentially be dangerous`)){const p=window.open();if(p){try{p.opener=null}catch{}p.location.href=l}else console.warn("Opening link blocked as opener could not be cleared")}}e.OscLinkProvider=_=r([a(0,h.IBufferService),a(1,h.IOptionsService),a(2,h.IOscLinkService)],_)},6193:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RenderDebouncer=void 0,e.RenderDebouncer=class{constructor(t,r){this._parentWindow=t,this._renderCallback=r,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(t){return this._refreshCallbacks.push(t),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(t,r,a){this._rowCount=a,t=t!==void 0?t:0,r=r!==void 0?r:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,t):t,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,r):r,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const t=Math.max(this._rowStart,0),r=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(t,r),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const t of this._refreshCallbacks)t(0);this._refreshCallbacks=[]}}},5596:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ScreenDprMonitor=void 0;const r=t(844);class a extends r.Disposable{constructor(h){super(),this._parentWindow=h,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,r.toDisposable)(()=>{this.clearListener()}))}setListener(h){this._listener&&this.clearListener(),this._listener=h,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var h;this._outerListener&&((h=this._resolutionMediaMatchList)===null||h===void 0||h.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}e.ScreenDprMonitor=a},3236:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;const r=t(3614),a=t(3656),o=t(6465),h=t(9042),_=t(3730),v=t(1680),g=t(3107),l=t(5744),p=t(2950),u=t(1296),f=t(428),y=t(4269),b=t(5114),A=t(8934),R=t(3230),C=t(9312),L=t(4725),O=t(6731),N=t(8055),I=t(8969),P=t(8460),V=t(844),G=t(6114),re=t(8437),J=t(2584),x=t(7399),U=t(5941),F=t(9074),z=t(2585),D=t(5435),Z=t(4567),se=typeof window<"u"?window.document:null;class he extends I.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(T={}){super(T),this.browser=G,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new V.MutableDisposable),this._onCursorMove=this.register(new P.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new P.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new P.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new P.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new P.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new P.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new P.EventEmitter),this._onBlur=this.register(new P.EventEmitter),this._onA11yCharEmitter=this.register(new P.EventEmitter),this._onA11yTabEmitter=this.register(new P.EventEmitter),this._onWillOpen=this.register(new P.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(o.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(_.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(F.DecorationService),this._instantiationService.setService(z.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((B,q)=>this.refresh(B,q))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(B=>this._reportWindowsOptions(B))),this.register(this._inputHandler.onColor(B=>this._handleColorEvent(B))),this.register((0,P.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,P.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(B=>this._afterResize(B.cols,B.rows))),this.register((0,V.toDisposable)(()=>{var B,q;this._customKeyEventHandler=void 0,(q=(B=this.element)===null||B===void 0?void 0:B.parentNode)===null||q===void 0||q.removeChild(this.element)}))}_handleColorEvent(T){if(this._themeService)for(const B of T){let q,X="";switch(B.index){case 256:q="foreground",X="10";break;case 257:q="background",X="11";break;case 258:q="cursor",X="12";break;default:q="ansi",X="4;"+B.index}switch(B.type){case 0:const ie=N.color.toColorRGB(q==="ansi"?this._themeService.colors.ansi[B.index]:this._themeService.colors[q]);this.coreService.triggerDataEvent(`${J.C0.ESC}]${X};${(0,U.toRgbString)(ie)}${J.C1_ESCAPED.ST}`);break;case 1:if(q==="ansi")this._themeService.modifyColors(te=>te.ansi[B.index]=N.rgba.toColor(...B.color));else{const te=q;this._themeService.modifyColors(le=>le[te]=N.rgba.toColor(...B.color))}break;case 2:this._themeService.restoreColor(B.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(T){T?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Z.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(T){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(J.C0.ESC+"[I"),this.updateCursorStyle(T),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var T;return(T=this.textarea)===null||T===void 0?void 0:T.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(J.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const T=this.buffer.ybase+this.buffer.y,B=this.buffer.lines.get(T);if(!B)return;const q=Math.min(this.buffer.x,this.cols-1),X=this._renderService.dimensions.css.cell.height,ie=B.getWidth(q),te=this._renderService.dimensions.css.cell.width*ie,le=this.buffer.y*this._renderService.dimensions.css.cell.height,ue=q*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ue+"px",this.textarea.style.top=le+"px",this.textarea.style.width=te+"px",this.textarea.style.height=X+"px",this.textarea.style.lineHeight=X+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,a.addDisposableDomListener)(this.element,"copy",B=>{this.hasSelection()&&(0,r.copyHandler)(B,this._selectionService)}));const T=B=>(0,r.handlePasteEvent)(B,this.textarea,this.coreService,this.optionsService);this.register((0,a.addDisposableDomListener)(this.textarea,"paste",T)),this.register((0,a.addDisposableDomListener)(this.element,"paste",T)),G.isFirefox?this.register((0,a.addDisposableDomListener)(this.element,"mousedown",B=>{B.button===2&&(0,r.rightClickHandler)(B,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,a.addDisposableDomListener)(this.element,"contextmenu",B=>{(0,r.rightClickHandler)(B,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),G.isLinux&&this.register((0,a.addDisposableDomListener)(this.element,"auxclick",B=>{B.button===1&&(0,r.moveTextAreaUnderMouseCursor)(B,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,a.addDisposableDomListener)(this.textarea,"keyup",T=>this._keyUp(T),!0)),this.register((0,a.addDisposableDomListener)(this.textarea,"keydown",T=>this._keyDown(T),!0)),this.register((0,a.addDisposableDomListener)(this.textarea,"keypress",T=>this._keyPress(T),!0)),this.register((0,a.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,a.addDisposableDomListener)(this.textarea,"compositionupdate",T=>this._compositionHelper.compositionupdate(T))),this.register((0,a.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,a.addDisposableDomListener)(this.textarea,"input",T=>this._inputEvent(T),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(T){var B;if(!T)throw new Error("Terminal requires a parent element.");T.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=T.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),T.appendChild(this.element);const q=se.createDocumentFragment();this._viewportElement=se.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),q.appendChild(this._viewportElement),this._viewportScrollArea=se.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=se.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=se.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),q.appendChild(this.screenElement),this.textarea=se.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),G.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(b.CoreBrowserService,this.textarea,(B=this._document.defaultView)!==null&&B!==void 0?B:window),this._instantiationService.setService(L.ICoreBrowserService,this._coreBrowserService),this.register((0,a.addDisposableDomListener)(this.textarea,"focus",X=>this._handleTextAreaFocus(X))),this.register((0,a.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(f.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(L.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(O.ThemeService),this._instantiationService.setService(L.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(y.CharacterJoinerService),this._instantiationService.setService(L.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(R.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(L.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(X=>this._onRender.fire(X))),this.onResize(X=>this._renderService.resize(X.cols,X.rows)),this._compositionView=se.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(p.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(q);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(A.MouseService),this._instantiationService.setService(L.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(v.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(X=>this.scrollLines(X.amount,X.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(C.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(L.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(X=>this.scrollLines(X.amount,X.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(X=>this._renderService.handleSelectionChanged(X.start,X.end,X.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(X=>{this.textarea.value=X,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(X=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,a.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(g.BufferDecorationRenderer,this.screenElement)),this.register((0,a.addDisposableDomListener)(this.element,"mousedown",X=>this._selectionService.handleMouseDown(X))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Z.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",X=>this._handleScreenReaderModeOptionChange(X))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(l.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",X=>{!this._overviewRulerRenderer&&X&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(l.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(u.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const T=this,B=this.element;function q(te){const le=T._mouseService.getMouseReportCoords(te,T.screenElement);if(!le)return!1;let ue,W;switch(te.overrideType||te.type){case"mousemove":W=32,te.buttons===void 0?(ue=3,te.button!==void 0&&(ue=te.button<3?te.button:3)):ue=1&te.buttons?0:4&te.buttons?1:2&te.buttons?2:3;break;case"mouseup":W=0,ue=te.button<3?te.button:3;break;case"mousedown":W=1,ue=te.button<3?te.button:3;break;case"wheel":if(T.viewport.getLinesScrolled(te)===0)return!1;W=te.deltaY<0?0:1,ue=4;break;default:return!1}return!(W===void 0||ue===void 0||ue>4)&&T.coreMouseService.triggerMouseEvent({col:le.col,row:le.row,x:le.x,y:le.y,button:ue,action:W,ctrl:te.ctrlKey,alt:te.altKey,shift:te.shiftKey})}const X={mouseup:null,wheel:null,mousedrag:null,mousemove:null},ie={mouseup:te=>(q(te),te.buttons||(this._document.removeEventListener("mouseup",X.mouseup),X.mousedrag&&this._document.removeEventListener("mousemove",X.mousedrag)),this.cancel(te)),wheel:te=>(q(te),this.cancel(te,!0)),mousedrag:te=>{te.buttons&&q(te)},mousemove:te=>{te.buttons||q(te)}};this.register(this.coreMouseService.onProtocolChange(te=>{te?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(te)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&te?X.mousemove||(B.addEventListener("mousemove",ie.mousemove),X.mousemove=ie.mousemove):(B.removeEventListener("mousemove",X.mousemove),X.mousemove=null),16&te?X.wheel||(B.addEventListener("wheel",ie.wheel,{passive:!1}),X.wheel=ie.wheel):(B.removeEventListener("wheel",X.wheel),X.wheel=null),2&te?X.mouseup||(B.addEventListener("mouseup",ie.mouseup),X.mouseup=ie.mouseup):(this._document.removeEventListener("mouseup",X.mouseup),B.removeEventListener("mouseup",X.mouseup),X.mouseup=null),4&te?X.mousedrag||(X.mousedrag=ie.mousedrag):(this._document.removeEventListener("mousemove",X.mousedrag),X.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,a.addDisposableDomListener)(B,"mousedown",te=>{if(te.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(te))return q(te),X.mouseup&&this._document.addEventListener("mouseup",X.mouseup),X.mousedrag&&this._document.addEventListener("mousemove",X.mousedrag),this.cancel(te)})),this.register((0,a.addDisposableDomListener)(B,"wheel",te=>{if(!X.wheel){if(!this.buffer.hasScrollback){const le=this.viewport.getLinesScrolled(te);if(le===0)return;const ue=J.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(te.deltaY<0?"A":"B");let W="";for(let ee=0;ee<Math.abs(le);ee++)W+=ue;return this.coreService.triggerDataEvent(W,!0),this.cancel(te,!0)}return this.viewport.handleWheel(te)?this.cancel(te):void 0}},{passive:!1})),this.register((0,a.addDisposableDomListener)(B,"touchstart",te=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(te),this.cancel(te)},{passive:!0})),this.register((0,a.addDisposableDomListener)(B,"touchmove",te=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(te)?void 0:this.cancel(te)},{passive:!1}))}refresh(T,B){var q;(q=this._renderService)===null||q===void 0||q.refreshRows(T,B)}updateCursorStyle(T){var B;!((B=this._selectionService)===null||B===void 0)&&B.shouldColumnSelect(T)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(T,B,q=0){var X;q===1?(super.scrollLines(T,B,q),this.refresh(0,this.rows-1)):(X=this.viewport)===null||X===void 0||X.scrollLines(T)}paste(T){(0,r.paste)(T,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(T){this._customKeyEventHandler=T}registerLinkProvider(T){return this.linkifier2.registerLinkProvider(T)}registerCharacterJoiner(T){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const B=this._characterJoinerService.register(T);return this.refresh(0,this.rows-1),B}deregisterCharacterJoiner(T){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(T)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(T){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+T)}registerDecoration(T){return this._decorationService.registerDecoration(T)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(T,B,q){this._selectionService.setSelection(T,B,q)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var T;(T=this._selectionService)===null||T===void 0||T.clearSelection()}selectAll(){var T;(T=this._selectionService)===null||T===void 0||T.selectAll()}selectLines(T,B){var q;(q=this._selectionService)===null||q===void 0||q.selectLines(T,B)}_keyDown(T){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(T)===!1)return!1;const B=this.browser.isMac&&this.options.macOptionIsMeta&&T.altKey;if(!B&&!this._compositionHelper.keydown(T))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;B||T.key!=="Dead"&&T.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const q=(0,x.evaluateKeyboardEvent)(T,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(T),q.type===3||q.type===2){const X=this.rows-1;return this.scrollLines(q.type===2?-X:X),this.cancel(T,!0)}return q.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,T)||(q.cancel&&this.cancel(T,!0),!q.key||!!(T.key&&!T.ctrlKey&&!T.altKey&&!T.metaKey&&T.key.length===1&&T.key.charCodeAt(0)>=65&&T.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(q.key!==J.C0.ETX&&q.key!==J.C0.CR||(this.textarea.value=""),this._onKey.fire({key:q.key,domEvent:T}),this._showCursor(),this.coreService.triggerDataEvent(q.key,!0),!this.optionsService.rawOptions.screenReaderMode||T.altKey||T.ctrlKey?this.cancel(T,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(T,B){const q=T.isMac&&!this.options.macOptionIsMeta&&B.altKey&&!B.ctrlKey&&!B.metaKey||T.isWindows&&B.altKey&&B.ctrlKey&&!B.metaKey||T.isWindows&&B.getModifierState("AltGraph");return B.type==="keypress"?q:q&&(!B.keyCode||B.keyCode>47)}_keyUp(T){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(T)===!1||(function(B){return B.keyCode===16||B.keyCode===17||B.keyCode===18}(T)||this.focus(),this.updateCursorStyle(T),this._keyPressHandled=!1)}_keyPress(T){let B;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(T)===!1)return!1;if(this.cancel(T),T.charCode)B=T.charCode;else if(T.which===null||T.which===void 0)B=T.keyCode;else{if(T.which===0||T.charCode===0)return!1;B=T.which}return!(!B||(T.altKey||T.ctrlKey||T.metaKey)&&!this._isThirdLevelShift(this.browser,T)||(B=String.fromCharCode(B),this._onKey.fire({key:B,domEvent:T}),this._showCursor(),this.coreService.triggerDataEvent(B,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(T){if(T.data&&T.inputType==="insertText"&&(!T.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const B=T.data;return this.coreService.triggerDataEvent(B,!0),this.cancel(T),!0}return!1}resize(T,B){T!==this.cols||B!==this.rows?super.resize(T,B):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(T,B){var q,X;(q=this._charSizeService)===null||q===void 0||q.measure(),(X=this.viewport)===null||X===void 0||X.syncScrollArea(!0)}clear(){var T;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let B=1;B<this.rows;B++)this.buffer.lines.push(this.buffer.getBlankLine(re.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(T=this.viewport)===null||T===void 0||T.reset(),this.refresh(0,this.rows-1)}}reset(){var T,B;this.options.rows=this.rows,this.options.cols=this.cols;const q=this._customKeyEventHandler;this._setup(),super.reset(),(T=this._selectionService)===null||T===void 0||T.reset(),this._decorationService.reset(),(B=this.viewport)===null||B===void 0||B.reset(),this._customKeyEventHandler=q,this.refresh(0,this.rows-1)}clearTextureAtlas(){var T;(T=this._renderService)===null||T===void 0||T.clearTextureAtlas()}_reportFocus(){var T;!((T=this.element)===null||T===void 0)&&T.classList.contains("focus")?this.coreService.triggerDataEvent(J.C0.ESC+"[I"):this.coreService.triggerDataEvent(J.C0.ESC+"[O")}_reportWindowsOptions(T){if(this._renderService)switch(T){case D.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const B=this._renderService.dimensions.css.canvas.width.toFixed(0),q=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${J.C0.ESC}[4;${q};${B}t`);break;case D.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const X=this._renderService.dimensions.css.cell.width.toFixed(0),ie=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${J.C0.ESC}[6;${ie};${X}t`)}}cancel(T,B){if(this.options.cancelEvents||B)return T.preventDefault(),T.stopPropagation(),!1}}e.Terminal=he},9924:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TimeBasedDebouncer=void 0,e.TimeBasedDebouncer=class{constructor(t,r=1e3){this._renderCallback=t,this._debounceThresholdMS=r,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(t,r,a){this._rowCount=a,t=t!==void 0?t:0,r=r!==void 0?r:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,t):t,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,r):r;const o=Date.now();if(o-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=o,this._innerRefresh();else if(!this._additionalRefreshRequested){const h=o-this._lastRefreshMs,_=this._debounceThresholdMS-h;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},_)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const t=Math.max(this._rowStart,0),r=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(t,r)}}},1680:function(n,e,t){var r=this&&this.__decorate||function(p,u,f,y){var b,A=arguments.length,R=A<3?u:y===null?y=Object.getOwnPropertyDescriptor(u,f):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(p,u,f,y);else for(var C=p.length-1;C>=0;C--)(b=p[C])&&(R=(A<3?b(R):A>3?b(u,f,R):b(u,f))||R);return A>3&&R&&Object.defineProperty(u,f,R),R},a=this&&this.__param||function(p,u){return function(f,y){u(f,y,p)}};Object.defineProperty(e,"__esModule",{value:!0}),e.Viewport=void 0;const o=t(3656),h=t(4725),_=t(8460),v=t(844),g=t(2585);let l=e.Viewport=class extends v.Disposable{constructor(p,u,f,y,b,A,R,C){super(),this._viewportElement=p,this._scrollArea=u,this._bufferService=f,this._optionsService=y,this._charSizeService=b,this._renderService=A,this._coreBrowserService=R,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,o.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(L=>this._activeBuffer=L.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(L=>this._renderDimensions=L)),this._handleThemeChange(C.colors),this.register(C.onChangeColors(L=>this._handleThemeChange(L))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(p){this._viewportElement.style.backgroundColor=p.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(p){if(p)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const u=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==u&&(this._lastRecordedBufferHeight=u,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const p=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==p&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=p),this._refreshAnimationFrame=null}syncScrollArea(p=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(p);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(p)}_handleScroll(p){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const u=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:u,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const p=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(p*(this._smoothScrollState.target-this._smoothScrollState.origin)),p<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(p,u){const f=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(u<0&&this._viewportElement.scrollTop!==0||u>0&&f<this._lastRecordedBufferHeight)||(p.cancelable&&p.preventDefault(),!1)}handleWheel(p){const u=this._getPixelsScrolled(p);return u!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+u:this._smoothScrollState.target+=u,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=u,this._bubbleScroll(p,u))}scrollLines(p){if(p!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const u=p*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+u,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:p,suppressScrollEvent:!1})}_getPixelsScrolled(p){if(p.deltaY===0||p.shiftKey)return 0;let u=this._applyScrollModifier(p.deltaY,p);return p.deltaMode===WheelEvent.DOM_DELTA_LINE?u*=this._currentRowHeight:p.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(u*=this._currentRowHeight*this._bufferService.rows),u}getBufferElements(p,u){var f;let y,b="";const A=[],R=u??this._bufferService.buffer.lines.length,C=this._bufferService.buffer.lines;for(let L=p;L<R;L++){const O=C.get(L);if(!O)continue;const N=(f=C.get(L+1))===null||f===void 0?void 0:f.isWrapped;if(b+=O.translateToString(!N),!N||L===C.length-1){const I=document.createElement("div");I.textContent=b,A.push(I),b.length>0&&(y=I),b=""}}return{bufferElements:A,cursorElement:y}}getLinesScrolled(p){if(p.deltaY===0||p.shiftKey)return 0;let u=this._applyScrollModifier(p.deltaY,p);return p.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(u/=this._currentRowHeight+0,this._wheelPartialScroll+=u,u=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):p.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(u*=this._bufferService.rows),u}_applyScrollModifier(p,u){const f=this._optionsService.rawOptions.fastScrollModifier;return f==="alt"&&u.altKey||f==="ctrl"&&u.ctrlKey||f==="shift"&&u.shiftKey?p*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:p*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(p){this._lastTouchY=p.touches[0].pageY}handleTouchMove(p){const u=this._lastTouchY-p.touches[0].pageY;return this._lastTouchY=p.touches[0].pageY,u!==0&&(this._viewportElement.scrollTop+=u,this._bubbleScroll(p,u))}};e.Viewport=l=r([a(2,g.IBufferService),a(3,g.IOptionsService),a(4,h.ICharSizeService),a(5,h.IRenderService),a(6,h.ICoreBrowserService),a(7,h.IThemeService)],l)},3107:function(n,e,t){var r=this&&this.__decorate||function(l,p,u,f){var y,b=arguments.length,A=b<3?p:f===null?f=Object.getOwnPropertyDescriptor(p,u):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(l,p,u,f);else for(var R=l.length-1;R>=0;R--)(y=l[R])&&(A=(b<3?y(A):b>3?y(p,u,A):y(p,u))||A);return b>3&&A&&Object.defineProperty(p,u,A),A},a=this&&this.__param||function(l,p){return function(u,f){p(u,f,l)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferDecorationRenderer=void 0;const o=t(3656),h=t(4725),_=t(844),v=t(2585);let g=e.BufferDecorationRenderer=class extends _.Disposable{constructor(l,p,u,f){super(),this._screenElement=l,this._bufferService=p,this._decorationService=u,this._renderService=f,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,o.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(y=>this._removeDecoration(y))),this.register((0,_.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const l of this._decorationService.decorations)this._renderDecoration(l);this._dimensionsChanged=!1}_renderDecoration(l){this._refreshStyle(l),this._dimensionsChanged&&this._refreshXPosition(l)}_createElement(l){var p,u;const f=document.createElement("div");f.classList.add("xterm-decoration"),f.classList.toggle("xterm-decoration-top-layer",((p=l==null?void 0:l.options)===null||p===void 0?void 0:p.layer)==="top"),f.style.width=`${Math.round((l.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,f.style.height=(l.options.height||1)*this._renderService.dimensions.css.cell.height+"px",f.style.top=(l.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",f.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const y=(u=l.options.x)!==null&&u!==void 0?u:0;return y&&y>this._bufferService.cols&&(f.style.display="none"),this._refreshXPosition(l,f),f}_refreshStyle(l){const p=l.marker.line-this._bufferService.buffers.active.ydisp;if(p<0||p>=this._bufferService.rows)l.element&&(l.element.style.display="none",l.onRenderEmitter.fire(l.element));else{let u=this._decorationElements.get(l);u||(u=this._createElement(l),l.element=u,this._decorationElements.set(l,u),this._container.appendChild(u),l.onDispose(()=>{this._decorationElements.delete(l),u.remove()})),u.style.top=p*this._renderService.dimensions.css.cell.height+"px",u.style.display=this._altBufferIsActive?"none":"block",l.onRenderEmitter.fire(u)}}_refreshXPosition(l,p=l.element){var u;if(!p)return;const f=(u=l.options.x)!==null&&u!==void 0?u:0;(l.options.anchor||"left")==="right"?p.style.right=f?f*this._renderService.dimensions.css.cell.width+"px":"":p.style.left=f?f*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(l){var p;(p=this._decorationElements.get(l))===null||p===void 0||p.remove(),this._decorationElements.delete(l),l.dispose()}};e.BufferDecorationRenderer=g=r([a(1,v.IBufferService),a(2,v.IDecorationService),a(3,h.IRenderService)],g)},5871:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorZoneStore=void 0,e.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(t){if(t.options.overviewRulerOptions){for(const r of this._zones)if(r.color===t.options.overviewRulerOptions.color&&r.position===t.options.overviewRulerOptions.position){if(this._lineIntersectsZone(r,t.marker.line))return;if(this._lineAdjacentToZone(r,t.marker.line,t.options.overviewRulerOptions.position))return void this._addLineToZone(r,t.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=t.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=t.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=t.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=t.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:t.options.overviewRulerOptions.color,position:t.options.overviewRulerOptions.position,startBufferLine:t.marker.line,endBufferLine:t.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(t){this._linePadding=t}_lineIntersectsZone(t,r){return r>=t.startBufferLine&&r<=t.endBufferLine}_lineAdjacentToZone(t,r,a){return r>=t.startBufferLine-this._linePadding[a||"full"]&&r<=t.endBufferLine+this._linePadding[a||"full"]}_addLineToZone(t,r){t.startBufferLine=Math.min(t.startBufferLine,r),t.endBufferLine=Math.max(t.endBufferLine,r)}}},5744:function(n,e,t){var r=this&&this.__decorate||function(y,b,A,R){var C,L=arguments.length,O=L<3?b:R===null?R=Object.getOwnPropertyDescriptor(b,A):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,b,A,R);else for(var N=y.length-1;N>=0;N--)(C=y[N])&&(O=(L<3?C(O):L>3?C(b,A,O):C(b,A))||O);return L>3&&O&&Object.defineProperty(b,A,O),O},a=this&&this.__param||function(y,b){return function(A,R){b(A,R,y)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OverviewRulerRenderer=void 0;const o=t(5871),h=t(3656),_=t(4725),v=t(844),g=t(2585),l={full:0,left:0,center:0,right:0},p={full:0,left:0,center:0,right:0},u={full:0,left:0,center:0,right:0};let f=e.OverviewRulerRenderer=class extends v.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(y,b,A,R,C,L,O){var N;super(),this._viewportElement=y,this._screenElement=b,this._bufferService=A,this._decorationService=R,this._renderService=C,this._optionsService=L,this._coreBrowseService=O,this._colorZoneStore=new o.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(N=this._viewportElement.parentElement)===null||N===void 0||N.insertBefore(this._canvas,this._viewportElement);const I=this._canvas.getContext("2d");if(!I)throw new Error("Ctx cannot be null");this._ctx=I,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,v.toDisposable)(()=>{var P;(P=this._canvas)===null||P===void 0||P.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,h.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const y=Math.floor(this._canvas.width/3),b=Math.ceil(this._canvas.width/3);p.full=this._canvas.width,p.left=y,p.center=b,p.right=y,this._refreshDrawHeightConstants(),u.full=0,u.left=0,u.center=p.left,u.right=p.left+p.center}_refreshDrawHeightConstants(){l.full=Math.round(2*this._coreBrowseService.dpr);const y=this._canvas.height/this._bufferService.buffer.lines.length,b=Math.round(Math.max(Math.min(y,12),6)*this._coreBrowseService.dpr);l.left=b,l.center=b,l.right=b}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*l.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*l.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*l.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*l.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const b of this._decorationService.decorations)this._colorZoneStore.addDecoration(b);this._ctx.lineWidth=1;const y=this._colorZoneStore.zones;for(const b of y)b.position!=="full"&&this._renderColorZone(b);for(const b of y)b.position==="full"&&this._renderColorZone(b);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(y){this._ctx.fillStyle=y.color,this._ctx.fillRect(u[y.position||"full"],Math.round((this._canvas.height-1)*(y.startBufferLine/this._bufferService.buffers.active.lines.length)-l[y.position||"full"]/2),p[y.position||"full"],Math.round((this._canvas.height-1)*((y.endBufferLine-y.startBufferLine)/this._bufferService.buffers.active.lines.length)+l[y.position||"full"]))}_queueRefresh(y,b){this._shouldUpdateDimensions=y||this._shouldUpdateDimensions,this._shouldUpdateAnchor=b||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};e.OverviewRulerRenderer=f=r([a(2,g.IBufferService),a(3,g.IDecorationService),a(4,_.IRenderService),a(5,g.IOptionsService),a(6,_.ICoreBrowserService)],f)},2950:function(n,e,t){var r=this&&this.__decorate||function(g,l,p,u){var f,y=arguments.length,b=y<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,p):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(g,l,p,u);else for(var A=g.length-1;A>=0;A--)(f=g[A])&&(b=(y<3?f(b):y>3?f(l,p,b):f(l,p))||b);return y>3&&b&&Object.defineProperty(l,p,b),b},a=this&&this.__param||function(g,l){return function(p,u){l(p,u,g)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CompositionHelper=void 0;const o=t(4725),h=t(2585),_=t(2584);let v=e.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(g,l,p,u,f,y){this._textarea=g,this._compositionView=l,this._bufferService=p,this._optionsService=u,this._coreService=f,this._renderService=y,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(g){this._compositionView.textContent=g.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(g){if(this._isComposing||this._isSendingComposition){if(g.keyCode===229||g.keyCode===16||g.keyCode===17||g.keyCode===18)return!1;this._finalizeComposition(!1)}return g.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(g){if(this._compositionView.classList.remove("active"),this._isComposing=!1,g){const l={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let p;this._isSendingComposition=!1,l.start+=this._dataAlreadySent.length,p=this._isComposing?this._textarea.value.substring(l.start,l.end):this._textarea.value.substring(l.start),p.length>0&&this._coreService.triggerDataEvent(p,!0)}},0)}else{this._isSendingComposition=!1;const l=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(l,!0)}}_handleAnyTextareaChanges(){const g=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const l=this._textarea.value,p=l.replace(g,"");this._dataAlreadySent=p,l.length>g.length?this._coreService.triggerDataEvent(p,!0):l.length<g.length?this._coreService.triggerDataEvent(`${_.C0.DEL}`,!0):l.length===g.length&&l!==g&&this._coreService.triggerDataEvent(l,!0)}},0)}updateCompositionElements(g){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const l=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),p=this._renderService.dimensions.css.cell.height,u=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,f=l*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=f+"px",this._compositionView.style.top=u+"px",this._compositionView.style.height=p+"px",this._compositionView.style.lineHeight=p+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const y=this._compositionView.getBoundingClientRect();this._textarea.style.left=f+"px",this._textarea.style.top=u+"px",this._textarea.style.width=Math.max(y.width,1)+"px",this._textarea.style.height=Math.max(y.height,1)+"px",this._textarea.style.lineHeight=y.height+"px"}g||setTimeout(()=>this.updateCompositionElements(!0),0)}}};e.CompositionHelper=v=r([a(2,h.IBufferService),a(3,h.IOptionsService),a(4,h.ICoreService),a(5,o.IRenderService)],v)},9806:(n,e)=>{function t(r,a,o){const h=o.getBoundingClientRect(),_=r.getComputedStyle(o),v=parseInt(_.getPropertyValue("padding-left")),g=parseInt(_.getPropertyValue("padding-top"));return[a.clientX-h.left-v,a.clientY-h.top-g]}Object.defineProperty(e,"__esModule",{value:!0}),e.getCoords=e.getCoordsRelativeToElement=void 0,e.getCoordsRelativeToElement=t,e.getCoords=function(r,a,o,h,_,v,g,l,p){if(!v)return;const u=t(r,a,o);return u?(u[0]=Math.ceil((u[0]+(p?g/2:0))/g),u[1]=Math.ceil(u[1]/l),u[0]=Math.min(Math.max(u[0],1),h+(p?1:0)),u[1]=Math.min(Math.max(u[1],1),_),u):void 0}},9504:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.moveToCellSequence=void 0;const r=t(2584);function a(l,p,u,f){const y=l-o(l,u),b=p-o(p,u),A=Math.abs(y-b)-function(R,C,L){let O=0;const N=R-o(R,L),I=C-o(C,L);for(let P=0;P<Math.abs(N-I);P++){const V=h(R,C)==="A"?-1:1,G=L.buffer.lines.get(N+V*P);G!=null&&G.isWrapped&&O++}return O}(l,p,u);return g(A,v(h(l,p),f))}function o(l,p){let u=0,f=p.buffer.lines.get(l),y=f==null?void 0:f.isWrapped;for(;y&&l>=0&&l<p.rows;)u++,f=p.buffer.lines.get(--l),y=f==null?void 0:f.isWrapped;return u}function h(l,p){return l>p?"A":"B"}function _(l,p,u,f,y,b){let A=l,R=p,C="";for(;A!==u||R!==f;)A+=y?1:-1,y&&A>b.cols-1?(C+=b.buffer.translateBufferLineToString(R,!1,l,A),A=0,l=0,R++):!y&&A<0&&(C+=b.buffer.translateBufferLineToString(R,!1,0,l+1),A=b.cols-1,l=A,R--);return C+b.buffer.translateBufferLineToString(R,!1,l,A)}function v(l,p){const u=p?"O":"[";return r.C0.ESC+u+l}function g(l,p){l=Math.floor(l);let u="";for(let f=0;f<l;f++)u+=p;return u}e.moveToCellSequence=function(l,p,u,f){const y=u.buffer.x,b=u.buffer.y;if(!u.buffer.hasScrollback)return function(C,L,O,N,I,P){return a(L,N,I,P).length===0?"":g(_(C,L,C,L-o(L,I),!1,I).length,v("D",P))}(y,b,0,p,u,f)+a(b,p,u,f)+function(C,L,O,N,I,P){let V;V=a(L,N,I,P).length>0?N-o(N,I):L;const G=N,re=function(J,x,U,F,z,D){let Z;return Z=a(U,F,z,D).length>0?F-o(F,z):x,J<U&&Z<=F||J>=U&&Z<F?"C":"D"}(C,L,O,N,I,P);return g(_(C,V,O,G,re==="C",I).length,v(re,P))}(y,b,l,p,u,f);let A;if(b===p)return A=y>l?"D":"C",g(Math.abs(y-l),v(A,f));A=b>p?"D":"C";const R=Math.abs(b-p);return g(function(C,L){return L.cols-C}(b>p?l:y,u)+(R-1)*u.cols+1+((b>p?y:l)-1),v(A,f))}},1296:function(n,e,t){var r=this&&this.__decorate||function(I,P,V,G){var re,J=arguments.length,x=J<3?P:G===null?G=Object.getOwnPropertyDescriptor(P,V):G;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(I,P,V,G);else for(var U=I.length-1;U>=0;U--)(re=I[U])&&(x=(J<3?re(x):J>3?re(P,V,x):re(P,V))||x);return J>3&&x&&Object.defineProperty(P,V,x),x},a=this&&this.__param||function(I,P){return function(V,G){P(V,G,I)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRenderer=void 0;const o=t(3787),h=t(2550),_=t(2223),v=t(6171),g=t(4725),l=t(8055),p=t(8460),u=t(844),f=t(2585),y="xterm-dom-renderer-owner-",b="xterm-rows",A="xterm-fg-",R="xterm-bg-",C="xterm-focus",L="xterm-selection";let O=1,N=e.DomRenderer=class extends u.Disposable{constructor(I,P,V,G,re,J,x,U,F,z){super(),this._element=I,this._screenElement=P,this._viewportElement=V,this._linkifier2=G,this._charSizeService=J,this._optionsService=x,this._bufferService=U,this._coreBrowserService=F,this._themeService=z,this._terminalClass=O++,this._rowElements=[],this.onRequestRedraw=this.register(new p.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(b),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(L),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,v.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(D=>this._injectCss(D))),this._injectCss(this._themeService.colors),this._rowFactory=re.createInstance(o.DomRendererRowFactory,document),this._element.classList.add(y+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(D=>this._handleLinkHover(D))),this.register(this._linkifier2.onHideLinkUnderline(D=>this._handleLinkLeave(D))),this.register((0,u.toDisposable)(()=>{this._element.classList.remove(y+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new h.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const I=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*I,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*I),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/I),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/I),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const V of this._rowElements)V.style.width=`${this.dimensions.css.canvas.width}px`,V.style.height=`${this.dimensions.css.cell.height}px`,V.style.lineHeight=`${this.dimensions.css.cell.height}px`,V.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const P=`${this._terminalSelector} .${b} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=P,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(I){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let P=`${this._terminalSelector} .${b} { color: ${I.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;P+=`${this._terminalSelector} .${b} .xterm-dim { color: ${l.color.multiplyOpacity(I.foreground,.5).css};}`,P+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,P+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",P+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${I.cursor.css};  color: ${I.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${I.cursor.css}; }}`,P+=`${this._terminalSelector} .${b}.${C} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${b}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-block { background-color: ${I.cursor.css}; color: ${I.cursorAccent.css};}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${I.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${I.cursor.css} inset;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${I.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,P+=`${this._terminalSelector} .${L} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${L} div { position: absolute; background-color: ${I.selectionBackgroundOpaque.css};}${this._terminalSelector} .${L} div { position: absolute; background-color: ${I.selectionInactiveBackgroundOpaque.css};}`;for(const[V,G]of I.ansi.entries())P+=`${this._terminalSelector} .${A}${V} { color: ${G.css}; }${this._terminalSelector} .${A}${V}.xterm-dim { color: ${l.color.multiplyOpacity(G,.5).css}; }${this._terminalSelector} .${R}${V} { background-color: ${G.css}; }`;P+=`${this._terminalSelector} .${A}${_.INVERTED_DEFAULT_COLOR} { color: ${l.color.opaque(I.background).css}; }${this._terminalSelector} .${A}${_.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${l.color.multiplyOpacity(l.color.opaque(I.background),.5).css}; }${this._terminalSelector} .${R}${_.INVERTED_DEFAULT_COLOR} { background-color: ${I.foreground.css}; }`,this._themeStyleElement.textContent=P}_setDefaultSpacing(){const I=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${I}px`,this._rowFactory.defaultSpacing=I}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(I,P){for(let V=this._rowElements.length;V<=P;V++){const G=document.createElement("div");this._rowContainer.appendChild(G),this._rowElements.push(G)}for(;this._rowElements.length>P;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(I,P){this._refreshRowElements(I,P),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(C)}handleFocus(){this._rowContainer.classList.add(C),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(I,P,V){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(I,P,V),this.renderRows(0,this._bufferService.rows-1),!I||!P)return;const G=I[1]-this._bufferService.buffer.ydisp,re=P[1]-this._bufferService.buffer.ydisp,J=Math.max(G,0),x=Math.min(re,this._bufferService.rows-1);if(J>=this._bufferService.rows||x<0)return;const U=document.createDocumentFragment();if(V){const F=I[0]>P[0];U.appendChild(this._createSelectionElement(J,F?P[0]:I[0],F?I[0]:P[0],x-J+1))}else{const F=G===J?I[0]:0,z=J===re?P[0]:this._bufferService.cols;U.appendChild(this._createSelectionElement(J,F,z));const D=x-J-1;if(U.appendChild(this._createSelectionElement(J+1,0,this._bufferService.cols,D)),J!==x){const Z=re===x?P[0]:this._bufferService.cols;U.appendChild(this._createSelectionElement(x,0,Z))}}this._selectionContainer.appendChild(U)}_createSelectionElement(I,P,V,G=1){const re=document.createElement("div");return re.style.height=G*this.dimensions.css.cell.height+"px",re.style.top=I*this.dimensions.css.cell.height+"px",re.style.left=P*this.dimensions.css.cell.width+"px",re.style.width=this.dimensions.css.cell.width*(V-P)+"px",re}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const I of this._rowElements)I.replaceChildren()}renderRows(I,P){const V=this._bufferService.buffer,G=V.ybase+V.y,re=Math.min(V.x,this._bufferService.cols-1),J=this._optionsService.rawOptions.cursorBlink,x=this._optionsService.rawOptions.cursorStyle,U=this._optionsService.rawOptions.cursorInactiveStyle;for(let F=I;F<=P;F++){const z=F+V.ydisp,D=this._rowElements[F],Z=V.lines.get(z);if(!D||!Z)break;D.replaceChildren(...this._rowFactory.createRow(Z,z,z===G,x,U,re,J,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${y}${this._terminalClass}`}_handleLinkHover(I){this._setCellUnderline(I.x1,I.x2,I.y1,I.y2,I.cols,!0)}_handleLinkLeave(I){this._setCellUnderline(I.x1,I.x2,I.y1,I.y2,I.cols,!1)}_setCellUnderline(I,P,V,G,re,J){V<0&&(I=0),G<0&&(P=0);const x=this._bufferService.rows-1;V=Math.max(Math.min(V,x),0),G=Math.max(Math.min(G,x),0),re=Math.min(re,this._bufferService.cols);const U=this._bufferService.buffer,F=U.ybase+U.y,z=Math.min(U.x,re-1),D=this._optionsService.rawOptions.cursorBlink,Z=this._optionsService.rawOptions.cursorStyle,se=this._optionsService.rawOptions.cursorInactiveStyle;for(let he=V;he<=G;++he){const ce=he+U.ydisp,T=this._rowElements[he],B=U.lines.get(ce);if(!T||!B)break;T.replaceChildren(...this._rowFactory.createRow(B,ce,ce===F,Z,se,z,D,this.dimensions.css.cell.width,this._widthCache,J?he===V?I:0:-1,J?(he===G?P:re)-1:-1))}}};e.DomRenderer=N=r([a(4,f.IInstantiationService),a(5,g.ICharSizeService),a(6,f.IOptionsService),a(7,f.IBufferService),a(8,g.ICoreBrowserService),a(9,g.IThemeService)],N)},3787:function(n,e,t){var r=this&&this.__decorate||function(A,R,C,L){var O,N=arguments.length,I=N<3?R:L===null?L=Object.getOwnPropertyDescriptor(R,C):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(A,R,C,L);else for(var P=A.length-1;P>=0;P--)(O=A[P])&&(I=(N<3?O(I):N>3?O(R,C,I):O(R,C))||I);return N>3&&I&&Object.defineProperty(R,C,I),I},a=this&&this.__param||function(A,R){return function(C,L){R(C,L,A)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomRendererRowFactory=void 0;const o=t(2223),h=t(643),_=t(511),v=t(2585),g=t(8055),l=t(4725),p=t(4269),u=t(6171),f=t(3734);let y=e.DomRendererRowFactory=class{constructor(A,R,C,L,O,N,I){this._document=A,this._characterJoinerService=R,this._optionsService=C,this._coreBrowserService=L,this._coreService=O,this._decorationService=N,this._themeService=I,this._workCell=new _.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(A,R,C){this._selectionStart=A,this._selectionEnd=R,this._columnSelectMode=C}createRow(A,R,C,L,O,N,I,P,V,G,re){const J=[],x=this._characterJoinerService.getJoinedCharacters(R),U=this._themeService.colors;let F,z=A.getNoBgTrimmedLength();C&&z<N+1&&(z=N+1);let D=0,Z="",se=0,he=0,ce=0,T=!1,B=0,q=!1,X=0;const ie=[],te=G!==-1&&re!==-1;for(let le=0;le<z;le++){A.loadCell(le,this._workCell);let ue=this._workCell.getWidth();if(ue===0)continue;let W=!1,ee=le,Y=this._workCell;if(x.length>0&&le===x[0][0]){W=!0;const H=x.shift();Y=new p.JoinedCellData(this._workCell,A.translateToString(!0,H[0],H[1]),H[1]-H[0]),ee=H[1]-1,ue=Y.getWidth()}const de=this._isCellInSelection(le,R),ae=C&&le===N,Q=te&&le>=G&&le<=re;let oe=!1;this._decorationService.forEachDecorationAtCell(le,R,void 0,H=>{oe=!0});let be=Y.getChars()||h.WHITESPACE_CELL_CHAR;if(be===" "&&(Y.isUnderline()||Y.isOverline())&&(be=" "),X=ue*P-V.get(be,Y.isBold(),Y.isItalic()),F){if(D&&(de&&q||!de&&!q&&Y.bg===se)&&(de&&q&&U.selectionForeground||Y.fg===he)&&Y.extended.ext===ce&&Q===T&&X===B&&!ae&&!W&&!oe){Z+=be,D++;continue}D&&(F.textContent=Z),F=this._document.createElement("span"),D=0,Z=""}else F=this._document.createElement("span");if(se=Y.bg,he=Y.fg,ce=Y.extended.ext,T=Q,B=X,q=de,W&&N>=le&&N<=ee&&(N=le),!this._coreService.isCursorHidden&&ae){if(ie.push("xterm-cursor"),this._coreBrowserService.isFocused)I&&ie.push("xterm-cursor-blink"),ie.push(L==="bar"?"xterm-cursor-bar":L==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(O)switch(O){case"outline":ie.push("xterm-cursor-outline");break;case"block":ie.push("xterm-cursor-block");break;case"bar":ie.push("xterm-cursor-bar");break;case"underline":ie.push("xterm-cursor-underline")}}if(Y.isBold()&&ie.push("xterm-bold"),Y.isItalic()&&ie.push("xterm-italic"),Y.isDim()&&ie.push("xterm-dim"),Z=Y.isInvisible()?h.WHITESPACE_CELL_CHAR:Y.getChars()||h.WHITESPACE_CELL_CHAR,Y.isUnderline()&&(ie.push(`xterm-underline-${Y.extended.underlineStyle}`),Z===" "&&(Z=" "),!Y.isUnderlineColorDefault()))if(Y.isUnderlineColorRGB())F.style.textDecorationColor=`rgb(${f.AttributeData.toColorRGB(Y.getUnderlineColor()).join(",")})`;else{let H=Y.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Y.isBold()&&H<8&&(H+=8),F.style.textDecorationColor=U.ansi[H].css}Y.isOverline()&&(ie.push("xterm-overline"),Z===" "&&(Z=" ")),Y.isStrikethrough()&&ie.push("xterm-strikethrough"),Q&&(F.style.textDecoration="underline");let Se=Y.getFgColor(),Ee=Y.getFgColorMode(),Te=Y.getBgColor(),E=Y.getBgColorMode();const S=!!Y.isInverse();if(S){const H=Se;Se=Te,Te=H;const ne=Ee;Ee=E,E=ne}let k,j,$,M=!1;switch(this._decorationService.forEachDecorationAtCell(le,R,void 0,H=>{H.options.layer!=="top"&&M||(H.backgroundColorRGB&&(E=50331648,Te=H.backgroundColorRGB.rgba>>8&16777215,k=H.backgroundColorRGB),H.foregroundColorRGB&&(Ee=50331648,Se=H.foregroundColorRGB.rgba>>8&16777215,j=H.foregroundColorRGB),M=H.options.layer==="top")}),!M&&de&&(k=this._coreBrowserService.isFocused?U.selectionBackgroundOpaque:U.selectionInactiveBackgroundOpaque,Te=k.rgba>>8&16777215,E=50331648,M=!0,U.selectionForeground&&(Ee=50331648,Se=U.selectionForeground.rgba>>8&16777215,j=U.selectionForeground)),M&&ie.push("xterm-decoration-top"),E){case 16777216:case 33554432:$=U.ansi[Te],ie.push(`xterm-bg-${Te}`);break;case 50331648:$=g.rgba.toColor(Te>>16,Te>>8&255,255&Te),this._addStyle(F,`background-color:#${b((Te>>>0).toString(16),"0",6)}`);break;default:S?($=U.foreground,ie.push(`xterm-bg-${o.INVERTED_DEFAULT_COLOR}`)):$=U.background}switch(k||Y.isDim()&&(k=g.color.multiplyOpacity($,.5)),Ee){case 16777216:case 33554432:Y.isBold()&&Se<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(Se+=8),this._applyMinimumContrast(F,$,U.ansi[Se],Y,k,void 0)||ie.push(`xterm-fg-${Se}`);break;case 50331648:const H=g.rgba.toColor(Se>>16&255,Se>>8&255,255&Se);this._applyMinimumContrast(F,$,H,Y,k,j)||this._addStyle(F,`color:#${b(Se.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(F,$,U.foreground,Y,k,void 0)||S&&ie.push(`xterm-fg-${o.INVERTED_DEFAULT_COLOR}`)}ie.length&&(F.className=ie.join(" "),ie.length=0),ae||W||oe?F.textContent=Z:D++,X!==this.defaultSpacing&&(F.style.letterSpacing=`${X}px`),J.push(F),le=ee}return F&&D&&(F.textContent=Z),J}_applyMinimumContrast(A,R,C,L,O,N){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,u.excludeFromContrastRatioDemands)(L.getCode()))return!1;const I=this._getContrastCache(L);let P;if(O||N||(P=I.getColor(R.rgba,C.rgba)),P===void 0){const V=this._optionsService.rawOptions.minimumContrastRatio/(L.isDim()?2:1);P=g.color.ensureContrastRatio(O||R,N||C,V),I.setColor((O||R).rgba,(N||C).rgba,P??null)}return!!P&&(this._addStyle(A,`color:${P.css}`),!0)}_getContrastCache(A){return A.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(A,R){A.setAttribute("style",`${A.getAttribute("style")||""}${R};`)}_isCellInSelection(A,R){const C=this._selectionStart,L=this._selectionEnd;return!(!C||!L)&&(this._columnSelectMode?C[0]<=L[0]?A>=C[0]&&R>=C[1]&&A<L[0]&&R<=L[1]:A<C[0]&&R>=C[1]&&A>=L[0]&&R<=L[1]:R>C[1]&&R<L[1]||C[1]===L[1]&&R===C[1]&&A>=C[0]&&A<L[0]||C[1]<L[1]&&R===L[1]&&A<L[0]||C[1]<L[1]&&R===C[1]&&A>=C[0])}};function b(A,R,C){for(;A.length<C;)A=R+A;return A}e.DomRendererRowFactory=y=r([a(1,l.ICharacterJoinerService),a(2,v.IOptionsService),a(3,l.ICoreBrowserService),a(4,v.ICoreService),a(5,v.IDecorationService),a(6,l.IThemeService)],y)},2550:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WidthCache=void 0,e.WidthCache=class{constructor(t){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=t.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const r=t.createElement("span"),a=t.createElement("span");a.style.fontWeight="bold";const o=t.createElement("span");o.style.fontStyle="italic";const h=t.createElement("span");h.style.fontWeight="bold",h.style.fontStyle="italic",this._measureElements=[r,a,o,h],this._container.appendChild(r),this._container.appendChild(a),this._container.appendChild(o),this._container.appendChild(h),t.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(t,r,a,o){t===this._font&&r===this._fontSize&&a===this._weight&&o===this._weightBold||(this._font=t,this._fontSize=r,this._weight=a,this._weightBold=o,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${a}`,this._measureElements[1].style.fontWeight=`${o}`,this._measureElements[2].style.fontWeight=`${a}`,this._measureElements[3].style.fontWeight=`${o}`,this.clear())}get(t,r,a){let o=0;if(!r&&!a&&t.length===1&&(o=t.charCodeAt(0))<256)return this._flat[o]!==-9999?this._flat[o]:this._flat[o]=this._measure(t,0);let h=t;r&&(h+="B"),a&&(h+="I");let _=this._holey.get(h);if(_===void 0){let v=0;r&&(v|=1),a&&(v|=2),_=this._measure(t,v),this._holey.set(h,_)}return _}_measure(t,r){const a=this._measureElements[r];return a.textContent=t.repeat(32),a.offsetWidth/32}}},2223:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TEXT_BASELINE=e.DIM_OPACITY=e.INVERTED_DEFAULT_COLOR=void 0;const r=t(6114);e.INVERTED_DEFAULT_COLOR=257,e.DIM_OPACITY=.5,e.TEXT_BASELINE=r.isFirefox||r.isLegacyEdge?"bottom":"ideographic"},6171:(n,e)=>{function t(r){return 57508<=r&&r<=57558}Object.defineProperty(e,"__esModule",{value:!0}),e.createRenderDimensions=e.excludeFromContrastRatioDemands=e.isRestrictedPowerlineGlyph=e.isPowerlineGlyph=e.throwIfFalsy=void 0,e.throwIfFalsy=function(r){if(!r)throw new Error("value must not be falsy");return r},e.isPowerlineGlyph=t,e.isRestrictedPowerlineGlyph=function(r){return 57520<=r&&r<=57527},e.excludeFromContrastRatioDemands=function(r){return t(r)||function(a){return 9472<=a&&a<=9631}(r)},e.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionModel=void 0,e.SelectionModel=class{constructor(t){this._bufferService=t,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?t%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)-1]:[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[t,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[Math.max(t,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const t=this.selectionStart,r=this.selectionEnd;return!(!t||!r)&&(t[1]>r[1]||t[1]===r[1]&&t[0]>r[0])}handleTrim(t){return this.selectionStart&&(this.selectionStart[1]-=t),this.selectionEnd&&(this.selectionEnd[1]-=t),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(n,e,t){var r=this&&this.__decorate||function(l,p,u,f){var y,b=arguments.length,A=b<3?p:f===null?f=Object.getOwnPropertyDescriptor(p,u):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(l,p,u,f);else for(var R=l.length-1;R>=0;R--)(y=l[R])&&(A=(b<3?y(A):b>3?y(p,u,A):y(p,u))||A);return b>3&&A&&Object.defineProperty(p,u,A),A},a=this&&this.__param||function(l,p){return function(u,f){p(u,f,l)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharSizeService=void 0;const o=t(2585),h=t(8460),_=t(844);let v=e.CharSizeService=class extends _.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(l,p,u){super(),this._optionsService=u,this.width=0,this.height=0,this._onCharSizeChange=this.register(new h.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new g(l,p,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const l=this._measureStrategy.measure();l.width===this.width&&l.height===this.height||(this.width=l.width,this.height=l.height,this._onCharSizeChange.fire())}};e.CharSizeService=v=r([a(2,o.IOptionsService)],v);class g{constructor(p,u,f){this._document=p,this._parentElement=u,this._optionsService=f,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const p={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return p.width!==0&&p.height!==0&&(this._result.width=p.width/32,this._result.height=Math.ceil(p.height)),this._result}}},4269:function(n,e,t){var r=this&&this.__decorate||function(p,u,f,y){var b,A=arguments.length,R=A<3?u:y===null?y=Object.getOwnPropertyDescriptor(u,f):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(p,u,f,y);else for(var C=p.length-1;C>=0;C--)(b=p[C])&&(R=(A<3?b(R):A>3?b(u,f,R):b(u,f))||R);return A>3&&R&&Object.defineProperty(u,f,R),R},a=this&&this.__param||function(p,u){return function(f,y){u(f,y,p)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CharacterJoinerService=e.JoinedCellData=void 0;const o=t(3734),h=t(643),_=t(511),v=t(2585);class g extends o.AttributeData{constructor(u,f,y){super(),this.content=0,this.combinedData="",this.fg=u.fg,this.bg=u.bg,this.combinedData=f,this._width=y}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(u){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.JoinedCellData=g;let l=e.CharacterJoinerService=class wa{constructor(u){this._bufferService=u,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new _.CellData}register(u){const f={id:this._nextCharacterJoinerId++,handler:u};return this._characterJoiners.push(f),f.id}deregister(u){for(let f=0;f<this._characterJoiners.length;f++)if(this._characterJoiners[f].id===u)return this._characterJoiners.splice(f,1),!0;return!1}getJoinedCharacters(u){if(this._characterJoiners.length===0)return[];const f=this._bufferService.buffer.lines.get(u);if(!f||f.length===0)return[];const y=[],b=f.translateToString(!0);let A=0,R=0,C=0,L=f.getFg(0),O=f.getBg(0);for(let N=0;N<f.getTrimmedLength();N++)if(f.loadCell(N,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==L||this._workCell.bg!==O){if(N-A>1){const I=this._getJoinedRanges(b,C,R,f,A);for(let P=0;P<I.length;P++)y.push(I[P])}A=N,C=R,L=this._workCell.fg,O=this._workCell.bg}R+=this._workCell.getChars().length||h.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-A>1){const N=this._getJoinedRanges(b,C,R,f,A);for(let I=0;I<N.length;I++)y.push(N[I])}return y}_getJoinedRanges(u,f,y,b,A){const R=u.substring(f,y);let C=[];try{C=this._characterJoiners[0].handler(R)}catch(L){console.error(L)}for(let L=1;L<this._characterJoiners.length;L++)try{const O=this._characterJoiners[L].handler(R);for(let N=0;N<O.length;N++)wa._mergeRanges(C,O[N])}catch(O){console.error(O)}return this._stringRangesToCellRanges(C,b,A),C}_stringRangesToCellRanges(u,f,y){let b=0,A=!1,R=0,C=u[b];if(C){for(let L=y;L<this._bufferService.cols;L++){const O=f.getWidth(L),N=f.getString(L).length||h.WHITESPACE_CELL_CHAR.length;if(O!==0){if(!A&&C[0]<=R&&(C[0]=L,A=!0),C[1]<=R){if(C[1]=L,C=u[++b],!C)break;C[0]<=R?(C[0]=L,A=!0):A=!1}R+=N}}C&&(C[1]=this._bufferService.cols)}}static _mergeRanges(u,f){let y=!1;for(let b=0;b<u.length;b++){const A=u[b];if(y){if(f[1]<=A[0])return u[b-1][1]=f[1],u;if(f[1]<=A[1])return u[b-1][1]=Math.max(f[1],A[1]),u.splice(b,1),u;u.splice(b,1),b--}else{if(f[1]<=A[0])return u.splice(b,0,f),u;if(f[1]<=A[1])return A[0]=Math.min(f[0],A[0]),u;f[0]<A[1]&&(A[0]=Math.min(f[0],A[0]),y=!0)}}return y?u[u.length-1][1]=f[1]:u.push(f),u}};e.CharacterJoinerService=l=r([a(0,v.IBufferService)],l)},5114:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreBrowserService=void 0,e.CoreBrowserService=class{constructor(t,r){this._textarea=t,this.window=r,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(n,e,t){var r=this&&this.__decorate||function(v,g,l,p){var u,f=arguments.length,y=f<3?g:p===null?p=Object.getOwnPropertyDescriptor(g,l):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(v,g,l,p);else for(var b=v.length-1;b>=0;b--)(u=v[b])&&(y=(f<3?u(y):f>3?u(g,l,y):u(g,l))||y);return f>3&&y&&Object.defineProperty(g,l,y),y},a=this&&this.__param||function(v,g){return function(l,p){g(l,p,v)}};Object.defineProperty(e,"__esModule",{value:!0}),e.MouseService=void 0;const o=t(4725),h=t(9806);let _=e.MouseService=class{constructor(v,g){this._renderService=v,this._charSizeService=g}getCoords(v,g,l,p,u){return(0,h.getCoords)(window,v,g,l,p,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,u)}getMouseReportCoords(v,g){const l=(0,h.getCoordsRelativeToElement)(window,v,g);if(this._charSizeService.hasValidSize)return l[0]=Math.min(Math.max(l[0],0),this._renderService.dimensions.css.canvas.width-1),l[1]=Math.min(Math.max(l[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(l[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(l[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(l[0]),y:Math.floor(l[1])}}};e.MouseService=_=r([a(0,o.IRenderService),a(1,o.ICharSizeService)],_)},3230:function(n,e,t){var r=this&&this.__decorate||function(y,b,A,R){var C,L=arguments.length,O=L<3?b:R===null?R=Object.getOwnPropertyDescriptor(b,A):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,b,A,R);else for(var N=y.length-1;N>=0;N--)(C=y[N])&&(O=(L<3?C(O):L>3?C(b,A,O):C(b,A))||O);return L>3&&O&&Object.defineProperty(b,A,O),O},a=this&&this.__param||function(y,b){return function(A,R){b(A,R,y)}};Object.defineProperty(e,"__esModule",{value:!0}),e.RenderService=void 0;const o=t(3656),h=t(6193),_=t(5596),v=t(4725),g=t(8460),l=t(844),p=t(7226),u=t(2585);let f=e.RenderService=class extends l.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(y,b,A,R,C,L,O,N){if(super(),this._rowCount=y,this._charSizeService=R,this._renderer=this.register(new l.MutableDisposable),this._pausedResizeTask=new p.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new g.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new g.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new g.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new g.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new h.RenderDebouncer(O.window,(I,P)=>this._renderRows(I,P)),this.register(this._renderDebouncer),this._screenDprMonitor=new _.ScreenDprMonitor(O.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(L.onResize(()=>this._fullRefresh())),this.register(L.buffers.onBufferActivate(()=>{var I;return(I=this._renderer.value)===null||I===void 0?void 0:I.clear()})),this.register(A.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(C.onDecorationRegistered(()=>this._fullRefresh())),this.register(C.onDecorationRemoved(()=>this._fullRefresh())),this.register(A.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(L.cols,L.rows),this._fullRefresh()})),this.register(A.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(L.buffer.y,L.buffer.y,!0))),this.register((0,o.addDisposableDomListener)(O.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(N.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in O.window){const I=new O.window.IntersectionObserver(P=>this._handleIntersectionChange(P[P.length-1]),{threshold:0});I.observe(b),this.register({dispose:()=>I.disconnect()})}}_handleIntersectionChange(y){this._isPaused=y.isIntersecting===void 0?y.intersectionRatio===0:!y.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(y,b,A=!1){this._isPaused?this._needsFullRefresh=!0:(A||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(y,b,this._rowCount))}_renderRows(y,b){this._renderer.value&&(y=Math.min(y,this._rowCount-1),b=Math.min(b,this._rowCount-1),this._renderer.value.renderRows(y,b),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:y,end:b}),this._onRender.fire({start:y,end:b}),this._isNextRenderRedrawOnly=!0)}resize(y,b){this._rowCount=b,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(y){this._renderer.value=y,this._renderer.value.onRequestRedraw(b=>this.refreshRows(b.start,b.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(y){return this._renderDebouncer.addRefreshCallback(y)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var y,b;this._renderer.value&&((b=(y=this._renderer.value).clearTextureAtlas)===null||b===void 0||b.call(y),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(y,b){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(y,b)):this._renderer.value.handleResize(y,b),this._fullRefresh())}handleCharSizeChanged(){var y;(y=this._renderer.value)===null||y===void 0||y.handleCharSizeChanged()}handleBlur(){var y;(y=this._renderer.value)===null||y===void 0||y.handleBlur()}handleFocus(){var y;(y=this._renderer.value)===null||y===void 0||y.handleFocus()}handleSelectionChanged(y,b,A){var R;this._selectionState.start=y,this._selectionState.end=b,this._selectionState.columnSelectMode=A,(R=this._renderer.value)===null||R===void 0||R.handleSelectionChanged(y,b,A)}handleCursorMove(){var y;(y=this._renderer.value)===null||y===void 0||y.handleCursorMove()}clear(){var y;(y=this._renderer.value)===null||y===void 0||y.clear()}};e.RenderService=f=r([a(2,u.IOptionsService),a(3,v.ICharSizeService),a(4,u.IDecorationService),a(5,u.IBufferService),a(6,v.ICoreBrowserService),a(7,v.IThemeService)],f)},9312:function(n,e,t){var r=this&&this.__decorate||function(C,L,O,N){var I,P=arguments.length,V=P<3?L:N===null?N=Object.getOwnPropertyDescriptor(L,O):N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")V=Reflect.decorate(C,L,O,N);else for(var G=C.length-1;G>=0;G--)(I=C[G])&&(V=(P<3?I(V):P>3?I(L,O,V):I(L,O))||V);return P>3&&V&&Object.defineProperty(L,O,V),V},a=this&&this.__param||function(C,L){return function(O,N){L(O,N,C)}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionService=void 0;const o=t(9806),h=t(9504),_=t(456),v=t(4725),g=t(8460),l=t(844),p=t(6114),u=t(4841),f=t(511),y=t(2585),b=String.fromCharCode(160),A=new RegExp(b,"g");let R=e.SelectionService=class extends l.Disposable{constructor(C,L,O,N,I,P,V,G,re){super(),this._element=C,this._screenElement=L,this._linkifier=O,this._bufferService=N,this._coreService=I,this._mouseService=P,this._optionsService=V,this._renderService=G,this._coreBrowserService=re,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new f.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new g.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new g.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new g.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new g.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=J=>this._handleMouseMove(J),this._mouseUpListener=J=>this._handleMouseUp(J),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(J=>this._handleTrim(J)),this.register(this._bufferService.buffers.onBufferActivate(J=>this._handleBufferActivate(J))),this.enable(),this._model=new _.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,l.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const C=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;return!(!C||!L||C[0]===L[0]&&C[1]===L[1])}get selectionText(){const C=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;if(!C||!L)return"";const O=this._bufferService.buffer,N=[];if(this._activeSelectionMode===3){if(C[0]===L[0])return"";const I=C[0]<L[0]?C[0]:L[0],P=C[0]<L[0]?L[0]:C[0];for(let V=C[1];V<=L[1];V++){const G=O.translateBufferLineToString(V,!0,I,P);N.push(G)}}else{const I=C[1]===L[1]?L[0]:void 0;N.push(O.translateBufferLineToString(C[1],!0,C[0],I));for(let P=C[1]+1;P<=L[1]-1;P++){const V=O.lines.get(P),G=O.translateBufferLineToString(P,!0);V!=null&&V.isWrapped?N[N.length-1]+=G:N.push(G)}if(C[1]!==L[1]){const P=O.lines.get(L[1]),V=O.translateBufferLineToString(L[1],!0,0,L[0]);P&&P.isWrapped?N[N.length-1]+=V:N.push(V)}}return N.map(I=>I.replace(A," ")).join(p.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(C){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),p.isLinux&&C&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(C){const L=this._getMouseBufferCoords(C),O=this._model.finalSelectionStart,N=this._model.finalSelectionEnd;return!!(O&&N&&L)&&this._areCoordsInSelection(L,O,N)}isCellInSelection(C,L){const O=this._model.finalSelectionStart,N=this._model.finalSelectionEnd;return!(!O||!N)&&this._areCoordsInSelection([C,L],O,N)}_areCoordsInSelection(C,L,O){return C[1]>L[1]&&C[1]<O[1]||L[1]===O[1]&&C[1]===L[1]&&C[0]>=L[0]&&C[0]<O[0]||L[1]<O[1]&&C[1]===O[1]&&C[0]<O[0]||L[1]<O[1]&&C[1]===L[1]&&C[0]>=L[0]}_selectWordAtCursor(C,L){var O,N;const I=(N=(O=this._linkifier.currentLink)===null||O===void 0?void 0:O.link)===null||N===void 0?void 0:N.range;if(I)return this._model.selectionStart=[I.start.x-1,I.start.y-1],this._model.selectionStartLength=(0,u.getRangeLength)(I,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const P=this._getMouseBufferCoords(C);return!!P&&(this._selectWordAt(P,L),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(C,L){this._model.clearSelection(),C=Math.max(C,0),L=Math.min(L,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,C],this._model.selectionEnd=[this._bufferService.cols,L],this.refresh(),this._onSelectionChange.fire()}_handleTrim(C){this._model.handleTrim(C)&&this.refresh()}_getMouseBufferCoords(C){const L=this._mouseService.getCoords(C,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(L)return L[0]--,L[1]--,L[1]+=this._bufferService.buffer.ydisp,L}_getMouseEventScrollAmount(C){let L=(0,o.getCoordsRelativeToElement)(this._coreBrowserService.window,C,this._screenElement)[1];const O=this._renderService.dimensions.css.canvas.height;return L>=0&&L<=O?0:(L>O&&(L-=O),L=Math.min(Math.max(L,-50),50),L/=50,L/Math.abs(L)+Math.round(14*L))}shouldForceSelection(C){return p.isMac?C.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:C.shiftKey}handleMouseDown(C){if(this._mouseDownTimeStamp=C.timeStamp,(C.button!==2||!this.hasSelection)&&C.button===0){if(!this._enabled){if(!this.shouldForceSelection(C))return;C.stopPropagation()}C.preventDefault(),this._dragScrollAmount=0,this._enabled&&C.shiftKey?this._handleIncrementalClick(C):C.detail===1?this._handleSingleClick(C):C.detail===2?this._handleDoubleClick(C):C.detail===3&&this._handleTripleClick(C),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(C){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(C))}_handleSingleClick(C){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(C)?3:0,this._model.selectionStart=this._getMouseBufferCoords(C),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const L=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);L&&L.length!==this._model.selectionStart[0]&&L.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(C){this._selectWordAtCursor(C,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(C){const L=this._getMouseBufferCoords(C);L&&(this._activeSelectionMode=2,this._selectLineAt(L[1]))}shouldColumnSelect(C){return C.altKey&&!(p.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(C){if(C.stopImmediatePropagation(),!this._model.selectionStart)return;const L=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(C),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(C),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const O=this._bufferService.buffer;if(this._model.selectionEnd[1]<O.lines.length){const N=O.lines.get(this._model.selectionEnd[1]);N&&N.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}L&&L[0]===this._model.selectionEnd[0]&&L[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const C=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(C.ydisp+this._bufferService.rows,C.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=C.ydisp),this.refresh()}}_handleMouseUp(C){const L=C.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&L<500&&C.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const O=this._mouseService.getCoords(C,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(O&&O[0]!==void 0&&O[1]!==void 0){const N=(0,h.moveToCellSequence)(O[0]-1,O[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(N,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const C=this._model.finalSelectionStart,L=this._model.finalSelectionEnd,O=!(!C||!L||C[0]===L[0]&&C[1]===L[1]);O?C&&L&&(this._oldSelectionStart&&this._oldSelectionEnd&&C[0]===this._oldSelectionStart[0]&&C[1]===this._oldSelectionStart[1]&&L[0]===this._oldSelectionEnd[0]&&L[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(C,L,O)):this._oldHasSelection&&this._fireOnSelectionChange(C,L,O)}_fireOnSelectionChange(C,L,O){this._oldSelectionStart=C,this._oldSelectionEnd=L,this._oldHasSelection=O,this._onSelectionChange.fire()}_handleBufferActivate(C){this.clearSelection(),this._trimListener.dispose(),this._trimListener=C.activeBuffer.lines.onTrim(L=>this._handleTrim(L))}_convertViewportColToCharacterIndex(C,L){let O=L;for(let N=0;L>=N;N++){const I=C.loadCell(N,this._workCell).getChars().length;this._workCell.getWidth()===0?O--:I>1&&L!==N&&(O+=I-1)}return O}setSelection(C,L,O){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[C,L],this._model.selectionStartLength=O,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(C){this._isClickInSelection(C)||(this._selectWordAtCursor(C,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(C,L,O=!0,N=!0){if(C[0]>=this._bufferService.cols)return;const I=this._bufferService.buffer,P=I.lines.get(C[1]);if(!P)return;const V=I.translateBufferLineToString(C[1],!1);let G=this._convertViewportColToCharacterIndex(P,C[0]),re=G;const J=C[0]-G;let x=0,U=0,F=0,z=0;if(V.charAt(G)===" "){for(;G>0&&V.charAt(G-1)===" ";)G--;for(;re<V.length&&V.charAt(re+1)===" ";)re++}else{let se=C[0],he=C[0];P.getWidth(se)===0&&(x++,se--),P.getWidth(he)===2&&(U++,he++);const ce=P.getString(he).length;for(ce>1&&(z+=ce-1,re+=ce-1);se>0&&G>0&&!this._isCharWordSeparator(P.loadCell(se-1,this._workCell));){P.loadCell(se-1,this._workCell);const T=this._workCell.getChars().length;this._workCell.getWidth()===0?(x++,se--):T>1&&(F+=T-1,G-=T-1),G--,se--}for(;he<P.length&&re+1<V.length&&!this._isCharWordSeparator(P.loadCell(he+1,this._workCell));){P.loadCell(he+1,this._workCell);const T=this._workCell.getChars().length;this._workCell.getWidth()===2?(U++,he++):T>1&&(z+=T-1,re+=T-1),re++,he++}}re++;let D=G+J-x+F,Z=Math.min(this._bufferService.cols,re-G+x+U-F-z);if(L||V.slice(G,re).trim()!==""){if(O&&D===0&&P.getCodePoint(0)!==32){const se=I.lines.get(C[1]-1);if(se&&P.isWrapped&&se.getCodePoint(this._bufferService.cols-1)!==32){const he=this._getWordAt([this._bufferService.cols-1,C[1]-1],!1,!0,!1);if(he){const ce=this._bufferService.cols-he.start;D-=ce,Z+=ce}}}if(N&&D+Z===this._bufferService.cols&&P.getCodePoint(this._bufferService.cols-1)!==32){const se=I.lines.get(C[1]+1);if(se!=null&&se.isWrapped&&se.getCodePoint(0)!==32){const he=this._getWordAt([0,C[1]+1],!1,!1,!0);he&&(Z+=he.length)}}return{start:D,length:Z}}}_selectWordAt(C,L){const O=this._getWordAt(C,L);if(O){for(;O.start<0;)O.start+=this._bufferService.cols,C[1]--;this._model.selectionStart=[O.start,C[1]],this._model.selectionStartLength=O.length}}_selectToWordAt(C){const L=this._getWordAt(C,!0);if(L){let O=C[1];for(;L.start<0;)L.start+=this._bufferService.cols,O--;if(!this._model.areSelectionValuesReversed())for(;L.start+L.length>this._bufferService.cols;)L.length-=this._bufferService.cols,O++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?L.start:L.start+L.length,O]}}_isCharWordSeparator(C){return C.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(C.getChars())>=0}_selectLineAt(C){const L=this._bufferService.buffer.getWrappedRangeForLine(C),O={start:{x:0,y:L.first},end:{x:this._bufferService.cols-1,y:L.last}};this._model.selectionStart=[0,L.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,u.getRangeLength)(O,this._bufferService.cols)}};e.SelectionService=R=r([a(3,y.IBufferService),a(4,y.ICoreService),a(5,v.IMouseService),a(6,y.IOptionsService),a(7,v.IRenderService),a(8,v.ICoreBrowserService)],R)},4725:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IThemeService=e.ICharacterJoinerService=e.ISelectionService=e.IRenderService=e.IMouseService=e.ICoreBrowserService=e.ICharSizeService=void 0;const r=t(8343);e.ICharSizeService=(0,r.createDecorator)("CharSizeService"),e.ICoreBrowserService=(0,r.createDecorator)("CoreBrowserService"),e.IMouseService=(0,r.createDecorator)("MouseService"),e.IRenderService=(0,r.createDecorator)("RenderService"),e.ISelectionService=(0,r.createDecorator)("SelectionService"),e.ICharacterJoinerService=(0,r.createDecorator)("CharacterJoinerService"),e.IThemeService=(0,r.createDecorator)("ThemeService")},6731:function(n,e,t){var r=this&&this.__decorate||function(R,C,L,O){var N,I=arguments.length,P=I<3?C:O===null?O=Object.getOwnPropertyDescriptor(C,L):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(R,C,L,O);else for(var V=R.length-1;V>=0;V--)(N=R[V])&&(P=(I<3?N(P):I>3?N(C,L,P):N(C,L))||P);return I>3&&P&&Object.defineProperty(C,L,P),P},a=this&&this.__param||function(R,C){return function(L,O){C(L,O,R)}};Object.defineProperty(e,"__esModule",{value:!0}),e.ThemeService=e.DEFAULT_ANSI_COLORS=void 0;const o=t(7239),h=t(8055),_=t(8460),v=t(844),g=t(2585),l=h.css.toColor("#ffffff"),p=h.css.toColor("#000000"),u=h.css.toColor("#ffffff"),f=h.css.toColor("#000000"),y={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};e.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const R=[h.css.toColor("#2e3436"),h.css.toColor("#cc0000"),h.css.toColor("#4e9a06"),h.css.toColor("#c4a000"),h.css.toColor("#3465a4"),h.css.toColor("#75507b"),h.css.toColor("#06989a"),h.css.toColor("#d3d7cf"),h.css.toColor("#555753"),h.css.toColor("#ef2929"),h.css.toColor("#8ae234"),h.css.toColor("#fce94f"),h.css.toColor("#729fcf"),h.css.toColor("#ad7fa8"),h.css.toColor("#34e2e2"),h.css.toColor("#eeeeec")],C=[0,95,135,175,215,255];for(let L=0;L<216;L++){const O=C[L/36%6|0],N=C[L/6%6|0],I=C[L%6];R.push({css:h.channels.toCss(O,N,I),rgba:h.channels.toRgba(O,N,I)})}for(let L=0;L<24;L++){const O=8+10*L;R.push({css:h.channels.toCss(O,O,O),rgba:h.channels.toRgba(O,O,O)})}return R})());let b=e.ThemeService=class extends v.Disposable{get colors(){return this._colors}constructor(R){super(),this._optionsService=R,this._contrastCache=new o.ColorContrastCache,this._halfContrastCache=new o.ColorContrastCache,this._onChangeColors=this.register(new _.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:l,background:p,cursor:u,cursorAccent:f,selectionForeground:void 0,selectionBackgroundTransparent:y,selectionBackgroundOpaque:h.color.blend(p,y),selectionInactiveBackgroundTransparent:y,selectionInactiveBackgroundOpaque:h.color.blend(p,y),ansi:e.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(R={}){const C=this._colors;if(C.foreground=A(R.foreground,l),C.background=A(R.background,p),C.cursor=A(R.cursor,u),C.cursorAccent=A(R.cursorAccent,f),C.selectionBackgroundTransparent=A(R.selectionBackground,y),C.selectionBackgroundOpaque=h.color.blend(C.background,C.selectionBackgroundTransparent),C.selectionInactiveBackgroundTransparent=A(R.selectionInactiveBackground,C.selectionBackgroundTransparent),C.selectionInactiveBackgroundOpaque=h.color.blend(C.background,C.selectionInactiveBackgroundTransparent),C.selectionForeground=R.selectionForeground?A(R.selectionForeground,h.NULL_COLOR):void 0,C.selectionForeground===h.NULL_COLOR&&(C.selectionForeground=void 0),h.color.isOpaque(C.selectionBackgroundTransparent)&&(C.selectionBackgroundTransparent=h.color.opacity(C.selectionBackgroundTransparent,.3)),h.color.isOpaque(C.selectionInactiveBackgroundTransparent)&&(C.selectionInactiveBackgroundTransparent=h.color.opacity(C.selectionInactiveBackgroundTransparent,.3)),C.ansi=e.DEFAULT_ANSI_COLORS.slice(),C.ansi[0]=A(R.black,e.DEFAULT_ANSI_COLORS[0]),C.ansi[1]=A(R.red,e.DEFAULT_ANSI_COLORS[1]),C.ansi[2]=A(R.green,e.DEFAULT_ANSI_COLORS[2]),C.ansi[3]=A(R.yellow,e.DEFAULT_ANSI_COLORS[3]),C.ansi[4]=A(R.blue,e.DEFAULT_ANSI_COLORS[4]),C.ansi[5]=A(R.magenta,e.DEFAULT_ANSI_COLORS[5]),C.ansi[6]=A(R.cyan,e.DEFAULT_ANSI_COLORS[6]),C.ansi[7]=A(R.white,e.DEFAULT_ANSI_COLORS[7]),C.ansi[8]=A(R.brightBlack,e.DEFAULT_ANSI_COLORS[8]),C.ansi[9]=A(R.brightRed,e.DEFAULT_ANSI_COLORS[9]),C.ansi[10]=A(R.brightGreen,e.DEFAULT_ANSI_COLORS[10]),C.ansi[11]=A(R.brightYellow,e.DEFAULT_ANSI_COLORS[11]),C.ansi[12]=A(R.brightBlue,e.DEFAULT_ANSI_COLORS[12]),C.ansi[13]=A(R.brightMagenta,e.DEFAULT_ANSI_COLORS[13]),C.ansi[14]=A(R.brightCyan,e.DEFAULT_ANSI_COLORS[14]),C.ansi[15]=A(R.brightWhite,e.DEFAULT_ANSI_COLORS[15]),R.extendedAnsi){const L=Math.min(C.ansi.length-16,R.extendedAnsi.length);for(let O=0;O<L;O++)C.ansi[O+16]=A(R.extendedAnsi[O],e.DEFAULT_ANSI_COLORS[O+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(R){this._restoreColor(R),this._onChangeColors.fire(this.colors)}_restoreColor(R){if(R!==void 0)switch(R){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[R]=this._restoreColors.ansi[R]}else for(let C=0;C<this._restoreColors.ansi.length;++C)this._colors.ansi[C]=this._restoreColors.ansi[C]}modifyColors(R){R(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function A(R,C){if(R!==void 0)try{return h.css.toColor(R)}catch{}return C}e.ThemeService=b=r([a(0,g.IOptionsService)],b)},6349:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CircularList=void 0;const r=t(8460),a=t(844);class o extends a.Disposable{constructor(_){super(),this._maxLength=_,this.onDeleteEmitter=this.register(new r.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new r.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new r.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(_){if(this._maxLength===_)return;const v=new Array(_);for(let g=0;g<Math.min(_,this.length);g++)v[g]=this._array[this._getCyclicIndex(g)];this._array=v,this._maxLength=_,this._startIndex=0}get length(){return this._length}set length(_){if(_>this._length)for(let v=this._length;v<_;v++)this._array[v]=void 0;this._length=_}get(_){return this._array[this._getCyclicIndex(_)]}set(_,v){this._array[this._getCyclicIndex(_)]=v}push(_){this._array[this._getCyclicIndex(this._length)]=_,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(_,v,...g){if(v){for(let l=_;l<this._length-v;l++)this._array[this._getCyclicIndex(l)]=this._array[this._getCyclicIndex(l+v)];this._length-=v,this.onDeleteEmitter.fire({index:_,amount:v})}for(let l=this._length-1;l>=_;l--)this._array[this._getCyclicIndex(l+g.length)]=this._array[this._getCyclicIndex(l)];for(let l=0;l<g.length;l++)this._array[this._getCyclicIndex(_+l)]=g[l];if(g.length&&this.onInsertEmitter.fire({index:_,amount:g.length}),this._length+g.length>this._maxLength){const l=this._length+g.length-this._maxLength;this._startIndex+=l,this._length=this._maxLength,this.onTrimEmitter.fire(l)}else this._length+=g.length}trimStart(_){_>this._length&&(_=this._length),this._startIndex+=_,this._length-=_,this.onTrimEmitter.fire(_)}shiftElements(_,v,g){if(!(v<=0)){if(_<0||_>=this._length)throw new Error("start argument out of range");if(_+g<0)throw new Error("Cannot shift elements in list beyond index 0");if(g>0){for(let p=v-1;p>=0;p--)this.set(_+p+g,this.get(_+p));const l=_+v+g-this._length;if(l>0)for(this._length+=l;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let l=0;l<v;l++)this.set(_+l+g,this.get(_+l))}}_getCyclicIndex(_){return(this._startIndex+_)%this._maxLength}}e.CircularList=o},1439:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.clone=void 0,e.clone=function t(r,a=5){if(typeof r!="object")return r;const o=Array.isArray(r)?[]:{};for(const h in r)o[h]=a<=1?r[h]:r[h]&&t(r[h],a-1);return o}},8055:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.contrastRatio=e.toPaddedHex=e.rgba=e.rgb=e.css=e.color=e.channels=e.NULL_COLOR=void 0;const r=t(6114);let a=0,o=0,h=0,_=0;var v,g,l,p,u;function f(b){const A=b.toString(16);return A.length<2?"0"+A:A}function y(b,A){return b<A?(A+.05)/(b+.05):(b+.05)/(A+.05)}e.NULL_COLOR={css:"#00000000",rgba:0},function(b){b.toCss=function(A,R,C,L){return L!==void 0?`#${f(A)}${f(R)}${f(C)}${f(L)}`:`#${f(A)}${f(R)}${f(C)}`},b.toRgba=function(A,R,C,L=255){return(A<<24|R<<16|C<<8|L)>>>0}}(v||(e.channels=v={})),function(b){function A(R,C){return _=Math.round(255*C),[a,o,h]=u.toChannels(R.rgba),{css:v.toCss(a,o,h,_),rgba:v.toRgba(a,o,h,_)}}b.blend=function(R,C){if(_=(255&C.rgba)/255,_===1)return{css:C.css,rgba:C.rgba};const L=C.rgba>>24&255,O=C.rgba>>16&255,N=C.rgba>>8&255,I=R.rgba>>24&255,P=R.rgba>>16&255,V=R.rgba>>8&255;return a=I+Math.round((L-I)*_),o=P+Math.round((O-P)*_),h=V+Math.round((N-V)*_),{css:v.toCss(a,o,h),rgba:v.toRgba(a,o,h)}},b.isOpaque=function(R){return(255&R.rgba)==255},b.ensureContrastRatio=function(R,C,L){const O=u.ensureContrastRatio(R.rgba,C.rgba,L);if(O)return u.toColor(O>>24&255,O>>16&255,O>>8&255)},b.opaque=function(R){const C=(255|R.rgba)>>>0;return[a,o,h]=u.toChannels(C),{css:v.toCss(a,o,h),rgba:C}},b.opacity=A,b.multiplyOpacity=function(R,C){return _=255&R.rgba,A(R,_*C/255)},b.toColorRGB=function(R){return[R.rgba>>24&255,R.rgba>>16&255,R.rgba>>8&255]}}(g||(e.color=g={})),function(b){let A,R;if(!r.isNode){const C=document.createElement("canvas");C.width=1,C.height=1;const L=C.getContext("2d",{willReadFrequently:!0});L&&(A=L,A.globalCompositeOperation="copy",R=A.createLinearGradient(0,0,1,1))}b.toColor=function(C){if(C.match(/#[\da-f]{3,8}/i))switch(C.length){case 4:return a=parseInt(C.slice(1,2).repeat(2),16),o=parseInt(C.slice(2,3).repeat(2),16),h=parseInt(C.slice(3,4).repeat(2),16),u.toColor(a,o,h);case 5:return a=parseInt(C.slice(1,2).repeat(2),16),o=parseInt(C.slice(2,3).repeat(2),16),h=parseInt(C.slice(3,4).repeat(2),16),_=parseInt(C.slice(4,5).repeat(2),16),u.toColor(a,o,h,_);case 7:return{css:C,rgba:(parseInt(C.slice(1),16)<<8|255)>>>0};case 9:return{css:C,rgba:parseInt(C.slice(1),16)>>>0}}const L=C.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(L)return a=parseInt(L[1]),o=parseInt(L[2]),h=parseInt(L[3]),_=Math.round(255*(L[5]===void 0?1:parseFloat(L[5]))),u.toColor(a,o,h,_);if(!A||!R)throw new Error("css.toColor: Unsupported css format");if(A.fillStyle=R,A.fillStyle=C,typeof A.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(A.fillRect(0,0,1,1),[a,o,h,_]=A.getImageData(0,0,1,1).data,_!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:v.toRgba(a,o,h,_),css:C}}}(l||(e.css=l={})),function(b){function A(R,C,L){const O=R/255,N=C/255,I=L/255;return .2126*(O<=.03928?O/12.92:Math.pow((O+.055)/1.055,2.4))+.7152*(N<=.03928?N/12.92:Math.pow((N+.055)/1.055,2.4))+.0722*(I<=.03928?I/12.92:Math.pow((I+.055)/1.055,2.4))}b.relativeLuminance=function(R){return A(R>>16&255,R>>8&255,255&R)},b.relativeLuminance2=A}(p||(e.rgb=p={})),function(b){function A(C,L,O){const N=C>>24&255,I=C>>16&255,P=C>>8&255;let V=L>>24&255,G=L>>16&255,re=L>>8&255,J=y(p.relativeLuminance2(V,G,re),p.relativeLuminance2(N,I,P));for(;J<O&&(V>0||G>0||re>0);)V-=Math.max(0,Math.ceil(.1*V)),G-=Math.max(0,Math.ceil(.1*G)),re-=Math.max(0,Math.ceil(.1*re)),J=y(p.relativeLuminance2(V,G,re),p.relativeLuminance2(N,I,P));return(V<<24|G<<16|re<<8|255)>>>0}function R(C,L,O){const N=C>>24&255,I=C>>16&255,P=C>>8&255;let V=L>>24&255,G=L>>16&255,re=L>>8&255,J=y(p.relativeLuminance2(V,G,re),p.relativeLuminance2(N,I,P));for(;J<O&&(V<255||G<255||re<255);)V=Math.min(255,V+Math.ceil(.1*(255-V))),G=Math.min(255,G+Math.ceil(.1*(255-G))),re=Math.min(255,re+Math.ceil(.1*(255-re))),J=y(p.relativeLuminance2(V,G,re),p.relativeLuminance2(N,I,P));return(V<<24|G<<16|re<<8|255)>>>0}b.ensureContrastRatio=function(C,L,O){const N=p.relativeLuminance(C>>8),I=p.relativeLuminance(L>>8);if(y(N,I)<O){if(I<N){const G=A(C,L,O),re=y(N,p.relativeLuminance(G>>8));if(re<O){const J=R(C,L,O);return re>y(N,p.relativeLuminance(J>>8))?G:J}return G}const P=R(C,L,O),V=y(N,p.relativeLuminance(P>>8));if(V<O){const G=A(C,L,O);return V>y(N,p.relativeLuminance(G>>8))?P:G}return P}},b.reduceLuminance=A,b.increaseLuminance=R,b.toChannels=function(C){return[C>>24&255,C>>16&255,C>>8&255,255&C]},b.toColor=function(C,L,O,N){return{css:v.toCss(C,L,O,N),rgba:v.toRgba(C,L,O,N)}}}(u||(e.rgba=u={})),e.toPaddedHex=f,e.contrastRatio=y},8969:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoreTerminal=void 0;const r=t(844),a=t(2585),o=t(4348),h=t(7866),_=t(744),v=t(7302),g=t(6975),l=t(8460),p=t(1753),u=t(1480),f=t(7994),y=t(9282),b=t(5435),A=t(5981),R=t(2660);let C=!1;class L extends r.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new l.EventEmitter),this._onScroll.event(N=>{var I;(I=this._onScrollApi)===null||I===void 0||I.fire(N.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(N){for(const I in N)this.optionsService.options[I]=N[I]}constructor(N){super(),this._windowsWrappingHeuristics=this.register(new r.MutableDisposable),this._onBinary=this.register(new l.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new l.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new l.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new l.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new l.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new l.EventEmitter),this._instantiationService=new o.InstantiationService,this.optionsService=this.register(new v.OptionsService(N)),this._instantiationService.setService(a.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(_.BufferService)),this._instantiationService.setService(a.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(h.LogService)),this._instantiationService.setService(a.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(g.CoreService)),this._instantiationService.setService(a.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(p.CoreMouseService)),this._instantiationService.setService(a.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(u.UnicodeService)),this._instantiationService.setService(a.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(f.CharsetService),this._instantiationService.setService(a.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(R.OscLinkService),this._instantiationService.setService(a.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new b.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,l.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,l.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,l.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,l.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(I=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(I=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new A.WriteBuffer((I,P)=>this._inputHandler.parse(I,P))),this.register((0,l.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(N,I){this._writeBuffer.write(N,I)}writeSync(N,I){this._logService.logLevel<=a.LogLevelEnum.WARN&&!C&&(this._logService.warn("writeSync is unreliable and will be removed soon."),C=!0),this._writeBuffer.writeSync(N,I)}resize(N,I){isNaN(N)||isNaN(I)||(N=Math.max(N,_.MINIMUM_COLS),I=Math.max(I,_.MINIMUM_ROWS),this._bufferService.resize(N,I))}scroll(N,I=!1){this._bufferService.scroll(N,I)}scrollLines(N,I,P){this._bufferService.scrollLines(N,I,P)}scrollPages(N){this.scrollLines(N*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(N){const I=N-this._bufferService.buffer.ydisp;I!==0&&this.scrollLines(I)}registerEscHandler(N,I){return this._inputHandler.registerEscHandler(N,I)}registerDcsHandler(N,I){return this._inputHandler.registerDcsHandler(N,I)}registerCsiHandler(N,I){return this._inputHandler.registerCsiHandler(N,I)}registerOscHandler(N,I){return this._inputHandler.registerOscHandler(N,I)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let N=!1;const I=this.optionsService.rawOptions.windowsPty;I&&I.buildNumber!==void 0&&I.buildNumber!==void 0?N=I.backend==="conpty"&&I.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(N=!0),N?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const N=[];N.push(this.onLineFeed(y.updateWindowsModeWrappedState.bind(null,this._bufferService))),N.push(this.registerCsiHandler({final:"H"},()=>((0,y.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,r.toDisposable)(()=>{for(const I of N)I.dispose()})}}}e.CoreTerminal=L},8460:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=t=>(this._listeners.push(t),{dispose:()=>{if(!this._disposed){for(let r=0;r<this._listeners.length;r++)if(this._listeners[r]===t)return void this._listeners.splice(r,1)}}})),this._event}fire(t,r){const a=[];for(let o=0;o<this._listeners.length;o++)a.push(this._listeners[o]);for(let o=0;o<a.length;o++)a[o].call(void 0,t,r)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},e.forwardEvent=function(t,r){return t(a=>r.fire(a))}},5435:function(n,e,t){var r=this&&this.__decorate||function(J,x,U,F){var z,D=arguments.length,Z=D<3?x:F===null?F=Object.getOwnPropertyDescriptor(x,U):F;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Z=Reflect.decorate(J,x,U,F);else for(var se=J.length-1;se>=0;se--)(z=J[se])&&(Z=(D<3?z(Z):D>3?z(x,U,Z):z(x,U))||Z);return D>3&&Z&&Object.defineProperty(x,U,Z),Z},a=this&&this.__param||function(J,x){return function(U,F){x(U,F,J)}};Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=e.WindowsOptionsReportType=void 0;const o=t(2584),h=t(7116),_=t(2015),v=t(844),g=t(482),l=t(8437),p=t(8460),u=t(643),f=t(511),y=t(3734),b=t(2585),A=t(6242),R=t(6351),C=t(5941),L={"(":0,")":1,"*":2,"+":3,"-":1,".":2},O=131072;function N(J,x){if(J>24)return x.setWinLines||!1;switch(J){case 1:return!!x.restoreWin;case 2:return!!x.minimizeWin;case 3:return!!x.setWinPosition;case 4:return!!x.setWinSizePixels;case 5:return!!x.raiseWin;case 6:return!!x.lowerWin;case 7:return!!x.refreshWin;case 8:return!!x.setWinSizeChars;case 9:return!!x.maximizeWin;case 10:return!!x.fullscreenWin;case 11:return!!x.getWinState;case 13:return!!x.getWinPosition;case 14:return!!x.getWinSizePixels;case 15:return!!x.getScreenSizePixels;case 16:return!!x.getCellSizePixels;case 18:return!!x.getWinSizeChars;case 19:return!!x.getScreenSizeChars;case 20:return!!x.getIconTitle;case 21:return!!x.getWinTitle;case 22:return!!x.pushTitle;case 23:return!!x.popTitle;case 24:return!!x.setWinLines}return!1}var I;(function(J){J[J.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",J[J.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(I||(e.WindowsOptionsReportType=I={}));let P=0;class V extends v.Disposable{getAttrData(){return this._curAttrData}constructor(x,U,F,z,D,Z,se,he,ce=new _.EscapeSequenceParser){super(),this._bufferService=x,this._charsetService=U,this._coreService=F,this._logService=z,this._optionsService=D,this._oscLinkService=Z,this._coreMouseService=se,this._unicodeService=he,this._parser=ce,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new g.StringToUtf32,this._utf8Decoder=new g.Utf8ToUtf32,this._workCell=new f.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=l.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=l.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new p.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new p.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new p.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new p.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new p.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new p.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new p.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new p.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new p.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new p.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new p.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new p.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new p.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new G(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(T=>this._activeBuffer=T.activeBuffer)),this._parser.setCsiHandlerFallback((T,B)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(T),params:B.toArray()})}),this._parser.setEscHandlerFallback(T=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(T)})}),this._parser.setExecuteHandlerFallback(T=>{this._logService.debug("Unknown EXECUTE code: ",{code:T})}),this._parser.setOscHandlerFallback((T,B,q)=>{this._logService.debug("Unknown OSC code: ",{identifier:T,action:B,data:q})}),this._parser.setDcsHandlerFallback((T,B,q)=>{B==="HOOK"&&(q=q.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(T),action:B,payload:q})}),this._parser.setPrintHandler((T,B,q)=>this.print(T,B,q)),this._parser.registerCsiHandler({final:"@"},T=>this.insertChars(T)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},T=>this.scrollLeft(T)),this._parser.registerCsiHandler({final:"A"},T=>this.cursorUp(T)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},T=>this.scrollRight(T)),this._parser.registerCsiHandler({final:"B"},T=>this.cursorDown(T)),this._parser.registerCsiHandler({final:"C"},T=>this.cursorForward(T)),this._parser.registerCsiHandler({final:"D"},T=>this.cursorBackward(T)),this._parser.registerCsiHandler({final:"E"},T=>this.cursorNextLine(T)),this._parser.registerCsiHandler({final:"F"},T=>this.cursorPrecedingLine(T)),this._parser.registerCsiHandler({final:"G"},T=>this.cursorCharAbsolute(T)),this._parser.registerCsiHandler({final:"H"},T=>this.cursorPosition(T)),this._parser.registerCsiHandler({final:"I"},T=>this.cursorForwardTab(T)),this._parser.registerCsiHandler({final:"J"},T=>this.eraseInDisplay(T,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},T=>this.eraseInDisplay(T,!0)),this._parser.registerCsiHandler({final:"K"},T=>this.eraseInLine(T,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},T=>this.eraseInLine(T,!0)),this._parser.registerCsiHandler({final:"L"},T=>this.insertLines(T)),this._parser.registerCsiHandler({final:"M"},T=>this.deleteLines(T)),this._parser.registerCsiHandler({final:"P"},T=>this.deleteChars(T)),this._parser.registerCsiHandler({final:"S"},T=>this.scrollUp(T)),this._parser.registerCsiHandler({final:"T"},T=>this.scrollDown(T)),this._parser.registerCsiHandler({final:"X"},T=>this.eraseChars(T)),this._parser.registerCsiHandler({final:"Z"},T=>this.cursorBackwardTab(T)),this._parser.registerCsiHandler({final:"`"},T=>this.charPosAbsolute(T)),this._parser.registerCsiHandler({final:"a"},T=>this.hPositionRelative(T)),this._parser.registerCsiHandler({final:"b"},T=>this.repeatPrecedingCharacter(T)),this._parser.registerCsiHandler({final:"c"},T=>this.sendDeviceAttributesPrimary(T)),this._parser.registerCsiHandler({prefix:">",final:"c"},T=>this.sendDeviceAttributesSecondary(T)),this._parser.registerCsiHandler({final:"d"},T=>this.linePosAbsolute(T)),this._parser.registerCsiHandler({final:"e"},T=>this.vPositionRelative(T)),this._parser.registerCsiHandler({final:"f"},T=>this.hVPosition(T)),this._parser.registerCsiHandler({final:"g"},T=>this.tabClear(T)),this._parser.registerCsiHandler({final:"h"},T=>this.setMode(T)),this._parser.registerCsiHandler({prefix:"?",final:"h"},T=>this.setModePrivate(T)),this._parser.registerCsiHandler({final:"l"},T=>this.resetMode(T)),this._parser.registerCsiHandler({prefix:"?",final:"l"},T=>this.resetModePrivate(T)),this._parser.registerCsiHandler({final:"m"},T=>this.charAttributes(T)),this._parser.registerCsiHandler({final:"n"},T=>this.deviceStatus(T)),this._parser.registerCsiHandler({prefix:"?",final:"n"},T=>this.deviceStatusPrivate(T)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},T=>this.softReset(T)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},T=>this.setCursorStyle(T)),this._parser.registerCsiHandler({final:"r"},T=>this.setScrollRegion(T)),this._parser.registerCsiHandler({final:"s"},T=>this.saveCursor(T)),this._parser.registerCsiHandler({final:"t"},T=>this.windowOptions(T)),this._parser.registerCsiHandler({final:"u"},T=>this.restoreCursor(T)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},T=>this.insertColumns(T)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},T=>this.deleteColumns(T)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},T=>this.selectProtected(T)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},T=>this.requestMode(T,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},T=>this.requestMode(T,!1)),this._parser.setExecuteHandler(o.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(o.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(o.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(o.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(o.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(o.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(o.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(o.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(o.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(o.C1.IND,()=>this.index()),this._parser.setExecuteHandler(o.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(o.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new A.OscHandler(T=>(this.setTitle(T),this.setIconName(T),!0))),this._parser.registerOscHandler(1,new A.OscHandler(T=>this.setIconName(T))),this._parser.registerOscHandler(2,new A.OscHandler(T=>this.setTitle(T))),this._parser.registerOscHandler(4,new A.OscHandler(T=>this.setOrReportIndexedColor(T))),this._parser.registerOscHandler(8,new A.OscHandler(T=>this.setHyperlink(T))),this._parser.registerOscHandler(10,new A.OscHandler(T=>this.setOrReportFgColor(T))),this._parser.registerOscHandler(11,new A.OscHandler(T=>this.setOrReportBgColor(T))),this._parser.registerOscHandler(12,new A.OscHandler(T=>this.setOrReportCursorColor(T))),this._parser.registerOscHandler(104,new A.OscHandler(T=>this.restoreIndexedColor(T))),this._parser.registerOscHandler(110,new A.OscHandler(T=>this.restoreFgColor(T))),this._parser.registerOscHandler(111,new A.OscHandler(T=>this.restoreBgColor(T))),this._parser.registerOscHandler(112,new A.OscHandler(T=>this.restoreCursorColor(T))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const T in h.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:T},()=>this.selectCharset("("+T)),this._parser.registerEscHandler({intermediates:")",final:T},()=>this.selectCharset(")"+T)),this._parser.registerEscHandler({intermediates:"*",final:T},()=>this.selectCharset("*"+T)),this._parser.registerEscHandler({intermediates:"+",final:T},()=>this.selectCharset("+"+T)),this._parser.registerEscHandler({intermediates:"-",final:T},()=>this.selectCharset("-"+T)),this._parser.registerEscHandler({intermediates:".",final:T},()=>this.selectCharset("."+T)),this._parser.registerEscHandler({intermediates:"/",final:T},()=>this.selectCharset("/"+T));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(T=>(this._logService.error("Parsing error: ",T),T)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new R.DcsHandler((T,B)=>this.requestStatusString(T,B)))}_preserveStack(x,U,F,z){this._parseStack.paused=!0,this._parseStack.cursorStartX=x,this._parseStack.cursorStartY=U,this._parseStack.decodedLength=F,this._parseStack.position=z}_logSlowResolvingAsync(x){this._logService.logLevel<=b.LogLevelEnum.WARN&&Promise.race([x,new Promise((U,F)=>setTimeout(()=>F("#SLOW_TIMEOUT"),5e3))]).catch(U=>{if(U!=="#SLOW_TIMEOUT")throw U;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(x,U){let F,z=this._activeBuffer.x,D=this._activeBuffer.y,Z=0;const se=this._parseStack.paused;if(se){if(F=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,U))return this._logSlowResolvingAsync(F),F;z=this._parseStack.cursorStartX,D=this._parseStack.cursorStartY,this._parseStack.paused=!1,x.length>O&&(Z=this._parseStack.position+O)}if(this._logService.logLevel<=b.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof x=="string"?` "${x}"`:` "${Array.prototype.map.call(x,he=>String.fromCharCode(he)).join("")}"`),typeof x=="string"?x.split("").map(he=>he.charCodeAt(0)):x),this._parseBuffer.length<x.length&&this._parseBuffer.length<O&&(this._parseBuffer=new Uint32Array(Math.min(x.length,O))),se||this._dirtyRowTracker.clearRange(),x.length>O)for(let he=Z;he<x.length;he+=O){const ce=he+O<x.length?he+O:x.length,T=typeof x=="string"?this._stringDecoder.decode(x.substring(he,ce),this._parseBuffer):this._utf8Decoder.decode(x.subarray(he,ce),this._parseBuffer);if(F=this._parser.parse(this._parseBuffer,T))return this._preserveStack(z,D,T,he),this._logSlowResolvingAsync(F),F}else if(!se){const he=typeof x=="string"?this._stringDecoder.decode(x,this._parseBuffer):this._utf8Decoder.decode(x,this._parseBuffer);if(F=this._parser.parse(this._parseBuffer,he))return this._preserveStack(z,D,he,0),this._logSlowResolvingAsync(F),F}this._activeBuffer.x===z&&this._activeBuffer.y===D||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(x,U,F){let z,D;const Z=this._charsetService.charset,se=this._optionsService.rawOptions.screenReaderMode,he=this._bufferService.cols,ce=this._coreService.decPrivateModes.wraparound,T=this._coreService.modes.insertMode,B=this._curAttrData;let q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&F-U>0&&q.getWidth(this._activeBuffer.x-1)===2&&q.setCellFromCodePoint(this._activeBuffer.x-1,0,1,B.fg,B.bg,B.extended);for(let X=U;X<F;++X){if(z=x[X],D=this._unicodeService.wcwidth(z),z<127&&Z){const ie=Z[String.fromCharCode(z)];ie&&(z=ie.charCodeAt(0))}if(se&&this._onA11yChar.fire((0,g.stringFromCodePoint)(z)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),D||!this._activeBuffer.x){if(this._activeBuffer.x+D-1>=he){if(ce){for(;this._activeBuffer.x<he;)q.setCellFromCodePoint(this._activeBuffer.x++,0,1,B.fg,B.bg,B.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=he-1,D===2)continue}if(T&&(q.insertCells(this._activeBuffer.x,D,this._activeBuffer.getNullCell(B),B),q.getWidth(he-1)===2&&q.setCellFromCodePoint(he-1,u.NULL_CELL_CODE,u.NULL_CELL_WIDTH,B.fg,B.bg,B.extended)),q.setCellFromCodePoint(this._activeBuffer.x++,z,D,B.fg,B.bg,B.extended),D>0)for(;--D;)q.setCellFromCodePoint(this._activeBuffer.x++,0,0,B.fg,B.bg,B.extended)}else q.getWidth(this._activeBuffer.x-1)?q.addCodepointToCell(this._activeBuffer.x-1,z):q.addCodepointToCell(this._activeBuffer.x-2,z)}F-U>0&&(q.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<he&&F-U>0&&q.getWidth(this._activeBuffer.x)===0&&!q.hasContent(this._activeBuffer.x)&&q.setCellFromCodePoint(this._activeBuffer.x,0,1,B.fg,B.bg,B.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(x,U){return x.final!=="t"||x.prefix||x.intermediates?this._parser.registerCsiHandler(x,U):this._parser.registerCsiHandler(x,F=>!N(F.params[0],this._optionsService.rawOptions.windowOptions)||U(F))}registerDcsHandler(x,U){return this._parser.registerDcsHandler(x,new R.DcsHandler(U))}registerEscHandler(x,U){return this._parser.registerEscHandler(x,U)}registerOscHandler(x,U){return this._parser.registerOscHandler(x,new A.OscHandler(U))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var x;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((x=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||x===void 0)&&x.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);U.hasWidth(this._activeBuffer.x)&&!U.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const x=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-x),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(x=this._bufferService.cols-1){this._activeBuffer.x=Math.min(x,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(x,U){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=x,this._activeBuffer.y=this._activeBuffer.scrollTop+U):(this._activeBuffer.x=x,this._activeBuffer.y=U),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(x,U){this._restrictCursor(),this._setCursor(this._activeBuffer.x+x,this._activeBuffer.y+U)}cursorUp(x){const U=this._activeBuffer.y-this._activeBuffer.scrollTop;return U>=0?this._moveCursor(0,-Math.min(U,x.params[0]||1)):this._moveCursor(0,-(x.params[0]||1)),!0}cursorDown(x){const U=this._activeBuffer.scrollBottom-this._activeBuffer.y;return U>=0?this._moveCursor(0,Math.min(U,x.params[0]||1)):this._moveCursor(0,x.params[0]||1),!0}cursorForward(x){return this._moveCursor(x.params[0]||1,0),!0}cursorBackward(x){return this._moveCursor(-(x.params[0]||1),0),!0}cursorNextLine(x){return this.cursorDown(x),this._activeBuffer.x=0,!0}cursorPrecedingLine(x){return this.cursorUp(x),this._activeBuffer.x=0,!0}cursorCharAbsolute(x){return this._setCursor((x.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(x){return this._setCursor(x.length>=2?(x.params[1]||1)-1:0,(x.params[0]||1)-1),!0}charPosAbsolute(x){return this._setCursor((x.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(x){return this._moveCursor(x.params[0]||1,0),!0}linePosAbsolute(x){return this._setCursor(this._activeBuffer.x,(x.params[0]||1)-1),!0}vPositionRelative(x){return this._moveCursor(0,x.params[0]||1),!0}hVPosition(x){return this.cursorPosition(x),!0}tabClear(x){const U=x.params[0];return U===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:U===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(x){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let U=x.params[0]||1;for(;U--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(x){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let U=x.params[0]||1;for(;U--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(x){const U=x.params[0];return U===1&&(this._curAttrData.bg|=536870912),U!==2&&U!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(x,U,F,z=!1,D=!1){const Z=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);Z.replaceCells(U,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),D),z&&(Z.isWrapped=!1)}_resetBufferLine(x,U=!1){const F=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);F&&(F.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),U),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+x),F.isWrapped=!1)}eraseInDisplay(x,U=!1){let F;switch(this._restrictCursor(this._bufferService.cols),x.params[0]){case 0:for(F=this._activeBuffer.y,this._dirtyRowTracker.markDirty(F),this._eraseInBufferLine(F++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,U);F<this._bufferService.rows;F++)this._resetBufferLine(F,U);this._dirtyRowTracker.markDirty(F);break;case 1:for(F=this._activeBuffer.y,this._dirtyRowTracker.markDirty(F),this._eraseInBufferLine(F,0,this._activeBuffer.x+1,!0,U),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(F+1).isWrapped=!1);F--;)this._resetBufferLine(F,U);this._dirtyRowTracker.markDirty(0);break;case 2:for(F=this._bufferService.rows,this._dirtyRowTracker.markDirty(F-1);F--;)this._resetBufferLine(F,U);this._dirtyRowTracker.markDirty(0);break;case 3:const z=this._activeBuffer.lines.length-this._bufferService.rows;z>0&&(this._activeBuffer.lines.trimStart(z),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-z,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-z,0),this._onScroll.fire(0))}return!0}eraseInLine(x,U=!1){switch(this._restrictCursor(this._bufferService.cols),x.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,U);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,U);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,U)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(x){this._restrictCursor();let U=x.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const F=this._activeBuffer.ybase+this._activeBuffer.y,z=this._bufferService.rows-1-this._activeBuffer.scrollBottom,D=this._bufferService.rows-1+this._activeBuffer.ybase-z+1;for(;U--;)this._activeBuffer.lines.splice(D-1,1),this._activeBuffer.lines.splice(F,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(x){this._restrictCursor();let U=x.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const F=this._activeBuffer.ybase+this._activeBuffer.y;let z;for(z=this._bufferService.rows-1-this._activeBuffer.scrollBottom,z=this._bufferService.rows-1+this._activeBuffer.ybase-z;U--;)this._activeBuffer.lines.splice(F,1),this._activeBuffer.lines.splice(z,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(x){this._restrictCursor();const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return U&&(U.insertCells(this._activeBuffer.x,x.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(x){this._restrictCursor();const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return U&&(U.deleteCells(this._activeBuffer.x,x.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(x){let U=x.params[0]||1;for(;U--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(x){let U=x.params[0]||1;for(;U--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(l.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const U=x.params[0]||1;for(let F=this._activeBuffer.scrollTop;F<=this._activeBuffer.scrollBottom;++F){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+F);z.deleteCells(0,U,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),z.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const U=x.params[0]||1;for(let F=this._activeBuffer.scrollTop;F<=this._activeBuffer.scrollBottom;++F){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+F);z.insertCells(0,U,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),z.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const U=x.params[0]||1;for(let F=this._activeBuffer.scrollTop;F<=this._activeBuffer.scrollBottom;++F){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+F);z.insertCells(this._activeBuffer.x,U,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),z.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const U=x.params[0]||1;for(let F=this._activeBuffer.scrollTop;F<=this._activeBuffer.scrollBottom;++F){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+F);z.deleteCells(this._activeBuffer.x,U,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),z.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(x){this._restrictCursor();const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return U&&(U.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(x.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(x){if(!this._parser.precedingCodepoint)return!0;const U=x.params[0]||1,F=new Uint32Array(U);for(let z=0;z<U;++z)F[z]=this._parser.precedingCodepoint;return this.print(F,0,F.length),!0}sendDeviceAttributesPrimary(x){return x.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(o.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(o.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(x){return x.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(o.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(o.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(x.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(o.C0.ESC+"[>83;40003;0c")),!0}_is(x){return(this._optionsService.rawOptions.termName+"").indexOf(x)===0}setMode(x){for(let U=0;U<x.length;U++)switch(x.params[U]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(x){for(let U=0;U<x.length;U++)switch(x.params[U]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),this._charsetService.setgCharset(1,h.DEFAULT_CHARSET),this._charsetService.setgCharset(2,h.DEFAULT_CHARSET),this._charsetService.setgCharset(3,h.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(x){for(let U=0;U<x.length;U++)switch(x.params[U]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(x){for(let U=0;U<x.length;U++)switch(x.params[U]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),x.params[U]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(x,U){const F=this._coreService.decPrivateModes,{activeProtocol:z,activeEncoding:D}=this._coreMouseService,Z=this._coreService,{buffers:se,cols:he}=this._bufferService,{active:ce,alt:T}=se,B=this._optionsService.rawOptions,q=le=>le?1:2,X=x.params[0];return ie=X,te=U?X===2?4:X===4?q(Z.modes.insertMode):X===12?3:X===20?q(B.convertEol):0:X===1?q(F.applicationCursorKeys):X===3?B.windowOptions.setWinLines?he===80?2:he===132?1:0:0:X===6?q(F.origin):X===7?q(F.wraparound):X===8?3:X===9?q(z==="X10"):X===12?q(B.cursorBlink):X===25?q(!Z.isCursorHidden):X===45?q(F.reverseWraparound):X===66?q(F.applicationKeypad):X===67?4:X===1e3?q(z==="VT200"):X===1002?q(z==="DRAG"):X===1003?q(z==="ANY"):X===1004?q(F.sendFocus):X===1005?4:X===1006?q(D==="SGR"):X===1015?4:X===1016?q(D==="SGR_PIXELS"):X===1048?1:X===47||X===1047||X===1049?q(ce===T):X===2004?q(F.bracketedPasteMode):0,Z.triggerDataEvent(`${o.C0.ESC}[${U?"":"?"}${ie};${te}$y`),!0;var ie,te}_updateAttrColor(x,U,F,z,D){return U===2?(x|=50331648,x&=-16777216,x|=y.AttributeData.fromColorRGB([F,z,D])):U===5&&(x&=-50331904,x|=33554432|255&F),x}_extractColor(x,U,F){const z=[0,0,-1,0,0,0];let D=0,Z=0;do{if(z[Z+D]=x.params[U+Z],x.hasSubParams(U+Z)){const se=x.getSubParams(U+Z);let he=0;do z[1]===5&&(D=1),z[Z+he+1+D]=se[he];while(++he<se.length&&he+Z+1+D<z.length);break}if(z[1]===5&&Z+D>=2||z[1]===2&&Z+D>=5)break;z[1]&&(D=1)}while(++Z+U<x.length&&Z+D<z.length);for(let se=2;se<z.length;++se)z[se]===-1&&(z[se]=0);switch(z[0]){case 38:F.fg=this._updateAttrColor(F.fg,z[1],z[3],z[4],z[5]);break;case 48:F.bg=this._updateAttrColor(F.bg,z[1],z[3],z[4],z[5]);break;case 58:F.extended=F.extended.clone(),F.extended.underlineColor=this._updateAttrColor(F.extended.underlineColor,z[1],z[3],z[4],z[5])}return Z}_processUnderline(x,U){U.extended=U.extended.clone(),(!~x||x>5)&&(x=1),U.extended.underlineStyle=x,U.fg|=268435456,x===0&&(U.fg&=-268435457),U.updateExtended()}_processSGR0(x){x.fg=l.DEFAULT_ATTR_DATA.fg,x.bg=l.DEFAULT_ATTR_DATA.bg,x.extended=x.extended.clone(),x.extended.underlineStyle=0,x.extended.underlineColor&=-67108864,x.updateExtended()}charAttributes(x){if(x.length===1&&x.params[0]===0)return this._processSGR0(this._curAttrData),!0;const U=x.length;let F;const z=this._curAttrData;for(let D=0;D<U;D++)F=x.params[D],F>=30&&F<=37?(z.fg&=-50331904,z.fg|=16777216|F-30):F>=40&&F<=47?(z.bg&=-50331904,z.bg|=16777216|F-40):F>=90&&F<=97?(z.fg&=-50331904,z.fg|=16777224|F-90):F>=100&&F<=107?(z.bg&=-50331904,z.bg|=16777224|F-100):F===0?this._processSGR0(z):F===1?z.fg|=134217728:F===3?z.bg|=67108864:F===4?(z.fg|=268435456,this._processUnderline(x.hasSubParams(D)?x.getSubParams(D)[0]:1,z)):F===5?z.fg|=536870912:F===7?z.fg|=67108864:F===8?z.fg|=1073741824:F===9?z.fg|=2147483648:F===2?z.bg|=134217728:F===21?this._processUnderline(2,z):F===22?(z.fg&=-134217729,z.bg&=-134217729):F===23?z.bg&=-67108865:F===24?(z.fg&=-268435457,this._processUnderline(0,z)):F===25?z.fg&=-536870913:F===27?z.fg&=-67108865:F===28?z.fg&=-1073741825:F===29?z.fg&=2147483647:F===39?(z.fg&=-67108864,z.fg|=16777215&l.DEFAULT_ATTR_DATA.fg):F===49?(z.bg&=-67108864,z.bg|=16777215&l.DEFAULT_ATTR_DATA.bg):F===38||F===48||F===58?D+=this._extractColor(x,D,z):F===53?z.bg|=1073741824:F===55?z.bg&=-1073741825:F===59?(z.extended=z.extended.clone(),z.extended.underlineColor=-1,z.updateExtended()):F===100?(z.fg&=-67108864,z.fg|=16777215&l.DEFAULT_ATTR_DATA.fg,z.bg&=-67108864,z.bg|=16777215&l.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",F);return!0}deviceStatus(x){switch(x.params[0]){case 5:this._coreService.triggerDataEvent(`${o.C0.ESC}[0n`);break;case 6:const U=this._activeBuffer.y+1,F=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${o.C0.ESC}[${U};${F}R`)}return!0}deviceStatusPrivate(x){if(x.params[0]===6){const U=this._activeBuffer.y+1,F=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${o.C0.ESC}[?${U};${F}R`)}return!0}softReset(x){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=l.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(x){const U=x.params[0]||1;switch(U){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const F=U%2==1;return this._optionsService.options.cursorBlink=F,!0}setScrollRegion(x){const U=x.params[0]||1;let F;return(x.length<2||(F=x.params[1])>this._bufferService.rows||F===0)&&(F=this._bufferService.rows),F>U&&(this._activeBuffer.scrollTop=U-1,this._activeBuffer.scrollBottom=F-1,this._setCursor(0,0)),!0}windowOptions(x){if(!N(x.params[0],this._optionsService.rawOptions.windowOptions))return!0;const U=x.length>1?x.params[1]:0;switch(x.params[0]){case 14:U!==2&&this._onRequestWindowsOptionsReport.fire(I.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(I.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${o.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:U!==0&&U!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),U!==0&&U!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:U!==0&&U!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),U!==0&&U!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(x){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(x){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(x){return this._windowTitle=x,this._onTitleChange.fire(x),!0}setIconName(x){return this._iconName=x,!0}setOrReportIndexedColor(x){const U=[],F=x.split(";");for(;F.length>1;){const z=F.shift(),D=F.shift();if(/^\d+$/.exec(z)){const Z=parseInt(z);if(re(Z))if(D==="?")U.push({type:0,index:Z});else{const se=(0,C.parseColor)(D);se&&U.push({type:1,index:Z,color:se})}}}return U.length&&this._onColor.fire(U),!0}setHyperlink(x){const U=x.split(";");return!(U.length<2)&&(U[1]?this._createHyperlink(U[0],U[1]):!U[0]&&this._finishHyperlink())}_createHyperlink(x,U){this._getCurrentLinkId()&&this._finishHyperlink();const F=x.split(":");let z;const D=F.findIndex(Z=>Z.startsWith("id="));return D!==-1&&(z=F[D].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:z,uri:U}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(x,U){const F=x.split(";");for(let z=0;z<F.length&&!(U>=this._specialColors.length);++z,++U)if(F[z]==="?")this._onColor.fire([{type:0,index:this._specialColors[U]}]);else{const D=(0,C.parseColor)(F[z]);D&&this._onColor.fire([{type:1,index:this._specialColors[U],color:D}])}return!0}setOrReportFgColor(x){return this._setOrReportSpecialColor(x,0)}setOrReportBgColor(x){return this._setOrReportSpecialColor(x,1)}setOrReportCursorColor(x){return this._setOrReportSpecialColor(x,2)}restoreIndexedColor(x){if(!x)return this._onColor.fire([{type:2}]),!0;const U=[],F=x.split(";");for(let z=0;z<F.length;++z)if(/^\d+$/.exec(F[z])){const D=parseInt(F[z]);re(D)&&U.push({type:2,index:D})}return U.length&&this._onColor.fire(U),!0}restoreFgColor(x){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(x){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(x){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),!0}selectCharset(x){return x.length!==2?(this.selectDefaultCharset(),!0):(x[0]==="/"||this._charsetService.setgCharset(L[x[0]],h.CHARSETS[x[1]]||h.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const x=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,x,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=l.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=l.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(x){return this._charsetService.setgLevel(x),!0}screenAlignmentPattern(){const x=new f.CellData;x.content=4194304|"E".charCodeAt(0),x.fg=this._curAttrData.fg,x.bg=this._curAttrData.bg,this._setCursor(0,0);for(let U=0;U<this._bufferService.rows;++U){const F=this._activeBuffer.ybase+this._activeBuffer.y+U,z=this._activeBuffer.lines.get(F);z&&(z.fill(x),z.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(x,U){const F=this._bufferService.buffer,z=this._optionsService.rawOptions;return(D=>(this._coreService.triggerDataEvent(`${o.C0.ESC}${D}${o.C0.ESC}\\`),!0))(x==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:x==='"p'?'P1$r61;1"p':x==="r"?`P1$r${F.scrollTop+1};${F.scrollBottom+1}r`:x==="m"?"P1$r0m":x===" q"?`P1$r${{block:2,underline:4,bar:6}[z.cursorStyle]-(z.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(x,U){this._dirtyRowTracker.markRangeDirty(x,U)}}e.InputHandler=V;let G=class{constructor(J){this._bufferService=J,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(J){J<this.start?this.start=J:J>this.end&&(this.end=J)}markRangeDirty(J,x){J>x&&(P=J,J=x,x=P),J<this.start&&(this.start=J),x>this.end&&(this.end=x)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function re(J){return 0<=J&&J<256}G=r([a(0,b.IBufferService)],G)},844:(n,e)=>{function t(r){for(const a of r)a.dispose();r.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.MutableDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const r of this._disposables)r.dispose();this._disposables.length=0}register(r){return this._disposables.push(r),r}unregister(r){const a=this._disposables.indexOf(r);a!==-1&&this._disposables.splice(a,1)}},e.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(r){var a;this._isDisposed||r===this._value||((a=this._value)===null||a===void 0||a.dispose(),this._value=r)}clear(){this.value=void 0}dispose(){var r;this._isDisposed=!0,(r=this._value)===null||r===void 0||r.dispose(),this._value=void 0}},e.toDisposable=function(r){return{dispose:r}},e.disposeArray=t,e.getDisposeArrayDisposable=function(r){return{dispose:()=>t(r)}}},1505:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FourKeyMap=e.TwoKeyMap=void 0;class t{constructor(){this._data={}}set(a,o,h){this._data[a]||(this._data[a]={}),this._data[a][o]=h}get(a,o){return this._data[a]?this._data[a][o]:void 0}clear(){this._data={}}}e.TwoKeyMap=t,e.FourKeyMap=class{constructor(){this._data=new t}set(r,a,o,h,_){this._data.get(r,a)||this._data.set(r,a,new t),this._data.get(r,a).set(o,h,_)}get(r,a,o,h){var _;return(_=this._data.get(r,a))===null||_===void 0?void 0:_.get(o,h)}clear(){this._data.clear()}}},6114:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isChromeOS=e.isLinux=e.isWindows=e.isIphone=e.isIpad=e.isMac=e.getSafariVersion=e.isSafari=e.isLegacyEdge=e.isFirefox=e.isNode=void 0,e.isNode=typeof navigator>"u";const t=e.isNode?"node":navigator.userAgent,r=e.isNode?"node":navigator.platform;e.isFirefox=t.includes("Firefox"),e.isLegacyEdge=t.includes("Edge"),e.isSafari=/^((?!chrome|android).)*safari/i.test(t),e.getSafariVersion=function(){if(!e.isSafari)return 0;const a=t.match(/Version\/(\d+)/);return a===null||a.length<2?0:parseInt(a[1])},e.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(r),e.isIpad=r==="iPad",e.isIphone=r==="iPhone",e.isWindows=["Windows","Win16","Win32","WinCE"].includes(r),e.isLinux=r.indexOf("Linux")>=0,e.isChromeOS=/\bCrOS\b/.test(t)},6106:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SortedList=void 0;let t=0;e.SortedList=class{constructor(r){this._getKey=r,this._array=[]}clear(){this._array.length=0}insert(r){this._array.length!==0?(t=this._search(this._getKey(r)),this._array.splice(t,0,r)):this._array.push(r)}delete(r){if(this._array.length===0)return!1;const a=this._getKey(r);if(a===void 0||(t=this._search(a),t===-1)||this._getKey(this._array[t])!==a)return!1;do if(this._array[t]===r)return this._array.splice(t,1),!0;while(++t<this._array.length&&this._getKey(this._array[t])===a);return!1}*getKeyIterator(r){if(this._array.length!==0&&(t=this._search(r),!(t<0||t>=this._array.length)&&this._getKey(this._array[t])===r))do yield this._array[t];while(++t<this._array.length&&this._getKey(this._array[t])===r)}forEachByKey(r,a){if(this._array.length!==0&&(t=this._search(r),!(t<0||t>=this._array.length)&&this._getKey(this._array[t])===r))do a(this._array[t]);while(++t<this._array.length&&this._getKey(this._array[t])===r)}values(){return[...this._array].values()}_search(r){let a=0,o=this._array.length-1;for(;o>=a;){let h=a+o>>1;const _=this._getKey(this._array[h]);if(_>r)o=h-1;else{if(!(_<r)){for(;h>0&&this._getKey(this._array[h-1])===r;)h--;return h}a=h+1}}return a}}},7226:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DebouncedIdleTask=e.IdleTaskQueue=e.PriorityTaskQueue=void 0;const r=t(6114);class a{constructor(){this._tasks=[],this._i=0}enqueue(_){this._tasks.push(_),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(_){this._idleCallback=void 0;let v=0,g=0,l=_.timeRemaining(),p=0;for(;this._i<this._tasks.length;){if(v=Date.now(),this._tasks[this._i]()||this._i++,v=Math.max(1,Date.now()-v),g=Math.max(v,g),p=_.timeRemaining(),1.5*g>p)return l-v<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(l-v))}ms`),void this._start();l=p}this.clear()}}class o extends a{_requestCallback(_){return setTimeout(()=>_(this._createDeadline(16)))}_cancelCallback(_){clearTimeout(_)}_createDeadline(_){const v=Date.now()+_;return{timeRemaining:()=>Math.max(0,v-Date.now())}}}e.PriorityTaskQueue=o,e.IdleTaskQueue=!r.isNode&&"requestIdleCallback"in window?class extends a{_requestCallback(h){return requestIdleCallback(h)}_cancelCallback(h){cancelIdleCallback(h)}}:o,e.DebouncedIdleTask=class{constructor(){this._queue=new e.IdleTaskQueue}set(h){this._queue.clear(),this._queue.enqueue(h)}flush(){this._queue.flush()}}},9282:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.updateWindowsModeWrappedState=void 0;const r=t(643);e.updateWindowsModeWrappedState=function(a){const o=a.buffer.lines.get(a.buffer.ybase+a.buffer.y-1),h=o==null?void 0:o.get(a.cols-1),_=a.buffer.lines.get(a.buffer.ybase+a.buffer.y);_&&h&&(_.isWrapped=h[r.CHAR_DATA_CODE_INDEX]!==r.NULL_CELL_CODE&&h[r.CHAR_DATA_CODE_INDEX]!==r.WHITESPACE_CELL_CODE)}},3734:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedAttrs=e.AttributeData=void 0;class t{constructor(){this.fg=0,this.bg=0,this.extended=new r}static toColorRGB(o){return[o>>>16&255,o>>>8&255,255&o]}static fromColorRGB(o){return(255&o[0])<<16|(255&o[1])<<8|255&o[2]}clone(){const o=new t;return o.fg=this.fg,o.bg=this.bg,o.extended=this.extended.clone(),o}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}e.AttributeData=t;class r{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(o){this._ext=o}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(o){this._ext&=-469762049,this._ext|=o<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(o){this._ext&=-67108864,this._ext|=67108863&o}get urlId(){return this._urlId}set urlId(o){this._urlId=o}constructor(o=0,h=0){this._ext=0,this._urlId=0,this._ext=o,this._urlId=h}clone(){return new r(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}e.ExtendedAttrs=r},9092:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Buffer=e.MAX_BUFFER_SIZE=void 0;const r=t(6349),a=t(7226),o=t(3734),h=t(8437),_=t(4634),v=t(511),g=t(643),l=t(4863),p=t(7116);e.MAX_BUFFER_SIZE=4294967295,e.Buffer=class{constructor(u,f,y){this._hasScrollback=u,this._optionsService=f,this._bufferService=y,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=h.DEFAULT_ATTR_DATA.clone(),this.savedCharset=p.DEFAULT_CHARSET,this.markers=[],this._nullCell=v.CellData.fromCharData([0,g.NULL_CELL_CHAR,g.NULL_CELL_WIDTH,g.NULL_CELL_CODE]),this._whitespaceCell=v.CellData.fromCharData([0,g.WHITESPACE_CELL_CHAR,g.WHITESPACE_CELL_WIDTH,g.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new a.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new r.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(u){return u?(this._nullCell.fg=u.fg,this._nullCell.bg=u.bg,this._nullCell.extended=u.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new o.ExtendedAttrs),this._nullCell}getWhitespaceCell(u){return u?(this._whitespaceCell.fg=u.fg,this._whitespaceCell.bg=u.bg,this._whitespaceCell.extended=u.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new o.ExtendedAttrs),this._whitespaceCell}getBlankLine(u,f){return new h.BufferLine(this._bufferService.cols,this.getNullCell(u),f)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const u=this.ybase+this.y-this.ydisp;return u>=0&&u<this._rows}_getCorrectBufferLength(u){if(!this._hasScrollback)return u;const f=u+this._optionsService.rawOptions.scrollback;return f>e.MAX_BUFFER_SIZE?e.MAX_BUFFER_SIZE:f}fillViewportRows(u){if(this.lines.length===0){u===void 0&&(u=h.DEFAULT_ATTR_DATA);let f=this._rows;for(;f--;)this.lines.push(this.getBlankLine(u))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new r.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(u,f){const y=this.getNullCell(h.DEFAULT_ATTR_DATA);let b=0;const A=this._getCorrectBufferLength(f);if(A>this.lines.maxLength&&(this.lines.maxLength=A),this.lines.length>0){if(this._cols<u)for(let C=0;C<this.lines.length;C++)b+=+this.lines.get(C).resize(u,y);let R=0;if(this._rows<f)for(let C=this._rows;C<f;C++)this.lines.length<f+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new h.BufferLine(u,y)):this.ybase>0&&this.lines.length<=this.ybase+this.y+R+1?(this.ybase--,R++,this.ydisp>0&&this.ydisp--):this.lines.push(new h.BufferLine(u,y)));else for(let C=this._rows;C>f;C--)this.lines.length>f+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(A<this.lines.maxLength){const C=this.lines.length-A;C>0&&(this.lines.trimStart(C),this.ybase=Math.max(this.ybase-C,0),this.ydisp=Math.max(this.ydisp-C,0),this.savedY=Math.max(this.savedY-C,0)),this.lines.maxLength=A}this.x=Math.min(this.x,u-1),this.y=Math.min(this.y,f-1),R&&(this.y+=R),this.savedX=Math.min(this.savedX,u-1),this.scrollTop=0}if(this.scrollBottom=f-1,this._isReflowEnabled&&(this._reflow(u,f),this._cols>u))for(let R=0;R<this.lines.length;R++)b+=+this.lines.get(R).resize(u,y);this._cols=u,this._rows=f,this._memoryCleanupQueue.clear(),b>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let u=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,u=!1);let f=0;for(;this._memoryCleanupPosition<this.lines.length;)if(f+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),f>100)return!0;return u}get _isReflowEnabled(){const u=this._optionsService.rawOptions.windowsPty;return u&&u.buildNumber?this._hasScrollback&&u.backend==="conpty"&&u.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(u,f){this._cols!==u&&(u>this._cols?this._reflowLarger(u,f):this._reflowSmaller(u,f))}_reflowLarger(u,f){const y=(0,_.reflowLargerGetLinesToRemove)(this.lines,this._cols,u,this.ybase+this.y,this.getNullCell(h.DEFAULT_ATTR_DATA));if(y.length>0){const b=(0,_.reflowLargerCreateNewLayout)(this.lines,y);(0,_.reflowLargerApplyNewLayout)(this.lines,b.layout),this._reflowLargerAdjustViewport(u,f,b.countRemoved)}}_reflowLargerAdjustViewport(u,f,y){const b=this.getNullCell(h.DEFAULT_ATTR_DATA);let A=y;for(;A-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<f&&this.lines.push(new h.BufferLine(u,b))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-y,0)}_reflowSmaller(u,f){const y=this.getNullCell(h.DEFAULT_ATTR_DATA),b=[];let A=0;for(let R=this.lines.length-1;R>=0;R--){let C=this.lines.get(R);if(!C||!C.isWrapped&&C.getTrimmedLength()<=u)continue;const L=[C];for(;C.isWrapped&&R>0;)C=this.lines.get(--R),L.unshift(C);const O=this.ybase+this.y;if(O>=R&&O<R+L.length)continue;const N=L[L.length-1].getTrimmedLength(),I=(0,_.reflowSmallerGetNewLineLengths)(L,this._cols,u),P=I.length-L.length;let V;V=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+P):Math.max(0,this.lines.length-this.lines.maxLength+P);const G=[];for(let z=0;z<P;z++){const D=this.getBlankLine(h.DEFAULT_ATTR_DATA,!0);G.push(D)}G.length>0&&(b.push({start:R+L.length+A,newLines:G}),A+=G.length),L.push(...G);let re=I.length-1,J=I[re];J===0&&(re--,J=I[re]);let x=L.length-P-1,U=N;for(;x>=0;){const z=Math.min(U,J);if(L[re]===void 0)break;if(L[re].copyCellsFrom(L[x],U-z,J-z,z,!0),J-=z,J===0&&(re--,J=I[re]),U-=z,U===0){x--;const D=Math.max(x,0);U=(0,_.getWrappedLineTrimmedLength)(L,D,this._cols)}}for(let z=0;z<L.length;z++)I[z]<u&&L[z].setCell(I[z],y);let F=P-V;for(;F-- >0;)this.ybase===0?this.y<f-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+A)-f&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+P,this.ybase+f-1)}if(b.length>0){const R=[],C=[];for(let re=0;re<this.lines.length;re++)C.push(this.lines.get(re));const L=this.lines.length;let O=L-1,N=0,I=b[N];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+A);let P=0;for(let re=Math.min(this.lines.maxLength-1,L+A-1);re>=0;re--)if(I&&I.start>O+P){for(let J=I.newLines.length-1;J>=0;J--)this.lines.set(re--,I.newLines[J]);re++,R.push({index:O+1,amount:I.newLines.length}),P+=I.newLines.length,I=b[++N]}else this.lines.set(re,C[O--]);let V=0;for(let re=R.length-1;re>=0;re--)R[re].index+=V,this.lines.onInsertEmitter.fire(R[re]),V+=R[re].amount;const G=Math.max(0,L+A-this.lines.maxLength);G>0&&this.lines.onTrimEmitter.fire(G)}}translateBufferLineToString(u,f,y=0,b){const A=this.lines.get(u);return A?A.translateToString(f,y,b):""}getWrappedRangeForLine(u){let f=u,y=u;for(;f>0&&this.lines.get(f).isWrapped;)f--;for(;y+1<this.lines.length&&this.lines.get(y+1).isWrapped;)y++;return{first:f,last:y}}setupTabStops(u){for(u!=null?this.tabs[u]||(u=this.prevStop(u)):(this.tabs={},u=0);u<this._cols;u+=this._optionsService.rawOptions.tabStopWidth)this.tabs[u]=!0}prevStop(u){for(u==null&&(u=this.x);!this.tabs[--u]&&u>0;);return u>=this._cols?this._cols-1:u<0?0:u}nextStop(u){for(u==null&&(u=this.x);!this.tabs[++u]&&u<this._cols;);return u>=this._cols?this._cols-1:u<0?0:u}clearMarkers(u){this._isClearing=!0;for(let f=0;f<this.markers.length;f++)this.markers[f].line===u&&(this.markers[f].dispose(),this.markers.splice(f--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let u=0;u<this.markers.length;u++)this.markers[u].dispose(),this.markers.splice(u--,1);this._isClearing=!1}addMarker(u){const f=new l.Marker(u);return this.markers.push(f),f.register(this.lines.onTrim(y=>{f.line-=y,f.line<0&&f.dispose()})),f.register(this.lines.onInsert(y=>{f.line>=y.index&&(f.line+=y.amount)})),f.register(this.lines.onDelete(y=>{f.line>=y.index&&f.line<y.index+y.amount&&f.dispose(),f.line>y.index&&(f.line-=y.amount)})),f.register(f.onDispose(()=>this._removeMarker(f))),f}_removeMarker(u){this._isClearing||this.markers.splice(this.markers.indexOf(u),1)}}},8437:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLine=e.DEFAULT_ATTR_DATA=void 0;const r=t(3734),a=t(511),o=t(643),h=t(482);e.DEFAULT_ATTR_DATA=Object.freeze(new r.AttributeData);let _=0;class v{constructor(l,p,u=!1){this.isWrapped=u,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*l);const f=p||a.CellData.fromCharData([0,o.NULL_CELL_CHAR,o.NULL_CELL_WIDTH,o.NULL_CELL_CODE]);for(let y=0;y<l;++y)this.setCell(y,f);this.length=l}get(l){const p=this._data[3*l+0],u=2097151&p;return[this._data[3*l+1],2097152&p?this._combined[l]:u?(0,h.stringFromCodePoint)(u):"",p>>22,2097152&p?this._combined[l].charCodeAt(this._combined[l].length-1):u]}set(l,p){this._data[3*l+1]=p[o.CHAR_DATA_ATTR_INDEX],p[o.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[l]=p[1],this._data[3*l+0]=2097152|l|p[o.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*l+0]=p[o.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|p[o.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(l){return this._data[3*l+0]>>22}hasWidth(l){return 12582912&this._data[3*l+0]}getFg(l){return this._data[3*l+1]}getBg(l){return this._data[3*l+2]}hasContent(l){return 4194303&this._data[3*l+0]}getCodePoint(l){const p=this._data[3*l+0];return 2097152&p?this._combined[l].charCodeAt(this._combined[l].length-1):2097151&p}isCombined(l){return 2097152&this._data[3*l+0]}getString(l){const p=this._data[3*l+0];return 2097152&p?this._combined[l]:2097151&p?(0,h.stringFromCodePoint)(2097151&p):""}isProtected(l){return 536870912&this._data[3*l+2]}loadCell(l,p){return _=3*l,p.content=this._data[_+0],p.fg=this._data[_+1],p.bg=this._data[_+2],2097152&p.content&&(p.combinedData=this._combined[l]),268435456&p.bg&&(p.extended=this._extendedAttrs[l]),p}setCell(l,p){2097152&p.content&&(this._combined[l]=p.combinedData),268435456&p.bg&&(this._extendedAttrs[l]=p.extended),this._data[3*l+0]=p.content,this._data[3*l+1]=p.fg,this._data[3*l+2]=p.bg}setCellFromCodePoint(l,p,u,f,y,b){268435456&y&&(this._extendedAttrs[l]=b),this._data[3*l+0]=p|u<<22,this._data[3*l+1]=f,this._data[3*l+2]=y}addCodepointToCell(l,p){let u=this._data[3*l+0];2097152&u?this._combined[l]+=(0,h.stringFromCodePoint)(p):(2097151&u?(this._combined[l]=(0,h.stringFromCodePoint)(2097151&u)+(0,h.stringFromCodePoint)(p),u&=-2097152,u|=2097152):u=p|4194304,this._data[3*l+0]=u)}insertCells(l,p,u,f){if((l%=this.length)&&this.getWidth(l-1)===2&&this.setCellFromCodePoint(l-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new r.ExtendedAttrs),p<this.length-l){const y=new a.CellData;for(let b=this.length-l-p-1;b>=0;--b)this.setCell(l+p+b,this.loadCell(l+b,y));for(let b=0;b<p;++b)this.setCell(l+b,u)}else for(let y=l;y<this.length;++y)this.setCell(y,u);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new r.ExtendedAttrs)}deleteCells(l,p,u,f){if(l%=this.length,p<this.length-l){const y=new a.CellData;for(let b=0;b<this.length-l-p;++b)this.setCell(l+b,this.loadCell(l+p+b,y));for(let b=this.length-p;b<this.length;++b)this.setCell(b,u)}else for(let y=l;y<this.length;++y)this.setCell(y,u);l&&this.getWidth(l-1)===2&&this.setCellFromCodePoint(l-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new r.ExtendedAttrs),this.getWidth(l)!==0||this.hasContent(l)||this.setCellFromCodePoint(l,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new r.ExtendedAttrs)}replaceCells(l,p,u,f,y=!1){if(y)for(l&&this.getWidth(l-1)===2&&!this.isProtected(l-1)&&this.setCellFromCodePoint(l-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new r.ExtendedAttrs),p<this.length&&this.getWidth(p-1)===2&&!this.isProtected(p)&&this.setCellFromCodePoint(p,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new r.ExtendedAttrs);l<p&&l<this.length;)this.isProtected(l)||this.setCell(l,u),l++;else for(l&&this.getWidth(l-1)===2&&this.setCellFromCodePoint(l-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new r.ExtendedAttrs),p<this.length&&this.getWidth(p-1)===2&&this.setCellFromCodePoint(p,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new r.ExtendedAttrs);l<p&&l<this.length;)this.setCell(l++,u)}resize(l,p){if(l===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const u=3*l;if(l>this.length){if(this._data.buffer.byteLength>=4*u)this._data=new Uint32Array(this._data.buffer,0,u);else{const f=new Uint32Array(u);f.set(this._data),this._data=f}for(let f=this.length;f<l;++f)this.setCell(f,p)}else{this._data=this._data.subarray(0,u);const f=Object.keys(this._combined);for(let b=0;b<f.length;b++){const A=parseInt(f[b],10);A>=l&&delete this._combined[A]}const y=Object.keys(this._extendedAttrs);for(let b=0;b<y.length;b++){const A=parseInt(y[b],10);A>=l&&delete this._extendedAttrs[A]}}return this.length=l,4*u*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const l=new Uint32Array(this._data.length);return l.set(this._data),this._data=l,1}return 0}fill(l,p=!1){if(p)for(let u=0;u<this.length;++u)this.isProtected(u)||this.setCell(u,l);else{this._combined={},this._extendedAttrs={};for(let u=0;u<this.length;++u)this.setCell(u,l)}}copyFrom(l){this.length!==l.length?this._data=new Uint32Array(l._data):this._data.set(l._data),this.length=l.length,this._combined={};for(const p in l._combined)this._combined[p]=l._combined[p];this._extendedAttrs={};for(const p in l._extendedAttrs)this._extendedAttrs[p]=l._extendedAttrs[p];this.isWrapped=l.isWrapped}clone(){const l=new v(0);l._data=new Uint32Array(this._data),l.length=this.length;for(const p in this._combined)l._combined[p]=this._combined[p];for(const p in this._extendedAttrs)l._extendedAttrs[p]=this._extendedAttrs[p];return l.isWrapped=this.isWrapped,l}getTrimmedLength(){for(let l=this.length-1;l>=0;--l)if(4194303&this._data[3*l+0])return l+(this._data[3*l+0]>>22);return 0}getNoBgTrimmedLength(){for(let l=this.length-1;l>=0;--l)if(4194303&this._data[3*l+0]||50331648&this._data[3*l+2])return l+(this._data[3*l+0]>>22);return 0}copyCellsFrom(l,p,u,f,y){const b=l._data;if(y)for(let R=f-1;R>=0;R--){for(let C=0;C<3;C++)this._data[3*(u+R)+C]=b[3*(p+R)+C];268435456&b[3*(p+R)+2]&&(this._extendedAttrs[u+R]=l._extendedAttrs[p+R])}else for(let R=0;R<f;R++){for(let C=0;C<3;C++)this._data[3*(u+R)+C]=b[3*(p+R)+C];268435456&b[3*(p+R)+2]&&(this._extendedAttrs[u+R]=l._extendedAttrs[p+R])}const A=Object.keys(l._combined);for(let R=0;R<A.length;R++){const C=parseInt(A[R],10);C>=p&&(this._combined[C-p+u]=l._combined[C])}}translateToString(l=!1,p=0,u=this.length){l&&(u=Math.min(u,this.getTrimmedLength()));let f="";for(;p<u;){const y=this._data[3*p+0],b=2097151&y;f+=2097152&y?this._combined[p]:b?(0,h.stringFromCodePoint)(b):o.WHITESPACE_CELL_CHAR,p+=y>>22||1}return f}}e.BufferLine=v},4841:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getRangeLength=void 0,e.getRangeLength=function(t,r){if(t.start.y>t.end.y)throw new Error(`Buffer range end (${t.end.x}, ${t.end.y}) cannot be before start (${t.start.x}, ${t.start.y})`);return r*(t.end.y-t.start.y)+(t.end.x-t.start.x+1)}},4634:(n,e)=>{function t(r,a,o){if(a===r.length-1)return r[a].getTrimmedLength();const h=!r[a].hasContent(o-1)&&r[a].getWidth(o-1)===1,_=r[a+1].getWidth(0)===2;return h&&_?o-1:o}Object.defineProperty(e,"__esModule",{value:!0}),e.getWrappedLineTrimmedLength=e.reflowSmallerGetNewLineLengths=e.reflowLargerApplyNewLayout=e.reflowLargerCreateNewLayout=e.reflowLargerGetLinesToRemove=void 0,e.reflowLargerGetLinesToRemove=function(r,a,o,h,_){const v=[];for(let g=0;g<r.length-1;g++){let l=g,p=r.get(++l);if(!p.isWrapped)continue;const u=[r.get(g)];for(;l<r.length&&p.isWrapped;)u.push(p),p=r.get(++l);if(h>=g&&h<l){g+=u.length-1;continue}let f=0,y=t(u,f,a),b=1,A=0;for(;b<u.length;){const C=t(u,b,a),L=C-A,O=o-y,N=Math.min(L,O);u[f].copyCellsFrom(u[b],A,y,N,!1),y+=N,y===o&&(f++,y=0),A+=N,A===C&&(b++,A=0),y===0&&f!==0&&u[f-1].getWidth(o-1)===2&&(u[f].copyCellsFrom(u[f-1],o-1,y++,1,!1),u[f-1].setCell(o-1,_))}u[f].replaceCells(y,o,_);let R=0;for(let C=u.length-1;C>0&&(C>f||u[C].getTrimmedLength()===0);C--)R++;R>0&&(v.push(g+u.length-R),v.push(R)),g+=u.length-1}return v},e.reflowLargerCreateNewLayout=function(r,a){const o=[];let h=0,_=a[h],v=0;for(let g=0;g<r.length;g++)if(_===g){const l=a[++h];r.onDeleteEmitter.fire({index:g-v,amount:l}),g+=l-1,v+=l,_=a[++h]}else o.push(g);return{layout:o,countRemoved:v}},e.reflowLargerApplyNewLayout=function(r,a){const o=[];for(let h=0;h<a.length;h++)o.push(r.get(a[h]));for(let h=0;h<o.length;h++)r.set(h,o[h]);r.length=a.length},e.reflowSmallerGetNewLineLengths=function(r,a,o){const h=[],_=r.map((p,u)=>t(r,u,a)).reduce((p,u)=>p+u);let v=0,g=0,l=0;for(;l<_;){if(_-l<o){h.push(_-l);break}v+=o;const p=t(r,g,a);v>p&&(v-=p,g++);const u=r[g].getWidth(v-1)===2;u&&v--;const f=u?o-1:o;h.push(f),l+=f}return h},e.getWrappedLineTrimmedLength=t},5295:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferSet=void 0;const r=t(8460),a=t(844),o=t(9092);class h extends a.Disposable{constructor(v,g){super(),this._optionsService=v,this._bufferService=g,this._onBufferActivate=this.register(new r.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new o.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new o.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(v){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(v),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(v,g){this._normal.resize(v,g),this._alt.resize(v,g),this.setupTabStops(v)}setupTabStops(v){this._normal.setupTabStops(v),this._alt.setupTabStops(v)}}e.BufferSet=h},511:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CellData=void 0;const r=t(482),a=t(643),o=t(3734);class h extends o.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new o.ExtendedAttrs,this.combinedData=""}static fromCharData(v){const g=new h;return g.setFromCharData(v),g}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,r.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(v){this.fg=v[a.CHAR_DATA_ATTR_INDEX],this.bg=0;let g=!1;if(v[a.CHAR_DATA_CHAR_INDEX].length>2)g=!0;else if(v[a.CHAR_DATA_CHAR_INDEX].length===2){const l=v[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=l&&l<=56319){const p=v[a.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=p&&p<=57343?this.content=1024*(l-55296)+p-56320+65536|v[a.CHAR_DATA_WIDTH_INDEX]<<22:g=!0}else g=!0}else this.content=v[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[a.CHAR_DATA_WIDTH_INDEX]<<22;g&&(this.combinedData=v[a.CHAR_DATA_CHAR_INDEX],this.content=2097152|v[a.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.CellData=h},643:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WHITESPACE_CELL_CODE=e.WHITESPACE_CELL_WIDTH=e.WHITESPACE_CELL_CHAR=e.NULL_CELL_CODE=e.NULL_CELL_WIDTH=e.NULL_CELL_CHAR=e.CHAR_DATA_CODE_INDEX=e.CHAR_DATA_WIDTH_INDEX=e.CHAR_DATA_CHAR_INDEX=e.CHAR_DATA_ATTR_INDEX=e.DEFAULT_EXT=e.DEFAULT_ATTR=e.DEFAULT_COLOR=void 0,e.DEFAULT_COLOR=0,e.DEFAULT_ATTR=256|e.DEFAULT_COLOR<<9,e.DEFAULT_EXT=0,e.CHAR_DATA_ATTR_INDEX=0,e.CHAR_DATA_CHAR_INDEX=1,e.CHAR_DATA_WIDTH_INDEX=2,e.CHAR_DATA_CODE_INDEX=3,e.NULL_CELL_CHAR="",e.NULL_CELL_WIDTH=1,e.NULL_CELL_CODE=0,e.WHITESPACE_CELL_CHAR=" ",e.WHITESPACE_CELL_WIDTH=1,e.WHITESPACE_CELL_CODE=32},4863:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Marker=void 0;const r=t(8460),a=t(844);class o{get id(){return this._id}constructor(_){this.line=_,this.isDisposed=!1,this._disposables=[],this._id=o._nextId++,this._onDispose=this.register(new r.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,a.disposeArray)(this._disposables),this._disposables.length=0)}register(_){return this._disposables.push(_),_}}e.Marker=o,o._nextId=1},7116:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_CHARSET=e.CHARSETS=void 0,e.CHARSETS={},e.DEFAULT_CHARSET=e.CHARSETS.B,e.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},e.CHARSETS.A={"#":"£"},e.CHARSETS.B=void 0,e.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},e.CHARSETS.C=e.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},e.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},e.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},e.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},e.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},e.CHARSETS.E=e.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},e.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},e.CHARSETS.H=e.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},e.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(n,e)=>{var t,r,a;Object.defineProperty(e,"__esModule",{value:!0}),e.C1_ESCAPED=e.C1=e.C0=void 0,function(o){o.NUL="\0",o.SOH="",o.STX="",o.ETX="",o.EOT="",o.ENQ="",o.ACK="",o.BEL="\x07",o.BS="\b",o.HT="	",o.LF=`
`,o.VT="\v",o.FF="\f",o.CR="\r",o.SO="",o.SI="",o.DLE="",o.DC1="",o.DC2="",o.DC3="",o.DC4="",o.NAK="",o.SYN="",o.ETB="",o.CAN="",o.EM="",o.SUB="",o.ESC="\x1B",o.FS="",o.GS="",o.RS="",o.US="",o.SP=" ",o.DEL=""}(t||(e.C0=t={})),function(o){o.PAD="",o.HOP="",o.BPH="",o.NBH="",o.IND="",o.NEL="",o.SSA="",o.ESA="",o.HTS="",o.HTJ="",o.VTS="",o.PLD="",o.PLU="",o.RI="",o.SS2="",o.SS3="",o.DCS="",o.PU1="",o.PU2="",o.STS="",o.CCH="",o.MW="",o.SPA="",o.EPA="",o.SOS="",o.SGCI="",o.SCI="",o.CSI="",o.ST="",o.OSC="",o.PM="",o.APC=""}(r||(e.C1=r={})),function(o){o.ST=`${t.ESC}\\`}(a||(e.C1_ESCAPED=a={}))},7399:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.evaluateKeyboardEvent=void 0;const r=t(2584),a={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};e.evaluateKeyboardEvent=function(o,h,_,v){const g={type:0,cancel:!1,key:void 0},l=(o.shiftKey?1:0)|(o.altKey?2:0)|(o.ctrlKey?4:0)|(o.metaKey?8:0);switch(o.keyCode){case 0:o.key==="UIKeyInputUpArrow"?g.key=h?r.C0.ESC+"OA":r.C0.ESC+"[A":o.key==="UIKeyInputLeftArrow"?g.key=h?r.C0.ESC+"OD":r.C0.ESC+"[D":o.key==="UIKeyInputRightArrow"?g.key=h?r.C0.ESC+"OC":r.C0.ESC+"[C":o.key==="UIKeyInputDownArrow"&&(g.key=h?r.C0.ESC+"OB":r.C0.ESC+"[B");break;case 8:if(o.altKey){g.key=r.C0.ESC+r.C0.DEL;break}g.key=r.C0.DEL;break;case 9:if(o.shiftKey){g.key=r.C0.ESC+"[Z";break}g.key=r.C0.HT,g.cancel=!0;break;case 13:g.key=o.altKey?r.C0.ESC+r.C0.CR:r.C0.CR,g.cancel=!0;break;case 27:g.key=r.C0.ESC,o.altKey&&(g.key=r.C0.ESC+r.C0.ESC),g.cancel=!0;break;case 37:if(o.metaKey)break;l?(g.key=r.C0.ESC+"[1;"+(l+1)+"D",g.key===r.C0.ESC+"[1;3D"&&(g.key=r.C0.ESC+(_?"b":"[1;5D"))):g.key=h?r.C0.ESC+"OD":r.C0.ESC+"[D";break;case 39:if(o.metaKey)break;l?(g.key=r.C0.ESC+"[1;"+(l+1)+"C",g.key===r.C0.ESC+"[1;3C"&&(g.key=r.C0.ESC+(_?"f":"[1;5C"))):g.key=h?r.C0.ESC+"OC":r.C0.ESC+"[C";break;case 38:if(o.metaKey)break;l?(g.key=r.C0.ESC+"[1;"+(l+1)+"A",_||g.key!==r.C0.ESC+"[1;3A"||(g.key=r.C0.ESC+"[1;5A")):g.key=h?r.C0.ESC+"OA":r.C0.ESC+"[A";break;case 40:if(o.metaKey)break;l?(g.key=r.C0.ESC+"[1;"+(l+1)+"B",_||g.key!==r.C0.ESC+"[1;3B"||(g.key=r.C0.ESC+"[1;5B")):g.key=h?r.C0.ESC+"OB":r.C0.ESC+"[B";break;case 45:o.shiftKey||o.ctrlKey||(g.key=r.C0.ESC+"[2~");break;case 46:g.key=l?r.C0.ESC+"[3;"+(l+1)+"~":r.C0.ESC+"[3~";break;case 36:g.key=l?r.C0.ESC+"[1;"+(l+1)+"H":h?r.C0.ESC+"OH":r.C0.ESC+"[H";break;case 35:g.key=l?r.C0.ESC+"[1;"+(l+1)+"F":h?r.C0.ESC+"OF":r.C0.ESC+"[F";break;case 33:o.shiftKey?g.type=2:o.ctrlKey?g.key=r.C0.ESC+"[5;"+(l+1)+"~":g.key=r.C0.ESC+"[5~";break;case 34:o.shiftKey?g.type=3:o.ctrlKey?g.key=r.C0.ESC+"[6;"+(l+1)+"~":g.key=r.C0.ESC+"[6~";break;case 112:g.key=l?r.C0.ESC+"[1;"+(l+1)+"P":r.C0.ESC+"OP";break;case 113:g.key=l?r.C0.ESC+"[1;"+(l+1)+"Q":r.C0.ESC+"OQ";break;case 114:g.key=l?r.C0.ESC+"[1;"+(l+1)+"R":r.C0.ESC+"OR";break;case 115:g.key=l?r.C0.ESC+"[1;"+(l+1)+"S":r.C0.ESC+"OS";break;case 116:g.key=l?r.C0.ESC+"[15;"+(l+1)+"~":r.C0.ESC+"[15~";break;case 117:g.key=l?r.C0.ESC+"[17;"+(l+1)+"~":r.C0.ESC+"[17~";break;case 118:g.key=l?r.C0.ESC+"[18;"+(l+1)+"~":r.C0.ESC+"[18~";break;case 119:g.key=l?r.C0.ESC+"[19;"+(l+1)+"~":r.C0.ESC+"[19~";break;case 120:g.key=l?r.C0.ESC+"[20;"+(l+1)+"~":r.C0.ESC+"[20~";break;case 121:g.key=l?r.C0.ESC+"[21;"+(l+1)+"~":r.C0.ESC+"[21~";break;case 122:g.key=l?r.C0.ESC+"[23;"+(l+1)+"~":r.C0.ESC+"[23~";break;case 123:g.key=l?r.C0.ESC+"[24;"+(l+1)+"~":r.C0.ESC+"[24~";break;default:if(!o.ctrlKey||o.shiftKey||o.altKey||o.metaKey)if(_&&!v||!o.altKey||o.metaKey)!_||o.altKey||o.ctrlKey||o.shiftKey||!o.metaKey?o.key&&!o.ctrlKey&&!o.altKey&&!o.metaKey&&o.keyCode>=48&&o.key.length===1?g.key=o.key:o.key&&o.ctrlKey&&(o.key==="_"&&(g.key=r.C0.US),o.key==="@"&&(g.key=r.C0.NUL)):o.keyCode===65&&(g.type=1);else{const p=a[o.keyCode],u=p==null?void 0:p[o.shiftKey?1:0];if(u)g.key=r.C0.ESC+u;else if(o.keyCode>=65&&o.keyCode<=90){const f=o.ctrlKey?o.keyCode-64:o.keyCode+32;let y=String.fromCharCode(f);o.shiftKey&&(y=y.toUpperCase()),g.key=r.C0.ESC+y}else if(o.keyCode===32)g.key=r.C0.ESC+(o.ctrlKey?r.C0.NUL:" ");else if(o.key==="Dead"&&o.code.startsWith("Key")){let f=o.code.slice(3,4);o.shiftKey||(f=f.toLowerCase()),g.key=r.C0.ESC+f,g.cancel=!0}}else o.keyCode>=65&&o.keyCode<=90?g.key=String.fromCharCode(o.keyCode-64):o.keyCode===32?g.key=r.C0.NUL:o.keyCode>=51&&o.keyCode<=55?g.key=String.fromCharCode(o.keyCode-51+27):o.keyCode===56?g.key=r.C0.DEL:o.keyCode===219?g.key=r.C0.ESC:o.keyCode===220?g.key=r.C0.FS:o.keyCode===221&&(g.key=r.C0.GS)}return g}},482:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Utf8ToUtf32=e.StringToUtf32=e.utf32ToString=e.stringFromCodePoint=void 0,e.stringFromCodePoint=function(t){return t>65535?(t-=65536,String.fromCharCode(55296+(t>>10))+String.fromCharCode(t%1024+56320)):String.fromCharCode(t)},e.utf32ToString=function(t,r=0,a=t.length){let o="";for(let h=r;h<a;++h){let _=t[h];_>65535?(_-=65536,o+=String.fromCharCode(55296+(_>>10))+String.fromCharCode(_%1024+56320)):o+=String.fromCharCode(_)}return o},e.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(t,r){const a=t.length;if(!a)return 0;let o=0,h=0;if(this._interim){const _=t.charCodeAt(h++);56320<=_&&_<=57343?r[o++]=1024*(this._interim-55296)+_-56320+65536:(r[o++]=this._interim,r[o++]=_),this._interim=0}for(let _=h;_<a;++_){const v=t.charCodeAt(_);if(55296<=v&&v<=56319){if(++_>=a)return this._interim=v,o;const g=t.charCodeAt(_);56320<=g&&g<=57343?r[o++]=1024*(v-55296)+g-56320+65536:(r[o++]=v,r[o++]=g)}else v!==65279&&(r[o++]=v)}return o}},e.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(t,r){const a=t.length;if(!a)return 0;let o,h,_,v,g=0,l=0,p=0;if(this.interim[0]){let y=!1,b=this.interim[0];b&=(224&b)==192?31:(240&b)==224?15:7;let A,R=0;for(;(A=63&this.interim[++R])&&R<4;)b<<=6,b|=A;const C=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,L=C-R;for(;p<L;){if(p>=a)return 0;if(A=t[p++],(192&A)!=128){p--,y=!0;break}this.interim[R++]=A,b<<=6,b|=63&A}y||(C===2?b<128?p--:r[g++]=b:C===3?b<2048||b>=55296&&b<=57343||b===65279||(r[g++]=b):b<65536||b>1114111||(r[g++]=b)),this.interim.fill(0)}const u=a-4;let f=p;for(;f<a;){for(;!(!(f<u)||128&(o=t[f])||128&(h=t[f+1])||128&(_=t[f+2])||128&(v=t[f+3]));)r[g++]=o,r[g++]=h,r[g++]=_,r[g++]=v,f+=4;if(o=t[f++],o<128)r[g++]=o;else if((224&o)==192){if(f>=a)return this.interim[0]=o,g;if(h=t[f++],(192&h)!=128){f--;continue}if(l=(31&o)<<6|63&h,l<128){f--;continue}r[g++]=l}else if((240&o)==224){if(f>=a)return this.interim[0]=o,g;if(h=t[f++],(192&h)!=128){f--;continue}if(f>=a)return this.interim[0]=o,this.interim[1]=h,g;if(_=t[f++],(192&_)!=128){f--;continue}if(l=(15&o)<<12|(63&h)<<6|63&_,l<2048||l>=55296&&l<=57343||l===65279)continue;r[g++]=l}else if((248&o)==240){if(f>=a)return this.interim[0]=o,g;if(h=t[f++],(192&h)!=128){f--;continue}if(f>=a)return this.interim[0]=o,this.interim[1]=h,g;if(_=t[f++],(192&_)!=128){f--;continue}if(f>=a)return this.interim[0]=o,this.interim[1]=h,this.interim[2]=_,g;if(v=t[f++],(192&v)!=128){f--;continue}if(l=(7&o)<<18|(63&h)<<12|(63&_)<<6|63&v,l<65536||l>1114111)continue;r[g++]=l}}return g}}},225:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeV6=void 0;const t=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],r=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let a;e.UnicodeV6=class{constructor(){if(this.version="6",!a){a=new Uint8Array(65536),a.fill(1),a[0]=0,a.fill(0,1,32),a.fill(0,127,160),a.fill(2,4352,4448),a[9001]=2,a[9002]=2,a.fill(2,11904,42192),a[12351]=1,a.fill(2,44032,55204),a.fill(2,63744,64256),a.fill(2,65040,65050),a.fill(2,65072,65136),a.fill(2,65280,65377),a.fill(2,65504,65511);for(let o=0;o<t.length;++o)a.fill(0,t[o][0],t[o][1]+1)}}wcwidth(o){return o<32?0:o<127?1:o<65536?a[o]:function(h,_){let v,g=0,l=_.length-1;if(h<_[0][0]||h>_[l][1])return!1;for(;l>=g;)if(v=g+l>>1,h>_[v][1])g=v+1;else{if(!(h<_[v][0]))return!0;l=v-1}return!1}(o,r)?0:o>=131072&&o<=196605||o>=196608&&o<=262141?2:1}}},5981:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WriteBuffer=void 0;const r=t(8460),a=t(844);class o extends a.Disposable{constructor(_){super(),this._action=_,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new r.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(_,v){if(v!==void 0&&this._syncCalls>v)return void(this._syncCalls=0);if(this._pendingData+=_.length,this._writeBuffer.push(_),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let g;for(this._isSyncWriting=!0;g=this._writeBuffer.shift();){this._action(g);const l=this._callbacks.shift();l&&l()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(_,v){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=_.length,this._writeBuffer.push(_),this._callbacks.push(v),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=_.length,this._writeBuffer.push(_),this._callbacks.push(v)}_innerWrite(_=0,v=!0){const g=_||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const l=this._writeBuffer[this._bufferOffset],p=this._action(l,v);if(p){const f=y=>Date.now()-g>=12?setTimeout(()=>this._innerWrite(0,y)):this._innerWrite(g,y);return void p.catch(y=>(queueMicrotask(()=>{throw y}),Promise.resolve(!1))).then(f)}const u=this._callbacks[this._bufferOffset];if(u&&u(),this._bufferOffset++,this._pendingData-=l.length,Date.now()-g>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}e.WriteBuffer=o},5941:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.toRgbString=e.parseColor=void 0;const t=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,r=/^[\da-f]+$/;function a(o,h){const _=o.toString(16),v=_.length<2?"0"+_:_;switch(h){case 4:return _[0];case 8:return v;case 12:return(v+v).slice(0,3);default:return v+v}}e.parseColor=function(o){if(!o)return;let h=o.toLowerCase();if(h.indexOf("rgb:")===0){h=h.slice(4);const _=t.exec(h);if(_){const v=_[1]?15:_[4]?255:_[7]?4095:65535;return[Math.round(parseInt(_[1]||_[4]||_[7]||_[10],16)/v*255),Math.round(parseInt(_[2]||_[5]||_[8]||_[11],16)/v*255),Math.round(parseInt(_[3]||_[6]||_[9]||_[12],16)/v*255)]}}else if(h.indexOf("#")===0&&(h=h.slice(1),r.exec(h)&&[3,6,9,12].includes(h.length))){const _=h.length/3,v=[0,0,0];for(let g=0;g<3;++g){const l=parseInt(h.slice(_*g,_*g+_),16);v[g]=_===1?l<<4:_===2?l:_===3?l>>4:l>>8}return v}},e.toRgbString=function(o,h=16){const[_,v,g]=o;return`rgb:${a(_,h)}/${a(v,h)}/${a(g,h)}`}},5770:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PAYLOAD_LIMIT=void 0,e.PAYLOAD_LIMIT=1e7},6351:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DcsHandler=e.DcsParser=void 0;const r=t(482),a=t(8742),o=t(5770),h=[];e.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=h,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}registerHandler(v,g){this._handlers[v]===void 0&&(this._handlers[v]=[]);const l=this._handlers[v];return l.push(g),{dispose:()=>{const p=l.indexOf(g);p!==-1&&l.splice(p,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}reset(){if(this._active.length)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].unhook(!1);this._stack.paused=!1,this._active=h,this._ident=0}hook(v,g){if(this.reset(),this._ident=v,this._active=this._handlers[v]||h,this._active.length)for(let l=this._active.length-1;l>=0;l--)this._active[l].hook(g);else this._handlerFb(this._ident,"HOOK",g)}put(v,g,l){if(this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].put(v,g,l);else this._handlerFb(this._ident,"PUT",(0,r.utf32ToString)(v,g,l))}unhook(v,g=!0){if(this._active.length){let l=!1,p=this._active.length-1,u=!1;if(this._stack.paused&&(p=this._stack.loopPosition-1,l=g,u=this._stack.fallThrough,this._stack.paused=!1),!u&&l===!1){for(;p>=0&&(l=this._active[p].unhook(v),l!==!0);p--)if(l instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!1,l;p--}for(;p>=0;p--)if(l=this._active[p].unhook(!1),l instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!0,l}else this._handlerFb(this._ident,"UNHOOK",v);this._active=h,this._ident=0}};const _=new a.Params;_.addParam(0),e.DcsHandler=class{constructor(v){this._handler=v,this._data="",this._params=_,this._hitLimit=!1}hook(v){this._params=v.length>1||v.params[0]?v.clone():_,this._data="",this._hitLimit=!1}put(v,g,l){this._hitLimit||(this._data+=(0,r.utf32ToString)(v,g,l),this._data.length>o.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(v){let g=!1;if(this._hitLimit)g=!1;else if(v&&(g=this._handler(this._data,this._params),g instanceof Promise))return g.then(l=>(this._params=_,this._data="",this._hitLimit=!1,l));return this._params=_,this._data="",this._hitLimit=!1,g}}},2015:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EscapeSequenceParser=e.VT500_TRANSITION_TABLE=e.TransitionTable=void 0;const r=t(844),a=t(8742),o=t(6242),h=t(6351);class _{constructor(p){this.table=new Uint8Array(p)}setDefault(p,u){this.table.fill(p<<4|u)}add(p,u,f,y){this.table[u<<8|p]=f<<4|y}addMany(p,u,f,y){for(let b=0;b<p.length;b++)this.table[u<<8|p[b]]=f<<4|y}}e.TransitionTable=_;const v=160;e.VT500_TRANSITION_TABLE=function(){const l=new _(4095),p=Array.apply(null,Array(256)).map((R,C)=>C),u=(R,C)=>p.slice(R,C),f=u(32,127),y=u(0,24);y.push(25),y.push.apply(y,u(28,32));const b=u(0,14);let A;for(A in l.setDefault(1,0),l.addMany(f,0,2,0),b)l.addMany([24,26,153,154],A,3,0),l.addMany(u(128,144),A,3,0),l.addMany(u(144,152),A,3,0),l.add(156,A,0,0),l.add(27,A,11,1),l.add(157,A,4,8),l.addMany([152,158,159],A,0,7),l.add(155,A,11,3),l.add(144,A,11,9);return l.addMany(y,0,3,0),l.addMany(y,1,3,1),l.add(127,1,0,1),l.addMany(y,8,0,8),l.addMany(y,3,3,3),l.add(127,3,0,3),l.addMany(y,4,3,4),l.add(127,4,0,4),l.addMany(y,6,3,6),l.addMany(y,5,3,5),l.add(127,5,0,5),l.addMany(y,2,3,2),l.add(127,2,0,2),l.add(93,1,4,8),l.addMany(f,8,5,8),l.add(127,8,5,8),l.addMany([156,27,24,26,7],8,6,0),l.addMany(u(28,32),8,0,8),l.addMany([88,94,95],1,0,7),l.addMany(f,7,0,7),l.addMany(y,7,0,7),l.add(156,7,0,0),l.add(127,7,0,7),l.add(91,1,11,3),l.addMany(u(64,127),3,7,0),l.addMany(u(48,60),3,8,4),l.addMany([60,61,62,63],3,9,4),l.addMany(u(48,60),4,8,4),l.addMany(u(64,127),4,7,0),l.addMany([60,61,62,63],4,0,6),l.addMany(u(32,64),6,0,6),l.add(127,6,0,6),l.addMany(u(64,127),6,0,0),l.addMany(u(32,48),3,9,5),l.addMany(u(32,48),5,9,5),l.addMany(u(48,64),5,0,6),l.addMany(u(64,127),5,7,0),l.addMany(u(32,48),4,9,5),l.addMany(u(32,48),1,9,2),l.addMany(u(32,48),2,9,2),l.addMany(u(48,127),2,10,0),l.addMany(u(48,80),1,10,0),l.addMany(u(81,88),1,10,0),l.addMany([89,90,92],1,10,0),l.addMany(u(96,127),1,10,0),l.add(80,1,11,9),l.addMany(y,9,0,9),l.add(127,9,0,9),l.addMany(u(28,32),9,0,9),l.addMany(u(32,48),9,9,12),l.addMany(u(48,60),9,8,10),l.addMany([60,61,62,63],9,9,10),l.addMany(y,11,0,11),l.addMany(u(32,128),11,0,11),l.addMany(u(28,32),11,0,11),l.addMany(y,10,0,10),l.add(127,10,0,10),l.addMany(u(28,32),10,0,10),l.addMany(u(48,60),10,8,10),l.addMany([60,61,62,63],10,0,11),l.addMany(u(32,48),10,9,12),l.addMany(y,12,0,12),l.add(127,12,0,12),l.addMany(u(28,32),12,0,12),l.addMany(u(32,48),12,9,12),l.addMany(u(48,64),12,0,11),l.addMany(u(64,127),12,12,13),l.addMany(u(64,127),10,12,13),l.addMany(u(64,127),9,12,13),l.addMany(y,13,13,13),l.addMany(f,13,13,13),l.add(127,13,0,13),l.addMany([27,156,24,26],13,14,0),l.add(v,0,2,0),l.add(v,8,5,8),l.add(v,6,0,6),l.add(v,11,0,11),l.add(v,13,13,13),l}();class g extends r.Disposable{constructor(p=e.VT500_TRANSITION_TABLE){super(),this._transitions=p,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new a.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(u,f,y)=>{},this._executeHandlerFb=u=>{},this._csiHandlerFb=(u,f)=>{},this._escHandlerFb=u=>{},this._errorHandlerFb=u=>u,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,r.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new o.OscParser),this._dcsParser=this.register(new h.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(p,u=[64,126]){let f=0;if(p.prefix){if(p.prefix.length>1)throw new Error("only one byte as prefix supported");if(f=p.prefix.charCodeAt(0),f&&60>f||f>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(p.intermediates){if(p.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let b=0;b<p.intermediates.length;++b){const A=p.intermediates.charCodeAt(b);if(32>A||A>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");f<<=8,f|=A}}if(p.final.length!==1)throw new Error("final must be a single byte");const y=p.final.charCodeAt(0);if(u[0]>y||y>u[1])throw new Error(`final must be in range ${u[0]} .. ${u[1]}`);return f<<=8,f|=y,f}identToString(p){const u=[];for(;p;)u.push(String.fromCharCode(255&p)),p>>=8;return u.reverse().join("")}setPrintHandler(p){this._printHandler=p}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(p,u){const f=this._identifier(p,[48,126]);this._escHandlers[f]===void 0&&(this._escHandlers[f]=[]);const y=this._escHandlers[f];return y.push(u),{dispose:()=>{const b=y.indexOf(u);b!==-1&&y.splice(b,1)}}}clearEscHandler(p){this._escHandlers[this._identifier(p,[48,126])]&&delete this._escHandlers[this._identifier(p,[48,126])]}setEscHandlerFallback(p){this._escHandlerFb=p}setExecuteHandler(p,u){this._executeHandlers[p.charCodeAt(0)]=u}clearExecuteHandler(p){this._executeHandlers[p.charCodeAt(0)]&&delete this._executeHandlers[p.charCodeAt(0)]}setExecuteHandlerFallback(p){this._executeHandlerFb=p}registerCsiHandler(p,u){const f=this._identifier(p);this._csiHandlers[f]===void 0&&(this._csiHandlers[f]=[]);const y=this._csiHandlers[f];return y.push(u),{dispose:()=>{const b=y.indexOf(u);b!==-1&&y.splice(b,1)}}}clearCsiHandler(p){this._csiHandlers[this._identifier(p)]&&delete this._csiHandlers[this._identifier(p)]}setCsiHandlerFallback(p){this._csiHandlerFb=p}registerDcsHandler(p,u){return this._dcsParser.registerHandler(this._identifier(p),u)}clearDcsHandler(p){this._dcsParser.clearHandler(this._identifier(p))}setDcsHandlerFallback(p){this._dcsParser.setHandlerFallback(p)}registerOscHandler(p,u){return this._oscParser.registerHandler(p,u)}clearOscHandler(p){this._oscParser.clearHandler(p)}setOscHandlerFallback(p){this._oscParser.setHandlerFallback(p)}setErrorHandler(p){this._errorHandler=p}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(p,u,f,y,b){this._parseStack.state=p,this._parseStack.handlers=u,this._parseStack.handlerPos=f,this._parseStack.transition=y,this._parseStack.chunkPos=b}parse(p,u,f){let y,b=0,A=0,R=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,R=this._parseStack.chunkPos+1;else{if(f===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const C=this._parseStack.handlers;let L=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(f===!1&&L>-1){for(;L>=0&&(y=C[L](this._params),y!==!0);L--)if(y instanceof Promise)return this._parseStack.handlerPos=L,y}this._parseStack.handlers=[];break;case 4:if(f===!1&&L>-1){for(;L>=0&&(y=C[L](),y!==!0);L--)if(y instanceof Promise)return this._parseStack.handlerPos=L,y}this._parseStack.handlers=[];break;case 6:if(b=p[this._parseStack.chunkPos],y=this._dcsParser.unhook(b!==24&&b!==26,f),y)return y;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(b=p[this._parseStack.chunkPos],y=this._oscParser.end(b!==24&&b!==26,f),y)return y;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,R=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let C=R;C<u;++C){switch(b=p[C],A=this._transitions.table[this.currentState<<8|(b<160?b:v)],A>>4){case 2:for(let P=C+1;;++P){if(P>=u||(b=p[P])<32||b>126&&b<v){this._printHandler(p,C,P),C=P-1;break}if(++P>=u||(b=p[P])<32||b>126&&b<v){this._printHandler(p,C,P),C=P-1;break}if(++P>=u||(b=p[P])<32||b>126&&b<v){this._printHandler(p,C,P),C=P-1;break}if(++P>=u||(b=p[P])<32||b>126&&b<v){this._printHandler(p,C,P),C=P-1;break}}break;case 3:this._executeHandlers[b]?this._executeHandlers[b]():this._executeHandlerFb(b),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:C,code:b,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const L=this._csiHandlers[this._collect<<8|b];let O=L?L.length-1:-1;for(;O>=0&&(y=L[O](this._params),y!==!0);O--)if(y instanceof Promise)return this._preserveStack(3,L,O,A,C),y;O<0&&this._csiHandlerFb(this._collect<<8|b,this._params),this.precedingCodepoint=0;break;case 8:do switch(b){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(b-48)}while(++C<u&&(b=p[C])>47&&b<60);C--;break;case 9:this._collect<<=8,this._collect|=b;break;case 10:const N=this._escHandlers[this._collect<<8|b];let I=N?N.length-1:-1;for(;I>=0&&(y=N[I](),y!==!0);I--)if(y instanceof Promise)return this._preserveStack(4,N,I,A,C),y;I<0&&this._escHandlerFb(this._collect<<8|b),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|b,this._params);break;case 13:for(let P=C+1;;++P)if(P>=u||(b=p[P])===24||b===26||b===27||b>127&&b<v){this._dcsParser.put(p,C,P),C=P-1;break}break;case 14:if(y=this._dcsParser.unhook(b!==24&&b!==26),y)return this._preserveStack(6,[],0,A,C),y;b===27&&(A|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let P=C+1;;P++)if(P>=u||(b=p[P])<32||b>127&&b<v){this._oscParser.put(p,C,P),C=P-1;break}break;case 6:if(y=this._oscParser.end(b!==24&&b!==26),y)return this._preserveStack(5,[],0,A,C),y;b===27&&(A|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&A}}}e.EscapeSequenceParser=g},6242:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OscHandler=e.OscParser=void 0;const r=t(5770),a=t(482),o=[];e.OscParser=class{constructor(){this._state=0,this._active=o,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(h,_){this._handlers[h]===void 0&&(this._handlers[h]=[]);const v=this._handlers[h];return v.push(_),{dispose:()=>{const g=v.indexOf(_);g!==-1&&v.splice(g,1)}}}clearHandler(h){this._handlers[h]&&delete this._handlers[h]}setHandlerFallback(h){this._handlerFb=h}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=o}reset(){if(this._state===2)for(let h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].end(!1);this._stack.paused=!1,this._active=o,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||o,this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].start();else this._handlerFb(this._id,"START")}_put(h,_,v){if(this._active.length)for(let g=this._active.length-1;g>=0;g--)this._active[g].put(h,_,v);else this._handlerFb(this._id,"PUT",(0,a.utf32ToString)(h,_,v))}start(){this.reset(),this._state=1}put(h,_,v){if(this._state!==3){if(this._state===1)for(;_<v;){const g=h[_++];if(g===59){this._state=2,this._start();break}if(g<48||57<g)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+g-48}this._state===2&&v-_>0&&this._put(h,_,v)}}end(h,_=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let v=!1,g=this._active.length-1,l=!1;if(this._stack.paused&&(g=this._stack.loopPosition-1,v=_,l=this._stack.fallThrough,this._stack.paused=!1),!l&&v===!1){for(;g>=0&&(v=this._active[g].end(h),v!==!0);g--)if(v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=g,this._stack.fallThrough=!1,v;g--}for(;g>=0;g--)if(v=this._active[g].end(!1),v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=g,this._stack.fallThrough=!0,v}else this._handlerFb(this._id,"END",h);this._active=o,this._id=-1,this._state=0}}},e.OscHandler=class{constructor(h){this._handler=h,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(h,_,v){this._hitLimit||(this._data+=(0,a.utf32ToString)(h,_,v),this._data.length>r.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(h){let _=!1;if(this._hitLimit)_=!1;else if(h&&(_=this._handler(this._data),_ instanceof Promise))return _.then(v=>(this._data="",this._hitLimit=!1,v));return this._data="",this._hitLimit=!1,_}}},8742:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Params=void 0;const t=2147483647;class r{static fromArray(o){const h=new r;if(!o.length)return h;for(let _=Array.isArray(o[0])?1:0;_<o.length;++_){const v=o[_];if(Array.isArray(v))for(let g=0;g<v.length;++g)h.addSubParam(v[g]);else h.addParam(v)}return h}constructor(o=32,h=32){if(this.maxLength=o,this.maxSubParamsLength=h,h>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(o),this.length=0,this._subParams=new Int32Array(h),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(o),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const o=new r(this.maxLength,this.maxSubParamsLength);return o.params.set(this.params),o.length=this.length,o._subParams.set(this._subParams),o._subParamsLength=this._subParamsLength,o._subParamsIdx.set(this._subParamsIdx),o._rejectDigits=this._rejectDigits,o._rejectSubDigits=this._rejectSubDigits,o._digitIsSub=this._digitIsSub,o}toArray(){const o=[];for(let h=0;h<this.length;++h){o.push(this.params[h]);const _=this._subParamsIdx[h]>>8,v=255&this._subParamsIdx[h];v-_>0&&o.push(Array.prototype.slice.call(this._subParams,_,v))}return o}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(o){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(o<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=o>t?t:o}}addSubParam(o){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(o<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=o>t?t:o,this._subParamsIdx[this.length-1]++}}hasSubParams(o){return(255&this._subParamsIdx[o])-(this._subParamsIdx[o]>>8)>0}getSubParams(o){const h=this._subParamsIdx[o]>>8,_=255&this._subParamsIdx[o];return _-h>0?this._subParams.subarray(h,_):null}getSubParamsAll(){const o={};for(let h=0;h<this.length;++h){const _=this._subParamsIdx[h]>>8,v=255&this._subParamsIdx[h];v-_>0&&(o[h]=this._subParams.slice(_,v))}return o}addDigit(o){let h;if(this._rejectDigits||!(h=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const _=this._digitIsSub?this._subParams:this.params,v=_[h-1];_[h-1]=~v?Math.min(10*v+o,t):o}}e.Params=r},5741:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AddonManager=void 0,e.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let t=this._addons.length-1;t>=0;t--)this._addons[t].instance.dispose()}loadAddon(t,r){const a={instance:r,dispose:r.dispose,isDisposed:!1};this._addons.push(a),r.dispose=()=>this._wrappedAddonDispose(a),r.activate(t)}_wrappedAddonDispose(t){if(t.isDisposed)return;let r=-1;for(let a=0;a<this._addons.length;a++)if(this._addons[a]===t){r=a;break}if(r===-1)throw new Error("Could not dispose an addon that has not been loaded");t.isDisposed=!0,t.dispose.apply(t.instance),this._addons.splice(r,1)}}},8771:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferApiView=void 0;const r=t(3785),a=t(511);e.BufferApiView=class{constructor(o,h){this._buffer=o,this.type=h}init(o){return this._buffer=o,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(o){const h=this._buffer.lines.get(o);if(h)return new r.BufferLineApiView(h)}getNullCell(){return new a.CellData}}},3785:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferLineApiView=void 0;const r=t(511);e.BufferLineApiView=class{constructor(a){this._line=a}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(a,o){if(!(a<0||a>=this._line.length))return o?(this._line.loadCell(a,o),o):this._line.loadCell(a,new r.CellData)}translateToString(a,o,h){return this._line.translateToString(a,o,h)}}},8285:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BufferNamespaceApi=void 0;const r=t(8771),a=t(8460),o=t(844);class h extends o.Disposable{constructor(v){super(),this._core=v,this._onBufferChange=this.register(new a.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new r.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new r.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}e.BufferNamespaceApi=h},7975:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ParserApi=void 0,e.ParserApi=class{constructor(t){this._core=t}registerCsiHandler(t,r){return this._core.registerCsiHandler(t,a=>r(a.toArray()))}addCsiHandler(t,r){return this.registerCsiHandler(t,r)}registerDcsHandler(t,r){return this._core.registerDcsHandler(t,(a,o)=>r(a,o.toArray()))}addDcsHandler(t,r){return this.registerDcsHandler(t,r)}registerEscHandler(t,r){return this._core.registerEscHandler(t,r)}addEscHandler(t,r){return this.registerEscHandler(t,r)}registerOscHandler(t,r){return this._core.registerOscHandler(t,r)}addOscHandler(t,r){return this.registerOscHandler(t,r)}}},7090:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeApi=void 0,e.UnicodeApi=class{constructor(t){this._core=t}register(t){this._core.unicodeService.register(t)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(t){this._core.unicodeService.activeVersion=t}}},744:function(n,e,t){var r=this&&this.__decorate||function(l,p,u,f){var y,b=arguments.length,A=b<3?p:f===null?f=Object.getOwnPropertyDescriptor(p,u):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(l,p,u,f);else for(var R=l.length-1;R>=0;R--)(y=l[R])&&(A=(b<3?y(A):b>3?y(p,u,A):y(p,u))||A);return b>3&&A&&Object.defineProperty(p,u,A),A},a=this&&this.__param||function(l,p){return function(u,f){p(u,f,l)}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferService=e.MINIMUM_ROWS=e.MINIMUM_COLS=void 0;const o=t(8460),h=t(844),_=t(5295),v=t(2585);e.MINIMUM_COLS=2,e.MINIMUM_ROWS=1;let g=e.BufferService=class extends h.Disposable{get buffer(){return this.buffers.active}constructor(l){super(),this.isUserScrolling=!1,this._onResize=this.register(new o.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new o.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(l.rawOptions.cols||0,e.MINIMUM_COLS),this.rows=Math.max(l.rawOptions.rows||0,e.MINIMUM_ROWS),this.buffers=this.register(new _.BufferSet(l,this))}resize(l,p){this.cols=l,this.rows=p,this.buffers.resize(l,p),this._onResize.fire({cols:l,rows:p})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(l,p=!1){const u=this.buffer;let f;f=this._cachedBlankLine,f&&f.length===this.cols&&f.getFg(0)===l.fg&&f.getBg(0)===l.bg||(f=u.getBlankLine(l,p),this._cachedBlankLine=f),f.isWrapped=p;const y=u.ybase+u.scrollTop,b=u.ybase+u.scrollBottom;if(u.scrollTop===0){const A=u.lines.isFull;b===u.lines.length-1?A?u.lines.recycle().copyFrom(f):u.lines.push(f.clone()):u.lines.splice(b+1,0,f.clone()),A?this.isUserScrolling&&(u.ydisp=Math.max(u.ydisp-1,0)):(u.ybase++,this.isUserScrolling||u.ydisp++)}else{const A=b-y+1;u.lines.shiftElements(y+1,A-1,-1),u.lines.set(b,f.clone())}this.isUserScrolling||(u.ydisp=u.ybase),this._onScroll.fire(u.ydisp)}scrollLines(l,p,u){const f=this.buffer;if(l<0){if(f.ydisp===0)return;this.isUserScrolling=!0}else l+f.ydisp>=f.ybase&&(this.isUserScrolling=!1);const y=f.ydisp;f.ydisp=Math.max(Math.min(f.ydisp+l,f.ybase),0),y!==f.ydisp&&(p||this._onScroll.fire(f.ydisp))}};e.BufferService=g=r([a(0,v.IOptionsService)],g)},7994:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CharsetService=void 0,e.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(t){this.glevel=t,this.charset=this._charsets[t]}setgCharset(t,r){this._charsets[t]=r,this.glevel===t&&(this.charset=r)}}},1753:function(n,e,t){var r=this&&this.__decorate||function(f,y,b,A){var R,C=arguments.length,L=C<3?y:A===null?A=Object.getOwnPropertyDescriptor(y,b):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(f,y,b,A);else for(var O=f.length-1;O>=0;O--)(R=f[O])&&(L=(C<3?R(L):C>3?R(y,b,L):R(y,b))||L);return C>3&&L&&Object.defineProperty(y,b,L),L},a=this&&this.__param||function(f,y){return function(b,A){y(b,A,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreMouseService=void 0;const o=t(2585),h=t(8460),_=t(844),v={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:f=>f.button!==4&&f.action===1&&(f.ctrl=!1,f.alt=!1,f.shift=!1,!0)},VT200:{events:19,restrict:f=>f.action!==32},DRAG:{events:23,restrict:f=>f.action!==32||f.button!==3},ANY:{events:31,restrict:f=>!0}};function g(f,y){let b=(f.ctrl?16:0)|(f.shift?4:0)|(f.alt?8:0);return f.button===4?(b|=64,b|=f.action):(b|=3&f.button,4&f.button&&(b|=64),8&f.button&&(b|=128),f.action===32?b|=32:f.action!==0||y||(b|=3)),b}const l=String.fromCharCode,p={DEFAULT:f=>{const y=[g(f,!1)+32,f.col+32,f.row+32];return y[0]>255||y[1]>255||y[2]>255?"":`\x1B[M${l(y[0])}${l(y[1])}${l(y[2])}`},SGR:f=>{const y=f.action===0&&f.button!==4?"m":"M";return`\x1B[<${g(f,!0)};${f.col};${f.row}${y}`},SGR_PIXELS:f=>{const y=f.action===0&&f.button!==4?"m":"M";return`\x1B[<${g(f,!0)};${f.x};${f.y}${y}`}};let u=e.CoreMouseService=class extends _.Disposable{constructor(f,y){super(),this._bufferService=f,this._coreService=y,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new h.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const b of Object.keys(v))this.addProtocol(b,v[b]);for(const b of Object.keys(p))this.addEncoding(b,p[b]);this.reset()}addProtocol(f,y){this._protocols[f]=y}addEncoding(f,y){this._encodings[f]=y}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(f){if(!this._protocols[f])throw new Error(`unknown protocol "${f}"`);this._activeProtocol=f,this._onProtocolChange.fire(this._protocols[f].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(f){if(!this._encodings[f])throw new Error(`unknown encoding "${f}"`);this._activeEncoding=f}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(f){if(f.col<0||f.col>=this._bufferService.cols||f.row<0||f.row>=this._bufferService.rows||f.button===4&&f.action===32||f.button===3&&f.action!==32||f.button!==4&&(f.action===2||f.action===3)||(f.col++,f.row++,f.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,f,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(f))return!1;const y=this._encodings[this._activeEncoding](f);return y&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(y):this._coreService.triggerDataEvent(y,!0)),this._lastEvent=f,!0}explainEvents(f){return{down:!!(1&f),up:!!(2&f),drag:!!(4&f),move:!!(8&f),wheel:!!(16&f)}}_equalEvents(f,y,b){if(b){if(f.x!==y.x||f.y!==y.y)return!1}else if(f.col!==y.col||f.row!==y.row)return!1;return f.button===y.button&&f.action===y.action&&f.ctrl===y.ctrl&&f.alt===y.alt&&f.shift===y.shift}};e.CoreMouseService=u=r([a(0,o.IBufferService),a(1,o.ICoreService)],u)},6975:function(n,e,t){var r=this&&this.__decorate||function(u,f,y,b){var A,R=arguments.length,C=R<3?f:b===null?b=Object.getOwnPropertyDescriptor(f,y):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(u,f,y,b);else for(var L=u.length-1;L>=0;L--)(A=u[L])&&(C=(R<3?A(C):R>3?A(f,y,C):A(f,y))||C);return R>3&&C&&Object.defineProperty(f,y,C),C},a=this&&this.__param||function(u,f){return function(y,b){f(y,b,u)}};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreService=void 0;const o=t(1439),h=t(8460),_=t(844),v=t(2585),g=Object.freeze({insertMode:!1}),l=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let p=e.CoreService=class extends _.Disposable{constructor(u,f,y){super(),this._bufferService=u,this._logService=f,this._optionsService=y,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new h.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new h.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,o.clone)(g),this.decPrivateModes=(0,o.clone)(l)}reset(){this.modes=(0,o.clone)(g),this.decPrivateModes=(0,o.clone)(l)}triggerDataEvent(u,f=!1){if(this._optionsService.rawOptions.disableStdin)return;const y=this._bufferService.buffer;f&&this._optionsService.rawOptions.scrollOnUserInput&&y.ybase!==y.ydisp&&this._onRequestScrollToBottom.fire(),f&&this._onUserInput.fire(),this._logService.debug(`sending data "${u}"`,()=>u.split("").map(b=>b.charCodeAt(0))),this._onData.fire(u)}triggerBinaryEvent(u){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${u}"`,()=>u.split("").map(f=>f.charCodeAt(0))),this._onBinary.fire(u))}};e.CoreService=p=r([a(0,v.IBufferService),a(1,v.ILogService),a(2,v.IOptionsService)],p)},9074:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DecorationService=void 0;const r=t(8055),a=t(8460),o=t(844),h=t(6106);let _=0,v=0;class g extends o.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new h.SortedList(u=>u==null?void 0:u.marker.line),this._onDecorationRegistered=this.register(new a.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new a.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,o.toDisposable)(()=>this.reset()))}registerDecoration(u){if(u.marker.isDisposed)return;const f=new l(u);if(f){const y=f.marker.onDispose(()=>f.dispose());f.onDispose(()=>{f&&(this._decorations.delete(f)&&this._onDecorationRemoved.fire(f),y.dispose())}),this._decorations.insert(f),this._onDecorationRegistered.fire(f)}return f}reset(){for(const u of this._decorations.values())u.dispose();this._decorations.clear()}*getDecorationsAtCell(u,f,y){var b,A,R;let C=0,L=0;for(const O of this._decorations.getKeyIterator(f))C=(b=O.options.x)!==null&&b!==void 0?b:0,L=C+((A=O.options.width)!==null&&A!==void 0?A:1),u>=C&&u<L&&(!y||((R=O.options.layer)!==null&&R!==void 0?R:"bottom")===y)&&(yield O)}forEachDecorationAtCell(u,f,y,b){this._decorations.forEachByKey(f,A=>{var R,C,L;_=(R=A.options.x)!==null&&R!==void 0?R:0,v=_+((C=A.options.width)!==null&&C!==void 0?C:1),u>=_&&u<v&&(!y||((L=A.options.layer)!==null&&L!==void 0?L:"bottom")===y)&&b(A)})}}e.DecorationService=g;class l extends o.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=r.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=r.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(u){super(),this.options=u,this.onRenderEmitter=this.register(new a.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new a.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=u.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InstantiationService=e.ServiceCollection=void 0;const r=t(2585),a=t(8343);class o{constructor(..._){this._entries=new Map;for(const[v,g]of _)this.set(v,g)}set(_,v){const g=this._entries.get(_);return this._entries.set(_,v),g}forEach(_){for(const[v,g]of this._entries.entries())_(v,g)}has(_){return this._entries.has(_)}get(_){return this._entries.get(_)}}e.ServiceCollection=o,e.InstantiationService=class{constructor(){this._services=new o,this._services.set(r.IInstantiationService,this)}setService(h,_){this._services.set(h,_)}getService(h){return this._services.get(h)}createInstance(h,..._){const v=(0,a.getServiceDependencies)(h).sort((p,u)=>p.index-u.index),g=[];for(const p of v){const u=this._services.get(p.id);if(!u)throw new Error(`[createInstance] ${h.name} depends on UNKNOWN service ${p.id}.`);g.push(u)}const l=v.length>0?v[0].index:_.length;if(_.length!==l)throw new Error(`[createInstance] First service dependency of ${h.name} at position ${l+1} conflicts with ${_.length} static arguments`);return new h(..._,...g)}}},7866:function(n,e,t){var r=this&&this.__decorate||function(l,p,u,f){var y,b=arguments.length,A=b<3?p:f===null?f=Object.getOwnPropertyDescriptor(p,u):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(l,p,u,f);else for(var R=l.length-1;R>=0;R--)(y=l[R])&&(A=(b<3?y(A):b>3?y(p,u,A):y(p,u))||A);return b>3&&A&&Object.defineProperty(p,u,A),A},a=this&&this.__param||function(l,p){return function(u,f){p(u,f,l)}};Object.defineProperty(e,"__esModule",{value:!0}),e.traceCall=e.setTraceLogger=e.LogService=void 0;const o=t(844),h=t(2585),_={trace:h.LogLevelEnum.TRACE,debug:h.LogLevelEnum.DEBUG,info:h.LogLevelEnum.INFO,warn:h.LogLevelEnum.WARN,error:h.LogLevelEnum.ERROR,off:h.LogLevelEnum.OFF};let v,g=e.LogService=class extends o.Disposable{get logLevel(){return this._logLevel}constructor(l){super(),this._optionsService=l,this._logLevel=h.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),v=this}_updateLogLevel(){this._logLevel=_[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(l){for(let p=0;p<l.length;p++)typeof l[p]=="function"&&(l[p]=l[p]())}_log(l,p,u){this._evalLazyOptionalParams(u),l.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+p,...u)}trace(l,...p){var u,f;this._logLevel<=h.LogLevelEnum.TRACE&&this._log((f=(u=this._optionsService.options.logger)===null||u===void 0?void 0:u.trace.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.log,l,p)}debug(l,...p){var u,f;this._logLevel<=h.LogLevelEnum.DEBUG&&this._log((f=(u=this._optionsService.options.logger)===null||u===void 0?void 0:u.debug.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.log,l,p)}info(l,...p){var u,f;this._logLevel<=h.LogLevelEnum.INFO&&this._log((f=(u=this._optionsService.options.logger)===null||u===void 0?void 0:u.info.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.info,l,p)}warn(l,...p){var u,f;this._logLevel<=h.LogLevelEnum.WARN&&this._log((f=(u=this._optionsService.options.logger)===null||u===void 0?void 0:u.warn.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.warn,l,p)}error(l,...p){var u,f;this._logLevel<=h.LogLevelEnum.ERROR&&this._log((f=(u=this._optionsService.options.logger)===null||u===void 0?void 0:u.error.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.error,l,p)}};e.LogService=g=r([a(0,h.IOptionsService)],g),e.setTraceLogger=function(l){v=l},e.traceCall=function(l,p,u){if(typeof u.value!="function")throw new Error("not supported");const f=u.value;u.value=function(...y){if(v.logLevel!==h.LogLevelEnum.TRACE)return f.apply(this,y);v.trace(`GlyphRenderer#${f.name}(${y.map(A=>JSON.stringify(A)).join(", ")})`);const b=f.apply(this,y);return v.trace(`GlyphRenderer#${f.name} return`,b),b}}},7302:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionsService=e.DEFAULT_OPTIONS=void 0;const r=t(8460),a=t(844),o=t(6114);e.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:o.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const h=["normal","bold","100","200","300","400","500","600","700","800","900"];class _ extends a.Disposable{constructor(g){super(),this._onOptionChange=this.register(new r.EventEmitter),this.onOptionChange=this._onOptionChange.event;const l=Object.assign({},e.DEFAULT_OPTIONS);for(const p in g)if(p in l)try{const u=g[p];l[p]=this._sanitizeAndValidateOption(p,u)}catch(u){console.error(u)}this.rawOptions=l,this.options=Object.assign({},l),this._setupOptions()}onSpecificOptionChange(g,l){return this.onOptionChange(p=>{p===g&&l(this.rawOptions[g])})}onMultipleOptionChange(g,l){return this.onOptionChange(p=>{g.indexOf(p)!==-1&&l()})}_setupOptions(){const g=p=>{if(!(p in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);return this.rawOptions[p]},l=(p,u)=>{if(!(p in e.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);u=this._sanitizeAndValidateOption(p,u),this.rawOptions[p]!==u&&(this.rawOptions[p]=u,this._onOptionChange.fire(p))};for(const p in this.rawOptions){const u={get:g.bind(this,p),set:l.bind(this,p)};Object.defineProperty(this.options,p,u)}}_sanitizeAndValidateOption(g,l){switch(g){case"cursorStyle":if(l||(l=e.DEFAULT_OPTIONS[g]),!function(p){return p==="block"||p==="underline"||p==="bar"}(l))throw new Error(`"${l}" is not a valid value for ${g}`);break;case"wordSeparator":l||(l=e.DEFAULT_OPTIONS[g]);break;case"fontWeight":case"fontWeightBold":if(typeof l=="number"&&1<=l&&l<=1e3)break;l=h.includes(l)?l:e.DEFAULT_OPTIONS[g];break;case"cursorWidth":l=Math.floor(l);case"lineHeight":case"tabStopWidth":if(l<1)throw new Error(`${g} cannot be less than 1, value: ${l}`);break;case"minimumContrastRatio":l=Math.max(1,Math.min(21,Math.round(10*l)/10));break;case"scrollback":if((l=Math.min(l,4294967295))<0)throw new Error(`${g} cannot be less than 0, value: ${l}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(l<=0)throw new Error(`${g} cannot be less than or equal to 0, value: ${l}`);break;case"rows":case"cols":if(!l&&l!==0)throw new Error(`${g} must be numeric, value: ${l}`);break;case"windowsPty":l=l??{}}return l}}e.OptionsService=_},2660:function(n,e,t){var r=this&&this.__decorate||function(_,v,g,l){var p,u=arguments.length,f=u<3?v:l===null?l=Object.getOwnPropertyDescriptor(v,g):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(_,v,g,l);else for(var y=_.length-1;y>=0;y--)(p=_[y])&&(f=(u<3?p(f):u>3?p(v,g,f):p(v,g))||f);return u>3&&f&&Object.defineProperty(v,g,f),f},a=this&&this.__param||function(_,v){return function(g,l){v(g,l,_)}};Object.defineProperty(e,"__esModule",{value:!0}),e.OscLinkService=void 0;const o=t(2585);let h=e.OscLinkService=class{constructor(_){this._bufferService=_,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(_){const v=this._bufferService.buffer;if(_.id===void 0){const y=v.addMarker(v.ybase+v.y),b={data:_,id:this._nextId++,lines:[y]};return y.onDispose(()=>this._removeMarkerFromLink(b,y)),this._dataByLinkId.set(b.id,b),b.id}const g=_,l=this._getEntryIdKey(g),p=this._entriesWithId.get(l);if(p)return this.addLineToLink(p.id,v.ybase+v.y),p.id;const u=v.addMarker(v.ybase+v.y),f={id:this._nextId++,key:this._getEntryIdKey(g),data:g,lines:[u]};return u.onDispose(()=>this._removeMarkerFromLink(f,u)),this._entriesWithId.set(f.key,f),this._dataByLinkId.set(f.id,f),f.id}addLineToLink(_,v){const g=this._dataByLinkId.get(_);if(g&&g.lines.every(l=>l.line!==v)){const l=this._bufferService.buffer.addMarker(v);g.lines.push(l),l.onDispose(()=>this._removeMarkerFromLink(g,l))}}getLinkData(_){var v;return(v=this._dataByLinkId.get(_))===null||v===void 0?void 0:v.data}_getEntryIdKey(_){return`${_.id};;${_.uri}`}_removeMarkerFromLink(_,v){const g=_.lines.indexOf(v);g!==-1&&(_.lines.splice(g,1),_.lines.length===0&&(_.data.id!==void 0&&this._entriesWithId.delete(_.key),this._dataByLinkId.delete(_.id)))}};e.OscLinkService=h=r([a(0,o.IBufferService)],h)},8343:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createDecorator=e.getServiceDependencies=e.serviceRegistry=void 0;const t="di$target",r="di$dependencies";e.serviceRegistry=new Map,e.getServiceDependencies=function(a){return a[r]||[]},e.createDecorator=function(a){if(e.serviceRegistry.has(a))return e.serviceRegistry.get(a);const o=function(h,_,v){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(g,l,p){l[t]===l?l[r].push({id:g,index:p}):(l[r]=[{id:g,index:p}],l[t]=l)})(o,h,v)};return o.toString=()=>a,e.serviceRegistry.set(a,o),o}},2585:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IDecorationService=e.IUnicodeService=e.IOscLinkService=e.IOptionsService=e.ILogService=e.LogLevelEnum=e.IInstantiationService=e.ICharsetService=e.ICoreService=e.ICoreMouseService=e.IBufferService=void 0;const r=t(8343);var a;e.IBufferService=(0,r.createDecorator)("BufferService"),e.ICoreMouseService=(0,r.createDecorator)("CoreMouseService"),e.ICoreService=(0,r.createDecorator)("CoreService"),e.ICharsetService=(0,r.createDecorator)("CharsetService"),e.IInstantiationService=(0,r.createDecorator)("InstantiationService"),function(o){o[o.TRACE=0]="TRACE",o[o.DEBUG=1]="DEBUG",o[o.INFO=2]="INFO",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.OFF=5]="OFF"}(a||(e.LogLevelEnum=a={})),e.ILogService=(0,r.createDecorator)("LogService"),e.IOptionsService=(0,r.createDecorator)("OptionsService"),e.IOscLinkService=(0,r.createDecorator)("OscLinkService"),e.IUnicodeService=(0,r.createDecorator)("UnicodeService"),e.IDecorationService=(0,r.createDecorator)("DecorationService")},1480:(n,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UnicodeService=void 0;const r=t(8460),a=t(225);e.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new r.EventEmitter,this.onChange=this._onChange.event;const o=new a.UnicodeV6;this.register(o),this._active=o.version,this._activeProvider=o}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(o){if(!this._providers[o])throw new Error(`unknown Unicode version "${o}"`);this._active=o,this._activeProvider=this._providers[o],this._onChange.fire(o)}register(o){this._providers[o.version]=o}wcwidth(o){return this._activeProvider.wcwidth(o)}getStringCellWidth(o){let h=0;const _=o.length;for(let v=0;v<_;++v){let g=o.charCodeAt(v);if(55296<=g&&g<=56319){if(++v>=_)return h+this.wcwidth(g);const l=o.charCodeAt(v);56320<=l&&l<=57343?g=1024*(g-55296)+l-56320+65536:h+=this.wcwidth(l)}h+=this.wcwidth(g)}return h}}}},m={};function w(n){var e=m[n];if(e!==void 0)return e.exports;var t=m[n]={exports:{}};return s[n].call(t.exports,t,t.exports,w),t.exports}var d={};return(()=>{var n=d;Object.defineProperty(n,"__esModule",{value:!0}),n.Terminal=void 0;const e=w(9042),t=w(3236),r=w(844),a=w(5741),o=w(8285),h=w(7975),_=w(7090),v=["cols","rows"];class g extends r.Disposable{constructor(p){super(),this._core=this.register(new t.Terminal(p)),this._addonManager=this.register(new a.AddonManager),this._publicOptions=Object.assign({},this._core.options);const u=y=>this._core.options[y],f=(y,b)=>{this._checkReadonlyOptions(y),this._core.options[y]=b};for(const y in this._core.options){const b={get:u.bind(this,y),set:f.bind(this,y)};Object.defineProperty(this._publicOptions,y,b)}}_checkReadonlyOptions(p){if(v.includes(p))throw new Error(`Option "${p}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new _.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new o.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const p=this._core.coreService.decPrivateModes;let u="none";switch(this._core.coreMouseService.activeProtocol){case"X10":u="x10";break;case"VT200":u="vt200";break;case"DRAG":u="drag";break;case"ANY":u="any"}return{applicationCursorKeysMode:p.applicationCursorKeys,applicationKeypadMode:p.applicationKeypad,bracketedPasteMode:p.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:u,originMode:p.origin,reverseWraparoundMode:p.reverseWraparound,sendFocusMode:p.sendFocus,wraparoundMode:p.wraparound}}get options(){return this._publicOptions}set options(p){for(const u in p)this._publicOptions[u]=p[u]}blur(){this._core.blur()}focus(){this._core.focus()}resize(p,u){this._verifyIntegers(p,u),this._core.resize(p,u)}open(p){this._core.open(p)}attachCustomKeyEventHandler(p){this._core.attachCustomKeyEventHandler(p)}registerLinkProvider(p){return this._core.registerLinkProvider(p)}registerCharacterJoiner(p){return this._checkProposedApi(),this._core.registerCharacterJoiner(p)}deregisterCharacterJoiner(p){this._checkProposedApi(),this._core.deregisterCharacterJoiner(p)}registerMarker(p=0){return this._verifyIntegers(p),this._core.registerMarker(p)}registerDecoration(p){var u,f,y;return this._checkProposedApi(),this._verifyPositiveIntegers((u=p.x)!==null&&u!==void 0?u:0,(f=p.width)!==null&&f!==void 0?f:0,(y=p.height)!==null&&y!==void 0?y:0),this._core.registerDecoration(p)}hasSelection(){return this._core.hasSelection()}select(p,u,f){this._verifyIntegers(p,u,f),this._core.select(p,u,f)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(p,u){this._verifyIntegers(p,u),this._core.selectLines(p,u)}dispose(){super.dispose()}scrollLines(p){this._verifyIntegers(p),this._core.scrollLines(p)}scrollPages(p){this._verifyIntegers(p),this._core.scrollPages(p)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(p){this._verifyIntegers(p),this._core.scrollToLine(p)}clear(){this._core.clear()}write(p,u){this._core.write(p,u)}writeln(p,u){this._core.write(p),this._core.write(`\r
`,u)}paste(p){this._core.paste(p)}refresh(p,u){this._verifyIntegers(p,u),this._core.refresh(p,u)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(p){this._addonManager.loadAddon(this,p)}static get strings(){return e}_verifyIntegers(...p){for(const u of p)if(u===1/0||isNaN(u)||u%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...p){for(const u of p)if(u&&(u===1/0||isNaN(u)||u%1!=0||u<0))throw new Error("This API only accepts positive integers")}}n.Terminal=g})(),d})())})(ya);var Eh=ya.exports,Sa={exports:{}};(function(i,c){(function(s,m){i.exports=m()})(self,()=>(()=>{var s={};return(()=>{var m=s;Object.defineProperty(m,"__esModule",{value:!0}),m.FitAddon=void 0,m.FitAddon=class{activate(w){this._terminal=w}dispose(){}fit(){const w=this.proposeDimensions();if(!w||!this._terminal||isNaN(w.cols)||isNaN(w.rows))return;const d=this._terminal._core;this._terminal.rows===w.rows&&this._terminal.cols===w.cols||(d._renderService.clear(),this._terminal.resize(w.cols,w.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const w=this._terminal._core,d=w._renderService.dimensions;if(d.css.cell.width===0||d.css.cell.height===0)return;const n=this._terminal.options.scrollback===0?0:w.viewport.scrollBarWidth,e=window.getComputedStyle(this._terminal.element.parentElement),t=parseInt(e.getPropertyValue("height")),r=Math.max(0,parseInt(e.getPropertyValue("width"))),a=window.getComputedStyle(this._terminal.element),o=t-(parseInt(a.getPropertyValue("padding-top"))+parseInt(a.getPropertyValue("padding-bottom"))),h=r-(parseInt(a.getPropertyValue("padding-right"))+parseInt(a.getPropertyValue("padding-left")))-n;return{cols:Math.max(2,Math.floor(h/d.css.cell.width)),rows:Math.max(1,Math.floor(o/d.css.cell.height))}}}})(),s})())})(Sa);var Ah=Sa.exports,Ca={exports:{}};(function(i,c){(function(s,m){i.exports=m()})(self,()=>(()=>{var s={345:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=t=>(this._listeners.push(t),{dispose:()=>{if(!this._disposed){for(let r=0;r<this._listeners.length;r++)if(this._listeners[r]===t)return void this._listeners.splice(r,1)}}})),this._event}fire(t,r){const a=[];for(let o=0;o<this._listeners.length;o++)a.push(this._listeners[o]);for(let o=0;o<a.length;o++)a[o].call(void 0,t,r)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},e.forwardEvent=function(t,r){return t(a=>r.fire(a))}},859:(n,e)=>{function t(r){for(const a of r)a.dispose();r.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.MutableDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const r of this._disposables)r.dispose();this._disposables.length=0}register(r){return this._disposables.push(r),r}unregister(r){const a=this._disposables.indexOf(r);a!==-1&&this._disposables.splice(a,1)}},e.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(r){var a;this._isDisposed||r===this._value||((a=this._value)===null||a===void 0||a.dispose(),this._value=r)}clear(){this.value=void 0}dispose(){var r;this._isDisposed=!0,(r=this._value)===null||r===void 0||r.dispose(),this._value=void 0}},e.toDisposable=function(r){return{dispose:r}},e.disposeArray=t,e.getDisposeArrayDisposable=function(r){return{dispose:()=>t(r)}}}},m={};function w(n){var e=m[n];if(e!==void 0)return e.exports;var t=m[n]={exports:{}};return s[n](t,t.exports,w),t.exports}var d={};return(()=>{var n=d;Object.defineProperty(n,"__esModule",{value:!0}),n.SearchAddon=void 0;const e=w(345),t=w(859),r=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";class a extends t.Disposable{constructor(h){var _;super(),this._highlightedLines=new Set,this._highlightDecorations=[],this._selectedDecoration=this.register(new t.MutableDisposable),this._linesCacheTimeoutId=0,this._onDidChangeResults=this.register(new e.EventEmitter),this.onDidChangeResults=this._onDidChangeResults.event,this._highlightLimit=(_=h==null?void 0:h.highlightLimit)!==null&&_!==void 0?_:1e3}activate(h){this._terminal=h,this.register(this._terminal.onWriteParsed(()=>this._updateMatches())),this.register(this._terminal.onResize(()=>this._updateMatches())),this.register((0,t.toDisposable)(()=>this.clearDecorations()))}_updateMatches(){var h;this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&(!((h=this._lastSearchOptions)===null||h===void 0)&&h.decorations)&&(this._highlightTimeout=setTimeout(()=>{const _=this._cachedSearchTerm;this._cachedSearchTerm=void 0,this.findPrevious(_,Object.assign(Object.assign({},this._lastSearchOptions),{incremental:!0,noScroll:!0}))},200))}clearDecorations(h){this._selectedDecoration.clear(),(0,t.disposeArray)(this._highlightDecorations),this._highlightDecorations=[],this._highlightedLines.clear(),h||(this._cachedSearchTerm=void 0)}findNext(h,_){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");this._lastSearchOptions=_,_!=null&&_.decorations&&(this._cachedSearchTerm!==void 0&&h===this._cachedSearchTerm||this._highlightAllMatches(h,_));const v=this._findNextAndSelect(h,_);return this._fireResults(_),this._cachedSearchTerm=h,v}_highlightAllMatches(h,_){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!h||h.length===0)return void this.clearDecorations();_=_||{},this.clearDecorations(!0);const v=[];let g,l=this._find(h,0,0,_);for(;l&&((g==null?void 0:g.row)!==l.row||(g==null?void 0:g.col)!==l.col)&&!(v.length>=this._highlightLimit);)g=l,v.push(g),l=this._find(h,g.col+g.term.length>=this._terminal.cols?g.row+1:g.row,g.col+g.term.length>=this._terminal.cols?0:g.col+1,_);for(const p of v){const u=this._createResultDecoration(p,_.decorations);u&&(this._highlightedLines.add(u.marker.line),this._highlightDecorations.push({decoration:u,match:p,dispose(){u.dispose()}}))}}_find(h,_,v,g){var l;if(!this._terminal||!h||h.length===0)return(l=this._terminal)===null||l===void 0||l.clearSelection(),void this.clearDecorations();if(v>this._terminal.cols)throw new Error(`Invalid col: ${v} to search in terminal of ${this._terminal.cols} cols`);let p;this._initLinesCache();const u={startRow:_,startCol:v};if(p=this._findInLine(h,u,g),!p)for(let f=_+1;f<this._terminal.buffer.active.baseY+this._terminal.rows&&(u.startRow=f,u.startCol=0,p=this._findInLine(h,u,g),!p);f++);return p}_findNextAndSelect(h,_){var v;if(!this._terminal||!h||h.length===0)return(v=this._terminal)===null||v===void 0||v.clearSelection(),this.clearDecorations(),!1;const g=this._terminal.getSelectionPosition();this._terminal.clearSelection();let l=0,p=0;g&&(this._cachedSearchTerm===h?(l=g.end.x,p=g.end.y):(l=g.start.x,p=g.start.y)),this._initLinesCache();const u={startRow:p,startCol:l};let f=this._findInLine(h,u,_);if(!f)for(let y=p+1;y<this._terminal.buffer.active.baseY+this._terminal.rows&&(u.startRow=y,u.startCol=0,f=this._findInLine(h,u,_),!f);y++);if(!f&&p!==0)for(let y=0;y<p&&(u.startRow=y,u.startCol=0,f=this._findInLine(h,u,_),!f);y++);return!f&&g&&(u.startRow=g.start.y,u.startCol=0,f=this._findInLine(h,u,_)),this._selectResult(f,_==null?void 0:_.decorations,_==null?void 0:_.noScroll)}findPrevious(h,_){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");this._lastSearchOptions=_,_!=null&&_.decorations&&(this._cachedSearchTerm!==void 0&&h===this._cachedSearchTerm||this._highlightAllMatches(h,_));const v=this._findPreviousAndSelect(h,_);return this._fireResults(_),this._cachedSearchTerm=h,v}_fireResults(h){if(h!=null&&h.decorations){let _=-1;if(this._selectedDecoration.value){const v=this._selectedDecoration.value.match;for(let g=0;g<this._highlightDecorations.length;g++){const l=this._highlightDecorations[g].match;if(l.row===v.row&&l.col===v.col&&l.size===v.size){_=g;break}}}this._onDidChangeResults.fire({resultIndex:_,resultCount:this._highlightDecorations.length})}}_findPreviousAndSelect(h,_){var v;if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!this._terminal||!h||h.length===0)return(v=this._terminal)===null||v===void 0||v.clearSelection(),this.clearDecorations(),!1;const g=this._terminal.getSelectionPosition();this._terminal.clearSelection();let l=this._terminal.buffer.active.baseY+this._terminal.rows-1,p=this._terminal.cols;const u=!0;this._initLinesCache();const f={startRow:l,startCol:p};let y;if(g&&(f.startRow=l=g.start.y,f.startCol=p=g.start.x,this._cachedSearchTerm!==h&&(y=this._findInLine(h,f,_,!1),y||(f.startRow=l=g.end.y,f.startCol=p=g.end.x))),y||(y=this._findInLine(h,f,_,u)),!y){f.startCol=Math.max(f.startCol,this._terminal.cols);for(let b=l-1;b>=0&&(f.startRow=b,y=this._findInLine(h,f,_,u),!y);b--);}if(!y&&l!==this._terminal.buffer.active.baseY+this._terminal.rows-1)for(let b=this._terminal.buffer.active.baseY+this._terminal.rows-1;b>=l&&(f.startRow=b,y=this._findInLine(h,f,_,u),!y);b--);return this._selectResult(y,_==null?void 0:_.decorations,_==null?void 0:_.noScroll)}_initLinesCache(){const h=this._terminal;this._linesCache||(this._linesCache=new Array(h.buffer.active.length),this._cursorMoveListener=h.onCursorMove(()=>this._destroyLinesCache()),this._resizeListener=h.onResize(()=>this._destroyLinesCache())),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(h,_,v){return(h===0||r.includes(_[h-1]))&&(h+v.length===_.length||r.includes(_[h+v.length]))}_findInLine(h,_,v={},g=!1){var l;const p=this._terminal,u=_.startRow,f=_.startCol,y=p.buffer.active.getLine(u);if(y!=null&&y.isWrapped)return g?void(_.startCol+=p.cols):(_.startRow--,_.startCol+=p.cols,this._findInLine(h,_,v));let b=(l=this._linesCache)===null||l===void 0?void 0:l[u];b||(b=this._translateBufferLineToStringWithWrap(u,!0),this._linesCache&&(this._linesCache[u]=b));const[A,R]=b,C=this._bufferColsToStringOffset(u,f),L=v.caseSensitive?h:h.toLowerCase(),O=v.caseSensitive?A:A.toLowerCase();let N=-1;if(v.regex){const I=RegExp(L,"g");let P;if(g)for(;P=I.exec(O.slice(0,C));)N=I.lastIndex-P[0].length,h=P[0],I.lastIndex-=h.length-1;else P=I.exec(O.slice(C)),P&&P[0].length>0&&(N=C+(I.lastIndex-P[0].length),h=P[0])}else g?C-L.length>=0&&(N=O.lastIndexOf(L,C-L.length)):N=O.indexOf(L,C);if(N>=0){if(v.wholeWord&&!this._isWholeWord(N,O,h))return;let I=0;for(;I<R.length-1&&N>=R[I+1];)I++;let P=I;for(;P<R.length-1&&N+h.length>=R[P+1];)P++;const V=N-R[I],G=N+h.length-R[P],re=this._stringLengthToBufferSize(u+I,V);return{term:h,col:re,row:u+I,size:this._stringLengthToBufferSize(u+P,G)-re+p.cols*(P-I)}}}_stringLengthToBufferSize(h,_){const v=this._terminal.buffer.active.getLine(h);if(!v)return 0;for(let g=0;g<_;g++){const l=v.getCell(g);if(!l)break;const p=l.getChars();p.length>1&&(_-=p.length-1);const u=v.getCell(g+1);u&&u.getWidth()===0&&_++}return _}_bufferColsToStringOffset(h,_){const v=this._terminal;let g=h,l=0,p=v.buffer.active.getLine(g);for(;_>0&&p;){for(let u=0;u<_&&u<v.cols;u++){const f=p.getCell(u);if(!f)break;f.getWidth()&&(l+=f.getCode()===0?1:f.getChars().length)}if(g++,p=v.buffer.active.getLine(g),p&&!p.isWrapped)break;_-=v.cols}return l}_translateBufferLineToStringWithWrap(h,_){var v;const g=this._terminal,l=[],p=[0];let u=g.buffer.active.getLine(h);for(;u;){const f=g.buffer.active.getLine(h+1),y=!!f&&f.isWrapped;let b=u.translateToString(!y&&_);if(y&&f){const A=u.getCell(u.length-1);A&&A.getCode()===0&&A.getWidth()===1&&((v=f.getCell(0))===null||v===void 0?void 0:v.getWidth())===2&&(b=b.slice(0,-1))}if(l.push(b),!y)break;p.push(p[p.length-1]+b.length),h++,u=f}return[l.join(""),p]}_selectResult(h,_,v){const g=this._terminal;if(this._selectedDecoration.clear(),!h)return g.clearSelection(),!1;if(g.select(h.col,h.row,h.size),_){const l=g.registerMarker(-g.buffer.active.baseY-g.buffer.active.cursorY+h.row);if(l){const p=g.registerDecoration({marker:l,x:h.col,width:h.size,backgroundColor:_.activeMatchBackground,layer:"top",overviewRulerOptions:{color:_.activeMatchColorOverviewRuler}});if(p){const u=[];u.push(l),u.push(p.onRender(f=>this._applyStyles(f,_.activeMatchBorder,!0))),u.push(p.onDispose(()=>(0,t.disposeArray)(u))),this._selectedDecoration.value={decoration:p,match:h,dispose(){p.dispose()}}}}}if(!v&&(h.row>=g.buffer.active.viewportY+g.rows||h.row<g.buffer.active.viewportY)){let l=h.row-g.buffer.active.viewportY;l-=Math.floor(g.rows/2),g.scrollLines(l)}return!0}_applyStyles(h,_,v){h.classList.contains("xterm-find-result-decoration")||(h.classList.add("xterm-find-result-decoration"),_&&(h.style.outline=`1px solid ${_}`)),v&&h.classList.add("xterm-find-active-result-decoration")}_createResultDecoration(h,_){const v=this._terminal,g=v.registerMarker(-v.buffer.active.baseY-v.buffer.active.cursorY+h.row);if(!g)return;const l=v.registerDecoration({marker:g,x:h.col,width:h.size,backgroundColor:_.matchBackground,overviewRulerOptions:this._highlightedLines.has(g.line)?void 0:{color:_.matchOverviewRuler,position:"center"}});if(l){const p=[];p.push(g),p.push(l.onRender(u=>this._applyStyles(u,_.matchBorder,!1))),p.push(l.onDispose(()=>(0,t.disposeArray)(p)))}return l}}n.SearchAddon=a})(),d})())})(Ca);var kh=Ca.exports,Ea={exports:{}};(function(i,c){(function(s,m){i.exports=m()})(self,()=>(()=>{var s={6:(n,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LinkComputer=e.WebLinkProvider=void 0,e.WebLinkProvider=class{constructor(r,a,o,h={}){this._terminal=r,this._regex=a,this._handler=o,this._options=h}provideLinks(r,a){const o=t.computeLink(r,this._regex,this._terminal,this._handler);a(this._addCallbacks(o))}_addCallbacks(r){return r.map(a=>(a.leave=this._options.leave,a.hover=(o,h)=>{if(this._options.hover){const{range:_}=a;this._options.hover(o,h,_)}},a))}};class t{static computeLink(a,o,h,_){const v=new RegExp(o.source,(o.flags||"")+"g"),[g,l]=t._getWindowedLineStrings(a-1,h),p=g.join("");let u;const f=[];for(;u=v.exec(p);){const y=u[0];try{const O=new URL(y),N=decodeURI(O.toString());if(y!==N&&y+"/"!==N)continue}catch{continue}const[b,A]=t._mapStrIdx(h,l,0,u.index),[R,C]=t._mapStrIdx(h,b,A,y.length);if(b===-1||A===-1||R===-1||C===-1)continue;const L={start:{x:A+1,y:b+1},end:{x:C,y:R+1}};f.push({range:L,text:y,activate:_})}return f}static _getWindowedLineStrings(a,o){let h,_=a,v=a,g=0,l="";const p=[];if(h=o.buffer.active.getLine(a)){const u=h.translateToString(!0);if(h.isWrapped&&u[0]!==" "){for(g=0;(h=o.buffer.active.getLine(--_))&&g<2048&&(l=h.translateToString(!0),g+=l.length,p.push(l),h.isWrapped&&l.indexOf(" ")===-1););p.reverse()}for(p.push(u),g=0;(h=o.buffer.active.getLine(++v))&&h.isWrapped&&g<2048&&(l=h.translateToString(!0),g+=l.length,p.push(l),l.indexOf(" ")===-1););}return[p,_]}static _mapStrIdx(a,o,h,_){const v=a.buffer.active,g=v.getNullCell();let l=h;for(;_;){const p=v.getLine(o);if(!p)return[-1,-1];for(let u=l;u<p.length;++u){p.getCell(u,g);const f=g.getChars();if(g.getWidth()&&(_-=f.length||1,u===p.length-1&&f==="")){const y=v.getLine(o+1);y&&y.isWrapped&&(y.getCell(0,g),g.getWidth()===2&&(_+=1))}if(_<0)return[o,u]}o++,l=0}return[o,l]}}e.LinkComputer=t}},m={};function w(n){var e=m[n];if(e!==void 0)return e.exports;var t=m[n]={exports:{}};return s[n](t,t.exports,w),t.exports}var d={};return(()=>{var n=d;Object.defineProperty(n,"__esModule",{value:!0}),n.WebLinksAddon=void 0;const e=w(6),t=/https?:[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function r(a,o){const h=window.open();if(h){try{h.opener=null}catch{}h.location.href=o}else console.warn("Opening link blocked as opener could not be cleared")}n.WebLinksAddon=class{constructor(a=r,o={}){this._handler=a,this._options=o}activate(a){this._terminal=a;const o=this._options,h=o.urlRegex||t;this._linkProvider=this._terminal.registerLinkProvider(new e.WebLinkProvider(this._terminal,h,this._handler,o))}dispose(){var a;(a=this._linkProvider)===null||a===void 0||a.dispose()}}})(),d})())})(Ea);var Rh=Ea.exports;const Th=i=>(Pa("data-v-d579c4b5"),i=i(),Da(),i),Lh={class:"terminal-box"},Ih={class:"info-box"},xh={class:"title"},Bh=Th(()=>Vt("div",{class:"terminal-content"},[Vt("div",{id:"terminal"})],-1)),Oh={__name:"index",setup(i){const c=js(null),s=js(null),m=Ta(()=>c.value===null?"连接中...":c.value?"连接成功":"连接失败");function w(){const n=window.location.hash,e=decodeURIComponent(n==null?void 0:n.split("?")[1]);if(e){const t=e.split("&"),r={};return t.forEach(a=>{const[o,h]=a.split("=");r[o]=h}),r}else return null}function d(){const n=w();if(s.value=n,n==null){alert("请传递参数");return}const e=n.userName,t=n.password,r=n.clientId,a=n.url,o=`zbgd/v3/terminal/dev/${r}`,h=`zbgd/v3/terminal/web/${r}`,_=new Eh.Terminal({cursorBlink:!0,macOptionIsMeta:!0,scrollback:1e4});_.attachCustomKeyEventHandler(u);const v=new Ah.FitAddon;_.loadAddon(v),_.loadAddon(new Rh.WebLinksAddon),_.loadAddon(new kh.SearchAddon),_.open(document.getElementById("terminal")),v.fit(),_.resize(15,50),console.log(`size: ${_.cols} columns, ${_.rows} rows`),v.fit(),_.writeln("You can copy with ctrl+shift+x"),_.writeln("You can paste with ctrl+shift+v"),_.writeln("Press Enter key to activate the terminal"),_.onData(b=>{console.log("browser terminal received new data:",b);var A={method:"control",uuid:f(),timestamp:Date.now(),device_id:r,source:"web",data:{input:b}};g.publish(h,JSON.stringify(A))});const g=Ch.connect(a,{username:e,password:t,clientId:e});g.subscribe(o),document.getElementById("status"),g.on("message",function(b,A){if(console.log(b),console.log(A),b==o){let R=JSON.parse(A);console.log("new output received from server:",R.data.output),_.write(R.data.output)}}),g.on("connect",()=>{l(),c.value=!0}),g.on("disconnect",()=>{c.value=!1});function l(){v.fit();const b={cols:_.cols,rows:_.rows};console.log("sending new dimensions to server's pty",b);var A={method:"resize",uuid:f(),timestamp:Date.now(),device_id:r,source:"web",data:{input:b}};g.publish(h,JSON.stringify(A))}function p(b,A){let R;return function(...C){const L=this;clearTimeout(R),R=setTimeout(()=>b.apply(L,C),A)}}function u(b){if(b.type!=="keydown")return!0;if(b.ctrlKey&&b.shiftKey){const A=b.key.toLowerCase();if(A==="v")return navigator.clipboard.readText().then(R=>{_.writeText(R)}),!1;if(A==="c"||A==="x"){const R=_.getSelection();return navigator.clipboard.writeText(R),_.focus(),!1}}return!0}function f(){for(var b=[],A="0123456789abcdef",R=0;R<36;R++)b[R]=A.substr(Math.floor(Math.random()*16),1);b[14]="4",b[19]=A.substr(b[19]&3|8,1),b[8]=b[13]=b[18]=b[23]="-";var C=b.join("");return C}const y=50;window.onresize=p(l,y)}return La(()=>{d()}),(n,e)=>{var t,r;return Ia(),xa("div",Lh,[Vt("div",Ih,[Vt("p",xh,[Ba(" MQTT Status:"),Vt("span",{id:"status",class:Oa(c.value?"success":"danger")},$r(m.value),3)]),Vt("p",null,"mqtt_user: "+$r((t=s.value)==null?void 0:t.clientId),1),Vt("p",null,"mqttUrl: "+$r((r=s.value)==null?void 0:r.url),1)]),Bh])}}},Mh=Ra(Oh,[["__scopeId","data-v-d579c4b5"]]);export{Mh as default};
